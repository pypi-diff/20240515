# Comparing `tmp/bert4keras3-1.3b0-py3-none-any.whl.zip` & `tmp/bert4keras3-1.3rc0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,30 +1,30 @@
-Zip file size: 77750 bytes, number of entries: 28
--rw-rw-rw-  2.0 fat      300 b- defN 24-Apr-30 17:24 bert4keras3/__init__.py
--rw-rw-rw-  2.0 fat    23146 b- defN 24-Apr-30 17:24 bert4keras3/backend.py
--rw-rw-rw-  2.0 fat    11419 b- defN 24-Apr-30 17:24 bert4keras3/layers.py
--rw-rw-rw-  2.0 fat     5506 b- defN 24-Apr-30 17:24 bert4keras3/models.py
--rw-rw-rw-  2.0 fat    30152 b- defN 24-Apr-30 17:24 bert4keras3/ops.py
--rw-rw-rw-  2.0 fat    27955 b- defN 24-Apr-30 17:24 bert4keras3/snippets.py
--rw-rw-rw-  2.0 fat    15509 b- defN 24-Apr-30 17:24 bert4keras3/tokenizers.py
--rw-rw-rw-  2.0 fat    28576 b- defN 24-Apr-30 17:24 bert4keras3/transformers.py
--rw-rw-rw-  2.0 fat    19920 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/Attentions.py
--rw-rw-rw-  2.0 fat    17887 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/Embeddings.py
--rw-rw-rw-  2.0 fat     4546 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/FFN.py
--rw-rw-rw-  2.0 fat     4233 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/GP.py
--rw-rw-rw-  2.0 fat     7551 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/LayerNorms.py
--rw-rw-rw-  2.0 fat      384 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/__init__.py
--rw-rw-rw-  2.0 fat     3374 b- defN 24-Apr-30 17:24 bert4keras3/Layers_add/sampler.py
--rw-rw-rw-  2.0 fat     6078 b- defN 24-Apr-30 17:24 bert4keras3/Models/Alberts.py
--rw-rw-rw-  2.0 fat    23889 b- defN 24-Apr-30 17:24 bert4keras3/Models/Berts.py
--rw-rw-rw-  2.0 fat     2775 b- defN 24-Apr-30 17:24 bert4keras3/Models/GAUs.py
--rw-rw-rw-  2.0 fat    15439 b- defN 24-Apr-30 17:24 bert4keras3/Models/GPTs.py
--rw-rw-rw-  2.0 fat     8857 b- defN 24-Apr-30 17:24 bert4keras3/Models/LLamas.py
--rw-rw-rw-  2.0 fat    12053 b- defN 24-Apr-30 17:24 bert4keras3/Models/Roformers.py
--rw-rw-rw-  2.0 fat    33118 b- defN 24-Apr-30 17:24 bert4keras3/Models/T5models.py
--rw-rw-rw-  2.0 fat      152 b- defN 24-Apr-30 17:24 bert4keras3/Models/__init__.py
--rw-rw-rw-  2.0 fat    11358 b- defN 24-Apr-30 17:25 bert4keras3-1.3b0.dist-info/LICENSE
--rw-rw-rw-  2.0 fat      221 b- defN 24-Apr-30 17:25 bert4keras3-1.3b0.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-30 17:25 bert4keras3-1.3b0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       12 b- defN 24-Apr-30 17:25 bert4keras3-1.3b0.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     2365 b- defN 24-Apr-30 17:25 bert4keras3-1.3b0.dist-info/RECORD
-28 files, 316867 bytes uncompressed, 73964 bytes compressed:  76.7%
+Zip file size: 77725 bytes, number of entries: 28
+-rw-rw-rw-  2.0 fat      300 b- defN 24-May-07 02:51 bert4keras3/__init__.py
+-rw-rw-rw-  2.0 fat    26329 b- defN 24-May-07 02:51 bert4keras3/backend.py
+-rw-rw-rw-  2.0 fat     8254 b- defN 24-May-07 02:51 bert4keras3/layers.py
+-rw-rw-rw-  2.0 fat     5506 b- defN 24-May-07 02:51 bert4keras3/models.py
+-rw-rw-rw-  2.0 fat    30152 b- defN 24-May-07 02:51 bert4keras3/ops.py
+-rw-rw-rw-  2.0 fat    27955 b- defN 24-May-07 02:51 bert4keras3/snippets.py
+-rw-rw-rw-  2.0 fat    15509 b- defN 24-May-07 02:51 bert4keras3/tokenizers.py
+-rw-rw-rw-  2.0 fat    28576 b- defN 24-May-07 02:51 bert4keras3/transformers.py
+-rw-rw-rw-  2.0 fat    19920 b- defN 24-May-07 02:51 bert4keras3/Layers_add/Attentions.py
+-rw-rw-rw-  2.0 fat    17887 b- defN 24-May-07 02:51 bert4keras3/Layers_add/Embeddings.py
+-rw-rw-rw-  2.0 fat     4436 b- defN 24-May-07 02:51 bert4keras3/Layers_add/FFN.py
+-rw-rw-rw-  2.0 fat     4233 b- defN 24-May-07 02:51 bert4keras3/Layers_add/GP.py
+-rw-rw-rw-  2.0 fat     7551 b- defN 24-May-07 02:51 bert4keras3/Layers_add/LayerNorms.py
+-rw-rw-rw-  2.0 fat      384 b- defN 24-May-07 02:51 bert4keras3/Layers_add/__init__.py
+-rw-rw-rw-  2.0 fat     3374 b- defN 24-May-07 02:51 bert4keras3/Layers_add/sampler.py
+-rw-rw-rw-  2.0 fat     6078 b- defN 24-May-07 02:51 bert4keras3/Models/Alberts.py
+-rw-rw-rw-  2.0 fat    23889 b- defN 24-May-07 02:51 bert4keras3/Models/Berts.py
+-rw-rw-rw-  2.0 fat     2775 b- defN 24-May-07 02:51 bert4keras3/Models/GAUs.py
+-rw-rw-rw-  2.0 fat    15439 b- defN 24-May-07 02:51 bert4keras3/Models/GPTs.py
+-rw-rw-rw-  2.0 fat     8857 b- defN 24-May-07 02:51 bert4keras3/Models/LLamas.py
+-rw-rw-rw-  2.0 fat    12053 b- defN 24-May-07 02:51 bert4keras3/Models/Roformers.py
+-rw-rw-rw-  2.0 fat    33118 b- defN 24-May-07 02:51 bert4keras3/Models/T5models.py
+-rw-rw-rw-  2.0 fat      152 b- defN 24-May-07 02:51 bert4keras3/Models/__init__.py
+-rw-rw-rw-  2.0 fat    11358 b- defN 24-May-07 02:52 bert4keras3-1.3rc0.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat      222 b- defN 24-May-07 02:52 bert4keras3-1.3rc0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-May-07 02:52 bert4keras3-1.3rc0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       12 b- defN 24-May-07 02:52 bert4keras3-1.3rc0.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     2369 b- defN 24-May-07 02:52 bert4keras3-1.3rc0.dist-info/RECORD
+28 files, 316780 bytes uncompressed, 73929 bytes compressed:  76.7%
```

## zipnote {}

```diff
@@ -63,23 +63,23 @@
 
 Filename: bert4keras3/Models/T5models.py
 Comment: 
 
 Filename: bert4keras3/Models/__init__.py
 Comment: 
 
-Filename: bert4keras3-1.3b0.dist-info/LICENSE
+Filename: bert4keras3-1.3rc0.dist-info/LICENSE
 Comment: 
 
-Filename: bert4keras3-1.3b0.dist-info/METADATA
+Filename: bert4keras3-1.3rc0.dist-info/METADATA
 Comment: 
 
-Filename: bert4keras3-1.3b0.dist-info/WHEEL
+Filename: bert4keras3-1.3rc0.dist-info/WHEEL
 Comment: 
 
-Filename: bert4keras3-1.3b0.dist-info/top_level.txt
+Filename: bert4keras3-1.3rc0.dist-info/top_level.txt
 Comment: 
 
-Filename: bert4keras3-1.3b0.dist-info/RECORD
+Filename: bert4keras3-1.3rc0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## bert4keras3/backend.py

```diff
@@ -82,15 +82,102 @@
     return ops.convert_to_numpy(x.shape)
 def gelu_erf(x):
     """基于Erf直接计算的gelu函数
     """
     return 0.5 * x * (1.0 + ops.erf(x / np.sqrt(2.0)))
 
 
+if (not is_tf_keras) and keras.__version__ < '2.3':
+    import tensorflow as tf
+    class Layer(keras.layers.Layer):
+        """重新定义Layer，赋予“层中层”功能
+        （仅keras 2.3以下版本需要）
+        """
+        def __init__(self, **kwargs):
+            super(Layer, self).__init__(**kwargs)
+            self.supports_masking = True  # 本项目的自定义层均可mask
 
+        def __setattr__(self, name, value):
+            if isinstance(value, keras.layers.Layer):
+                if not hasattr(self, '_layers'):
+                    self._layers = []
+                if value not in self._layers:
+                    self._layers.append(value)
+            super(Layer, self).__setattr__(name, value)
+
+        @property
+        def trainable_weights(self):
+            trainable = getattr(self, 'trainable', True)
+            if trainable:
+                trainable_weights = super(Layer, self).trainable_weights[:]
+                for l in getattr(self, '_layers', []):
+                    trainable_weights += l.trainable_weights
+                return trainable_weights
+            else:
+                return []
+
+        @property
+        def non_trainable_weights(self):
+            trainable = getattr(self, 'trainable', True)
+            non_trainable_weights = super(Layer, self).non_trainable_weights[:]
+            for l in getattr(self, '_layers', []):
+                if trainable:
+                    non_trainable_weights += l.non_trainable_weights
+                else:
+                    non_trainable_weights += l.weights
+            return non_trainable_weights
+
+    if keras.__version__ < '2.2.5':
+
+        import inspect
+
+        class Model(keras.models.Model):
+            """重新定义Model，整合fit和fit_generator
+            """
+            def fit(self, x=None, *args, **kwargs):
+                if inspect.isgenerator(x):
+                    return self.fit_generator(x, *args, **kwargs)
+                else:
+                    return super(Model, self).fit(x, *args, **kwargs)
+
+        keras.models.Model = Model
+
+else:
+
+    class Layer(keras.layers.Layer):
+        def __init__(self, **kwargs):
+            super(Layer, self).__init__(**kwargs)
+            self.supports_masking = True  # 本项目的自定义层均可mask
+keras.Layer = Layer
+if ((not is_tf_keras) or tf.__version__ < '1.15') and keras.__version__ < '3':
+
+    if not is_tf_keras:
+        NodeBase = keras.engine.base_layer.Node
+    else:
+        from tensorflow.python.keras.engine import base_layer
+        NodeBase = base_layer.Node
+
+    class Node(NodeBase):
+        """修改Node来修复keras下孪生网络的bug
+        注意：这是keras的bug，并不是bert4keras的bug，但keras已经不更新了，
+             所以只好在这里进行修改。tf 1.15+自带的keras已经修改了这个
+             bug。
+        """
+        @property
+        def arguments(self):
+            return self._arguments.copy()
+
+        @arguments.setter
+        def arguments(self, value):
+            self._arguments = value or {}
+
+    if not is_tf_keras:
+        keras.engine.base_layer.Node = Node
+    else:
+        base_layer.Node = Node
 def integerize_shape(func):
     """装饰器，保证input_shape一定是int或None
     """
     def convert(item):
         if hasattr(item, '__iter__'):
             return [convert(i) for i in item]
         elif hasattr(item, 'value'):
```

## bert4keras3/layers.py

```diff
@@ -16,103 +16,15 @@
 from bert4keras3.Layers_add.Embeddings import *
 from bert4keras3.Layers_add.GP import *
 from bert4keras3.Layers_add.LayerNorms import *
 from bert4keras3.Layers_add.Attentions import *
 from bert4keras3.Layers_add.FFN import *
 
 
-if (not is_tf_keras) and keras.__version__ < '2.3':
-    import tensorflow as tf
-    class Layer(keras.layers.Layer):
-        """重新定义Layer，赋予“层中层”功能
-        （仅keras 2.3以下版本需要）
-        """
-        def __init__(self, **kwargs):
-            super(Layer, self).__init__(**kwargs)
-            self.supports_masking = True  # 本项目的自定义层均可mask
 
-        def __setattr__(self, name, value):
-            if isinstance(value, keras.layers.Layer):
-                if not hasattr(self, '_layers'):
-                    self._layers = []
-                if value not in self._layers:
-                    self._layers.append(value)
-            super(Layer, self).__setattr__(name, value)
-
-        @property
-        def trainable_weights(self):
-            trainable = getattr(self, 'trainable', True)
-            if trainable:
-                trainable_weights = super(Layer, self).trainable_weights[:]
-                for l in getattr(self, '_layers', []):
-                    trainable_weights += l.trainable_weights
-                return trainable_weights
-            else:
-                return []
-
-        @property
-        def non_trainable_weights(self):
-            trainable = getattr(self, 'trainable', True)
-            non_trainable_weights = super(Layer, self).non_trainable_weights[:]
-            for l in getattr(self, '_layers', []):
-                if trainable:
-                    non_trainable_weights += l.non_trainable_weights
-                else:
-                    non_trainable_weights += l.weights
-            return non_trainable_weights
-
-    if keras.__version__ < '2.2.5':
-
-        import inspect
-
-        class Model(keras.models.Model):
-            """重新定义Model，整合fit和fit_generator
-            """
-            def fit(self, x=None, *args, **kwargs):
-                if inspect.isgenerator(x):
-                    return self.fit_generator(x, *args, **kwargs)
-                else:
-                    return super(Model, self).fit(x, *args, **kwargs)
-
-        keras.models.Model = Model
-
-else:
-
-    class Layer(keras.layers.Layer):
-        def __init__(self, **kwargs):
-            super(Layer, self).__init__(**kwargs)
-            self.supports_masking = True  # 本项目的自定义层均可mask
-
-
-if ((not is_tf_keras) or tf.__version__ < '1.15') and keras.__version__ < '3':
-
-    if not is_tf_keras:
-        NodeBase = keras.engine.base_layer.Node
-    else:
-        from tensorflow.python.keras.engine import base_layer
-        NodeBase = base_layer.Node
-
-    class Node(NodeBase):
-        """修改Node来修复keras下孪生网络的bug
-        注意：这是keras的bug，并不是bert4keras的bug，但keras已经不更新了，
-             所以只好在这里进行修改。tf 1.15+自带的keras已经修改了这个
-             bug。
-        """
-        @property
-        def arguments(self):
-            return self._arguments.copy()
-
-        @arguments.setter
-        def arguments(self, value):
-            self._arguments = value or {}
-
-    if not is_tf_keras:
-        keras.engine.base_layer.Node = Node
-    else:
-        base_layer.Node = Node
 
 
 class GlobalAveragePooling1D(keras.layers.GlobalAveragePooling1D):
     """重新定义GlobalAveragePooling1D，支持序列长度为None
     """
     def call(self, inputs, mask=None):
         axis = 1 if self.data_format == 'channels_last' else 2
```

## bert4keras3/Layers_add/FFN.py

```diff
@@ -120,14 +120,12 @@
             name="feedforward_output_dense",
         )
     @recompute_grad
     def call(self, x):
 
         activation = activations.get(self.activation[0])
         gate_output = self._feedforward_gate_dense(x)
-        #gate_output = ops.cast(gate_output, "float32")
         gate_output = activation(gate_output)
-        #gate_output = ops.cast(gate_output, x.dtype)
         x = self._feedforward_intermediate_dense(x)
         x = self._feedforward_output_dense(ops.multiply(x, gate_output))
         return x#
```

## Comparing `bert4keras3-1.3b0.dist-info/LICENSE` & `bert4keras3-1.3rc0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `bert4keras3-1.3b0.dist-info/RECORD` & `bert4keras3-1.3rc0.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,28 +1,28 @@
 bert4keras3/__init__.py,sha256=29y0RGIvNTBhSGTAOdNCMCUhlL3_s7x05sX_fdcjjhA,300
-bert4keras3/backend.py,sha256=D-9WqJu_Xu37hoHecwQyZmhMgIWrli38_ny8SyW9ZXE,23146
-bert4keras3/layers.py,sha256=IbVd3zYbsXhjeVOjcA0TSpuIbfa3eAJQ6f9N_eXnYO4,11419
+bert4keras3/backend.py,sha256=IfRrjkG7ww6d-kFbtunqaDysDa7jrX-FUXy4qrBhEoo,26329
+bert4keras3/layers.py,sha256=XiPKU3TrkhmtDhxXpDqHoD-QI-sKZx_PqZkowd1NvkA,8254
 bert4keras3/models.py,sha256=Iz6HP22lfNEbcXMlBBxeYdCAqu-t6w_pczkYsrZ6qIM,5506
 bert4keras3/ops.py,sha256=H1sbMv6WOJ5iGAB0rosPz9LoqdT0jS8knLRW_6XkFRU,30152
 bert4keras3/snippets.py,sha256=YwdYRvrewhM6g8ax9_Ath0HsJATzuyZksL5Dow9l65A,27955
 bert4keras3/tokenizers.py,sha256=PCxtC4L9tF2w-GUDujdPK8Z5WlnbaL8mYhRfHn1S_Qg,15509
 bert4keras3/transformers.py,sha256=g0-dYhls5_Og9bWCBkIgGpofK-sScFnqZO0kqAKmbkE,28576
 bert4keras3/Layers_add/Attentions.py,sha256=413rnVV4mSw_1dM9hynnYwBICx0aQM5l77Z9xR-kytA,19920
 bert4keras3/Layers_add/Embeddings.py,sha256=ouDdsbL0MCPjbl7rHyWzjSKy-U9U1a18BrMjCPqKn6o,17887
-bert4keras3/Layers_add/FFN.py,sha256=AtDY4woLD71m7KqswqV8HbK-9qOAjpayjt9NIMO1k6s,4546
+bert4keras3/Layers_add/FFN.py,sha256=aYIZ8BzmO2RzUMO65DatJEmeTxUjvnl1lJ6W5IIjqgk,4436
 bert4keras3/Layers_add/GP.py,sha256=fpKU4XhEZMTwb-LS9ApSQR8icbtstIZZaJ41jeH-qGY,4233
 bert4keras3/Layers_add/LayerNorms.py,sha256=Bgl-3N_g4OXaH6vX91Rm1Ig2x-J7nzvNgL5oMTulBqs,7551
 bert4keras3/Layers_add/__init__.py,sha256=24feh_P-5Hw1jbrfLJJo54DNtF-eV08tXPHNCmJh17Y,384
 bert4keras3/Layers_add/sampler.py,sha256=9n_d3p-RRJMqLyGAHqb2CarkGMGp4mGm-h7tBej-_I4,3374
 bert4keras3/Models/Alberts.py,sha256=uDue4rNrGgIWo02PubpeVaBL3x5-WckwBsP6QC8Cgvo,6078
 bert4keras3/Models/Berts.py,sha256=to92hpqZcEvwIVBH43oDx9P5yWcVfk6bvgorcCwFM6k,23889
 bert4keras3/Models/GAUs.py,sha256=KdYfhoADsVTIUKQ2loxeyChPFyCsjOfyO6w2Gr8EQrM,2775
 bert4keras3/Models/GPTs.py,sha256=OOqoHUpGatYDEbX3KyYPd9kqw0EA4fw0PeoX456ixEg,15439
 bert4keras3/Models/LLamas.py,sha256=-ppR72_JXRjOQaEC9gAnIfsRjRECTv2wXu8hCt-AvE4,8857
 bert4keras3/Models/Roformers.py,sha256=3KWBOfJksIxddQmnK6_6WzyqhFJ8DcR_1eTXKLmXcIQ,12053
 bert4keras3/Models/T5models.py,sha256=QrzcCQ6rIEcfYakTJgrzeyqlmj5aUz1gehWkZhqRhxU,33118
 bert4keras3/Models/__init__.py,sha256=mU4QuR6NHq05HAT9a2kzC_pLvCysRYZ_u1H4OjcdYHQ,152
-bert4keras3-1.3b0.dist-info/LICENSE,sha256=z8d0m5b2O9McPEK1xHG_dWgUBT6EfBDz6wA0F7xSPTA,11358
-bert4keras3-1.3b0.dist-info/METADATA,sha256=eBpaGRtOSjIlPllcVvt91md7syF7-S-m_2_k3vY_XLE,221
-bert4keras3-1.3b0.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-bert4keras3-1.3b0.dist-info/top_level.txt,sha256=cPWwwxSejEMpgAZFzYQc0WmhPrF3XwP3k1IwRO93gwQ,12
-bert4keras3-1.3b0.dist-info/RECORD,,
+bert4keras3-1.3rc0.dist-info/LICENSE,sha256=z8d0m5b2O9McPEK1xHG_dWgUBT6EfBDz6wA0F7xSPTA,11358
+bert4keras3-1.3rc0.dist-info/METADATA,sha256=EyYlrcQ2UZdbZwCQBmka7AXN9Jr8MS7v0ZYY8dZ_uwE,222
+bert4keras3-1.3rc0.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
+bert4keras3-1.3rc0.dist-info/top_level.txt,sha256=cPWwwxSejEMpgAZFzYQc0WmhPrF3XwP3k1IwRO93gwQ,12
+bert4keras3-1.3rc0.dist-info/RECORD,,
```

