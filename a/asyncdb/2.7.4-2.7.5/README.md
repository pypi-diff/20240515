# Comparing `tmp/asyncdb-2.7.4-pp39-pypy39_pp73-win_amd64.whl.zip` & `tmp/asyncdb-2.7.5-pp39-pypy39_pp73-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,71 +1,71 @@
-Zip file size: 217442 bytes, number of entries: 69
--rw-rw-rw-  2.0 fat      411 b- defN 24-May-14 00:32 asyncdb/__init__.py
--rw-rw-rw-  2.0 fat     1329 b- defN 24-May-14 00:32 asyncdb/connections.py
--rw-rw-rw-  2.0 fat    25523 b- defN 24-May-14 00:32 asyncdb/interfaces.py
--rw-rw-rw-  2.0 fat        0 b- defN 24-May-14 00:32 asyncdb/py.typed
--rw-rw-rw-  2.0 fat      280 b- defN 24-May-14 00:32 asyncdb/version.py
--rw-rw-rw-  2.0 fat       28 b- defN 24-May-14 00:32 asyncdb/drivers/__init__.py
--rw-rw-rw-  2.0 fat     4529 b- defN 24-May-14 00:32 asyncdb/drivers/abstract.py
--rw-rw-rw-  2.0 fat    19346 b- defN 24-May-14 00:32 asyncdb/drivers/bigquery.py
--rw-rw-rw-  2.0 fat    17209 b- defN 24-May-14 00:32 asyncdb/drivers/cassandra.py
--rw-rw-rw-  2.0 fat    14737 b- defN 24-May-14 00:32 asyncdb/drivers/delta.py
--rw-rw-rw-  2.0 fat    10233 b- defN 24-May-14 00:32 asyncdb/drivers/duckdb.py
--rw-rw-rw-  2.0 fat     2110 b- defN 24-May-14 00:32 asyncdb/drivers/dummy.py
--rw-rw-rw-  2.0 fat    13068 b- defN 24-May-14 00:32 asyncdb/drivers/hazel.py
--rw-rw-rw-  2.0 fat    20827 b- defN 24-May-14 00:32 asyncdb/drivers/influx.py
--rw-rw-rw-  2.0 fat    29764 b- defN 24-May-14 00:32 asyncdb/drivers/jdbc.py
--rw-rw-rw-  2.0 fat     6638 b- defN 24-May-14 00:32 asyncdb/drivers/mcache.py
--rw-rw-rw-  2.0 fat     9336 b- defN 24-May-14 00:32 asyncdb/drivers/memcache.py
--rw-rw-rw-  2.0 fat     3316 b- defN 24-May-14 00:32 asyncdb/drivers/mongo.py
--rw-rw-rw-  2.0 fat    19474 b- defN 24-May-14 00:32 asyncdb/drivers/mredis.py
--rw-rw-rw-  2.0 fat    15824 b- defN 24-May-14 00:32 asyncdb/drivers/mssql.py
--rw-rw-rw-  2.0 fat    16072 b- defN 24-May-14 00:32 asyncdb/drivers/mysql.py
--rw-rw-rw-  2.0 fat    18635 b- defN 24-May-14 00:32 asyncdb/drivers/mysqlclient.py
--rw-rw-rw-  2.0 fat     8036 b- defN 24-May-14 00:32 asyncdb/drivers/odbc.py
--rw-rw-rw-  2.0 fat     4206 b- defN 24-May-14 00:32 asyncdb/drivers/oracle.py
--rw-rw-rw-  2.0 fat    61614 b- defN 24-May-14 00:32 asyncdb/drivers/pg.py
--rw-rw-rw-  2.0 fat    22590 b- defN 24-May-14 00:32 asyncdb/drivers/postgres.py
--rw-rw-rw-  2.0 fat    19814 b- defN 24-May-14 00:32 asyncdb/drivers/redis.py
--rw-rw-rw-  2.0 fat    35185 b- defN 24-May-14 00:32 asyncdb/drivers/rethink.py
--rw-rw-rw-  2.0 fat    16815 b- defN 24-May-14 00:32 asyncdb/drivers/sa.py
--rw-rw-rw-  2.0 fat    56513 b- defN 24-May-14 00:32 asyncdb/drivers/scylladb.py
--rw-rw-rw-  2.0 fat     2071 b- defN 24-May-14 00:32 asyncdb/drivers/sql.py
--rw-rw-rw-  2.0 fat    25972 b- defN 24-May-14 00:32 asyncdb/drivers/sqlite.py
--rw-rw-rw-  2.0 fat    14374 b- defN 24-May-14 00:32 asyncdb/drivers/sqlserver.py
--rw-rw-rw-  2.0 fat      513 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/__init__.py
--rw-rw-rw-  2.0 fat      848 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/arrow.py
--rw-rw-rw-  2.0 fat      429 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/base.py
--rw-rw-rw-  2.0 fat      997 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/csv.py
--rw-rw-rw-  2.0 fat      693 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/dataclass.py
--rw-rw-rw-  2.0 fat      827 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/dt.py
--rw-rw-rw-  2.0 fat      408 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/generator.py
--rw-rw-rw-  2.0 fat      543 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/iter.py
--rw-rw-rw-  2.0 fat      418 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/json.py
--rw-rw-rw-  2.0 fat      986 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/output.py
--rw-rw-rw-  2.0 fat     1021 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/pandas.py
--rw-rw-rw-  2.0 fat      864 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/polars.py
--rw-rw-rw-  2.0 fat     1236 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/pyspark.py
--rw-rw-rw-  2.0 fat     1038 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/record.py
--rw-rw-rw-  2.0 fat      770 b- defN 24-May-14 00:32 asyncdb/drivers/outputs/recordset.py
--rw-rw-rw-  2.0 fat      867 b- defN 24-May-14 00:32 asyncdb/exceptions/__init__.py
--rw-rw-rw-  2.0 fat   158720 b- defN 24-May-14 00:39 asyncdb/exceptions/exceptions.pypy39-pp73-win_amd64.pyd
--rw-rw-rw-  2.0 fat     2539 b- defN 24-May-14 00:32 asyncdb/exceptions/handlers.py
--rw-rw-rw-  2.0 fat      176 b- defN 24-May-14 00:32 asyncdb/meta/__init__.py
--rw-rw-rw-  2.0 fat     3057 b- defN 24-May-14 00:32 asyncdb/meta/record.py
--rw-rw-rw-  2.0 fat     2221 b- defN 24-May-14 00:32 asyncdb/meta/recordset.py
--rw-rw-rw-  2.0 fat      542 b- defN 24-May-14 00:32 asyncdb/models/__init__.py
--rw-rw-rw-  2.0 fat    17784 b- defN 24-May-14 00:32 asyncdb/models/model.py
--rw-rw-rw-  2.0 fat      136 b- defN 24-May-14 00:32 asyncdb/utils/__init__.py
--rw-rw-rw-  2.0 fat     2484 b- defN 24-May-14 00:32 asyncdb/utils/functions.py
--rw-rw-rw-  2.0 fat      655 b- defN 24-May-14 00:32 asyncdb/utils/modules.py
--rw-rw-rw-  2.0 fat   111616 b- defN 24-May-14 00:39 asyncdb/utils/types.pypy39-pp73-win_amd64.pyd
--rw-rw-rw-  2.0 fat      319 b- defN 24-May-14 00:32 asyncdb/utils/uv.py
--rw-rw-rw-  2.0 fat      234 b- defN 24-May-14 00:32 asyncdb/utils/encoders/__init__.py
--rw-rw-rw-  2.0 fat      487 b- defN 24-May-14 00:32 asyncdb/utils/encoders/numpy.py
--rw-rw-rw-  2.0 fat     1195 b- defN 24-May-14 00:32 asyncdb/utils/encoders/pg.py
--rw-rw-rw-  2.0 fat     1538 b- defN 24-May-14 00:39 asyncdb-2.7.4.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    12860 b- defN 24-May-14 00:39 asyncdb-2.7.4.dist-info/METADATA
--rw-rw-rw-  2.0 fat      107 b- defN 24-May-14 00:39 asyncdb-2.7.4.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 24-May-14 00:39 asyncdb-2.7.4.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     5791 b- defN 24-May-14 00:39 asyncdb-2.7.4.dist-info/RECORD
-69 files, 850806 bytes uncompressed, 208342 bytes compressed:  75.5%
+Zip file size: 218618 bytes, number of entries: 69
+-rw-rw-rw-  2.0 fat      411 b- defN 24-May-14 16:14 asyncdb/__init__.py
+-rw-rw-rw-  2.0 fat     1329 b- defN 24-May-14 16:14 asyncdb/connections.py
+-rw-rw-rw-  2.0 fat    25834 b- defN 24-May-14 16:14 asyncdb/interfaces.py
+-rw-rw-rw-  2.0 fat        0 b- defN 24-May-14 16:14 asyncdb/py.typed
+-rw-rw-rw-  2.0 fat      280 b- defN 24-May-14 16:14 asyncdb/version.py
+-rw-rw-rw-  2.0 fat       28 b- defN 24-May-14 16:14 asyncdb/drivers/__init__.py
+-rw-rw-rw-  2.0 fat     4529 b- defN 24-May-14 16:14 asyncdb/drivers/abstract.py
+-rw-rw-rw-  2.0 fat    19346 b- defN 24-May-14 16:14 asyncdb/drivers/bigquery.py
+-rw-rw-rw-  2.0 fat    17209 b- defN 24-May-14 16:14 asyncdb/drivers/cassandra.py
+-rw-rw-rw-  2.0 fat    17269 b- defN 24-May-14 16:14 asyncdb/drivers/delta.py
+-rw-rw-rw-  2.0 fat    12185 b- defN 24-May-14 16:14 asyncdb/drivers/duckdb.py
+-rw-rw-rw-  2.0 fat     2110 b- defN 24-May-14 16:14 asyncdb/drivers/dummy.py
+-rw-rw-rw-  2.0 fat    13068 b- defN 24-May-14 16:14 asyncdb/drivers/hazel.py
+-rw-rw-rw-  2.0 fat    20827 b- defN 24-May-14 16:14 asyncdb/drivers/influx.py
+-rw-rw-rw-  2.0 fat    29764 b- defN 24-May-14 16:14 asyncdb/drivers/jdbc.py
+-rw-rw-rw-  2.0 fat     6638 b- defN 24-May-14 16:14 asyncdb/drivers/mcache.py
+-rw-rw-rw-  2.0 fat     9336 b- defN 24-May-14 16:14 asyncdb/drivers/memcache.py
+-rw-rw-rw-  2.0 fat     3316 b- defN 24-May-14 16:14 asyncdb/drivers/mongo.py
+-rw-rw-rw-  2.0 fat    19474 b- defN 24-May-14 16:14 asyncdb/drivers/mredis.py
+-rw-rw-rw-  2.0 fat    15824 b- defN 24-May-14 16:14 asyncdb/drivers/mssql.py
+-rw-rw-rw-  2.0 fat    16072 b- defN 24-May-14 16:14 asyncdb/drivers/mysql.py
+-rw-rw-rw-  2.0 fat    18635 b- defN 24-May-14 16:14 asyncdb/drivers/mysqlclient.py
+-rw-rw-rw-  2.0 fat     8036 b- defN 24-May-14 16:14 asyncdb/drivers/odbc.py
+-rw-rw-rw-  2.0 fat     4206 b- defN 24-May-14 16:14 asyncdb/drivers/oracle.py
+-rw-rw-rw-  2.0 fat    61614 b- defN 24-May-14 16:14 asyncdb/drivers/pg.py
+-rw-rw-rw-  2.0 fat    22590 b- defN 24-May-14 16:14 asyncdb/drivers/postgres.py
+-rw-rw-rw-  2.0 fat    19814 b- defN 24-May-14 16:14 asyncdb/drivers/redis.py
+-rw-rw-rw-  2.0 fat    35185 b- defN 24-May-14 16:14 asyncdb/drivers/rethink.py
+-rw-rw-rw-  2.0 fat    16815 b- defN 24-May-14 16:14 asyncdb/drivers/sa.py
+-rw-rw-rw-  2.0 fat    56513 b- defN 24-May-14 16:14 asyncdb/drivers/scylladb.py
+-rw-rw-rw-  2.0 fat     2071 b- defN 24-May-14 16:14 asyncdb/drivers/sql.py
+-rw-rw-rw-  2.0 fat    25972 b- defN 24-May-14 16:14 asyncdb/drivers/sqlite.py
+-rw-rw-rw-  2.0 fat    14374 b- defN 24-May-14 16:14 asyncdb/drivers/sqlserver.py
+-rw-rw-rw-  2.0 fat      513 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/__init__.py
+-rw-rw-rw-  2.0 fat      848 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/arrow.py
+-rw-rw-rw-  2.0 fat      429 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/base.py
+-rw-rw-rw-  2.0 fat      997 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/csv.py
+-rw-rw-rw-  2.0 fat      693 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/dataclass.py
+-rw-rw-rw-  2.0 fat      827 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/dt.py
+-rw-rw-rw-  2.0 fat      408 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/generator.py
+-rw-rw-rw-  2.0 fat      543 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/iter.py
+-rw-rw-rw-  2.0 fat      418 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/json.py
+-rw-rw-rw-  2.0 fat      986 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/output.py
+-rw-rw-rw-  2.0 fat     1021 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/pandas.py
+-rw-rw-rw-  2.0 fat      864 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/polars.py
+-rw-rw-rw-  2.0 fat     1236 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/pyspark.py
+-rw-rw-rw-  2.0 fat     1038 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/record.py
+-rw-rw-rw-  2.0 fat      770 b- defN 24-May-14 16:14 asyncdb/drivers/outputs/recordset.py
+-rw-rw-rw-  2.0 fat      867 b- defN 24-May-14 16:14 asyncdb/exceptions/__init__.py
+-rw-rw-rw-  2.0 fat   158720 b- defN 24-May-14 16:20 asyncdb/exceptions/exceptions.pypy39-pp73-win_amd64.pyd
+-rw-rw-rw-  2.0 fat     2539 b- defN 24-May-14 16:14 asyncdb/exceptions/handlers.py
+-rw-rw-rw-  2.0 fat      176 b- defN 24-May-14 16:14 asyncdb/meta/__init__.py
+-rw-rw-rw-  2.0 fat     3057 b- defN 24-May-14 16:14 asyncdb/meta/record.py
+-rw-rw-rw-  2.0 fat     2221 b- defN 24-May-14 16:14 asyncdb/meta/recordset.py
+-rw-rw-rw-  2.0 fat      542 b- defN 24-May-14 16:14 asyncdb/models/__init__.py
+-rw-rw-rw-  2.0 fat    17784 b- defN 24-May-14 16:14 asyncdb/models/model.py
+-rw-rw-rw-  2.0 fat      136 b- defN 24-May-14 16:14 asyncdb/utils/__init__.py
+-rw-rw-rw-  2.0 fat     2484 b- defN 24-May-14 16:14 asyncdb/utils/functions.py
+-rw-rw-rw-  2.0 fat      655 b- defN 24-May-14 16:14 asyncdb/utils/modules.py
+-rw-rw-rw-  2.0 fat   111616 b- defN 24-May-14 16:20 asyncdb/utils/types.pypy39-pp73-win_amd64.pyd
+-rw-rw-rw-  2.0 fat      319 b- defN 24-May-14 16:14 asyncdb/utils/uv.py
+-rw-rw-rw-  2.0 fat      234 b- defN 24-May-14 16:14 asyncdb/utils/encoders/__init__.py
+-rw-rw-rw-  2.0 fat      487 b- defN 24-May-14 16:14 asyncdb/utils/encoders/numpy.py
+-rw-rw-rw-  2.0 fat     1195 b- defN 24-May-14 16:14 asyncdb/utils/encoders/pg.py
+-rw-rw-rw-  2.0 fat     1538 b- defN 24-May-14 16:20 asyncdb-2.7.5.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat    12860 b- defN 24-May-14 16:20 asyncdb-2.7.5.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      107 b- defN 24-May-14 16:20 asyncdb-2.7.5.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 24-May-14 16:20 asyncdb-2.7.5.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     5791 b- defN 24-May-14 16:20 asyncdb-2.7.5.dist-info/RECORD
+69 files, 855601 bytes uncompressed, 209518 bytes compressed:  75.5%
```

## zipnote {}

```diff
@@ -186,23 +186,23 @@
 
 Filename: asyncdb/utils/encoders/numpy.py
 Comment: 
 
 Filename: asyncdb/utils/encoders/pg.py
 Comment: 
 
-Filename: asyncdb-2.7.4.dist-info/LICENSE
+Filename: asyncdb-2.7.5.dist-info/LICENSE
 Comment: 
 
-Filename: asyncdb-2.7.4.dist-info/METADATA
+Filename: asyncdb-2.7.5.dist-info/METADATA
 Comment: 
 
-Filename: asyncdb-2.7.4.dist-info/WHEEL
+Filename: asyncdb-2.7.5.dist-info/WHEEL
 Comment: 
 
-Filename: asyncdb-2.7.4.dist-info/top_level.txt
+Filename: asyncdb-2.7.5.dist-info/top_level.txt
 Comment: 
 
-Filename: asyncdb-2.7.4.dist-info/RECORD
+Filename: asyncdb-2.7.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## asyncdb/interfaces.py

```diff
@@ -174,17 +174,25 @@
         try:
             self.params = params.copy()
         except (TypeError, AttributeError, ValueError):
             self.params = {}
         if loop:
             self._loop = loop
         else:
-            self._loop = asyncio.get_event_loop()
-        # if self._loop.is_closed():
-        #     self._loop = asyncio.get_running_loop()
+            try:
+                self._loop = asyncio.get_event_loop()
+            except RuntimeError:
+                self._loop = asyncio.new_event_loop()
+        if self._loop.is_closed():
+            try:
+                self._loop = asyncio.get_running_loop()
+            except RuntimeError:
+                raise RuntimeError(
+                    "No Event Loop running. Please, run this code inside an asyncio loop."
+                )
         asyncio.set_event_loop(self._loop)
         # exception handler
         self._loop.set_exception_handler(default_exception_handler)
         try:
             self._debug = bool(params["DEBUG"])
         except KeyError:
             try:
```

## asyncdb/version.py

```diff
@@ -1,9 +1,9 @@
 """AsyncDB Meta information."""
 
 __title__ = "asyncdb"
 __description__ = "Library for Asynchronous data source connections \
     Collection of asyncio drivers."
-__version__ = "2.7.4"
+__version__ = "2.7.5"
 __author__ = "Jesus Lara"
 __author_email__ = "jesuslarag@gmail.com"
 __license__ = "BSD"
```

## asyncdb/drivers/delta.py

```diff
@@ -323,15 +323,17 @@
             )
         try:
             if df is not None:
                 df.to_parquet(parquet, engine="pyarrow", compression="snappy")
             elif atable is not None:
                 pq.write_table(atable, parquet, compression="snappy")
         except Exception as exc:
-            raise DriverError(f"Query Error: {exc}") from exc
+            raise DriverError(
+                f"Query Error: {exc}"
+            ) from exc
 
     async def write(
         self,
         data:  Union[pd.DataFrame, dt.Frame, pl.DataFrame, Iterable],
         table_id: str,
         path: PurePath,
         if_exists: str = "append",
@@ -421,8 +423,82 @@
             raise DriverError(f"DeltaTable Error: {exc}") from exc
         except Exception as exc:
             error = exc
             raise DriverError(f"Query Error: {exc}") from exc
         finally:
             return [result, error]  # pylint: disable=W0150
 
-    fetch_all = query
+    async def copy_to(
+        self,
+        source: Union[str, Path],
+        destination: Union[str, Path],
+        columns: list[str],
+        separator: str = ",",
+        has_header: bool = True,
+        lazy: bool = True,
+        replace_destination: bool = False,
+        compression: str = 'zstd',
+        **kwargs
+    ) -> Path:
+        """
+        Copy a CSV file efficiently to Parquet using Polars.
+
+        Returns:
+        - Path: Path to the created Parquet file.
+        """
+        if isinstance(source, str):
+            source = Path(source)
+        if isinstance(destination, str):
+            destination = Path(destination)
+
+        if not source.exists():
+            raise FileNotFoundError(
+                f"Parquet: File {source} not found"
+            )
+
+        if destination.exists():
+            if replace_destination is True:
+                destination.unlink()
+            else:
+                raise FileExistsError(
+                    f"Parquet: File {destination} already exists"
+                )
+        else:
+            if destination.parent.exists() is False:
+                destination.parent.mkdir(parents=True, exist_ok=True)
+
+        if lazy is True:
+            mtd = pl.scan_csv
+        else:
+            mtd = pl.read_csv
+        try:
+            df = mtd(
+                source,
+                separator=separator,
+                has_header=has_header,
+                new_columns=columns,  # Pass the column names
+                infer_schema_length=0,     # Infer schema from the first batch of rows
+                low_memory=True,            # Enable low memory mode for large files
+                **kwargs
+            )
+            if lazy is True:
+                df.sink_parquet(
+                    destination,
+                    compression=compression,
+                    row_group_size=100_000
+                )
+            else:
+                df.write_parquet(
+                    destination,
+                    compression=compression,
+                    row_group_size=100_000
+                )
+            # Read the Parquet file metadata
+            pq_file = pq.ParquetFile(destination)
+            metadata = pq_file.metadata
+            return destination, metadata
+        except FileExistsError:
+            raise
+        except Exception as err:
+            raise DriverError(
+                f"Delta: Error on COPY to Parquet: {err!s}"
+            ) from err
```

## asyncdb/drivers/duckdb.py

```diff
@@ -1,24 +1,25 @@
+from pathlib import Path, PurePath
 from typing import Any, Optional, Union
 from collections.abc import Iterable, Sequence
 import asyncio
 import time
-import duckdb as db
+import duckdb as duck
 from ..exceptions import NoDataFound, DriverError
 from ..interfaces import DBCursorBackend
 from .sql import SQLCursor, SQLDriver
 
 
 class duckdbCursor(SQLCursor):
     """
     Cursor Object for SQLite.
     """
 
     _provider: "duckdb"
-    _connection: db.DuckDBPyConnection = None
+    _connection: duck.DuckDBPyConnection = None
 
     async def __aenter__(self) -> "duckdbCursor":
         self._cursor = self._connection.execute(self._sentence, parameters=self._params)
         return self
 
     async def __anext__(self):
         """Use `cursor.fetchrow()` to provide an async iterable.
@@ -42,40 +43,61 @@
 
 
 class duckdb(SQLDriver, DBCursorBackend):
     _provider: str = "duckdb"
     _syntax: str = "sql"
     _dsn: str = "{database}"
 
-    def __init__(self, dsn: str = "", loop: asyncio.AbstractEventLoop = None, params: dict = None, **kwargs) -> None:
+    def __init__(
+        self,
+        dsn: str = "",
+        loop: asyncio.AbstractEventLoop = None,
+        params: dict = None,
+        **kwargs
+    ) -> None:
         SQLDriver.__init__(self, dsn, loop, params, **kwargs)
         DBCursorBackend.__init__(self)
+        self._memory_limit: str = kwargs.get('memory_limit', '1GB')
 
     async def connection(self, **kwargs):
         """
         Get a connection
         """
         self._connection = None
         self._connected = False
+        if not self._dsn:
+            self._dsn = ':memory:'
         try:
-            self._connection = db.connect(database=self._dsn, **kwargs)
+            self._connection = duck.connect(
+                database=self._dsn,
+                **kwargs
+            )
             if self._connection:
+                self._connection.execute(
+                    f"SET memory_limit='{self._memory_limit}'"
+                )
                 if self._init_func is not None and callable(self._init_func):
                     try:
                         await self._init_func(self._connection)  # pylint: disable=E1102
                     except RuntimeError as err:
-                        self._logger.exception(f"Error on Init Connection: {err!s}")
+                        self._logger.exception(
+                            f"Error on Init Connection: {err!s}"
+                        )
                 self._connected = True
                 self._initialized_on = time.time()
             return self
         except duckdb.ConnectionException as e:
-            raise DriverError(f"Unable to Open Database: {self._dsn}, {e}") from e
+            raise DriverError(
+                f"Unable to Open Database: {self._dsn}, {e}"
+            ) from e
         except Exception as e:
             self._logger.exception(e, stack_info=True)
-            raise DriverError(f"SQLite Unknown Error: {e!s}") from e
+            raise DriverError(
+                f"SQLite Unknown Error: {e!s}"
+            ) from e
 
     connect = connection
 
     async def prepare(self, sentence: Union[str, list]) -> Any:
         "Ignoring prepared sentences on DuckDB for now"
         raise NotImplementedError()  # pragma: no cover
 
@@ -92,15 +114,17 @@
         """
         Closing the Connection on DuckDB
         """
         try:
             if self._connection:
                 self._connection.close()
         except Exception as err:
-            raise DriverError(message=f"{__name__!s}: Closing Error: {err!s}") from err
+            raise DriverError(
+                message=f"{__name__!s}: Closing Error: {err!s}"
+            ) from err
         finally:
             self._connection = None
             self._connected = False
 
     async def query(self, sentence: Any, *args, **kwargs) -> Any:
         """
         Getting a Query from Database
@@ -280,7 +304,44 @@
                     return True
                 else:
                     return False
             except Exception as err:
                 raise DriverError(f"Error in Object Creation: {err!s}") from err
         else:
             raise RuntimeError(f"DuckDB: invalid Object type {object!s}")
+
+    async def copy_to(self, sentence: Union[str, Path], destination: str, **kwargs) -> bool:
+        """
+        Copy to a file from a query (or other file).
+        """
+        if isinstance(sentence, PurePath):
+            # SELECT from a File:
+            if sentence.exists():
+                query = f"SELECT * FROM '{sentence}'"
+            else:
+                raise FileNotFoundError(
+                    f"DuckDB: File {sentence} not found"
+                )
+        elif isinstance(sentence, str) and sentence.strip().upper().startswith("SELECT"):
+            query = sentence
+        else:
+            query = f"SELECT * FROM {sentence!s}"
+        # Destination:
+        if destination.stem == '.csv':
+            dest = f"'{destination!s}' (FORMAT CSV, HEADER)"
+        else:
+            dest = f"'{destination!s}' (FORMAT PARQUET, CODEC 'SNAPPY', ROW_GROUP_SIZE 100000);"
+        try:
+            qry = f"COPY ({query}) TO {dest}"
+            result = self._connection.execute(
+                qry
+            )
+            if result:
+                self._connection.commit()
+                # return the name of created file:
+                return destination
+            else:
+                return False
+        except Exception as err:
+            raise DriverError(
+                f"DuckDB: Error on COPY: {err!s}"
+            ) from err
```

## Comparing `asyncdb-2.7.4.dist-info/LICENSE` & `asyncdb-2.7.5.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `asyncdb-2.7.4.dist-info/METADATA` & `asyncdb-2.7.5.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: asyncdb
-Version: 2.7.4
+Version: 2.7.5
 Summary: Library for Asynchronous data source connections     Collection of asyncio drivers.
 Home-page: https://github.com/phenobarbital/asyncdb
 Author: Jesus Lara
 Author-email: jesuslarag@gmail.com
 License: BSD
 Project-URL: Source, https://github.com/phenobarbital/asyncdb
 Project-URL: Funding, https://paypal.me/phenobarbital
```

## Comparing `asyncdb-2.7.4.dist-info/RECORD` & `asyncdb-2.7.5.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,18 +1,18 @@
 asyncdb/__init__.py,sha256=0udlaJRz2alek7XfmdLNCM_kLB6NPY9szC5j4nsu3CU,411
 asyncdb/connections.py,sha256=qMLA_KBhvPYIym-pir8T8gqjIM5qktK9Friv808lHWI,1329
-asyncdb/interfaces.py,sha256=neAlRetp-gjwSSktJF-v3Z5vbJdgtODpTXgb1EKDIYk,25523
+asyncdb/interfaces.py,sha256=-v2Hh7oNi4yh6pOaz1Ld7FH4dukZxF-O2QEUv3TvhLI,25834
 asyncdb/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-asyncdb/version.py,sha256=WnwYfGyVkfWewOWPdpSTiRaXMIsMEb-RaWu4tc9W01k,280
+asyncdb/version.py,sha256=62W8gwHPeGUU_8v4sv8hlsWKLC_IkPT2n1HbUfm_sfM,280
 asyncdb/drivers/__init__.py,sha256=okzf2s2YG3qjE5Co21sdcsRPHsCedCc7lmhQjqT3OCY,28
 asyncdb/drivers/abstract.py,sha256=DFTeAdUC98t5n-1ASIrFnZQFr0kD3HMVC5SFc9r--6U,4529
 asyncdb/drivers/bigquery.py,sha256=WD_ipr83mojibBSv_rqJxz_z2CIrVn6-JtLY_ydgeTM,19346
 asyncdb/drivers/cassandra.py,sha256=IVLklNnZ5IoZygL99zXyHLLEvfMkX_G6CQU1U3VaLtY,17209
-asyncdb/drivers/delta.py,sha256=oXWU_3lOBqZOLyZcbiKsX7isOk0XyIaVFSEXw8HfQCI,14737
-asyncdb/drivers/duckdb.py,sha256=FKWpsD8CYBrH9aqi1pPwNv50K8ug-FVsgRQcbg9hVZA,10233
+asyncdb/drivers/delta.py,sha256=_YWSW9Ts36xBxErG99R-D-TZKMjlr-9q99m-oOHcnzY,17269
+asyncdb/drivers/duckdb.py,sha256=buawyJyYDrY4I3FpIcjZMv2L0zftL10ak2S_Hl2KxLg,12185
 asyncdb/drivers/dummy.py,sha256=hv4-_xDGc0vmYupoezxoA-afCJmTaSEn5jSTo12hGT8,2110
 asyncdb/drivers/hazel.py,sha256=aEXztGMbRJivEnIMeOn47KN1N5JLuVkbtUy9YE4q-Xg,13068
 asyncdb/drivers/influx.py,sha256=ag6hiy6cZP6qbXDWA3ax1_hjc4WYchvsKe5rYdaPLHU,20827
 asyncdb/drivers/jdbc.py,sha256=iUh4koHoEkK4nn2iE90Gqe4eRq-PtJo2TvXSZpdUFIQ,29764
 asyncdb/drivers/mcache.py,sha256=ZCta5ylKZwVvQZjAsKVwI90gRepHsqa2_CZ0bXIBj5s,6638
 asyncdb/drivers/memcache.py,sha256=9GYnWL5Q1hmBczQkiq_3jtcd-EnKeFmQqvFJvhnNE0Y,9336
 asyncdb/drivers/mongo.py,sha256=EvTlxjwoNQMu25QGM_MIwCAcf-bwpzBARVONspTrrHA,3316
@@ -43,27 +43,27 @@
 asyncdb/drivers/outputs/output.py,sha256=WgcgqrqwN0WSHpf4jTuTKftyH7Ov-KQjaWzAspR2TOc,986
 asyncdb/drivers/outputs/pandas.py,sha256=T94VGwsfQhq5P_o46TXTq6Av7E3vjPkxoBA4H4T4Z8k,1021
 asyncdb/drivers/outputs/polars.py,sha256=qJNPIu6AsBzSkSjMicLUwp20PnpvPA_Gx7fkHoPHtU4,864
 asyncdb/drivers/outputs/pyspark.py,sha256=ZoLiKGAcqO96NU2oapshn6rkxt-MKppeLlVWIsYq9IQ,1236
 asyncdb/drivers/outputs/record.py,sha256=sPFwhGgM9M1APINMzyQQJ6312MYqjNnauCVJWAbzC-A,1038
 asyncdb/drivers/outputs/recordset.py,sha256=oJpN0h2AaXmj6CbsOdN8uyUo3AC9YnD77GUqfAUOZsE,770
 asyncdb/exceptions/__init__.py,sha256=c6HhQu9AQcSn85Dp-jyvqiUUUVMK2gYJalN7gYdS008,867
-asyncdb/exceptions/exceptions.pypy39-pp73-win_amd64.pyd,sha256=qZDiRWl4e8Hq-y7oUJw2UDkZRGYnCrREWRmY2852CMs,158720
+asyncdb/exceptions/exceptions.pypy39-pp73-win_amd64.pyd,sha256=fRzZXeL4PwCnvph7HeUXUKppidoDf6ELWFFMafDKf4Y,158720
 asyncdb/exceptions/handlers.py,sha256=GEFCoNMkyXTBz9-tuJ3Y1Gsq2gcgAZcrQnzFZ4k_LVM,2539
 asyncdb/meta/__init__.py,sha256=Wl5uJSXic-gh52UKleUdEqdVaS2LTsSPsUOlh2nO3P8,176
 asyncdb/meta/record.py,sha256=bdKiYrlmX0FtBShvVw1rscMGfQq_CgDZwp194hHrCGg,3057
 asyncdb/meta/recordset.py,sha256=yRyKbCIg5kxDWgqsddMCTKQJctBfgvs6W9bOecaZg3k,2221
 asyncdb/models/__init__.py,sha256=I_v3ttQX7tdF6V2WlBh5bf6YUAxaukfHgiQmsE59cj8,542
 asyncdb/models/model.py,sha256=e02FQHXf2vEFOeMGpqO86mmzzNzHWOYMT6B2oXZP1No,17784
 asyncdb/utils/__init__.py,sha256=Bx7Kk7jHsVfVsNchJH5BdA4zDQFmvRxt9TnY0fd9qWo,136
 asyncdb/utils/functions.py,sha256=Pr5wkjacMvuG7vOSGGLF_CfKkVqTRZpnbJZcl6T2IpE,2484
 asyncdb/utils/modules.py,sha256=6tUulpoEUpitmoOd972JLdj_XiYx0xbHcAimZRZ81yE,655
-asyncdb/utils/types.pypy39-pp73-win_amd64.pyd,sha256=B2ZBg3t-zQ7QeH9BAaQ8Vv_QTInETfZwhH1Z1cXVvCQ,111616
+asyncdb/utils/types.pypy39-pp73-win_amd64.pyd,sha256=EDcym5zOgkyMvnmojy2S9swaN1LG2YzuGbJx4MHRDGw,111616
 asyncdb/utils/uv.py,sha256=r3HYjQmAAl4yOYQwvi2ghUGGJVWPqUFNqRWcjKWCNxs,319
 asyncdb/utils/encoders/__init__.py,sha256=YwtnLtxCmPm21EALjW1Y2upbyIHJiNWHjrchuetp4Fc,234
 asyncdb/utils/encoders/numpy.py,sha256=DkNoKLLA2haOG0qOm9J5RmRBkgiEZbcl9do5mBvIQbY,487
 asyncdb/utils/encoders/pg.py,sha256=i70nydH2S4XxAZUJdoJjXYsU_Ju6hAJbynLsztZSP10,1195
-asyncdb-2.7.4.dist-info/LICENSE,sha256=mThyqULh5pc9N8g3nfITEVMYcHOxzkPyJHQGWwFuQ_c,1538
-asyncdb-2.7.4.dist-info/METADATA,sha256=WBiFYR-1DYbityJKAnWlteQOod8AcKYHMm80EWho9YM,12860
-asyncdb-2.7.4.dist-info/WHEEL,sha256=1cqEyrKxUA_c-f0mOszCh_7q-AnzL9K6iMxWION_yb8,107
-asyncdb-2.7.4.dist-info/top_level.txt,sha256=vMLK2jQFYyNY3ta7idY3krhSki0RPpQ8yVZCVa724JI,8
-asyncdb-2.7.4.dist-info/RECORD,,
+asyncdb-2.7.5.dist-info/LICENSE,sha256=mThyqULh5pc9N8g3nfITEVMYcHOxzkPyJHQGWwFuQ_c,1538
+asyncdb-2.7.5.dist-info/METADATA,sha256=v-OngODPc3W8_V_kcFqjCrg5rttDOznPPmZslAwbvFU,12860
+asyncdb-2.7.5.dist-info/WHEEL,sha256=1cqEyrKxUA_c-f0mOszCh_7q-AnzL9K6iMxWION_yb8,107
+asyncdb-2.7.5.dist-info/top_level.txt,sha256=vMLK2jQFYyNY3ta7idY3krhSki0RPpQ8yVZCVa724JI,8
+asyncdb-2.7.5.dist-info/RECORD,,
```

