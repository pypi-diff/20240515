# Comparing `tmp/web3-7.0.0b5.tar.gz` & `tmp/web3-7.0.0b6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "web3-7.0.0b5.tar", last modified: Fri Apr 26 17:03:25 2024, max compression
+gzip compressed data, was "web3-7.0.0b6.tar", last modified: Wed May 15 18:04:28 2024, max compression
```

## Comparing `web3-7.0.0b5.tar` & `web3-7.0.0b6.tar`

### file list

```diff
@@ -1,200 +1,411 @@
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.860050 web3-7.0.0b5/
--rw-r--r--   0 fselmo     (501) staff       (20)     1090 2024-04-17 00:22:53.000000 web3-7.0.0b5/LICENSE
--rw-r--r--   0 fselmo     (501) staff       (20)      127 2024-04-26 04:05:16.000000 web3-7.0.0b5/MANIFEST.in
--rw-r--r--   0 fselmo     (501) staff       (20)     3906 2024-04-26 17:03:25.859299 web3-7.0.0b5/PKG-INFO
--rw-r--r--   0 fselmo     (501) staff       (20)     1424 2024-04-26 04:05:16.000000 web3-7.0.0b5/README.md
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.643074 web3-7.0.0b5/ens/
--rw-r--r--   0 fselmo     (501) staff       (20)      285 2023-12-15 21:55:37.000000 web3-7.0.0b5/ens/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16786 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/_normalization.py
--rw-r--r--   0 fselmo     (501) staff       (20)    34745 2024-04-17 00:22:53.000000 web3-7.0.0b5/ens/abis.py
--rw-r--r--   0 fselmo     (501) staff       (20)    22414 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/async_ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)       41 2023-12-15 21:55:37.000000 web3-7.0.0b5/ens/auto.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3477 2024-04-26 16:47:57.000000 web3-7.0.0b5/ens/base_ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)      913 2024-04-17 00:22:53.000000 web3-7.0.0b5/ens/constants.py
--rw-r--r--   0 fselmo     (501) staff       (20)   148602 2024-04-22 15:24:52.000000 web3-7.0.0b5/ens/contract_data.py
--rw-r--r--   0 fselmo     (501) staff       (20)    21718 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2683 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/exceptions.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.645867 web3-7.0.0b5/ens/specs/
--rw-r--r--   0 fselmo     (501) staff       (20)    48403 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/specs/nf.json
--rw-r--r--   0 fselmo     (501) staff       (20)  3115334 2024-04-26 04:05:16.000000 web3-7.0.0b5/ens/specs/normalization_spec.json
--rw-r--r--   0 fselmo     (501) staff       (20)     9421 2024-04-26 16:47:57.000000 web3-7.0.0b5/ens/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3598 2024-04-26 04:05:16.000000 web3-7.0.0b5/pyproject.toml
--rw-r--r--   0 fselmo     (501) staff       (20)       38 2024-04-26 17:03:25.860212 web3-7.0.0b5/setup.cfg
--rw-r--r--   0 fselmo     (501) staff       (20)     2484 2024-04-26 17:02:19.000000 web3-7.0.0b5/setup.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.674575 web3-7.0.0b5/web3/
--rw-r--r--   0 fselmo     (501) staff       (20)      900 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.731397 web3-7.0.0b5/web3/_utils/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b5/web3/_utils/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    30677 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)      486 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/_utils/async_caching.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5225 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/async_transactions.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2138 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/blocks.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4841 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/caching.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.733796 web3-7.0.0b5/web3/_utils/compat/
--rw-r--r--   0 fselmo     (501) staff       (20)      526 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/compat/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.740414 web3-7.0.0b5/web3/_utils/contract_sources/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/contract_sources/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6486 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/contract_sources/compile_contracts.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.776845 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      552 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/_custom_contract_data.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5344 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/address_reflector.py
--rw-r--r--   0 fselmo     (501) staff       (20)    18852 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/arrays_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    14783 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/bytes_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6089 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/constructor_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6334 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/contract_caller_tester.py
--rw-r--r--   0 fselmo     (501) staff       (20)    40967 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/emitter_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5573 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/event_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)    15824 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/extended_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1651 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/fallback_function_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1886 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7637 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/math_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16716 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/offchain_lookup.py
--rw-r--r--   0 fselmo     (501) staff       (20)    32387 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/offchain_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)    15579 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/panic_errors_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/payable_tester.py
--rw-r--r--   0 fselmo     (501) staff       (20)    17290 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/receive_function_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5264 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/reflector_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4264 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/revert_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3555 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/simple_resolver.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8238 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/storage_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11586 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/string_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    23180 2024-04-22 15:24:52.000000 web3-7.0.0b5/web3/_utils/contract_sources/contract_data/tuple_contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)    14206 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/contracts.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1701 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/datatypes.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/decorators.py
--rw-r--r--   0 fselmo     (501) staff       (20)      132 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/empty.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9262 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/encoding.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2434 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/ens.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6868 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/error_formatters_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    17406 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/events.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2099 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/fee_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11980 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/filters.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3067 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/formatters.py
--rw-r--r--   0 fselmo     (501) staff       (20)       55 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/function_identifiers.py
--rw-r--r--   0 fselmo     (501) staff       (20)      205 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/http.py
--rw-r--r--   0 fselmo     (501) staff       (20)      209 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/hypothesis.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1083 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/math.py
--rw-r--r--   0 fselmo     (501) staff       (20)    33591 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/method_formatters.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3175 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.788149 web3-7.0.0b5/web3/_utils/module_testing/
--rw-r--r--   0 fselmo     (501) staff       (20)      376 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module_testing/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)   186021 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module_testing/eth_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3406 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/module_testing/go_ethereum_admin_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1176 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/module_testing/go_ethereum_txpool_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5559 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module_testing/module_testing_utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1272 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/module_testing/net_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)    16567 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module_testing/persistent_connection_provider.py
--rw-r--r--   0 fselmo     (501) staff       (20)    10023 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/module_testing/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     9613 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/_utils/module_testing/web3_module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7392 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/normalizers.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8843 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/request.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8529 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/rpc_abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4245 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/threads.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8912 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/transactions.py
--rw-r--r--   0 fselmo     (501) staff       (20)      873 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/_utils/type_conversion.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2559 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/_utils/utility_methods.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6370 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/_utils/validation.py
--rw-r--r--   0 fselmo     (501) staff       (20)      994 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/_utils/windows.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.791115 web3-7.0.0b5/web3/auto/
--rw-r--r--   0 fselmo     (501) staff       (20)       44 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/auto/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      438 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/auto/gethdev.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.795181 web3-7.0.0b5/web3/beacon/
--rw-r--r--   0 fselmo     (501) staff       (20)       65 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/beacon/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2208 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/beacon/api_endpoints.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7472 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/beacon/async_beacon.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6640 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/beacon/beacon.py
--rw-r--r--   0 fselmo     (501) staff       (20)      564 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/constants.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.801568 web3-7.0.0b5/web3/contract/
--rw-r--r--   0 fselmo     (501) staff       (20)      187 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/contract/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    20515 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/contract/async_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    37011 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/contract/base_contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    20124 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/contract/contract.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12510 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/contract/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)    10939 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/datastructures.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.806877 web3-7.0.0b5/web3/eth/
--rw-r--r--   0 fselmo     (501) staff       (20)      124 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/eth/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    24084 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/eth/async_eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6905 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/eth/base_eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)    21002 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/eth/eth.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8246 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/exceptions.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.809478 web3-7.0.0b5/web3/gas_strategies/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b5/web3/gas_strategies/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      352 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/gas_strategies/rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     8981 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/gas_strategies/time_based.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5867 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/geth.py
--rw-r--r--   0 fselmo     (501) staff       (20)      198 2022-09-26 17:05:32.000000 web3-7.0.0b5/web3/logs.py
--rw-r--r--   0 fselmo     (501) staff       (20)    13936 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)    17029 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/manager.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7874 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/method.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.821894 web3-7.0.0b5/web3/middleware/
--rw-r--r--   0 fselmo     (501) staff       (20)     2414 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2259 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/attrdict.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3553 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/base.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1647 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/buffered_gas_estimate.py
--rw-r--r--   0 fselmo     (501) staff       (20)    22174 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/filter.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7567 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/formatting.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3779 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/gas_price_strategy.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4309 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/names.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1429 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/proof_of_authority.py
--rw-r--r--   0 fselmo     (501) staff       (20)      348 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/pythonic.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5742 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/signing.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2680 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/stalecheck.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4280 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/middleware/validation.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4793 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/module.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1562 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/net.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.827014 web3-7.0.0b5/web3/providers/
--rw-r--r--   0 fselmo     (501) staff       (20)      470 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5323 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/async_base.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3465 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/auto.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4468 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/base.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.830666 web3-7.0.0b5/web3/providers/eth_tester/
--rw-r--r--   0 fselmo     (501) staff       (20)       83 2024-04-17 00:22:53.000000 web3-7.0.0b5/web3/providers/eth_tester/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12776 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/eth_tester/defaults.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7807 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/eth_tester/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)    13137 2024-04-26 04:05:16.000000 web3-7.0.0b5/web3/providers/eth_tester/middleware.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5768 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/ipc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3953 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/legacy_websocket.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.836515 web3-7.0.0b5/web3/providers/persistent/
--rw-r--r--   0 fselmo     (501) staff       (20)      283 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     7215 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/async_ipc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3918 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/persistent.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1109 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/persistent_connection.py
--rw-r--r--   0 fselmo     (501) staff       (20)    11540 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/request_processor.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1140 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     6901 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/persistent/websocket.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.839670 web3-7.0.0b5/web3/providers/rpc/
--rw-r--r--   0 fselmo     (501) staff       (20)       89 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/rpc/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4674 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/rpc/async_rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     4683 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/rpc/rpc.py
--rw-r--r--   0 fselmo     (501) staff       (20)     2212 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/providers/rpc/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/py.typed
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.840502 web3-7.0.0b5/web3/scripts/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/scripts/__init__.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.841633 web3-7.0.0b5/web3/scripts/release/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/scripts/release/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1534 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/scripts/release/test_package.py
--rw-r--r--   0 fselmo     (501) staff       (20)      923 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/testing.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.628235 web3-7.0.0b5/web3/tools/
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.846159 web3-7.0.0b5/web3/tools/benchmark/
--rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/tools/benchmark/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)     5768 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/tools/benchmark/main.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3253 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/tools/benchmark/node.py
--rw-r--r--   0 fselmo     (501) staff       (20)      912 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/tools/benchmark/reporting.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1696 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/tools/benchmark/utils.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3098 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/tracing.py
--rw-r--r--   0 fselmo     (501) staff       (20)    12623 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/types.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.853074 web3-7.0.0b5/web3/utils/
--rw-r--r--   0 fselmo     (501) staff       (20)      455 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/utils/__init__.py
--rw-r--r--   0 fselmo     (501) staff       (20)      498 2024-04-26 16:47:57.000000 web3-7.0.0b5/web3/utils/abi.py
--rw-r--r--   0 fselmo     (501) staff       (20)      967 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/utils/address.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3096 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/utils/async_exception_handling.py
--rw-r--r--   0 fselmo     (501) staff       (20)     1618 2024-04-26 04:05:17.000000 web3-7.0.0b5/web3/utils/caching.py
--rw-r--r--   0 fselmo     (501) staff       (20)     3052 2023-12-15 21:55:37.000000 web3-7.0.0b5/web3/utils/exception_handling.py
-drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-04-26 17:03:25.853868 web3-7.0.0b5/web3.egg-info/
--rw-r--r--   0 fselmo     (501) staff       (20)     3906 2024-04-26 17:03:25.000000 web3-7.0.0b5/web3.egg-info/PKG-INFO
--rw-r--r--   0 fselmo     (501) staff       (20)     5564 2024-04-26 17:03:25.000000 web3-7.0.0b5/web3.egg-info/SOURCES.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-04-26 17:03:25.000000 web3-7.0.0b5/web3.egg-info/dependency_links.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-04-11 21:58:58.000000 web3-7.0.0b5/web3.egg-info/not-zip-safe
--rw-r--r--   0 fselmo     (501) staff       (20)      752 2024-04-26 17:03:25.000000 web3-7.0.0b5/web3.egg-info/requires.txt
--rw-r--r--   0 fselmo     (501) staff       (20)        9 2024-04-26 17:03:25.000000 web3-7.0.0b5/web3.egg-info/top_level.txt
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.856337 web3-7.0.0b6/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1095 2024-05-10 16:53:33.000000 web3-7.0.0b6/LICENSE
+-rw-r--r--   0 fselmo     (501) staff       (20)      226 2024-05-10 16:53:33.000000 web3-7.0.0b6/MANIFEST.in
+-rw-r--r--   0 fselmo     (501) staff       (20)     4675 2024-05-15 18:04:28.855865 web3-7.0.0b6/PKG-INFO
+-rw-r--r--   0 fselmo     (501) staff       (20)     1628 2024-05-10 16:53:33.000000 web3-7.0.0b6/README.md
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.607055 web3-7.0.0b6/ens/
+-rw-r--r--   0 fselmo     (501) staff       (20)      285 2023-12-15 21:55:37.000000 web3-7.0.0b6/ens/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16786 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/_normalization.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    34745 2024-04-17 00:22:53.000000 web3-7.0.0b6/ens/abis.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    22414 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/async_ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)       41 2023-12-15 21:55:37.000000 web3-7.0.0b6/ens/auto.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3477 2024-04-26 16:47:57.000000 web3-7.0.0b6/ens/base_ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      913 2024-04-17 00:22:53.000000 web3-7.0.0b6/ens/constants.py
+-rw-r--r--   0 fselmo     (501) staff       (20)   148602 2024-05-03 21:29:54.000000 web3-7.0.0b6/ens/contract_data.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    21718 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2683 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/exceptions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.608920 web3-7.0.0b6/ens/specs/
+-rw-r--r--   0 fselmo     (501) staff       (20)    48403 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/specs/nf.json
+-rw-r--r--   0 fselmo     (501) staff       (20)  3115334 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/specs/normalization_spec.json
+-rw-r--r--   0 fselmo     (501) staff       (20)     9421 2024-05-09 22:47:33.000000 web3-7.0.0b6/ens/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3598 2024-05-10 16:53:33.000000 web3-7.0.0b6/pyproject.toml
+-rw-r--r--   0 fselmo     (501) staff       (20)       38 2024-05-15 18:04:28.856423 web3-7.0.0b6/setup.cfg
+-rw-r--r--   0 fselmo     (501) staff       (20)     2736 2024-05-15 18:03:37.000000 web3-7.0.0b6/setup.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.622654 web3-7.0.0b6/tests/
+-rw-r--r--   0 fselmo     (501) staff       (20)     6148 2023-06-12 22:06:43.000000 web3-7.0.0b6/tests/.DS_Store
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2022-11-18 19:01:14.000000 web3-7.0.0b6/tests/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.624607 web3-7.0.0b6/tests/beacon/
+-rw-r--r--   0 fselmo     (501) staff       (20)     7537 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/beacon/test_async_beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5621 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/beacon/test_beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3762 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/conftest.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.626311 web3-7.0.0b6/tests/core/
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.628920 web3-7.0.0b6/tests/core/admin-module/
+-rw-r--r--   0 fselmo     (501) staff       (20)      318 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/admin-module/test_admin_addPeer.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      174 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/admin-module/test_admin_nodeInfo.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      105 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/admin-module/test_admin_peers.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.629654 web3-7.0.0b6/tests/core/block-utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1224 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/block-utils/test_select_method_for_block_identifier.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.631463 web3-7.0.0b6/tests/core/caching-utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1081 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/caching-utils/test_generate_cache_key.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10707 2024-05-15 17:57:22.000000 web3-7.0.0b6/tests/core/caching-utils/test_request_caching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2286 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/conftest.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.654283 web3-7.0.0b6/tests/core/contracts/
+-rw-r--r--   0 fselmo     (501) staff       (20)    22667 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2815 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_args_and_kwargs_merger.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6077 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_ambiguous_functions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1446 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_attributes.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15645 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_build_transaction.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    78204 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/test_contract_call_interface.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16079 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_caller_interface.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2608 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_class_construction.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    21339 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/test_contract_constructor.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3818 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_contract_constructor_encoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7912 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_contract_deployment.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6849 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_contract_estimate_gas.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2653 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_events_build_filter.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12227 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/test_contract_example.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2698 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/test_contract_init.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7433 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_contract_method_abi_decoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6876 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_method_abi_encoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5320 2024-04-26 16:47:57.000000 web3-7.0.0b6/tests/core/contracts/test_contract_method_to_argument_matching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1140 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/contracts/test_contract_panic_errors.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20905 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_contract_transact_interface.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3776 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/contracts/test_contract_util_functions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    43931 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/contracts/test_extracting_event_data.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4960 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_extracting_event_data_old.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7848 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/test_offchain_lookup.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1066 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/contracts/utils.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.654966 web3-7.0.0b6/tests/core/datastructures/
+-rw-r--r--   0 fselmo     (501) staff       (20)     6627 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/datastructures/test_datastructures.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.655780 web3-7.0.0b6/tests/core/empty-object/
+-rw-r--r--   0 fselmo     (501) staff       (20)      134 2022-09-26 17:05:32.000000 web3-7.0.0b6/tests/core/empty-object/test_empty_object_is_falsy.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.664147 web3-7.0.0b6/tests/core/eth-module/
+-rw-r--r--   0 fselmo     (501) staff       (20)       99 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    22661 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/test_accounts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7306 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/eth-module/test_block_api.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1049 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/test_default_account_api.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1355 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/eth-module/test_eth_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      603 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/eth-module/test_eth_fee_history.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1163 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/test_eth_filter.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      241 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/eth-module/test_eth_mining.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      513 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/test_eth_properties.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      739 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/eth-module/test_gas_pricing.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1352 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/eth-module/test_poa.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14316 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/eth-module/test_transactions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.665073 web3-7.0.0b6/tests/core/eth-tester-api/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1679 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/eth-tester-api/test_withdrawals.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.665890 web3-7.0.0b6/tests/core/exceptions/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1048 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/exceptions/test_exceptions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.678039 web3-7.0.0b6/tests/core/filtering/
+-rw-r--r--   0 fselmo     (501) staff       (20)     2478 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2853 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_basic_filter_tests.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      694 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_create_filter_topic_merging.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14736 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_data_filters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12863 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_get_logs.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15299 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_on_event_filtering.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5937 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_past_event_filtering.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    13516 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/test_contract_topic_filters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2529 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/filtering/test_existing_filter_instance.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1573 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/filtering/test_filter_against_latest_blocks.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1647 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/filtering/test_filter_against_pending_transactions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1112 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/filtering/test_filter_against_transaction_logs.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10231 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/filtering/test_filters_against_many_blocks.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6696 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/core/filtering/test_utils_functions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2167 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/filtering/utils.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.679277 web3-7.0.0b6/tests/core/gas-strategies/
+-rw-r--r--   0 fselmo     (501) staff       (20)      312 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/gas-strategies/test_rpc_gas_pricing_strategies.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9662 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/gas-strategies/test_time_based_gas_price_strategy.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.683404 web3-7.0.0b6/tests/core/manager/
+-rw-r--r--   0 fselmo     (501) staff       (20)     1014 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      700 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/test_default_middlewares.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      878 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/test_middleware_can_be_stateful.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5465 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/test_middleware_onion_api.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      421 2022-09-26 17:05:32.000000 web3-7.0.0b6/tests/core/manager/test_provider_property.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      962 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/test_provider_request_wrapping.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12577 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/manager/test_response_formatters.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.684962 web3-7.0.0b6/tests/core/method-class/
+-rw-r--r--   0 fselmo     (501) staff       (20)    10714 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/method-class/test_method.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      907 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/method-class/test_result_formatters.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.690275 web3-7.0.0b6/tests/core/middleware/
+-rw-r--r--   0 fselmo     (501) staff       (20)     3853 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_attrdict_middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6881 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/middleware/test_eth_tester_middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10016 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_filter_middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2951 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_formatting_middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2054 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_gas_price_strategy.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4251 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_name_to_address_middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7152 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_stalecheck.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16471 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/middleware/test_transaction_signing.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.691172 web3-7.0.0b6/tests/core/module-class/
+-rw-r--r--   0 fselmo     (501) staff       (20)     3098 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/module-class/test_module.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.697808 web3-7.0.0b6/tests/core/providers/
+-rw-r--r--   0 fselmo     (501) staff       (20)     3334 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_async_http_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7947 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/core/providers/test_async_ipc_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2587 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/providers/test_async_tester_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1751 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_auto_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1186 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_base_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3218 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_http_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6361 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_http_request_retry.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5093 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_ipc_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2087 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/providers/test_legacy_websocket_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4229 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/providers/test_tester_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11405 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/core/providers/test_websocket_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1188 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/test_library_files.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.699813 web3-7.0.0b6/tests/core/testing-module/
+-rw-r--r--   0 fselmo     (501) staff       (20)      546 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/testing-module/test_testing_mine.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1309 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/testing-module/test_testing_snapshot_and_revert.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      300 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/testing-module/test_testing_timeTravel.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.701951 web3-7.0.0b6/tests/core/txpool-module/
+-rw-r--r--   0 fselmo     (501) staff       (20)      240 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/txpool-module/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1243 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/txpool-module/test_txpool_content.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1347 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/txpool-module/test_txpool_inspect.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.722550 web3-7.0.0b6/tests/core/utilities/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:00.000000 web3-7.0.0b6/tests/core/utilities/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      231 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9950 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1424 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_abi_filter_by_abi_name.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1454 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_abi_filtering_by_argument_name.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3971 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_abi_is_encodable.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2965 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_abi_named_tree.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2209 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_address.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2769 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/utilities/test_async_transaction.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5200 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_attach_modules.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2808 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_attributedict.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      835 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_caching_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3755 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_construct_event_data_set.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3050 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_construct_event_filter_params.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4033 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_construct_event_topics.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1096 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_datatypes.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      484 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_decorators.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9700 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_encoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2555 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_event_filter_builder.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      842 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_event_interface.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1433 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_fee_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1314 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      489 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/core/utilities/test_is_predefined_block_number.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      586 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_is_probably_enum.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4315 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_is_recognized_type.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1491 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_math.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5037 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/utilities/test_method_formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3519 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_prepare_transaction_replacement.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15187 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_request.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1188 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/utilities/test_select_filter_method.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2142 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_threads.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5069 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_valid_transaction_params.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4991 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/utilities/test_validation.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.727828 web3-7.0.0b6/tests/core/web3-module/
+-rw-r--r--   0 fselmo     (501) staff       (20)       57 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/web3-module/test_api.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2854 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/web3-module/test_attach_modules.py
+-rw-r--r--   0 fselmo     (501) staff       (20)       93 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/web3-module/test_client_version.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6489 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/web3-module/test_conversions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      115 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/core/web3-module/test_import_and_version.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2659 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/web3-module/test_keccak.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      681 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/core/web3-module/test_providers.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3702 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/web3-module/test_strict_bytes_type_checking.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      269 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/core/web3-module/test_web3_inheritance.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.733512 web3-7.0.0b6/tests/ens/
+-rw-r--r--   0 fselmo     (501) staff       (20)    35274 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/ens/conftest.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.740484 web3-7.0.0b6/tests/ens/normalization/
+-rw-r--r--   0 fselmo     (501) staff       (20)  2971054 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/ens/normalization/normalization_tests.json
+-rw-r--r--   0 fselmo     (501) staff       (20)     1344 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/ens/normalization/test_normalize_name_ensip15.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8434 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/ens/test_ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1481 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/ens/test_get_registry.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5023 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/ens/test_get_text.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      982 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/ens/test_nameprep.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7836 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/ens/test_offchain_resolution.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9201 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/ens/test_setup_address.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7954 2024-04-17 00:22:53.000000 web3-7.0.0b6/tests/ens/test_setup_name.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7245 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/ens/test_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2315 2023-12-15 21:55:37.000000 web3-7.0.0b6/tests/ens/test_wildcard_resolution.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.748022 web3-7.0.0b6/tests/integration/
+-rw-r--r--   0 fselmo     (501) staff       (20)     6148 2021-07-01 17:47:25.000000 web3-7.0.0b6/tests/integration/.DS_Store
+-rw-r--r--   0 fselmo     (501) staff       (20)     1753 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/integration/README.md
+-rw-r--r--   0 fselmo     (501) staff       (20)      592 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/integration/common.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1764 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/integration/conftest.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.749440 web3-7.0.0b6/tests/integration/generate_fixtures/
+-rw-r--r--   0 fselmo     (501) staff       (20)     7240 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/generate_fixtures/common.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11562 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/generate_fixtures/go_ethereum.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    47949 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/geth-1.13.14-fixture.zip
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.753846 web3-7.0.0b6/tests/integration/go_ethereum/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2022-11-18 19:01:11.000000 web3-7.0.0b6/tests/integration/go_ethereum/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4184 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/common.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10655 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/go_ethereum/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4370 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_http.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2989 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ipc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2886 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_legacy_ws.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.756821 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1168 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/conftest.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2137 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/test_async_await_w3.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2150 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/test_async_ctx_manager_w3.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2143 2024-05-10 16:53:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/test_goethereum_ws/test_async_iterator_w3.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1841 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/integration/go_ethereum/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    22827 2024-05-14 16:23:45.000000 web3-7.0.0b6/tests/integration/test_ethereum_tester.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2493 2024-05-09 22:47:33.000000 web3-7.0.0b6/tests/utils.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.766167 web3-7.0.0b6/web3/
+-rw-r--r--   0 fselmo     (501) staff       (20)      900 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.788819 web3-7.0.0b6/web3/_utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b6/web3/_utils/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    30677 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      486 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/_utils/async_caching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5225 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/async_transactions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6316 2024-05-10 16:53:33.000000 web3-7.0.0b6/web3/_utils/batching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2138 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/blocks.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5406 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/_utils/caching.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.789469 web3-7.0.0b6/web3/_utils/compat/
+-rw-r--r--   0 fselmo     (501) staff       (20)      547 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/_utils/compat/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.790372 web3-7.0.0b6/web3/_utils/contract_sources/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/contract_sources/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6486 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/contract_sources/compile_contracts.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.804023 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      552 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/_custom_contract_data.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5344 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/address_reflector.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    18852 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/arrays_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14783 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/bytes_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6089 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/constructor_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6334 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/contract_caller_tester.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    40967 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/emitter_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5573 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/event_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15824 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/extended_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1651 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/fallback_function_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1886 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7637 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/math_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16716 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/offchain_lookup.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    32387 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/offchain_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    15579 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/panic_errors_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/payable_tester.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    17290 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/receive_function_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5264 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/reflector_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4264 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/revert_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3555 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/simple_resolver.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8238 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/storage_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11586 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/string_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    23180 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contract_sources/contract_data/tuple_contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14206 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/contracts.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1701 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/datatypes.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1825 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/decorators.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      132 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/empty.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     9262 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/encoding.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2434 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/ens.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6868 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/error_formatters_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    17363 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/_utils/events.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2099 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/fee_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    11980 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/filters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3067 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)       55 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/function_identifiers.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      205 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/http.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      209 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/hypothesis.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1083 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/math.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    33591 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/method_formatters.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3175 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/module.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.811002 web3-7.0.0b6/web3/_utils/module_testing/
+-rw-r--r--   0 fselmo     (501) staff       (20)      376 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/module_testing/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)   186043 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/module_testing/eth_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3406 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/module_testing/go_ethereum_admin_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1176 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/module_testing/go_ethereum_txpool_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5862 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/_utils/module_testing/module_testing_utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1272 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/module_testing/net_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16567 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/module_testing/persistent_connection_provider.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10023 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/module_testing/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    25121 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/_utils/module_testing/web3_module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7392 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/normalizers.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8843 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/request.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8529 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/_utils/rpc_abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4245 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/threads.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8912 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/transactions.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      873 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/type_conversion.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2559 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/_utils/utility_methods.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6370 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/_utils/validation.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      994 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/_utils/windows.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.812735 web3-7.0.0b6/web3/auto/
+-rw-r--r--   0 fselmo     (501) staff       (20)       44 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/auto/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      438 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/auto/gethdev.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.814772 web3-7.0.0b6/web3/beacon/
+-rw-r--r--   0 fselmo     (501) staff       (20)       65 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/beacon/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2208 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/beacon/api_endpoints.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7472 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/beacon/async_beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6640 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/beacon/beacon.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      564 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/constants.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.817224 web3-7.0.0b6/web3/contract/
+-rw-r--r--   0 fselmo     (501) staff       (20)      187 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/contract/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20515 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/contract/async_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    37011 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/contract/base_contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20124 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/contract/contract.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    16662 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/contract/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    10939 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/datastructures.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.819902 web3-7.0.0b6/web3/eth/
+-rw-r--r--   0 fselmo     (501) staff       (20)      124 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/eth/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    24043 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/eth/async_eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6905 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/eth/base_eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20961 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/eth/eth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8742 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/exceptions.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.821542 web3-7.0.0b6/web3/gas_strategies/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2021-06-07 18:31:01.000000 web3-7.0.0b6/web3/gas_strategies/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      352 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/gas_strategies/rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8949 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/gas_strategies/time_based.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5867 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/geth.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      198 2022-09-26 17:05:32.000000 web3-7.0.0b6/web3/logs.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14350 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    20730 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/manager.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8593 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/method.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.831885 web3-7.0.0b6/web3/middleware/
+-rw-r--r--   0 fselmo     (501) staff       (20)     2414 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2259 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/attrdict.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5103 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/middleware/base.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1647 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/buffered_gas_estimate.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    22174 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/filter.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7567 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/formatting.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3779 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/gas_price_strategy.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4309 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/names.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1429 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/proof_of_authority.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      348 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/pythonic.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5742 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/signing.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2680 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/stalecheck.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4280 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/middleware/validation.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5996 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/module.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1562 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/net.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.836080 web3-7.0.0b6/web3/providers/
+-rw-r--r--   0 fselmo     (501) staff       (20)      470 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6832 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/async_base.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3465 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/auto.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5884 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/base.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.838454 web3-7.0.0b6/web3/providers/eth_tester/
+-rw-r--r--   0 fselmo     (501) staff       (20)       83 2024-04-17 00:22:53.000000 web3-7.0.0b6/web3/providers/eth_tester/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12776 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/providers/eth_tester/defaults.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     7807 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/eth_tester/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    13137 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/providers/eth_tester/middleware.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6355 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/ipc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     4767 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/legacy_websocket.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.842538 web3-7.0.0b6/web3/providers/persistent/
+-rw-r--r--   0 fselmo     (501) staff       (20)      283 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/persistent/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     6213 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/providers/persistent/async_ipc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     8918 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/persistent/persistent.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1109 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/persistent/persistent_connection.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    14504 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/providers/persistent/request_processor.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1140 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/persistent/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5446 2024-05-10 16:53:34.000000 web3-7.0.0b6/web3/providers/persistent/websocket.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.844150 web3-7.0.0b6/web3/providers/rpc/
+-rw-r--r--   0 fselmo     (501) staff       (20)       89 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/providers/rpc/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5430 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/rpc/async_rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5420 2024-05-15 17:57:22.000000 web3-7.0.0b6/web3/providers/rpc/rpc.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     2212 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/providers/rpc/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/py.typed
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.844654 web3-7.0.0b6/web3/scripts/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/scripts/__init__.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.845308 web3-7.0.0b6/web3/scripts/release/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/scripts/release/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1534 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/scripts/release/test_package.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      923 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/testing.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.592845 web3-7.0.0b6/web3/tools/
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.847767 web3-7.0.0b6/web3/tools/benchmark/
+-rw-r--r--   0 fselmo     (501) staff       (20)        0 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/tools/benchmark/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     5768 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/tools/benchmark/main.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3253 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/tools/benchmark/node.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      912 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/tools/benchmark/reporting.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1696 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/tools/benchmark/utils.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3098 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/tracing.py
+-rw-r--r--   0 fselmo     (501) staff       (20)    12881 2024-05-14 16:23:45.000000 web3-7.0.0b6/web3/types.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.850917 web3-7.0.0b6/web3/utils/
+-rw-r--r--   0 fselmo     (501) staff       (20)      455 2024-04-26 16:47:57.000000 web3-7.0.0b6/web3/utils/__init__.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      498 2024-04-26 16:47:57.000000 web3-7.0.0b6/web3/utils/abi.py
+-rw-r--r--   0 fselmo     (501) staff       (20)      967 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/utils/address.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3096 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/utils/async_exception_handling.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     1618 2024-05-09 22:47:33.000000 web3-7.0.0b6/web3/utils/caching.py
+-rw-r--r--   0 fselmo     (501) staff       (20)     3052 2023-12-15 21:55:37.000000 web3-7.0.0b6/web3/utils/exception_handling.py
+drwxr-xr-x   0 fselmo     (501) staff       (20)        0 2024-05-15 18:04:28.851352 web3-7.0.0b6/web3.egg-info/
+-rw-r--r--   0 fselmo     (501) staff       (20)     4675 2024-05-15 18:04:10.000000 web3-7.0.0b6/web3.egg-info/PKG-INFO
+-rw-r--r--   0 fselmo     (501) staff       (20)    13880 2024-05-15 18:04:28.000000 web3-7.0.0b6/web3.egg-info/SOURCES.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-05-15 18:04:10.000000 web3-7.0.0b6/web3.egg-info/dependency_links.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        1 2024-04-11 21:58:58.000000 web3-7.0.0b6/web3.egg-info/not-zip-safe
+-rw-r--r--   0 fselmo     (501) staff       (20)      919 2024-05-15 18:04:10.000000 web3-7.0.0b6/web3.egg-info/requires.txt
+-rw-r--r--   0 fselmo     (501) staff       (20)        9 2024-05-15 18:04:10.000000 web3-7.0.0b6/web3.egg-info/top_level.txt
```

### Comparing `web3-7.0.0b5/LICENSE` & `web3-7.0.0b6/LICENSE`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 The MIT License (MIT)
 
-Copyright (c) 2016 The Ethereum Foundation
+Copyright (c) 2016-2024 The Ethereum Foundation
 
 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:
```

### Comparing `web3-7.0.0b5/PKG-INFO` & `web3-7.0.0b6/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,26 +1,27 @@
 Metadata-Version: 2.1
 Name: web3
-Version: 7.0.0b5
-Summary: web3.py
+Version: 7.0.0b6
+Summary: web3: A Python library for interacting with Ethereum
 Home-page: https://github.com/ethereum/web3.py
 Author: The Ethereum Foundation
 Author-email: snakecharmers@ethereum.org
 License: MIT
 Keywords: ethereum
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
-Requires-Python: >=3.8
+Classifier: Programming Language :: Python :: 3.12
+Requires-Python: >=3.8, <4
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: aiohttp>=3.7.4.post0
 Requires-Dist: eth-abi>=5.0.1
 Requires-Dist: eth-account>=0.12.2
 Requires-Dist: eth-hash[pycryptodome]>=0.5.1
 Requires-Dist: eth-typing>=4.0.0
@@ -28,47 +29,58 @@
 Requires-Dist: hexbytes>=1.2.0
 Requires-Dist: pydantic>=2.4.0
 Requires-Dist: pywin32>=223; platform_system == "Windows"
 Requires-Dist: requests>=2.16.0
 Requires-Dist: typing-extensions>=4.0.1
 Requires-Dist: websockets>=10.0.0
 Requires-Dist: pyunormalize>=15.0.0
-Provides-Extra: tester
-Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "tester"
-Requires-Dist: py-geth>=4.1.0; extra == "tester"
-Provides-Extra: docs
-Requires-Dist: sphinx>=5.3.0; extra == "docs"
-Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
-Requires-Dist: towncrier<22,>=21; extra == "docs"
 Provides-Extra: dev
-Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
-Requires-Dist: py-geth>=4.1.0; extra == "dev"
-Requires-Dist: sphinx>=5.3.0; extra == "dev"
-Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
-Requires-Dist: towncrier<22,>=21; extra == "dev"
 Requires-Dist: build>=0.9.0; extra == "dev"
-Requires-Dist: bumpversion; extra == "dev"
+Requires-Dist: bumpversion>=0.5.3; extra == "dev"
 Requires-Dist: flaky>=3.7.0; extra == "dev"
 Requires-Dist: hypothesis>=3.31.2; extra == "dev"
+Requires-Dist: ipython; extra == "dev"
 Requires-Dist: pre-commit>=3.4.0; extra == "dev"
-Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
+Requires-Dist: pytest-asyncio<0.23,>=0.21.2; extra == "dev"
 Requires-Dist: pytest-mock>=1.10; extra == "dev"
-Requires-Dist: pytest-watch>=4.2; extra == "dev"
-Requires-Dist: pytest-xdist>=1.29; extra == "dev"
-Requires-Dist: pytest>=7.0.0; extra == "dev"
 Requires-Dist: setuptools>=38.6.0; extra == "dev"
-Requires-Dist: tox>=3.18.0; extra == "dev"
+Requires-Dist: tox>=4.0.0; extra == "dev"
 Requires-Dist: tqdm>4.32; extra == "dev"
 Requires-Dist: twine>=1.13; extra == "dev"
+Requires-Dist: wheel; extra == "dev"
+Requires-Dist: sphinx>=6.0.0; extra == "dev"
+Requires-Dist: sphinx-autobuild>=2021.3.14; extra == "dev"
+Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
+Requires-Dist: towncrier<22,>=21; extra == "dev"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
+Requires-Dist: py-geth>=4.1.0; extra == "dev"
+Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
+Requires-Dist: pytest-mock>=1.10; extra == "dev"
+Requires-Dist: pytest-xdist>=2.4.0; extra == "dev"
+Requires-Dist: pytest>=7.0.0; extra == "dev"
+Provides-Extra: docs
+Requires-Dist: sphinx>=6.0.0; extra == "docs"
+Requires-Dist: sphinx-autobuild>=2021.3.14; extra == "docs"
+Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
+Requires-Dist: towncrier<22,>=21; extra == "docs"
+Provides-Extra: test
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "test"
+Requires-Dist: py-geth>=4.1.0; extra == "test"
+Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "test"
+Requires-Dist: pytest-mock>=1.10; extra == "test"
+Requires-Dist: pytest-xdist>=2.4.0; extra == "test"
+Requires-Dist: pytest>=7.0.0; extra == "test"
 
 # web3.py
 
-[![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
-[![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
+[![Join the conversation on Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
+[![PyPI version](https://badge.fury.io/py/web3.svg)](https://badge.fury.io/py/web3)
+[![Python versions](https://img.shields.io/pypi/pyversions/web3.svg)](https://pypi.python.org/pypi/web3)
+[![Docs build](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 
 A Python library for interacting with Ethereum.
 
 - Python 3.8+ support
 
 ______________________________________________________________________
```

### Comparing `web3-7.0.0b5/README.md` & `web3-7.0.0b6/README.md`

 * *Files 20% similar despite different names*

```diff
@@ -1,12 +1,14 @@
 # web3.py
 
-[![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
-[![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
+[![Join the conversation on Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
+[![PyPI version](https://badge.fury.io/py/web3.svg)](https://badge.fury.io/py/web3)
+[![Python versions](https://img.shields.io/pypi/pyversions/web3.svg)](https://pypi.python.org/pypi/web3)
+[![Docs build](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 
 A Python library for interacting with Ethereum.
 
 - Python 3.8+ support
 
 ______________________________________________________________________
```

### Comparing `web3-7.0.0b5/ens/_normalization.py` & `web3-7.0.0b6/ens/_normalization.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/abis.py` & `web3-7.0.0b6/ens/abis.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/async_ens.py` & `web3-7.0.0b6/ens/async_ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/base_ens.py` & `web3-7.0.0b6/ens/base_ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/constants.py` & `web3-7.0.0b6/ens/constants.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/contract_data.py` & `web3-7.0.0b6/ens/contract_data.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/ens.py` & `web3-7.0.0b6/ens/ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/exceptions.py` & `web3-7.0.0b6/ens/exceptions.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/specs/nf.json` & `web3-7.0.0b6/ens/specs/nf.json`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/specs/normalization_spec.json` & `web3-7.0.0b6/ens/specs/normalization_spec.json`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/ens/utils.py` & `web3-7.0.0b6/ens/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/pyproject.toml` & `web3-7.0.0b6/pyproject.toml`

 * *Ordering differences only*

 * *Files 2% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 [tool.autoflake]
-remove_all_unused_imports = true
 exclude = "__init__.py"
+remove_all_unused_imports = true
 
 [tool.isort]
 combine_as_imports = true
 extra_standard_library = "pytest"
 force_grid_wrap = 1
 force_sort_within_sections = true
 honor_noqa = true
 known_first_party = "web3"
 known_third_party = "hypothesis"
 multi_line_output = 3
 profile = "black"
+use_parentheses = true
 # skip `__init__.py` files because sometimes order of initialization is important
 skip="__init__.py,web3/main.py,web3/utils/windows.py"
-use_parentheses = true
 
 [tool.mypy]
 check_untyped_defs = true
 disallow_any_generics = true
 disallow_incomplete_defs = true
 disallow_subclassing_any = true
 disallow_untyped_calls = true
@@ -63,27 +63,27 @@
 # D400 - Enabling this error code seems to make it a requirement that the first
 # sentence in a docstring is not split across two lines.  It also makes it a
 # requirement that no docstring can have a multi-sentence description without a
 # summary line.  Neither one of those requirements seem appropriate.
 
 [tool.pytest.ini_options]
 addopts = "-v --showlocals --durations 10"
-xfail_strict = true
 asyncio_mode = "strict"
-log_format = "%(levelname)8s  %(asctime)s  %(filename)20s  %(message)s"
 log_date_format = "%m-%d %H:%M:%S"
+log_format = "%(levelname)8s  %(asctime)s  %(filename)20s  %(message)s"
+xfail_strict = true
 
 [tool.towncrier]
 # Read https://github.com/ethereum/web3.py/blob/main/newsfragments/README.md for instructions
-package = "web3"
-filename = "docs/release_notes.rst"
 directory = "newsfragments"
-underlines = ["-", "~", "^"]
-title_format = "web3.py v{version} ({project_date})"
+filename = "docs/release_notes.rst"
 issue_format = "`#{issue} <https://github.com/ethereum/web3.py/issues/{issue}>`__"
+package = "web3"
+title_format = "web3.py v{version} ({project_date})"
+underlines = ["-", "~", "^"]
 
 [[tool.towncrier.type]]
 directory = "breaking"
 name = "Breaking Changes"
 showcontent = true
 
 [[tool.towncrier.type]]
```

### Comparing `web3-7.0.0b5/setup.py` & `web3-7.0.0b6/setup.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,55 +1,61 @@
 #!/usr/bin/env python
 from setuptools import (
     find_packages,
     setup,
 )
 
 extras_require = {
-    "tester": [
-        "eth-tester[py-evm]>=0.11.0b1,<0.12.0b1",
-        "py-geth>=4.1.0",
-    ],
-    "docs": [
-        "sphinx>=5.3.0",
-        "sphinx_rtd_theme>=1.0.0",
-        "towncrier>=21,<22",
-    ],
     "dev": [
         "build>=0.9.0",
-        "bumpversion",
+        "bumpversion>=0.5.3",
         "flaky>=3.7.0",
         "hypothesis>=3.31.2",
+        "ipython",
         "pre-commit>=3.4.0",
-        "pytest-asyncio>=0.18.1,<0.23",
+        "pytest-asyncio>=0.21.2,<0.23",
         "pytest-mock>=1.10",
-        "pytest-watch>=4.2",
-        "pytest-xdist>=1.29",
-        "pytest>=7.0.0",
         "setuptools>=38.6.0",
-        "tox>=3.18.0",
+        "tox>=4.0.0",
         "tqdm>4.32",
         "twine>=1.13",
+        "wheel",
+    ],
+    "docs": [
+        "sphinx>=6.0.0",
+        "sphinx-autobuild>=2021.3.14",
+        "sphinx_rtd_theme>=1.0.0",
+        "towncrier>=21,<22",
+    ],
+    "test": [
+        "eth-tester[py-evm]>=0.11.0b1,<0.12.0b1",
+        "py-geth>=4.1.0",
+        "pytest-asyncio>=0.18.1,<0.23",
+        "pytest-mock>=1.10",
+        "pytest-xdist>=2.4.0",
+        "pytest>=7.0.0",
     ],
 }
 
 extras_require["dev"] = (
-    extras_require["tester"] + extras_require["docs"] + extras_require["dev"]
+    extras_require["dev"] + extras_require["docs"] + extras_require["test"]
 )
 
+
 with open("./README.md") as readme:
     long_description = readme.read()
 
+
 setup(
     name="web3",
-    # *IMPORTANT*: Don't manually change the version here. Use the 'bumpversion' utility.
-    version="7.0.0-beta.5",
-    description="""web3.py""",
-    long_description_content_type="text/markdown",
+    # *IMPORTANT*: Don't manually change the version here. Use `make bump`, as described in readme
+    version="7.0.0-beta.6",
+    description="""web3: A Python library for interacting with Ethereum""",
     long_description=long_description,
+    long_description_content_type="text/markdown",
     author="The Ethereum Foundation",
     author_email="snakecharmers@ethereum.org",
     url="https://github.com/ethereum/web3.py",
     include_package_data=True,
     install_requires=[
         "aiohttp>=3.7.4.post0",
         "eth-abi>=5.0.1",
@@ -61,27 +67,28 @@
         "pydantic>=2.4.0",
         "pywin32>=223;platform_system=='Windows'",
         "requests>=2.16.0",
         "typing-extensions>=4.0.1",
         "websockets>=10.0.0",
         "pyunormalize>=15.0.0",
     ],
-    python_requires=">=3.8",
+    python_requires=">=3.8, <4",
     extras_require=extras_require,
     py_modules=["web3", "ens"],
     license="MIT",
     zip_safe=False,
     keywords="ethereum",
-    packages=find_packages(exclude=["tests", "tests.*"]),
+    packages=find_packages(exclude=["scripts", "scripts.*", "tests", "tests.*"]),
     package_data={"web3": ["py.typed"]},
     classifiers=[
         "Development Status :: 5 - Production/Stable",
         "Intended Audience :: Developers",
         "License :: OSI Approved :: MIT License",
         "Natural Language :: English",
         "Programming Language :: Python :: 3",
         "Programming Language :: Python :: 3.8",
         "Programming Language :: Python :: 3.9",
         "Programming Language :: Python :: 3.10",
         "Programming Language :: Python :: 3.11",
+        "Programming Language :: Python :: 3.12",
     ],
 )
```

### Comparing `web3-7.0.0b5/web3/__init__.py` & `web3-7.0.0b6/web3/__init__.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/abi.py` & `web3-7.0.0b6/web3/_utils/abi.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/async_transactions.py` & `web3-7.0.0b6/web3/_utils/async_transactions.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/blocks.py` & `web3-7.0.0b6/web3/_utils/blocks.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/caching.py` & `web3-7.0.0b6/web3/_utils/caching.py`

 * *Files 5% similar despite different names*

```diff
@@ -2,18 +2,21 @@
 import hashlib
 import threading
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Coroutine,
+    Dict,
     List,
+    Set,
     Tuple,
     TypeVar,
     Union,
+    cast,
 )
 
 from eth_utils import (
     is_boolean,
     is_bytes,
     is_dict,
     is_list_like,
@@ -65,15 +68,19 @@
 
 
 class RequestInformation:
     def __init__(
         self,
         method: "RPCEndpoint",
         params: Any,
-        response_formatters: Tuple[Callable[..., Any], ...],
+        response_formatters: Tuple[
+            Union[Dict[str, Callable[..., Any]], Callable[..., Any]],
+            Callable[..., Any],
+            Callable[..., Any],
+        ],
         subscription_id: str = None,
     ):
         self.method = method
         self.params = params
         self.response_formatters = response_formatters
         self.subscription_id = subscription_id
         self.middleware_response_processors: List[Callable[..., Any]] = []
@@ -83,15 +90,32 @@
     provider: Union[ASYNC_PROVIDER_TYPE, SYNC_PROVIDER_TYPE], method: "RPCEndpoint"
 ) -> bool:
     if provider.cache_allowed_requests and method in provider.cacheable_requests:
         return True
     return False
 
 
-# -- request caching decorators -- #
+# -- request caching -- #
+
+
+CACHEABLE_REQUESTS = cast(
+    Set["RPCEndpoint"],
+    (
+        "eth_chainId",
+        "eth_getBlockByHash",
+        "eth_getBlockTransactionCountByHash",
+        "eth_getRawTransactionByHash",
+        "eth_getTransactionByBlockHashAndIndex",
+        "eth_getTransactionByHash",
+        "eth_getUncleByBlockHashAndIndex",
+        "eth_getUncleCountByBlockHash",
+        "net_version",
+        "web3_clientVersion",
+    ),
+)
 
 
 def _should_cache_response(response: "RPCResponse") -> bool:
     return (
         "error" not in response
         and "result" in response
         and not is_null(response["result"])
```

### Comparing `web3-7.0.0b5/web3/_utils/compat/__init__.py` & `web3-7.0.0b6/web3/_utils/compat/__init__.py`

 * *Files 17% similar despite different names*

```diff
@@ -7,8 +7,9 @@
 
 # Once web3 supports >= the noted python version, the type may be directly
 # imported from `typing`
 
 from typing_extensions import (
     NotRequired,  # py311
     Self,  # py311
+    Unpack,  # py311
 )
```

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/compile_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/compile_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/_custom_contract_data.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/_custom_contract_data.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/address_reflector.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/address_reflector.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/arrays_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/arrays_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/bytes_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/bytes_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/constructor_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/constructor_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/contract_caller_tester.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/contract_caller_tester.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/emitter_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/emitter_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/event_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/event_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/extended_resolver.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/extended_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/fallback_function_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/fallback_function_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/function_name_tester_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/math_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/math_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/offchain_lookup.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/offchain_lookup.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/offchain_resolver.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/offchain_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/panic_errors_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/panic_errors_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/payable_tester.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/payable_tester.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/receive_function_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/receive_function_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/reflector_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/reflector_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/revert_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/revert_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/simple_resolver.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/simple_resolver.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/storage_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/storage_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/string_contract.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/string_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contract_sources/contract_data/tuple_contracts.py` & `web3-7.0.0b6/web3/_utils/contract_sources/contract_data/tuple_contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/contracts.py` & `web3-7.0.0b6/web3/_utils/contracts.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/datatypes.py` & `web3-7.0.0b6/web3/_utils/datatypes.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/decorators.py` & `web3-7.0.0b6/web3/_utils/decorators.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/encoding.py` & `web3-7.0.0b6/web3/_utils/encoding.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/ens.py` & `web3-7.0.0b6/web3/_utils/ens.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/error_formatters_utils.py` & `web3-7.0.0b6/web3/_utils/error_formatters_utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/events.py` & `web3-7.0.0b6/web3/_utils/events.py`

 * *Files 2% similar despite different names*

```diff
@@ -440,16 +440,16 @@
 
 
 class EventFilterBuilder(BaseEventFilterBuilder):
     def deploy(self, w3: "Web3") -> "LogFilter":
         if not isinstance(w3, web3.Web3):
             raise Web3ValueError(f"Invalid web3 argument: got: {w3!r}")
 
-        for arg in AttributeDict.values(self.args):
-            arg._immutable = True  # type: ignore[attr-defined]
+        for arg in self.args.values():
+            arg._immutable = True
         self._immutable = True
 
         log_filter = cast("LogFilter", w3.eth.filter(self.filter_params))
         log_filter.filter_params = self.filter_params
         log_filter.set_data_filters(self.data_argument_values)
         log_filter.builder = self
         if self.formatter is not None:
```

### Comparing `web3-7.0.0b5/web3/_utils/fee_utils.py` & `web3-7.0.0b6/web3/_utils/fee_utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/filters.py` & `web3-7.0.0b6/web3/_utils/filters.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/formatters.py` & `web3-7.0.0b6/web3/_utils/formatters.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/math.py` & `web3-7.0.0b6/web3/_utils/math.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/method_formatters.py` & `web3-7.0.0b6/web3/_utils/method_formatters.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module.py` & `web3-7.0.0b6/web3/_utils/module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/eth_module.py` & `web3-7.0.0b6/web3/_utils/module_testing/eth_module.py`

 * *Files 1% similar despite different names*

```diff
@@ -460,11168 +460,11169 @@
 00001cb0: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
 00001cc0: 2020 206d 6f64 6966 6965 645f 7478 6e5f     modified_txn_
 00001cd0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
 00001ce0: 6e63 5f77 332e 6574 682e 6d6f 6469 6679  nc_w3.eth.modify
 00001cf0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
 00001d00: 2020 2020 2020 2020 2020 7478 6e5f 6861            txn_ha
 00001d10: 7368 2c20 6761 7350 7269 6365 3d28 6361  sh, gasPrice=(ca
-00001d20: 7374 2869 6e74 2c20 7478 6e5f 7061 7261  st(int, txn_para
-00001d30: 6d73 5b22 6761 7350 7269 6365 225d 2920  ms["gasPrice"]) 
-00001d40: 2a20 3229 2c20 7661 6c75 653d 320a 2020  * 2), value=2.  
-00001d50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00001d60: 6d6f 6469 6669 6564 5f74 786e 203d 2061  modified_txn = a
-00001d70: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00001d80: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00001d90: 6e28 6d6f 6469 6669 6564 5f74 786e 5f68  n(modified_txn_h
-00001da0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
-00001db0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-00001dc0: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
-00001dd0: 2020 6d6f 6469 6669 6564 5f74 786e 5b22    modified_txn["
-00001de0: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
-00001df0: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
-00001e00: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
-00001e10: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00001e20: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00001e30: 6d65 5f61 6464 7265 7373 280a 2020 2020  me_address(.    
-00001e40: 2020 2020 2020 2020 6d6f 6469 6669 6564          modified
-00001e50: 5f74 786e 5b22 746f 225d 2c20 6361 7374  _txn["to"], cast
-00001e60: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
-00001e70: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
-00001e80: 225d 290a 2020 2020 2020 2020 290a 2020  "]).        ).  
-00001e90: 2020 2020 2020 6173 7365 7274 206d 6f64        assert mod
-00001ea0: 6966 6965 645f 7478 6e5b 2276 616c 7565  ified_txn["value
-00001eb0: 225d 203d 3d20 320a 2020 2020 2020 2020  "] == 2.        
-00001ec0: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
-00001ed0: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-00001ee0: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-00001ef0: 7274 206d 6f64 6966 6965 645f 7478 6e5b  rt modified_txn[
-00001f00: 2267 6173 5072 6963 6522 5d20 3d3d 2063  "gasPrice"] == c
-00001f10: 6173 7428 696e 742c 2074 786e 5f70 6172  ast(int, txn_par
-00001f20: 616d 735b 2267 6173 5072 6963 6522 5d29  ams["gasPrice"])
-00001f30: 202a 2032 0a0a 2020 2020 4070 7974 6573   * 2..    @pytes
-00001f40: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00001f50: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00001f60: 745f 6574 685f 6d6f 6469 6679 5f74 7261  t_eth_modify_tra
-00001f70: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-00001f80: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00001f90: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00001fa0: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-00001fb0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00001fc0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00001fd0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00001fe0: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
-00001ff0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00002000: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-00002010: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-00002020: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
-00002030: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00002040: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00002050: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00002060: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
-00002070: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00002080: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00002090: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-000020a0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-000020b0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-000020c0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-000020d0: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-000020e0: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
-000020f0: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
-00002100: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-00002110: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
-00002120: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
-00002130: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
-00002140: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00002150: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
-00002160: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00002170: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-00002180: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-00002190: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
-000021a0: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
-000021b0: 6173 796e 635f 7733 2e65 7468 2e6d 6f64  async_w3.eth.mod
-000021c0: 6966 795f 7472 616e 7361 6374 696f 6e28  ify_transaction(
-000021d0: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
-000021e0: 5f68 6173 682c 0a20 2020 2020 2020 2020  _hash,.         
-000021f0: 2020 2076 616c 7565 3d32 2c0a 2020 2020     value=2,.    
-00002200: 2020 2020 2020 2020 6d61 7850 7269 6f72          maxPrior
-00002210: 6974 7946 6565 5065 7247 6173 3d28 6361  ityFeePerGas=(ca
-00002220: 7374 2857 6569 2c20 7478 6e5f 7061 7261  st(Wei, txn_para
-00002230: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
-00002240: 6565 5065 7247 6173 225d 2920 2a20 3229  eePerGas"]) * 2)
-00002250: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-00002260: 7846 6565 5065 7247 6173 3d28 6361 7374  xFeePerGas=(cast
-00002270: 2857 6569 2c20 7478 6e5f 7061 7261 6d73  (Wei, txn_params
-00002280: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
-00002290: 2920 2a20 3229 2c0a 2020 2020 2020 2020  ) * 2),.        
-000022a0: 290a 2020 2020 2020 2020 6d6f 6469 6669  ).        modifi
-000022b0: 6564 5f74 786e 203d 2061 7761 6974 2061  ed_txn = await a
-000022c0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-000022d0: 7472 616e 7361 6374 696f 6e28 6d6f 6469  transaction(modi
-000022e0: 6669 6564 5f74 786e 5f68 6173 6829 0a0a  fied_txn_hash)..
-000022f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00002300: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
-00002310: 2020 2020 2020 2020 2020 2020 6d6f 6469              modi
-00002320: 6669 6564 5f74 786e 5b22 6672 6f6d 225d  fied_txn["from"]
-00002330: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
-00002340: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
-00002350: 6d73 5b22 6672 6f6d 225d 290a 2020 2020  ms["from"]).    
-00002360: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
-00002370: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-00002380: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
-00002390: 2020 6d6f 6469 6669 6564 5f74 786e 5b22    modified_txn["
-000023a0: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
-000023b0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-000023c0: 7061 7261 6d73 5b22 746f 225d 290a 2020  params["to"]).  
-000023d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000023e0: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
-000023f0: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
-00002400: 320a 2020 2020 2020 2020 6173 7365 7274  2.        assert
-00002410: 206d 6f64 6966 6965 645f 7478 6e5b 2267   modified_txn["g
-00002420: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
-00002430: 2020 2020 2020 6173 7365 7274 2028 0a20        assert (. 
-00002440: 2020 2020 2020 2020 2020 206d 6f64 6966             modif
-00002450: 6965 645f 7478 6e5b 226d 6178 5072 696f  ied_txn["maxPrio
-00002460: 7269 7479 4665 6550 6572 4761 7322 5d0a  rityFeePerGas"].
-00002470: 2020 2020 2020 2020 2020 2020 3d3d 2063              == c
-00002480: 6173 7428 5765 692c 2074 786e 5f70 6172  ast(Wei, txn_par
-00002490: 616d 735b 226d 6178 5072 696f 7269 7479  ams["maxPriority
-000024a0: 4665 6550 6572 4761 7322 5d29 202a 2032  FeePerGas"]) * 2
-000024b0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000024c0: 2020 2061 7373 6572 7420 6d6f 6469 6669     assert modifi
-000024d0: 6564 5f74 786e 5b22 6d61 7846 6565 5065  ed_txn["maxFeePe
-000024e0: 7247 6173 225d 203d 3d20 6361 7374 2857  rGas"] == cast(W
-000024f0: 6569 2c20 7478 6e5f 7061 7261 6d73 5b22  ei, txn_params["
-00002500: 6d61 7846 6565 5065 7247 6173 225d 2920  maxFeePerGas"]) 
-00002510: 2a20 320a 0a20 2020 2040 7079 7465 7374  * 2..    @pytest
-00002520: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00002530: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00002540: 5f61 7379 6e63 5f65 7468 5f73 6967 6e5f  _async_eth_sign_
-00002550: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-00002560: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00002570: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-00002580: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-00002590: 2020 6173 796e 635f 6b65 7966 696c 655f    async_keyfile_
-000025a0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-000025b0: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-000025c0: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-000025d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000025e0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-000025f0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-00002600: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-00002610: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-00002620: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00002630: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00002640: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
-00002650: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00002660: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00002670: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00002680: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-00002690: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-000026a0: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-000026b0: 2020 2020 2020 2022 6d61 7846 6565 5065         "maxFeePe
-000026c0: 7247 6173 223a 2061 7379 6e63 5f77 332e  rGas": async_w3.
-000026d0: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
-000026e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-000026f0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00002700: 7247 6173 223a 2061 7379 6e63 5f77 332e  rGas": async_w3.
-00002710: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
-00002720: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00002730: 6e6f 6e63 6522 3a20 4e6f 6e63 6528 3029  nonce": Nonce(0)
-00002740: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00002750: 2020 2020 7265 7375 6c74 203d 2061 7761      result = awa
-00002760: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00002770: 7369 676e 5f74 7261 6e73 6163 7469 6f6e  sign_transaction
-00002780: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-00002790: 2020 2020 2073 6967 6e61 746f 7279 5f61       signatory_a
-000027a0: 6363 6f75 6e74 203d 2061 7379 6e63 5f77  ccount = async_w
-000027b0: 332e 6574 682e 6163 636f 756e 742e 7265  3.eth.account.re
-000027c0: 636f 7665 725f 7472 616e 7361 6374 696f  cover_transactio
-000027d0: 6e28 7265 7375 6c74 5b22 7261 7722 5d29  n(result["raw"])
-000027e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000027f0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-00002800: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00002810: 616c 5f74 7970 6520 3d3d 2073 6967 6e61  al_type == signa
-00002820: 746f 7279 5f61 6363 6f75 6e74 0a20 2020  tory_account.   
-00002830: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-00002840: 6c74 5b22 7478 225d 5b22 746f 225d 203d  lt["tx"]["to"] =
-00002850: 3d20 7478 6e5f 7061 7261 6d73 5b22 746f  = txn_params["to
-00002860: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-00002870: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
-00002880: 7661 6c75 6522 5d20 3d3d 2074 786e 5f70  value"] == txn_p
-00002890: 6172 616d 735b 2276 616c 7565 225d 0a20  arams["value"]. 
-000028a0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000028b0: 7375 6c74 5b22 7478 225d 5b22 6761 7322  sult["tx"]["gas"
-000028c0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-000028d0: 2267 6173 225d 0a20 2020 2020 2020 2061  "gas"].        a
-000028e0: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-000028f0: 225d 5b22 6d61 7846 6565 5065 7247 6173  "]["maxFeePerGas
-00002900: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-00002910: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
-00002920: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00002930: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-00002940: 7375 6c74 5b22 7478 225d 5b22 6d61 7850  sult["tx"]["maxP
-00002950: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-00002960: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-00002970: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-00002980: 5065 7247 6173 225d 0a20 2020 2020 2020  PerGas"].       
-00002990: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-000029a0: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
-000029b0: 6e6f 6e63 6522 5d20 3d3d 2074 786e 5f70  nonce"] == txn_p
-000029c0: 6172 616d 735b 226e 6f6e 6365 225d 0a0a  arams["nonce"]..
-000029d0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-000029e0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-000029f0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00002a00: 7369 676e 5f74 7970 6564 5f64 6174 6128  sign_typed_data(
-00002a10: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00002a20: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
-00002a30: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
-00002a40: 2020 2020 2020 6173 796e 635f 6b65 7966        async_keyf
-00002a50: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00002a60: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
-00002a70: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-00002a80: 2020 2020 2020 2020 6173 796e 635f 736b          async_sk
-00002a90: 6970 5f69 665f 7465 7374 7270 633a 2043  ip_if_testrpc: C
-00002aa0: 616c 6c61 626c 655b 5b22 4173 796e 6357  allable[["AsyncW
-00002ab0: 6562 3322 5d2c 204e 6f6e 655d 2c0a 2020  eb3"], None],.  
-00002ac0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00002ad0: 2020 2020 2076 616c 6964 4a53 4f4e 4d65       validJSONMe
-00002ae0: 7373 6167 6520 3d20 2222 220a 2020 2020  ssage = """.    
-00002af0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00002b00: 2020 2020 2020 2020 2020 2274 7970 6573            "types
-00002b10: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
-00002b20: 2020 2020 2020 2020 2022 4549 5037 3132           "EIP712
-00002b30: 446f 6d61 696e 223a 205b 0a20 2020 2020  Domain": [.     
-00002b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b50: 2020 207b 226e 616d 6522 3a20 226e 616d     {"name": "nam
-00002b60: 6522 2c20 2274 7970 6522 3a20 2273 7472  e", "type": "str
-00002b70: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
-00002b80: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00002b90: 226e 616d 6522 3a20 2276 6572 7369 6f6e  "name": "version
-00002ba0: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
-00002bb0: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
-00002bc0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00002bd0: 6e61 6d65 223a 2022 6368 6169 6e49 6422  name": "chainId"
-00002be0: 2c20 2274 7970 6522 3a20 2275 696e 7432  , "type": "uint2
-00002bf0: 3536 227d 2c0a 2020 2020 2020 2020 2020  56"},.          
-00002c00: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00002c10: 6e61 6d65 223a 2022 7665 7269 6679 696e  name": "verifyin
-00002c20: 6743 6f6e 7472 6163 7422 2c20 2274 7970  gContract", "typ
-00002c30: 6522 3a20 2261 6464 7265 7373 227d 0a20  e": "address"}. 
-00002c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c50: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00002c60: 2020 2020 2020 2020 2020 2250 6572 736f            "Perso
-00002c70: 6e22 3a20 5b0a 2020 2020 2020 2020 2020  n": [.          
-00002c80: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00002c90: 6e61 6d65 223a 2022 6e61 6d65 222c 2022  name": "name", "
-00002ca0: 7479 7065 223a 2022 7374 7269 6e67 227d  type": "string"}
-00002cb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002cc0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
-00002cd0: 223a 2022 7761 6c6c 6574 222c 2022 7479  ": "wallet", "ty
-00002ce0: 7065 223a 2022 6164 6472 6573 7322 7d0a  pe": "address"}.
-00002cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d00: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-00002d10: 2020 2020 2020 2020 2020 2022 4d61 696c             "Mail
-00002d20: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
-00002d30: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00002d40: 616d 6522 3a20 2266 726f 6d22 2c20 2274  ame": "from", "t
-00002d50: 7970 6522 3a20 2250 6572 736f 6e22 7d2c  ype": "Person"},
-00002d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002d70: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
-00002d80: 3a20 2274 6f22 2c20 2274 7970 6522 3a20  : "to", "type": 
-00002d90: 2250 6572 736f 6e22 7d2c 0a20 2020 2020  "Person"},.     
-00002da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002db0: 2020 207b 226e 616d 6522 3a20 2263 6f6e     {"name": "con
-00002dc0: 7465 6e74 7322 2c20 2274 7970 6522 3a20  tents", "type": 
-00002dd0: 2273 7472 696e 6722 7d0a 2020 2020 2020  "string"}.      
-00002de0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00002df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e00: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00002e10: 2020 2022 7072 696d 6172 7954 7970 6522     "primaryType"
-00002e20: 3a20 224d 6169 6c22 2c0a 2020 2020 2020  : "Mail",.      
-00002e30: 2020 2020 2020 2020 2020 2264 6f6d 6169            "domai
-00002e40: 6e22 3a20 7b0a 2020 2020 2020 2020 2020  n": {.          
-00002e50: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00002e60: 3a20 2245 7468 6572 204d 6169 6c22 2c0a  : "Ether Mail",.
-00002e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e80: 2020 2020 2276 6572 7369 6f6e 223a 2022      "version": "
-00002e90: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-00002ea0: 2020 2020 2020 2020 2263 6861 696e 4964          "chainId
-00002eb0: 223a 2022 3078 3031 222c 0a20 2020 2020  ": "0x01",.     
-00002ec0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00002ed0: 7665 7269 6679 696e 6743 6f6e 7472 6163  verifyingContrac
-00002ee0: 7422 3a20 2230 7843 6343 4363 6363 6343  t": "0xCcCCccccC
-00002ef0: 4343 4363 4343 4343 4343 6343 6343 6363  CCCcCCCCCCcCcCcc
-00002f00: 4363 4343 4363 4363 6363 6363 6363 4322  CcCCCcCcccccccC"
-00002f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002f20: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00002f30: 2020 2020 226d 6573 7361 6765 223a 207b      "message": {
-00002f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002f50: 2020 2020 2022 6672 6f6d 223a 207b 0a20       "from": {. 
-00002f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f70: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
-00002f80: 436f 7722 2c0a 2020 2020 2020 2020 2020  Cow",.          
-00002f90: 2020 2020 2020 2020 2020 2020 2020 2277                "w
-00002fa0: 616c 6c65 7422 3a20 2230 7843 4432 6133  allet": "0xCD2a3
-00002fb0: 6439 4639 3338 4531 3343 4439 3437 4563  d9F938E13CD947Ec
-00002fc0: 3035 4162 4337 4645 3733 3444 6638 4444  05AbC7FE734Df8DD
-00002fd0: 3832 3622 0a20 2020 2020 2020 2020 2020  826".           
-00002fe0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00002ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003000: 2274 6f22 3a20 7b0a 2020 2020 2020 2020  "to": {.        
-00003010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003020: 226e 616d 6522 3a20 2242 6f62 222c 0a20  "name": "Bob",. 
-00003030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003040: 2020 2020 2020 2022 7761 6c6c 6574 223a         "wallet":
-00003050: 2022 3078 6242 6242 4242 4262 6242 4242   "0xbBbBBBBbbBBB
-00003060: 6262 6242 6262 4262 6262 6242 4262 4262  bbbBbbBbbbbBBbBb
-00003070: 6262 6242 6242 6262 4242 6242 220a 2020  bbbBbBbbBBbB".  
-00003080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003090: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-000030a0: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-000030b0: 7473 223a 2022 4865 6c6c 6f2c 2042 6f62  ts": "Hello, Bob
-000030c0: 2122 0a20 2020 2020 2020 2020 2020 2020  !".             
-000030d0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-000030e0: 207d 0a20 2020 2020 2020 2022 2222 0a20   }.        """. 
-000030f0: 2020 2020 2020 2061 7379 6e63 5f73 6b69         async_ski
-00003100: 705f 6966 5f74 6573 7472 7063 2861 7379  p_if_testrpc(asy
-00003110: 6e63 5f77 3329 0a20 2020 2020 2020 2073  nc_w3).        s
-00003120: 6967 6e61 7475 7265 203d 2048 6578 4279  ignature = HexBy
-00003130: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00003140: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00003150: 6574 682e 7369 676e 5f74 7970 6564 5f64  eth.sign_typed_d
-00003160: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
-00003170: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
-00003180: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00003190: 7373 5f64 7561 6c5f 7479 7065 2c20 6a73  ss_dual_type, js
-000031a0: 6f6e 2e6c 6f61 6473 2876 616c 6964 4a53  on.loads(validJS
-000031b0: 4f4e 4d65 7373 6167 6529 0a20 2020 2020  ONMessage).     
-000031c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000031d0: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
-000031e0: 7420 6c65 6e28 7369 676e 6174 7572 6529  t len(signature)
-000031f0: 203d 3d20 3332 202b 2033 3220 2b20 310a   == 32 + 32 + 1.
-00003200: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00003210: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-00003220: 796e 6320 6465 6620 7465 7374 5f69 6e76  ync def test_inv
-00003230: 616c 6964 5f65 7468 5f73 6967 6e5f 7479  alid_eth_sign_ty
-00003240: 7065 645f 6461 7461 280a 2020 2020 2020  ped_data(.      
-00003250: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00003260: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00003270: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-00003280: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00003290: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-000032a0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-000032b0: 4164 6472 6573 732c 0a20 2020 2020 2020  Address,.       
-000032c0: 2061 7379 6e63 5f73 6b69 705f 6966 5f74   async_skip_if_t
-000032d0: 6573 7472 7063 3a20 4361 6c6c 6162 6c65  estrpc: Callable
-000032e0: 5b5b 2241 7379 6e63 5765 6233 225d 2c20  [["AsyncWeb3"], 
-000032f0: 4e6f 6e65 5d2c 0a20 2020 2029 202d 3e20  None],.    ) -> 
-00003300: 4e6f 6e65 3a0a 2020 2020 2020 2020 6173  None:.        as
-00003310: 796e 635f 736b 6970 5f69 665f 7465 7374  ync_skip_if_test
-00003320: 7270 6328 6173 796e 635f 7733 290a 2020  rpc(async_w3).  
-00003330: 2020 2020 2020 696e 7661 6c69 645f 7479        invalid_ty
-00003340: 7065 645f 6d65 7373 6167 6520 3d20 2222  ped_message = ""
-00003350: 220a 2020 2020 2020 2020 2020 2020 7b0a  ".            {.
-00003360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003370: 2274 7970 6573 223a 207b 0a20 2020 2020  "types": {.     
-00003380: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00003390: 4549 5037 3132 446f 6d61 696e 223a 205b  EIP712Domain": [
-000033a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000033b0: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
-000033c0: 3a20 226e 616d 6522 2c20 2274 7970 6522  : "name", "type"
-000033d0: 3a20 2273 7472 696e 6722 7d2c 0a20 2020  : "string"},.   
-000033e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000033f0: 2020 2020 207b 226e 616d 6522 3a20 2276       {"name": "v
-00003400: 6572 7369 6f6e 222c 2022 7479 7065 223a  ersion", "type":
-00003410: 2022 7374 7269 6e67 227d 2c0a 2020 2020   "string"},.    
-00003420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003430: 2020 2020 7b22 6e61 6d65 223a 2022 6368      {"name": "ch
-00003440: 6169 6e49 6422 2c20 2274 7970 6522 3a20  ainId", "type": 
-00003450: 2275 696e 7432 3536 227d 2c0a 2020 2020  "uint256"},.    
-00003460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003470: 2020 2020 7b22 6e61 6d65 223a 2022 7665      {"name": "ve
-00003480: 7269 6679 696e 6743 6f6e 7472 6163 7422  rifyingContract"
-00003490: 2c20 2274 7970 6522 3a20 2261 6464 7265  , "type": "addre
-000034a0: 7373 227d 0a20 2020 2020 2020 2020 2020  ss"}.           
-000034b0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-000034c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034d0: 2250 6572 736f 6e22 3a20 5b0a 2020 2020  "Person": [.    
-000034e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034f0: 2020 2020 7b22 6e61 6d65 223a 2022 6e61      {"name": "na
-00003500: 6d65 222c 2022 7479 7065 223a 2022 7374  me", "type": "st
-00003510: 7269 6e67 227d 2c0a 2020 2020 2020 2020  ring"},.        
-00003520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003530: 7b22 6e61 6d65 223a 2022 7761 6c6c 6574  {"name": "wallet
-00003540: 222c 2022 7479 7065 223a 2022 6164 6472  ", "type": "addr
-00003550: 6573 7322 7d0a 2020 2020 2020 2020 2020  ess"}.          
-00003560: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00003570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003580: 2022 4d61 696c 223a 205b 0a20 2020 2020   "Mail": [.     
-00003590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035a0: 2020 207b 226e 616d 6522 3a20 2266 726f     {"name": "fro
-000035b0: 6d22 2c20 2274 7970 6522 3a20 2250 6572  m", "type": "Per
-000035c0: 736f 6e22 7d2c 0a20 2020 2020 2020 2020  son"},.         
-000035d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000035e0: 226e 616d 6522 3a20 2274 6f22 2c20 2274  "name": "to", "t
-000035f0: 7970 6522 3a20 2250 6572 736f 6e5b 325d  ype": "Person[2]
-00003600: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00003610: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-00003620: 6d65 223a 2022 636f 6e74 656e 7473 222c  me": "contents",
-00003630: 2022 7479 7065 223a 2022 7374 7269 6e67   "type": "string
-00003640: 227d 0a20 2020 2020 2020 2020 2020 2020  "}.             
-00003650: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00003660: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00003670: 2020 2020 2020 2020 2020 2020 2270 7269              "pri
-00003680: 6d61 7279 5479 7065 223a 2022 4d61 696c  maryType": "Mail
-00003690: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000036a0: 2020 2022 646f 6d61 696e 223a 207b 0a20     "domain": {. 
-000036b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000036c0: 2020 2022 6e61 6d65 223a 2022 4574 6865     "name": "Ethe
-000036d0: 7220 4d61 696c 222c 0a20 2020 2020 2020  r Mail",.       
-000036e0: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-000036f0: 7273 696f 6e22 3a20 2231 222c 0a20 2020  rsion": "1",.   
-00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003710: 2022 6368 6169 6e49 6422 3a20 2230 7830   "chainId": "0x0
-00003720: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-00003730: 2020 2020 2020 2020 2276 6572 6966 7969          "verifyi
-00003740: 6e67 436f 6e74 7261 6374 223a 2022 3078  ngContract": "0x
-00003750: 4363 4343 6363 6363 4343 4343 6343 4343  CcCCccccCCCCcCCC
-00003760: 4343 4363 4363 4363 6343 6343 4343 6343  CCCcCcCccCcCCCcC
-00003770: 6363 6363 6363 6343 220a 2020 2020 2020  cccccccC".      
-00003780: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00003790: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
-000037a0: 7373 6167 6522 3a20 7b0a 2020 2020 2020  ssage": {.      
-000037b0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-000037c0: 726f 6d22 3a20 7b0a 2020 2020 2020 2020  rom": {.        
-000037d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037e0: 226e 616d 6522 3a20 2243 6f77 222c 0a20  "name": "Cow",. 
-000037f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003800: 2020 2020 2020 2022 7761 6c6c 6574 223a         "wallet":
-00003810: 2022 3078 4344 3261 3364 3946 3933 3845   "0xCD2a3d9F938E
-00003820: 3133 4344 3934 3745 6330 3541 6243 3746  13CD947Ec05AbC7F
-00003830: 4537 3334 4466 3844 4438 3236 220a 2020  E734Df8DD826".  
-00003840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003850: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00003860: 2020 2020 2020 2020 2022 746f 223a 205b           "to": [
-00003870: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00003880: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00003890: 3a20 2242 6f62 222c 0a20 2020 2020 2020  : "Bob",.       
-000038a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000038b0: 2022 7761 6c6c 6574 223a 2022 3078 6242   "wallet": "0xbB
-000038c0: 6242 4242 4262 6242 4242 6262 6242 6262  bBBBBbbBBBbbbBbb
-000038d0: 4262 6262 6242 4262 4262 6262 6242 6242  BbbbbBBbBbbbbBbB
-000038e0: 6262 4242 6242 220a 2020 2020 2020 2020  bbBBbB".        
-000038f0: 2020 2020 2020 2020 2020 2020 7d5d 2c0a              }],.
-00003900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003910: 2020 2020 2263 6f6e 7465 6e74 7322 3a20      "contents": 
-00003920: 2248 656c 6c6f 2c20 426f 6221 220a 2020  "Hello, Bob!".  
-00003930: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00003940: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00003950: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003960: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00003970: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
-00003980: 2020 5765 6233 5661 6c75 6545 7272 6f72    Web3ValueError
-00003990: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-000039a0: 7463 683d 7222 2e2a 4578 7065 6374 6564  tch=r".*Expected
-000039b0: 2032 2069 7465 6d73 2066 6f72 2061 7272   2 items for arr
-000039c0: 6179 2074 7970 6520 5065 7273 6f6e 5c5b  ay type Person\[
-000039d0: 325c 5d2c 2067 6f74 2031 2069 7465 6d73  2\], got 1 items
-000039e0: 2e2a 222c 0a20 2020 2020 2020 2029 3a0a  .*",.        ):.
-000039f0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-00003a00: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
-00003a10: 6967 6e5f 7479 7065 645f 6461 7461 280a  ign_typed_data(.
-00003a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a30: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-00003a40: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00003a50: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00003a60: 2020 2020 2020 2020 206a 736f 6e2e 6c6f           json.lo
-00003a70: 6164 7328 696e 7661 6c69 645f 7479 7065  ads(invalid_type
-00003a80: 645f 6d65 7373 6167 6529 2c0a 2020 2020  d_message),.    
-00003a90: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00003aa0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00003ab0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00003ac0: 6620 7465 7374 5f61 7379 6e63 5f65 7468  f test_async_eth
-00003ad0: 5f73 6967 6e5f 7472 616e 7361 6374 696f  _sign_transactio
-00003ae0: 6e5f 6c65 6761 6379 280a 2020 2020 2020  n_legacy(.      
-00003af0: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-00003b00: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
-00003b10: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00003b20: 6f75 6e74 5f61 6464 7265 7373 3a20 4368  ount_address: Ch
-00003b30: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-00003b40: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00003b50: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00003b60: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00003b70: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00003b80: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-00003b90: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
-00003ba0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-00003bb0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
-00003bc0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00003bd0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00003be0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-00003bf0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00003c00: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00003c10: 2020 2020 2022 6761 7350 7269 6365 223a       "gasPrice":
-00003c20: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00003c30: 6574 682e 6761 735f 7072 6963 652c 0a20  eth.gas_price,. 
-00003c40: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
-00003c50: 6522 3a20 4e6f 6e63 6528 3029 2c0a 2020  e": Nonce(0),.  
-00003c60: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00003c70: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
-00003c80: 7379 6e63 5f77 332e 6574 682e 7369 676e  sync_w3.eth.sign
-00003c90: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00003ca0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00003cb0: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
-00003cc0: 6e74 203d 2061 7379 6e63 5f77 332e 6574  nt = async_w3.et
-00003cd0: 682e 6163 636f 756e 742e 7265 636f 7665  h.account.recove
-00003ce0: 725f 7472 616e 7361 6374 696f 6e28 7265  r_transaction(re
-00003cf0: 7375 6c74 5b22 7261 7722 5d29 0a20 2020  sult["raw"]).   
-00003d00: 2020 2020 2061 7373 6572 7420 6173 796e       assert asyn
-00003d10: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00003d20: 745f 6164 6472 6573 7320 3d3d 2073 6967  t_address == sig
-00003d30: 6e61 746f 7279 5f61 6363 6f75 6e74 0a20  natory_account. 
-00003d40: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00003d50: 7375 6c74 5b22 7478 225d 5b22 746f 225d  sult["tx"]["to"]
-00003d60: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
-00003d70: 746f 225d 0a20 2020 2020 2020 2061 7373  to"].        ass
-00003d80: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
-00003d90: 5b22 7661 6c75 6522 5d20 3d3d 2074 786e  ["value"] == txn
-00003da0: 5f70 6172 616d 735b 2276 616c 7565 225d  _params["value"]
-00003db0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00003dc0: 7265 7375 6c74 5b22 7478 225d 5b22 6761  result["tx"]["ga
-00003dd0: 7322 5d20 3d3d 2074 786e 5f70 6172 616d  s"] == txn_param
-00003de0: 735b 2267 6173 225d 0a20 2020 2020 2020  s["gas"].       
-00003df0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-00003e00: 7478 225d 5b22 6761 7350 7269 6365 225d  tx"]["gasPrice"]
-00003e10: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
-00003e20: 6761 7350 7269 6365 225d 0a20 2020 2020  gasPrice"].     
-00003e30: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
-00003e40: 5b22 7478 225d 5b22 6e6f 6e63 6522 5d20  ["tx"]["nonce"] 
-00003e50: 3d3d 2074 786e 5f70 6172 616d 735b 226e  == txn_params["n
-00003e60: 6f6e 6365 225d 0a0a 2020 2020 4070 7974  once"]..    @pyt
-00003e70: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00003e80: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00003e90: 6573 745f 6173 796e 635f 6574 685f 7369  est_async_eth_si
-00003ea0: 676e 5f74 7261 6e73 6163 7469 6f6e 5f68  gn_transaction_h
-00003eb0: 6578 5f66 6565 7328 0a20 2020 2020 2020  ex_fees(.       
-00003ec0: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-00003ed0: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-00003ee0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-00003ef0: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
-00003f00: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
-00003f10: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00003f20: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-00003f30: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
-00003f40: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-00003f50: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
-00003f60: 6363 6f75 6e74 5f61 6464 7265 7373 2c0a  ccount_address,.
-00003f70: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
-00003f80: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-00003f90: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
-00003fa0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00003fb0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00003fc0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-00003fd0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00003fe0: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
-00003ff0: 7322 3a20 6865 7828 6173 796e 635f 7733  s": hex(async_w3
-00004000: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
-00004010: 2229 292c 0a20 2020 2020 2020 2020 2020  ")),.           
-00004020: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
-00004030: 5065 7247 6173 223a 2068 6578 2861 7379  PerGas": hex(asy
-00004040: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-00004050: 2267 7765 6922 2929 2c0a 2020 2020 2020  "gwei")),.      
-00004060: 2020 2020 2020 226e 6f6e 6365 223a 204e        "nonce": N
-00004070: 6f6e 6365 2830 292c 0a20 2020 2020 2020  once(0),.       
-00004080: 207d 0a20 2020 2020 2020 2072 6573 756c   }.        resul
-00004090: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-000040a0: 7733 2e65 7468 2e73 6967 6e5f 7472 616e  w3.eth.sign_tran
-000040b0: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
-000040c0: 6d73 290a 2020 2020 2020 2020 7369 676e  ms).        sign
-000040d0: 6174 6f72 795f 6163 636f 756e 7420 3d20  atory_account = 
-000040e0: 6173 796e 635f 7733 2e65 7468 2e61 6363  async_w3.eth.acc
-000040f0: 6f75 6e74 2e72 6563 6f76 6572 5f74 7261  ount.recover_tra
-00004100: 6e73 6163 7469 6f6e 2872 6573 756c 745b  nsaction(result[
-00004110: 2272 6177 225d 290a 2020 2020 2020 2020  "raw"]).        
-00004120: 6173 7365 7274 2061 7379 6e63 5f6b 6579  assert async_key
-00004130: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00004140: 7265 7373 203d 3d20 7369 676e 6174 6f72  ress == signator
-00004150: 795f 6163 636f 756e 740a 2020 2020 2020  y_account.      
-00004160: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-00004170: 2274 7822 5d5b 2274 6f22 5d20 3d3d 2074  "tx"]["to"] == t
-00004180: 786e 5f70 6172 616d 735b 2274 6f22 5d0a  xn_params["to"].
-00004190: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-000041a0: 6573 756c 745b 2274 7822 5d5b 2276 616c  esult["tx"]["val
-000041b0: 7565 225d 203d 3d20 7478 6e5f 7061 7261  ue"] == txn_para
-000041c0: 6d73 5b22 7661 6c75 6522 5d0a 2020 2020  ms["value"].    
-000041d0: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-000041e0: 745b 2274 7822 5d5b 2267 6173 225d 203d  t["tx"]["gas"] =
-000041f0: 3d20 7478 6e5f 7061 7261 6d73 5b22 6761  = txn_params["ga
-00004200: 7322 5d0a 2020 2020 2020 2020 6173 7365  s"].        asse
-00004210: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
-00004220: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
-00004230: 3d3d 2069 6e74 2873 7472 2874 786e 5f70  == int(str(txn_p
-00004240: 6172 616d 735b 226d 6178 4665 6550 6572  arams["maxFeePer
-00004250: 4761 7322 5d29 2c20 3136 290a 2020 2020  Gas"]), 16).    
-00004260: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-00004270: 745b 2274 7822 5d5b 226d 6178 5072 696f  t["tx"]["maxPrio
-00004280: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
-00004290: 3d3d 2069 6e74 280a 2020 2020 2020 2020  == int(.        
-000042a0: 2020 2020 7374 7228 7478 6e5f 7061 7261      str(txn_para
-000042b0: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
-000042c0: 6565 5065 7247 6173 225d 292c 2031 360a  eePerGas"]), 16.
-000042d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000042e0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-000042f0: 2274 7822 5d5b 226e 6f6e 6365 225d 203d  "tx"]["nonce"] =
-00004300: 3d20 7478 6e5f 7061 7261 6d73 5b22 6e6f  = txn_params["no
-00004310: 6e63 6522 5d0a 0a20 2020 2040 7079 7465  nce"]..    @pyte
-00004320: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00004330: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00004340: 2e78 6661 696c 280a 2020 2020 2020 2020  .xfail(.        
-00004350: 7265 6173 6f6e 3d22 6173 796e 6320 6e61  reason="async na
-00004360: 6d65 5f74 6f5f 6164 6472 6573 735f 6d69  me_to_address_mi
-00004370: 6464 6c65 7761 7265 2068 6173 206e 6f74  ddleware has not
-00004380: 2062 6565 6e20 696d 706c 656d 656e 7465   been implemente
-00004390: 6420 7965 7422 0a20 2020 2029 0a20 2020  d yet".    ).   
-000043a0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-000043b0: 6173 796e 635f 6574 685f 7369 676e 5f74  async_eth_sign_t
-000043c0: 7261 6e73 6163 7469 6f6e 5f65 6e73 5f6e  ransaction_ens_n
-000043d0: 616d 6573 280a 2020 2020 2020 2020 7365  ames(.        se
-000043e0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-000043f0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
-00004400: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00004410: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-00004420: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-00004430: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00004440: 2077 6974 6820 656e 735f 6164 6472 6573   with ens_addres
-00004450: 7365 7328 0a20 2020 2020 2020 2020 2020  ses(.           
-00004460: 2061 7379 6e63 5f77 332c 207b 2275 6e6c   async_w3, {"unl
-00004470: 6f63 6b65 642d 6163 636f 756e 742e 6574  ocked-account.et
-00004480: 6822 3a20 6173 796e 635f 6b65 7966 696c  h": async_keyfil
-00004490: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-000044a0: 737d 0a20 2020 2020 2020 2029 3a0a 2020  s}.        ):.  
-000044b0: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
-000044c0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-000044d0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000044e0: 2020 2022 6672 6f6d 223a 2022 756e 6c6f     "from": "unlo
-000044f0: 636b 6564 2d61 6363 6f75 6e74 2e65 7468  cked-account.eth
-00004500: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00004510: 2020 2022 746f 223a 2022 756e 6c6f 636b     "to": "unlock
-00004520: 6564 2d61 6363 6f75 6e74 2e65 7468 222c  ed-account.eth",
-00004530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004540: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00004550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00004560: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
-00004570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004580: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-00004590: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-000045a0: 322c 2022 6777 6569 2229 2c0a 2020 2020  2, "gwei"),.    
-000045b0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-000045c0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-000045d0: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
-000045e0: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-000045f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004600: 226e 6f6e 6365 223a 204e 6f6e 6365 2830  "nonce": Nonce(0
-00004610: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
-00004620: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00004630: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
-00004640: 635f 7733 2e65 7468 2e73 6967 6e5f 7472  c_w3.eth.sign_tr
-00004650: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00004660: 7261 6d73 290a 2020 2020 2020 2020 2020  rams).          
-00004670: 2020 7369 676e 6174 6f72 795f 6163 636f    signatory_acco
-00004680: 756e 7420 3d20 6173 796e 635f 7733 2e65  unt = async_w3.e
-00004690: 7468 2e61 6363 6f75 6e74 2e72 6563 6f76  th.account.recov
-000046a0: 6572 5f74 7261 6e73 6163 7469 6f6e 2872  er_transaction(r
-000046b0: 6573 756c 745b 2272 6177 225d 290a 2020  esult["raw"]).  
-000046c0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000046d0: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
-000046e0: 6363 6f75 6e74 5f61 6464 7265 7373 203d  ccount_address =
-000046f0: 3d20 7369 676e 6174 6f72 795f 6163 636f  = signatory_acco
-00004700: 756e 740a 2020 2020 2020 2020 2020 2020  unt.            
-00004710: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-00004720: 7822 5d5b 2274 6f22 5d20 3d3d 2061 7379  x"]["to"] == asy
-00004730: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00004740: 6e74 5f61 6464 7265 7373 0a20 2020 2020  nt_address.     
-00004750: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00004760: 7375 6c74 5b22 7478 225d 5b22 7661 6c75  sult["tx"]["valu
-00004770: 6522 5d20 3d3d 2074 786e 5f70 6172 616d  e"] == txn_param
-00004780: 735b 2276 616c 7565 225d 0a20 2020 2020  s["value"].     
-00004790: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000047a0: 7375 6c74 5b22 7478 225d 5b22 6761 7322  sult["tx"]["gas"
-000047b0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-000047c0: 2267 6173 225d 0a20 2020 2020 2020 2020  "gas"].         
-000047d0: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
-000047e0: 5b22 7478 225d 5b22 6d61 7846 6565 5065  ["tx"]["maxFeePe
-000047f0: 7247 6173 225d 203d 3d20 7478 6e5f 7061  rGas"] == txn_pa
-00004800: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
-00004810: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
-00004820: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
-00004830: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00004840: 5b22 7478 225d 5b22 6d61 7850 7269 6f72  ["tx"]["maxPrior
-00004850: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
-00004860: 2020 2020 2020 2020 2020 2020 2020 203d                 =
-00004870: 3d20 7478 6e5f 7061 7261 6d73 5b22 6d61  = txn_params["ma
-00004880: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00004890: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
-000048a0: 2029 0a20 2020 2020 2020 2020 2020 2061   ).            a
-000048b0: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-000048c0: 225d 5b22 6e6f 6e63 6522 5d20 3d3d 2074  "]["nonce"] == t
-000048d0: 786e 5f70 6172 616d 735b 226e 6f6e 6365  xn_params["nonce
-000048e0: 225d 0a0a 2020 2020 4070 7974 6573 742e  "]..    @pytest.
-000048f0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00004900: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00004910: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
-00004920: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
-00004930: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-00004940: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00004950: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-00004960: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00004970: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00004980: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-00004990: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
-000049a0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-000049b0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-000049c0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000049d0: 2022 6672 6f6d 223a 2061 7379 6e63 5f6b   "from": async_k
-000049e0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-000049f0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00004a00: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00004a10: 6f22 3a20 6173 796e 635f 6b65 7966 696c  o": async_keyfil
-00004a20: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00004a30: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-00004a40: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-00004a50: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-00004a60: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-00004a70: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00004a80: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-00004a90: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00004aa0: 332c 2022 6777 6569 2229 2c0a 2020 2020  3, "gwei"),.    
-00004ab0: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-00004ac0: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-00004ad0: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
-00004ae0: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
-00004af0: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-00004b00: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
-00004b10: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
-00004b20: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00004b30: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00004b40: 2074 786e 203d 2061 7761 6974 2061 7379   txn = await asy
-00004b50: 6e63 5f77 332e 6574 682e 6765 745f 7472  nc_w3.eth.get_tr
-00004b60: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-00004b70: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-00004b80: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-00004b90: 6573 7328 7478 6e5b 2266 726f 6d22 5d2c  ess(txn["from"],
-00004ba0: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-00004bb0: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-00004bc0: 735b 2266 726f 6d22 5d29 290a 2020 2020  s["from"])).    
-00004bd0: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00004be0: 6d65 5f61 6464 7265 7373 2874 786e 5b22  me_address(txn["
-00004bf0: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
-00004c00: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00004c10: 7061 7261 6d73 5b22 746f 225d 2929 0a20  params["to"])). 
-00004c20: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-00004c30: 6e5b 2276 616c 7565 225d 203d 3d20 310a  n["value"] == 1.
-00004c40: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00004c50: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
-00004c60: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
-00004c70: 7420 7478 6e5b 226d 6178 4665 6550 6572  t txn["maxFeePer
-00004c80: 4761 7322 5d20 3d3d 2074 786e 5f70 6172  Gas"] == txn_par
-00004c90: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
-00004ca0: 7322 5d0a 2020 2020 2020 2020 6173 7365  s"].        asse
-00004cb0: 7274 2074 786e 5b22 6d61 7850 7269 6f72  rt txn["maxPrior
-00004cc0: 6974 7946 6565 5065 7247 6173 225d 203d  ityFeePerGas"] =
-00004cd0: 3d20 7478 6e5f 7061 7261 6d73 5b22 6d61  = txn_params["ma
-00004ce0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00004cf0: 6173 225d 0a20 2020 2020 2020 2061 7373  as"].        ass
-00004d00: 6572 7420 7478 6e5b 2267 6173 5072 6963  ert txn["gasPric
-00004d10: 6522 5d20 3d3d 2074 786e 5f70 6172 616d  e"] == txn_param
-00004d20: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
-00004d30: 5d0a 0a20 2020 2040 7079 7465 7374 2e6d  ]..    @pytest.m
-00004d40: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00004d50: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00004d60: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
-00004d70: 696f 6e5f 6465 6661 756c 745f 6665 6573  ion_default_fees
-00004d80: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00004d90: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-00004da0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-00004db0: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
-00004dc0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00004dd0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
-00004de0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00004df0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00004e00: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00004e10: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-00004e20: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00004e30: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
-00004e40: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00004e50: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00004e60: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-00004e70: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-00004e80: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00004e90: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00004ea0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
-00004eb0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
-00004ec0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
-00004ed0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00004ee0: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
-00004ef0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00004f00: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-00004f10: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-00004f20: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
-00004f30: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00004f40: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
-00004f50: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
-00004f60: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-00004f70: 6164 6472 6573 7328 7478 6e5b 2266 726f  address(txn["fro
-00004f80: 6d22 5d2c 2063 6173 7428 4368 6563 6b73  m"], cast(Checks
-00004f90: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
-00004fa0: 6172 616d 735b 2266 726f 6d22 5d29 290a  arams["from"])).
-00004fb0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00004fc0: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-00004fd0: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
-00004fe0: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
-00004ff0: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
-00005000: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-00005010: 7420 7478 6e5b 2276 616c 7565 225d 203d  t txn["value"] =
-00005020: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
-00005030: 7274 2074 786e 5b22 6761 7322 5d20 3d3d  rt txn["gas"] ==
-00005040: 2032 3130 3030 0a20 2020 2020 2020 2061   21000.        a
-00005050: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-00005060: 2874 786e 5b22 6d61 7850 7269 6f72 6974  (txn["maxPriorit
-00005070: 7946 6565 5065 7247 6173 225d 290a 2020  yFeePerGas"]).  
-00005080: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00005090: 696e 7465 6765 7228 7478 6e5b 226d 6178  integer(txn["max
-000050a0: 4665 6550 6572 4761 7322 5d29 0a20 2020  FeePerGas"]).   
-000050b0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
-000050c0: 2267 6173 5072 6963 6522 5d20 3d3d 2074  "gasPrice"] == t
-000050d0: 786e 5b22 6d61 7846 6565 5065 7247 6173  xn["maxFeePerGas
-000050e0: 225d 0a0a 2020 2020 4070 7974 6573 742e  "]..    @pytest.
-000050f0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00005100: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00005110: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
-00005120: 7469 6f6e 5f68 6578 5f66 6565 7328 0a20  tion_hex_fees(. 
-00005130: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00005140: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-00005150: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-00005160: 2020 2020 6173 796e 635f 6b65 7966 696c      async_keyfil
-00005170: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00005180: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
-00005190: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-000051a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000051b0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-000051c0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-000051d0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-000051e0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-000051f0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00005200: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00005210: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00005220: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00005230: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00005240: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00005250: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00005260: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00005270: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00005280: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00005290: 5065 7247 6173 223a 2068 6578 2832 3530  PerGas": hex(250
-000052a0: 202a 2031 302a 2a39 292c 0a20 2020 2020   * 10**9),.     
-000052b0: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
-000052c0: 6974 7946 6565 5065 7247 6173 223a 2068  ityFeePerGas": h
-000052d0: 6578 2832 202a 2031 302a 2a39 292c 0a20  ex(2 * 10**9),. 
-000052e0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-000052f0: 2074 786e 5f68 6173 6820 3d20 6177 6169   txn_hash = awai
-00005300: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
-00005310: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-00005320: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-00005330: 2020 2020 7478 6e20 3d20 6177 6169 7420      txn = await 
-00005340: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00005350: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00005360: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
-00005370: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-00005380: 6464 7265 7373 2874 786e 5b22 6672 6f6d  ddress(txn["from
-00005390: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-000053a0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-000053b0: 7261 6d73 5b22 6672 6f6d 225d 2929 0a20  rams["from"])). 
-000053c0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000053d0: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
-000053e0: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
-000053f0: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-00005400: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
-00005410: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00005420: 2074 786e 5b22 7661 6c75 6522 5d20 3d3d   txn["value"] ==
-00005430: 2031 0a20 2020 2020 2020 2061 7373 6572   1.        asser
-00005440: 7420 7478 6e5b 2267 6173 225d 203d 3d20  t txn["gas"] == 
-00005450: 3231 3030 300a 2020 2020 2020 2020 6173  21000.        as
-00005460: 7365 7274 2074 786e 5b22 6d61 7846 6565  sert txn["maxFee
-00005470: 5065 7247 6173 225d 203d 3d20 3235 3020  PerGas"] == 250 
-00005480: 2a20 3130 2a2a 390a 2020 2020 2020 2020  * 10**9.        
-00005490: 6173 7365 7274 2074 786e 5b22 6d61 7850  assert txn["maxP
-000054a0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-000054b0: 225d 203d 3d20 3220 2a20 3130 2a2a 390a  "] == 2 * 10**9.
-000054c0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-000054d0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-000054e0: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
-000054f0: 5f73 656e 645f 7472 616e 7361 6374 696f  _send_transactio
-00005500: 6e5f 6e6f 5f67 6173 280a 2020 2020 2020  n_no_gas(.      
-00005510: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00005520: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00005530: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-00005540: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00005550: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00005560: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00005570: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
-00005580: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00005590: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-000055a0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-000055b0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
-000055c0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-000055d0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-000055e0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-000055f0: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
-00005600: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00005610: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00005620: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00005630: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00005640: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
-00005650: 6550 6572 4761 7322 3a20 5765 6928 3235  ePerGas": Wei(25
-00005660: 3020 2a20 3130 2a2a 3929 2c0a 2020 2020  0 * 10**9),.    
-00005670: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-00005680: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-00005690: 5765 6928 3220 2a20 3130 2a2a 3929 2c0a  Wei(2 * 10**9),.
-000056a0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000056b0: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
-000056c0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-000056d0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-000056e0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-000056f0: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
-00005700: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00005710: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
-00005720: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
-00005730: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-00005740: 6164 6472 6573 7328 7478 6e5b 2266 726f  address(txn["fro
-00005750: 6d22 5d2c 2063 6173 7428 4368 6563 6b73  m"], cast(Checks
-00005760: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
-00005770: 6172 616d 735b 2266 726f 6d22 5d29 290a  arams["from"])).
-00005780: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00005790: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-000057a0: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
-000057b0: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
-000057c0: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
-000057d0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-000057e0: 7420 7478 6e5b 2276 616c 7565 225d 203d  t txn["value"] =
-000057f0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
-00005800: 7274 2074 786e 5b22 6761 7322 5d20 3d3d  rt txn["gas"] ==
-00005810: 2031 3231 3030 3020 2023 2032 3130 3030   121000  # 21000
-00005820: 202b 2062 7566 6665 720a 0a20 2020 2040   + buffer..    @
-00005830: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00005840: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00005850: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
-00005860: 7472 616e 7361 6374 696f 6e5f 7769 7468  transaction_with
-00005870: 5f67 6173 5f70 7269 6365 280a 2020 2020  _gas_price(.    
-00005880: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00005890: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
-000058a0: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
-000058b0: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
-000058c0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
-000058d0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
-000058e0: 756d 4164 6472 6573 732c 0a20 2020 2029  umAddress,.    )
-000058f0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00005900: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-00005910: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-00005920: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
-00005930: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00005940: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00005950: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00005960: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
-00005970: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00005980: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00005990: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-000059a0: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-000059b0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-000059c0: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-000059d0: 2020 2020 2020 2267 6173 5072 6963 6522        "gasPrice"
-000059e0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-000059f0: 2020 2020 2020 226d 6178 4665 6550 6572        "maxFeePer
-00005a00: 4761 7322 3a20 5765 6928 3235 3020 2a20  Gas": Wei(250 * 
-00005a10: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
-00005a20: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-00005a30: 4665 6550 6572 4761 7322 3a20 5765 6928  FeePerGas": Wei(
-00005a40: 3220 2a20 3130 2a2a 3929 2c0a 2020 2020  2 * 10**9),.    
-00005a50: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
-00005a60: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00005a70: 2854 7261 6e73 6163 7469 6f6e 5479 7065  (TransactionType
-00005a80: 4d69 736d 6174 6368 293a 0a20 2020 2020  Mismatch):.     
-00005a90: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
-00005aa0: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
-00005ab0: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
-00005ac0: 6172 616d 7329 0a0a 2020 2020 4070 7974  arams)..    @pyt
-00005ad0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00005ae0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00005af0: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-00005b00: 6e73 6163 7469 6f6e 5f6e 6f5f 7072 696f  nsaction_no_prio
-00005b10: 7269 7479 5f66 6565 280a 2020 2020 2020  rity_fee(.      
-00005b20: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00005b30: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00005b40: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-00005b50: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00005b60: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00005b70: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-00005b80: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
-00005b90: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00005ba0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-00005bb0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-00005bc0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
-00005bd0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00005be0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00005bf0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00005c00: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
-00005c10: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00005c20: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00005c30: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00005c40: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00005c50: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-00005c60: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00005c70: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
-00005c80: 7322 3a20 5765 6928 3235 3020 2a20 3130  s": Wei(250 * 10
-00005c90: 2a2a 3929 2c0a 2020 2020 2020 2020 7d0a  **9),.        }.
-00005ca0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-00005cb0: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
-00005cc0: 2020 2020 2020 2020 496e 7661 6c69 6454          InvalidT
-00005cd0: 7261 6e73 6163 7469 6f6e 2c20 6d61 7463  ransaction, matc
-00005ce0: 683d 226d 6178 5072 696f 7269 7479 4665  h="maxPriorityFe
-00005cf0: 6550 6572 4761 7320 6d75 7374 2062 6520  ePerGas must be 
-00005d00: 6465 6669 6e65 6422 0a20 2020 2020 2020  defined".       
-00005d10: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00005d20: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00005d30: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-00005d40: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-00005d50: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00005d60: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-00005d70: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
-00005d80: 5f73 656e 645f 7472 616e 7361 6374 696f  _send_transactio
-00005d90: 6e5f 6e6f 5f6d 6178 5f66 6565 280a 2020  n_no_max_fee(.  
-00005da0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00005db0: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
-00005dc0: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
-00005dd0: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
-00005de0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00005df0: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-00005e00: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-00005e10: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00005e20: 2020 2020 6d61 7850 7269 6f72 6974 7946      maxPriorityF
-00005e30: 6565 5065 7247 6173 203d 2061 7379 6e63  eePerGas = async
-00005e40: 5f77 332e 746f 5f77 6569 2832 2c20 2267  _w3.to_wei(2, "g
-00005e50: 7765 6922 290a 2020 2020 2020 2020 7478  wei").        tx
-00005e60: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-00005e70: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00005e80: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
-00005e90: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00005ea0: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00005eb0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00005ec0: 2274 6f22 3a20 6173 796e 635f 6b65 7966  "to": async_keyf
-00005ed0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00005ee0: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-00005ef0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-00005f00: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-00005f10: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00005f20: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00005f30: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-00005f40: 6550 6572 4761 7322 3a20 6d61 7850 7269  ePerGas": maxPri
-00005f50: 6f72 6974 7946 6565 5065 7247 6173 2c0a  orityFeePerGas,.
-00005f60: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00005f70: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
-00005f80: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00005f90: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-00005fa0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-00005fb0: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
-00005fc0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00005fd0: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
-00005fe0: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
-00005ff0: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-00006000: 6164 6472 6573 7328 7478 6e5b 2266 726f  address(txn["fro
-00006010: 6d22 5d2c 2063 6173 7428 4368 6563 6b73  m"], cast(Checks
-00006020: 756d 4164 6472 6573 732c 2074 786e 5f70  umAddress, txn_p
-00006030: 6172 616d 735b 2266 726f 6d22 5d29 290a  arams["from"])).
-00006040: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00006050: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-00006060: 786e 5b22 746f 225d 2c20 6361 7374 2843  xn["to"], cast(C
-00006070: 6865 636b 7375 6d41 6464 7265 7373 2c20  hecksumAddress, 
-00006080: 7478 6e5f 7061 7261 6d73 5b22 746f 225d  txn_params["to"]
-00006090: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-000060a0: 7420 7478 6e5b 2276 616c 7565 225d 203d  t txn["value"] =
-000060b0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
-000060c0: 7274 2074 786e 5b22 6761 7322 5d20 3d3d  rt txn["gas"] ==
-000060d0: 2032 3130 3030 0a0a 2020 2020 2020 2020   21000..        
-000060e0: 626c 6f63 6b20 3d20 6177 6169 7420 6173  block = await as
-000060f0: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
-00006100: 6c6f 636b 2822 6c61 7465 7374 2229 0a20  lock("latest"). 
-00006110: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
-00006120: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
-00006130: 5d20 3d3d 206d 6178 5072 696f 7269 7479  ] == maxPriority
-00006140: 4665 6550 6572 4761 7320 2b20 3220 2a20  FeePerGas + 2 * 
-00006150: 626c 6f63 6b5b 2262 6173 6546 6565 5065  block["baseFeePe
-00006160: 7247 6173 225d 0a0a 2020 2020 4070 7974  rGas"]..    @pyt
-00006170: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00006180: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00006190: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-000061a0: 6e73 6163 7469 6f6e 5f6d 6178 5f66 6565  nsaction_max_fee
-000061b0: 5f6c 6573 735f 7468 616e 5f74 6970 280a  _less_than_tip(.
-000061c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000061d0: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
-000061e0: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
-000061f0: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
-00006200: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00006210: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
-00006220: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
-00006230: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00006240: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00006250: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-00006260: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00006270: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
-00006280: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00006290: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-000062a0: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
-000062b0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-000062c0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-000062d0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-000062e0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
-000062f0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-00006300: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
-00006310: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
-00006320: 6550 6572 4761 7322 3a20 5765 6928 3120  ePerGas": Wei(1 
-00006330: 2a20 3130 2a2a 3929 2c0a 2020 2020 2020  * 10**9),.      
-00006340: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
-00006350: 7479 4665 6550 6572 4761 7322 3a20 5765  tyFeePerGas": We
-00006360: 6928 3220 2a20 3130 2a2a 3929 2c0a 2020  i(2 * 10**9),.  
-00006370: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00006380: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00006390: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-000063a0: 496e 7661 6c69 6454 7261 6e73 6163 7469  InvalidTransacti
-000063b0: 6f6e 2c20 6d61 7463 683d 226d 6178 4665  on, match="maxFe
-000063c0: 6550 6572 4761 7320 6d75 7374 2062 6520  ePerGas must be 
-000063d0: 3e3d 206d 6178 5072 696f 7269 7479 4665  >= maxPriorityFe
-000063e0: 6550 6572 4761 7322 0a20 2020 2020 2020  ePerGas".       
-000063f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00006400: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00006410: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-00006420: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-00006430: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00006440: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-00006450: 796e 6320 6465 6620 7465 7374 5f76 616c  ync def test_val
-00006460: 6964 6174 696f 6e5f 6d69 6464 6c65 7761  idation_middlewa
-00006470: 7265 5f63 6861 696e 5f69 645f 6d69 736d  re_chain_id_mism
-00006480: 6174 6368 280a 2020 2020 2020 2020 7365  atch(.        se
-00006490: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-000064a0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000064b0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-000064c0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-000064d0: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-000064e0: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-000064f0: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
-00006500: 6e65 3a0a 2020 2020 2020 2020 7772 6f6e  ne:.        wron
-00006510: 675f 6368 6169 6e5f 6964 203d 2031 3233  g_chain_id = 123
-00006520: 3435 3637 3839 300a 2020 2020 2020 2020  4567890.        
-00006530: 6163 7475 616c 5f63 6861 696e 5f69 6420  actual_chain_id 
-00006540: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00006550: 2e65 7468 2e63 6861 696e 5f69 640a 0a20  .eth.chain_id.. 
-00006560: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00006570: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00006580: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00006590: 6d22 3a20 6173 796e 635f 6b65 7966 696c  m": async_keyfil
-000065a0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-000065b0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-000065c0: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
-000065d0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-000065e0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-000065f0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00006600: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-00006610: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-00006620: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-00006630: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
-00006640: 6565 5065 7247 6173 223a 2061 7379 6e63  eePerGas": async
-00006650: 5f77 332e 746f 5f77 6569 2832 2c20 2267  _w3.to_wei(2, "g
-00006660: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-00006670: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
-00006680: 6565 5065 7247 6173 223a 2061 7379 6e63  eePerGas": async
-00006690: 5f77 332e 746f 5f77 6569 2831 2c20 2267  _w3.to_wei(1, "g
-000066a0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-000066b0: 2020 2022 6368 6169 6e49 6422 3a20 7772     "chainId": wr
-000066c0: 6f6e 675f 6368 6169 6e5f 6964 2c0a 2020  ong_chain_id,.  
-000066d0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000066e0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-000066f0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00006700: 5765 6233 5661 6c69 6461 7469 6f6e 4572  Web3ValidationEr
-00006710: 726f 722c 0a20 2020 2020 2020 2020 2020  ror,.           
-00006720: 206d 6174 6368 3d66 2254 6865 2074 7261   match=f"The tra
-00006730: 6e73 6163 7469 6f6e 2064 6563 6c61 7265  nsaction declare
-00006740: 6420 6368 6169 6e20 4944 207b 7772 6f6e  d chain ID {wron
-00006750: 675f 6368 6169 6e5f 6964 7d2c 2022 0a20  g_chain_id}, ". 
-00006760: 2020 2020 2020 2020 2020 2066 2262 7574             f"but
-00006770: 2074 6865 2063 6f6e 6e65 6374 6564 206e   the connected n
-00006780: 6f64 6520 6973 206f 6e20 7b61 6374 7561  ode is on {actua
-00006790: 6c5f 6368 6169 6e5f 6964 7d22 2c0a 2020  l_chain_id}",.  
-000067a0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-000067b0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-000067c0: 5f77 332e 6574 682e 7365 6e64 5f74 7261  _w3.eth.send_tra
-000067d0: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
-000067e0: 616d 7329 0a0a 2020 2020 4070 7974 6573  ams)..    @pytes
-000067f0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00006800: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00006810: 745f 4578 7472 6144 6174 6154 6f50 4f41  t_ExtraDataToPOA
-00006820: 4d69 6464 6c65 7761 7265 280a 2020 2020  Middleware(.    
-00006830: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-00006840: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-00006850: 2072 6571 7565 7374 5f6d 6f63 6b65 723a   request_mocker:
-00006860: 2054 7970 655b 5265 7175 6573 744d 6f63   Type[RequestMoc
-00006870: 6b65 725d 0a20 2020 2029 202d 3e20 4e6f  ker].    ) -> No
-00006880: 6e65 3a0a 2020 2020 2020 2020 6173 796e  ne:.        asyn
-00006890: 635f 7733 2e6d 6964 646c 6577 6172 655f  c_w3.middleware_
-000068a0: 6f6e 696f 6e2e 696e 6a65 6374 2845 7874  onion.inject(Ext
-000068b0: 7261 4461 7461 546f 504f 414d 6964 646c  raDataToPOAMiddl
-000068c0: 6577 6172 652c 2022 706f 6122 2c20 6c61  eware, "poa", la
-000068d0: 7965 723d 3029 0a20 2020 2020 2020 2065  yer=0).        e
-000068e0: 7874 7261 5f64 6174 6120 3d20 6622 3078  xtra_data = f"0x
-000068f0: 7b27 6666 2720 2a20 3333 7d22 0a0a 2020  {'ff' * 33}"..  
-00006900: 2020 2020 2020 6173 796e 6320 7769 7468        async with
-00006910: 2072 6571 7565 7374 5f6d 6f63 6b65 7228   request_mocker(
-00006920: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
-00006930: 6e63 5f77 332c 0a20 2020 2020 2020 2020  nc_w3,.         
-00006940: 2020 206d 6f63 6b5f 7265 7375 6c74 733d     mock_results=
-00006950: 7b22 6574 685f 6765 7442 6c6f 636b 4279  {"eth_getBlockBy
-00006960: 4e75 6d62 6572 223a 207b 2265 7874 7261  Number": {"extra
-00006970: 4461 7461 223a 2065 7874 7261 5f64 6174  Data": extra_dat
-00006980: 617d 7d2c 0a20 2020 2020 2020 2029 3a0a  a}},.        ):.
-00006990: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-000069a0: 6b20 3d20 6177 6169 7420 6173 796e 635f  k = await async_
-000069b0: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-000069c0: 2822 6c61 7465 7374 2229 0a0a 2020 2020  ("latest")..    
-000069d0: 2020 2020 6173 7365 7274 2022 6578 7472      assert "extr
-000069e0: 6144 6174 6122 206e 6f74 2069 6e20 626c  aData" not in bl
-000069f0: 6f63 6b0a 2020 2020 2020 2020 6173 7365  ock.        asse
-00006a00: 7274 2062 6c6f 636b 5b22 7072 6f6f 664f  rt block["proofO
-00006a10: 6641 7574 686f 7269 7479 4461 7461 225d  fAuthorityData"]
-00006a20: 203d 3d20 746f 5f62 7974 6573 2868 6578   == to_bytes(hex
-00006a30: 7374 723d 6578 7472 615f 6461 7461 290a  str=extra_data).
-00006a40: 0a20 2020 2020 2020 2023 2063 6c65 616e  .        # clean
-00006a50: 2075 700a 2020 2020 2020 2020 6173 796e   up.        asyn
-00006a60: 635f 7733 2e6d 6964 646c 6577 6172 655f  c_w3.middleware_
-00006a70: 6f6e 696f 6e2e 7265 6d6f 7665 2822 706f  onion.remove("po
-00006a80: 6122 290a 0a20 2020 2040 7079 7465 7374  a")..    @pytest
-00006a90: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00006aa0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00006ab0: 5f61 7379 6e63 5f65 7468 5f73 656e 645f  _async_eth_send_
-00006ac0: 7261 775f 7472 616e 7361 6374 696f 6e28  raw_transaction(
-00006ad0: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00006ae0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00006af0: 6562 3322 2c20 6b65 7966 696c 655f 6163  eb3", keyfile_ac
-00006b00: 636f 756e 745f 706b 6579 3a20 4865 7853  count_pkey: HexS
-00006b10: 7472 0a20 2020 2029 202d 3e20 4e6f 6e65  tr.    ) -> None
-00006b20: 3a0a 2020 2020 2020 2020 6b65 7966 696c  :.        keyfil
-00006b30: 655f 6163 636f 756e 7420 3d20 6173 796e  e_account = asyn
-00006b40: 635f 7733 2e65 7468 2e61 6363 6f75 6e74  c_w3.eth.account
-00006b50: 2e66 726f 6d5f 6b65 7928 6b65 7966 696c  .from_key(keyfil
-00006b60: 655f 6163 636f 756e 745f 706b 6579 290a  e_account_pkey).
-00006b70: 2020 2020 2020 2020 7478 6e20 3d20 7b0a          txn = {.
-00006b80: 2020 2020 2020 2020 2020 2020 2263 6861              "cha
-00006b90: 696e 4964 223a 2031 3331 3237 3733 3232  inId": 131277322
-00006ba0: 3934 3035 3337 2c20 2023 2074 6865 2063  940537,  # the c
-00006bb0: 6861 696e 4964 2073 6574 2066 6f72 2074  hainId set for t
-00006bc0: 6865 2066 6978 7475 7265 0a20 2020 2020  he fixture.     
-00006bd0: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
-00006be0: 6579 6669 6c65 5f61 6363 6f75 6e74 2e61  eyfile_account.a
-00006bf0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00006c00: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
-00006c10: 655f 6163 636f 756e 742e 6164 6472 6573  e_account.addres
-00006c20: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-00006c30: 7661 6c75 6522 3a20 5765 6928 3029 2c0a  value": Wei(0),.
-00006c40: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-00006c50: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-00006c60: 2020 2020 2020 226e 6f6e 6365 223a 2061        "nonce": a
-00006c70: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00006c80: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00006c90: 6e5f 636f 756e 7428 0a20 2020 2020 2020  n_count(.       
-00006ca0: 2020 2020 2020 2020 206b 6579 6669 6c65           keyfile
-00006cb0: 5f61 6363 6f75 6e74 2e61 6464 7265 7373  _account.address
-00006cc0: 2c20 2270 656e 6469 6e67 220a 2020 2020  , "pending".    
-00006cd0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00006ce0: 2020 2020 2020 2022 6761 7350 7269 6365         "gasPrice
-00006cf0: 223a 2031 302a 2a39 2c0a 2020 2020 2020  ": 10**9,.      
-00006d00: 2020 7d0a 2020 2020 2020 2020 7369 676e    }.        sign
-00006d10: 6564 203d 206b 6579 6669 6c65 5f61 6363  ed = keyfile_acc
-00006d20: 6f75 6e74 2e73 6967 6e5f 7472 616e 7361  ount.sign_transa
-00006d30: 6374 696f 6e28 7478 6e29 0a20 2020 2020  ction(txn).     
-00006d40: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-00006d50: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00006d60: 2e73 656e 645f 7261 775f 7472 616e 7361  .send_raw_transa
-00006d70: 6374 696f 6e28 7369 676e 6564 2e72 6177  ction(signed.raw
-00006d80: 5472 616e 7361 6374 696f 6e29 0a20 2020  Transaction).   
-00006d90: 2020 2020 2061 7373 6572 7420 7478 6e5f       assert txn_
-00006da0: 6861 7368 203d 3d20 4865 7842 7974 6573  hash == HexBytes
-00006db0: 2873 6967 6e65 642e 6861 7368 290a 0a20  (signed.hash).. 
-00006dc0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00006dd0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00006de0: 6320 6465 6620 7465 7374 5f47 6173 5072  c def test_GasPr
-00006df0: 6963 6553 7472 6174 6567 794d 6964 646c  iceStrategyMiddl
-00006e00: 6577 6172 6528 0a20 2020 2020 2020 2073  eware(.        s
-00006e10: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-00006e20: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00006e30: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-00006e40: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00006e50: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00006e60: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00006e70: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-00006e80: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00006e90: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00006ea0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00006eb0: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00006ec0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00006ed0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00006ee0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00006ef0: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
-00006f00: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00006f10: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00006f20: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00006f30: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00006f40: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-00006f50: 3030 302c 0a20 2020 2020 2020 207d 0a20  000,.        }. 
-00006f60: 2020 2020 2020 2074 776f 5f67 7765 695f         two_gwei_
-00006f70: 696e 5f77 6569 203d 2061 7379 6e63 5f77  in_wei = async_w
-00006f80: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-00006f90: 6922 290a 0a20 2020 2020 2020 2064 6566  i")..        def
-00006fa0: 2067 6173 5f70 7269 6365 5f73 7472 6174   gas_price_strat
-00006fb0: 6567 7928 7733 3a20 2257 6562 3322 2c20  egy(w3: "Web3", 
-00006fc0: 7478 6e3a 2054 7850 6172 616d 7329 202d  txn: TxParams) -
-00006fd0: 3e20 5765 693a 0a20 2020 2020 2020 2020  > Wei:.         
-00006fe0: 2020 2072 6574 7572 6e20 7477 6f5f 6777     return two_gw
-00006ff0: 6569 5f69 6e5f 7765 690a 0a20 2020 2020  ei_in_wei..     
-00007000: 2020 2061 7379 6e63 5f77 332e 6574 682e     async_w3.eth.
-00007010: 7365 745f 6761 735f 7072 6963 655f 7374  set_gas_price_st
-00007020: 7261 7465 6779 2867 6173 5f70 7269 6365  rategy(gas_price
-00007030: 5f73 7472 6174 6567 7929 0a0a 2020 2020  _strategy)..    
-00007040: 2020 2020 7478 6e5f 6861 7368 203d 2061      txn_hash = a
-00007050: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00007060: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-00007070: 6f6e 2874 786e 5f70 6172 616d 7329 0a20  on(txn_params). 
-00007080: 2020 2020 2020 2074 786e 203d 2061 7761         txn = awa
-00007090: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-000070a0: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
-000070b0: 7478 6e5f 6861 7368 290a 0a20 2020 2020  txn_hash)..     
-000070c0: 2020 2061 7373 6572 7420 7478 6e5b 2267     assert txn["g
-000070d0: 6173 5072 6963 6522 5d20 3d3d 2074 776f  asPrice"] == two
-000070e0: 5f67 7765 695f 696e 5f77 6569 0a20 2020  _gwei_in_wei.   
-000070f0: 2020 2020 2061 7379 6e63 5f77 332e 6574       async_w3.et
-00007100: 682e 7365 745f 6761 735f 7072 6963 655f  h.set_gas_price_
-00007110: 7374 7261 7465 6779 284e 6f6e 6529 2020  strategy(None)  
-00007120: 2320 7265 7365 7420 7374 7261 7465 6779  # reset strategy
-00007130: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00007140: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00007150: 7379 6e63 2064 6566 2074 6573 745f 6761  sync def test_ga
-00007160: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
-00007170: 5f6d 6964 646c 6577 6172 655f 6865 785f  _middleware_hex_
-00007180: 7661 6c75 6528 0a20 2020 2020 2020 2073  value(.        s
-00007190: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-000071a0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-000071b0: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-000071c0: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-000071d0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-000071e0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-000071f0: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-00007200: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00007210: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00007220: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00007230: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00007240: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00007250: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00007260: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00007270: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
-00007280: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00007290: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-000072a0: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-000072b0: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-000072c0: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-000072d0: 3030 302c 0a20 2020 2020 2020 207d 0a20  000,.        }. 
-000072e0: 2020 2020 2020 2074 776f 5f67 7765 695f         two_gwei_
-000072f0: 696e 5f77 6569 203d 2061 7379 6e63 5f77  in_wei = async_w
-00007300: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-00007310: 6922 290a 0a20 2020 2020 2020 2064 6566  i")..        def
-00007320: 2067 6173 5f70 7269 6365 5f73 7472 6174   gas_price_strat
-00007330: 6567 7928 5f77 333a 2022 5765 6233 222c  egy(_w3: "Web3",
-00007340: 205f 7478 6e3a 2054 7850 6172 616d 7329   _txn: TxParams)
-00007350: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
-00007360: 2020 2020 2072 6574 7572 6e20 6865 7828       return hex(
-00007370: 7477 6f5f 6777 6569 5f69 6e5f 7765 6929  two_gwei_in_wei)
-00007380: 0a0a 2020 2020 2020 2020 6173 796e 635f  ..        async_
-00007390: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
-000073a0: 7269 6365 5f73 7472 6174 6567 7928 6761  rice_strategy(ga
-000073b0: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
-000073c0: 2920 2023 2074 7970 653a 2069 676e 6f72  )  # type: ignor
-000073d0: 650a 0a20 2020 2020 2020 2074 786e 5f68  e..        txn_h
-000073e0: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
-000073f0: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
-00007400: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00007410: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
-00007420: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
-00007430: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-00007440: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
-00007450: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00007460: 2074 786e 5b22 6761 7350 7269 6365 225d   txn["gasPrice"]
-00007470: 203d 3d20 7477 6f5f 6777 6569 5f69 6e5f   == two_gwei_in_
-00007480: 7765 690a 2020 2020 2020 2020 6173 796e  wei.        asyn
-00007490: 635f 7733 2e65 7468 2e73 6574 5f67 6173  c_w3.eth.set_gas
-000074a0: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-000074b0: 4e6f 6e65 2920 2023 2072 6573 6574 2073  None)  # reset s
-000074c0: 7472 6174 6567 790a 0a20 2020 2040 7079  trategy..    @py
-000074d0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-000074e0: 6f0a 2020 2020 4070 7974 6573 742e 6d61  o.    @pytest.ma
-000074f0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-00007500: 2020 2020 2020 2020 226d 6178 5f66 6565          "max_fee
-00007510: 222c 2028 3130 3030 3030 3030 3030 2c20  ", (1000000000, 
-00007520: 4e6f 6e65 292c 2069 6473 3d5b 2277 6974  None), ids=["wit
-00007530: 685f 6d61 785f 6665 6522 2c20 2277 6974  h_max_fee", "wit
-00007540: 686f 7574 5f6d 6178 5f66 6565 225d 0a20  hout_max_fee"]. 
-00007550: 2020 2029 0a20 2020 2061 7379 6e63 2064     ).    async d
-00007560: 6566 2074 6573 745f 6761 735f 7072 6963  ef test_gas_pric
-00007570: 655f 6672 6f6d 5f73 7472 6174 6567 795f  e_from_strategy_
-00007580: 6279 7061 7373 6564 5f66 6f72 5f64 796e  bypassed_for_dyn
-00007590: 616d 6963 5f66 6565 5f74 786e 280a 2020  amic_fee_txn(.  
-000075a0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000075b0: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
-000075c0: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
-000075d0: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
-000075e0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-000075f0: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-00007600: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-00007610: 2020 2020 206d 6178 5f66 6565 3a20 5765       max_fee: We
-00007620: 692c 0a20 2020 2029 202d 3e20 4e6f 6e65  i,.    ) -> None
-00007630: 3a0a 2020 2020 2020 2020 6d61 785f 7072  :.        max_pr
-00007640: 696f 7269 7479 5f66 6565 203d 2061 7379  iority_fee = asy
-00007650: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-00007660: 2267 7765 6922 290a 2020 2020 2020 2020  "gwei").        
-00007670: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-00007680: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-00007690: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
-000076a0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-000076b0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-000076c0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-000076d0: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
-000076e0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-000076f0: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00007700: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00007710: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00007720: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-00007730: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00007740: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-00007750: 4665 6550 6572 4761 7322 3a20 6d61 785f  FeePerGas": max_
-00007760: 7072 696f 7269 7479 5f66 6565 2c0a 2020  priority_fee,.  
-00007770: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00007780: 6966 206d 6178 5f66 6565 2069 7320 6e6f  if max_fee is no
-00007790: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000077a0: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
-000077b0: 2061 7373 6f63 2874 786e 5f70 6172 616d   assoc(txn_param
-000077c0: 732c 2022 6d61 7846 6565 5065 7247 6173  s, "maxFeePerGas
-000077d0: 222c 206d 6178 5f66 6565 290a 0a20 2020  ", max_fee)..   
-000077e0: 2020 2020 2064 6566 2067 6173 5f70 7269       def gas_pri
-000077f0: 6365 5f73 7472 6174 6567 7928 7733 3a20  ce_strategy(w3: 
-00007800: 2257 6562 3322 2c20 7478 6e3a 2054 7850  "Web3", txn: TxP
-00007810: 6172 616d 7329 202d 3e20 5765 693a 0a20  arams) -> Wei:. 
-00007820: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00007830: 6e20 6173 796e 635f 7733 2e74 6f5f 7765  n async_w3.to_we
-00007840: 6928 322c 2022 6777 6569 2229 0a0a 2020  i(2, "gwei")..  
-00007850: 2020 2020 2020 6173 796e 635f 7733 2e65        async_w3.e
-00007860: 7468 2e73 6574 5f67 6173 5f70 7269 6365  th.set_gas_price
-00007870: 5f73 7472 6174 6567 7928 6761 735f 7072  _strategy(gas_pr
-00007880: 6963 655f 7374 7261 7465 6779 290a 0a20  ice_strategy).. 
-00007890: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-000078a0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-000078b0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-000078c0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-000078d0: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
-000078e0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-000078f0: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
-00007900: 6f6e 2874 786e 5f68 6173 6829 0a0a 2020  on(txn_hash)..  
-00007910: 2020 2020 2020 6c61 7465 7374 5f62 6c6f        latest_blo
-00007920: 636b 203d 2061 7761 6974 2061 7379 6e63  ck = await async
-00007930: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
-00007940: 6b28 226c 6174 6573 7422 290a 2020 2020  k("latest").    
-00007950: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
-00007960: 2020 2020 2020 2020 2074 786e 5b22 6d61           txn["ma
-00007970: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
-00007980: 6d61 785f 6665 650a 2020 2020 2020 2020  max_fee.        
-00007990: 2020 2020 6966 206d 6178 5f66 6565 2069      if max_fee i
-000079a0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-000079b0: 2020 2020 2020 2065 6c73 6520 3220 2a20         else 2 * 
-000079c0: 6c61 7465 7374 5f62 6c6f 636b 5b22 6261  latest_block["ba
-000079d0: 7365 4665 6550 6572 4761 7322 5d20 2b20  seFeePerGas"] + 
-000079e0: 6d61 785f 7072 696f 7269 7479 5f66 6565  max_priority_fee
-000079f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00007a00: 2020 2061 7373 6572 7420 7478 6e5b 226d     assert txn["m
-00007a10: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-00007a20: 4761 7322 5d20 3d3d 206d 6178 5f70 7269  Gas"] == max_pri
-00007a30: 6f72 6974 795f 6665 650a 2020 2020 2020  ority_fee.      
-00007a40: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
-00007a50: 7350 7269 6365 225d 203d 3d20 7478 6e5b  sPrice"] == txn[
-00007a60: 226d 6178 4665 6550 6572 4761 7322 5d0a  "maxFeePerGas"].
-00007a70: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00007a80: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
-00007a90: 6963 655f 7374 7261 7465 6779 284e 6f6e  ice_strategy(Non
-00007aa0: 6529 2020 2320 7265 7365 7420 7374 7261  e)  # reset stra
-00007ab0: 7465 6779 0a0a 2020 2020 4070 7974 6573  tegy..    @pytes
-00007ac0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00007ad0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00007ae0: 745f 6761 735f 7072 6963 655f 6672 6f6d  t_gas_price_from
-00007af0: 5f73 7472 6174 6567 795f 6279 7061 7373  _strategy_bypass
-00007b00: 6564 5f66 6f72 5f64 796e 616d 6963 5f66  ed_for_dynamic_f
-00007b10: 6565 5f74 786e 5f6e 6f5f 7469 7028 0a20  ee_txn_no_tip(. 
-00007b20: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00007b30: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-00007b40: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-00007b50: 2020 2020 6173 796e 635f 6b65 7966 696c      async_keyfil
-00007b60: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00007b70: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
-00007b80: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-00007b90: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00007ba0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00007bb0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00007bc0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00007bd0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-00007be0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00007bf0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00007c00: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00007c10: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00007c20: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00007c30: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00007c40: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00007c50: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00007c60: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00007c70: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00007c80: 5065 7247 6173 223a 2057 6569 2831 3030  PerGas": Wei(100
-00007c90: 3030 3030 3030 3029 2c0a 2020 2020 2020  0000000),.      
-00007ca0: 2020 7d0a 0a20 2020 2020 2020 2064 6566    }..        def
-00007cb0: 2067 6173 5f70 7269 6365 5f73 7472 6174   gas_price_strat
-00007cc0: 6567 7928 5f77 333a 2022 5765 6233 222c  egy(_w3: "Web3",
-00007cd0: 205f 7478 6e3a 2054 7850 6172 616d 7329   _txn: TxParams)
-00007ce0: 202d 3e20 5765 693a 0a20 2020 2020 2020   -> Wei:.       
-00007cf0: 2020 2020 2072 6574 7572 6e20 6173 796e       return asyn
-00007d00: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
-00007d10: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
-00007d20: 6173 796e 635f 7733 2e65 7468 2e73 6574  async_w3.eth.set
-00007d30: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-00007d40: 6567 7928 6761 735f 7072 6963 655f 7374  egy(gas_price_st
-00007d50: 7261 7465 6779 290a 0a20 2020 2020 2020  rategy)..       
-00007d60: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00007d70: 7365 7328 0a20 2020 2020 2020 2020 2020  ses(.           
-00007d80: 2049 6e76 616c 6964 5472 616e 7361 6374   InvalidTransact
-00007d90: 696f 6e2c 206d 6174 6368 3d22 6d61 7850  ion, match="maxP
-00007da0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-00007db0: 206d 7573 7420 6265 2064 6566 696e 6564   must be defined
-00007dc0: 220a 2020 2020 2020 2020 293a 0a20 2020  ".        ):.   
-00007dd0: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-00007de0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
-00007df0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-00007e00: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-00007e10: 2020 6173 796e 635f 7733 2e65 7468 2e73    async_w3.eth.s
-00007e20: 6574 5f67 6173 5f70 7269 6365 5f73 7472  et_gas_price_str
-00007e30: 6174 6567 7928 4e6f 6e65 2920 2023 2072  ategy(None)  # r
-00007e40: 6573 6574 2073 7472 6174 6567 790a 0a20  eset strategy.. 
-00007e50: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00007e60: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00007e70: 6320 6465 6620 7465 7374 5f65 7468 5f65  c def test_eth_e
-00007e80: 7374 696d 6174 655f 6761 7328 0a20 2020  stimate_gas(.   
-00007e90: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00007ea0: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-00007eb0: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-00007ec0: 2020 6173 796e 635f 6b65 7966 696c 655f    async_keyfile_
-00007ed0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00007ee0: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-00007ef0: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-00007f00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00007f10: 2020 2067 6173 5f65 7374 696d 6174 6520     gas_estimate 
-00007f20: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00007f30: 2e65 7468 2e65 7374 696d 6174 655f 6761  .eth.estimate_ga
-00007f40: 7328 0a20 2020 2020 2020 2020 2020 207b  s(.            {
-00007f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007f60: 2022 6672 6f6d 223a 2061 7379 6e63 5f6b   "from": async_k
-00007f70: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00007f80: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00007f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007fa0: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
-00007fb0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00007fc0: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00007fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007fe0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-00007ff0: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
-00008000: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00008010: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-00008020: 6765 7228 6761 735f 6573 7469 6d61 7465  ger(gas_estimate
-00008030: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00008040: 2067 6173 5f65 7374 696d 6174 6520 3e20   gas_estimate > 
-00008050: 300a 0a20 2020 2040 7079 7465 7374 2e6d  0..    @pytest.m
-00008060: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00008070: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-00008080: 616d 6574 7269 7a65 280a 2020 2020 2020  ametrize(.      
-00008090: 2020 2270 6172 616d 7322 2c0a 2020 2020    "params",.    
-000080a0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-000080b0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-000080c0: 2020 2020 226e 6f6e 6365 223a 2031 2c20      "nonce": 1, 
-000080d0: 2023 2069 6e74 0a20 2020 2020 2020 2020   # int.         
-000080e0: 2020 2020 2020 2022 6261 6c61 6e63 6522         "balance"
-000080f0: 3a20 312c 2020 2320 696e 740a 2020 2020  : 1,  # int.    
-00008100: 2020 2020 2020 2020 2020 2020 2263 6f64              "cod
-00008110: 6522 3a20 4865 7853 7472 2822 3078 2229  e": HexStr("0x")
-00008120: 2c20 2023 2048 6578 5374 720a 2020 2020  ,  # HexStr.    
-00008130: 2020 2020 2020 2020 2020 2020 2320 7769              # wi
-00008140: 7468 2073 7461 7465 0a20 2020 2020 2020  th state.       
-00008150: 2020 2020 2020 2020 2022 7374 6174 6522           "state"
-00008160: 3a20 7b48 6578 5374 7228 6622 3078 7b27  : {HexStr(f"0x{'
-00008170: 3030 2720 2a20 3332 7d22 293a 2048 6578  00' * 32}"): Hex
-00008180: 5374 7228 6622 3078 7b27 3030 2720 2a20  Str(f"0x{'00' * 
-00008190: 3332 7d22 297d 2c0a 2020 2020 2020 2020  32}")},.        
-000081a0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-000081b0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-000081c0: 2020 2020 2022 6e6f 6e63 6522 3a20 4865       "nonce": He
-000081d0: 7853 7472 2822 3078 3122 292c 2020 2320  xStr("0x1"),  # 
-000081e0: 4865 7853 7472 0a20 2020 2020 2020 2020  HexStr.         
-000081f0: 2020 2020 2020 2022 6261 6c61 6e63 6522         "balance"
-00008200: 3a20 4865 7853 7472 2822 3078 3122 292c  : HexStr("0x1"),
-00008210: 2020 2320 4865 7853 7472 0a20 2020 2020    # HexStr.     
-00008220: 2020 2020 2020 2020 2020 2022 636f 6465             "code
-00008230: 223a 2062 225c 7830 3022 2c20 2023 2062  ": b"\x00",  # b
-00008240: 7974 6573 0a20 2020 2020 2020 2020 2020  ytes.           
-00008250: 2020 2020 2023 2077 6974 6820 7374 6174       # with stat
-00008260: 6544 6966 660a 2020 2020 2020 2020 2020  eDiff.          
-00008270: 2020 2020 2020 2273 7461 7465 4469 6666        "stateDiff
-00008280: 223a 207b 4865 7853 7472 2866 2230 787b  ": {HexStr(f"0x{
-00008290: 2730 3027 202a 2033 327d 2229 3a20 4865  '00' * 32}"): He
-000082a0: 7853 7472 2866 2230 787b 2730 3027 202a  xStr(f"0x{'00' *
-000082b0: 2033 327d 2229 7d2c 0a20 2020 2020 2020   32}")},.       
-000082c0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-000082d0: 292c 0a20 2020 2029 0a20 2020 2061 7379  ),.    ).    asy
-000082e0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-000082f0: 6573 7469 6d61 7465 5f67 6173 5f77 6974  estimate_gas_wit
-00008300: 685f 6f76 6572 7269 6465 5f70 6172 616d  h_override_param
-00008310: 5f74 7970 655f 6368 6563 6b28 0a20 2020  _type_check(.   
-00008320: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00008330: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-00008340: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-00008350: 2020 6173 796e 635f 6d61 7468 5f63 6f6e    async_math_con
-00008360: 7472 6163 743a 2022 4173 796e 6343 6f6e  tract: "AsyncCon
-00008370: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
-00008380: 7061 7261 6d73 3a20 5374 6174 654f 7665  params: StateOve
-00008390: 7272 6964 6550 6172 616d 732c 0a20 2020  rrideParams,.   
-000083a0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000083b0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-000083c0: 5478 5061 7261 6d73 203d 207b 2266 726f  TxParams = {"fro
-000083d0: 6d22 3a20 6177 6169 7420 6173 796e 635f  m": await async_
-000083e0: 7733 2e65 7468 2e63 6f69 6e62 6173 657d  w3.eth.coinbase}
-000083f0: 0a0a 2020 2020 2020 2020 2320 6173 7365  ..        # asse
-00008400: 7274 2064 6f65 7320 6e6f 7420 7261 6973  rt does not rais
-00008410: 650a 2020 2020 2020 2020 6177 6169 7420  e.        await 
-00008420: 6173 796e 635f 7733 2e65 7468 2e65 7374  async_w3.eth.est
-00008430: 696d 6174 655f 6761 7328 0a20 2020 2020  imate_gas(.     
-00008440: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00008450: 732c 204e 6f6e 652c 207b 6173 796e 635f  s, None, {async_
-00008460: 6d61 7468 5f63 6f6e 7472 6163 742e 6164  math_contract.ad
-00008470: 6472 6573 733a 2070 6172 616d 737d 0a20  dress: params}. 
-00008480: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-00008490: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-000084a0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-000084b0: 2074 6573 745f 6574 685f 6665 655f 6869   test_eth_fee_hi
-000084c0: 7374 6f72 7928 7365 6c66 2c20 6173 796e  story(self, asyn
-000084d0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000084e0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-000084f0: 2020 2020 6665 655f 6869 7374 6f72 7920      fee_history 
-00008500: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00008510: 2e65 7468 2e66 6565 5f68 6973 746f 7279  .eth.fee_history
-00008520: 2831 2c20 226c 6174 6573 7422 2c20 5b35  (1, "latest", [5
-00008530: 305d 290a 2020 2020 2020 2020 6173 7365  0]).        asse
-00008540: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00008550: 6665 655f 6869 7374 6f72 795b 2262 6173  fee_history["bas
-00008560: 6546 6565 5065 7247 6173 225d 290a 2020  eFeePerGas"]).  
-00008570: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00008580: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
-00008590: 7374 6f72 795b 2267 6173 5573 6564 5261  story["gasUsedRa
-000085a0: 7469 6f22 5d29 0a20 2020 2020 2020 2061  tio"]).        a
-000085b0: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-000085c0: 2866 6565 5f68 6973 746f 7279 5b22 6f6c  (fee_history["ol
-000085d0: 6465 7374 426c 6f63 6b22 5d29 0a20 2020  destBlock"]).   
-000085e0: 2020 2020 2061 7373 6572 7420 6665 655f       assert fee_
-000085f0: 6869 7374 6f72 795b 226f 6c64 6573 7442  history["oldestB
-00008600: 6c6f 636b 225d 203e 3d20 300a 2020 2020  lock"] >= 0.    
-00008610: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
-00008620: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
-00008630: 6f72 795b 2272 6577 6172 6422 5d29 0a20  ory["reward"]). 
-00008640: 2020 2020 2020 2069 6620 6c65 6e28 6665         if len(fe
-00008650: 655f 6869 7374 6f72 795b 2272 6577 6172  e_history["rewar
-00008660: 6422 5d29 203e 2030 3a0a 2020 2020 2020  d"]) > 0:.      
-00008670: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00008680: 6c69 7374 5f6c 696b 6528 6665 655f 6869  list_like(fee_hi
-00008690: 7374 6f72 795b 2272 6577 6172 6422 5d5b  story["reward"][
-000086a0: 305d 290a 0a20 2020 2040 7079 7465 7374  0])..    @pytest
-000086b0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-000086c0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-000086d0: 5f65 7468 5f66 6565 5f68 6973 746f 7279  _eth_fee_history
-000086e0: 5f77 6974 685f 696e 7465 6765 7228 0a20  _with_integer(. 
-000086f0: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
-00008700: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00008710: 3322 2c20 6173 796e 635f 656d 7074 795f  3", async_empty_
-00008720: 626c 6f63 6b3a 2042 6c6f 636b 4461 7461  block: BlockData
-00008730: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00008740: 2020 2020 2020 2020 6665 655f 6869 7374          fee_hist
-00008750: 6f72 7920 3d20 6177 6169 7420 6173 796e  ory = await asyn
-00008760: 635f 7733 2e65 7468 2e66 6565 5f68 6973  c_w3.eth.fee_his
-00008770: 746f 7279 280a 2020 2020 2020 2020 2020  tory(.          
-00008780: 2020 312c 2061 7379 6e63 5f65 6d70 7479    1, async_empty
-00008790: 5f62 6c6f 636b 5b22 6e75 6d62 6572 225d  _block["number"]
-000087a0: 2c20 5b35 305d 0a20 2020 2020 2020 2029  , [50].        )
-000087b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000087c0: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
-000087d0: 5f68 6973 746f 7279 5b22 6261 7365 4665  _history["baseFe
-000087e0: 6550 6572 4761 7322 5d29 0a20 2020 2020  ePerGas"]).     
-000087f0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
-00008800: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
-00008810: 7279 5b22 6761 7355 7365 6452 6174 696f  ry["gasUsedRatio
-00008820: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
-00008830: 7274 2069 735f 696e 7465 6765 7228 6665  rt is_integer(fe
-00008840: 655f 6869 7374 6f72 795b 226f 6c64 6573  e_history["oldes
-00008850: 7442 6c6f 636b 225d 290a 2020 2020 2020  tBlock"]).      
-00008860: 2020 6173 7365 7274 2066 6565 5f68 6973    assert fee_his
-00008870: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
-00008880: 6b22 5d20 3e3d 2030 0a20 2020 2020 2020  k"] >= 0.       
-00008890: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-000088a0: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
-000088b0: 5b22 7265 7761 7264 225d 290a 2020 2020  ["reward"]).    
-000088c0: 2020 2020 6966 206c 656e 2866 6565 5f68      if len(fee_h
-000088d0: 6973 746f 7279 5b22 7265 7761 7264 225d  istory["reward"]
-000088e0: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
-000088f0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
-00008900: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
-00008910: 7279 5b22 7265 7761 7264 225d 5b30 5d29  ry["reward"][0])
-00008920: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00008930: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00008940: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-00008950: 685f 6665 655f 6869 7374 6f72 795f 6e6f  h_fee_history_no
-00008960: 5f72 6577 6172 645f 7065 7263 656e 7469  _reward_percenti
-00008970: 6c65 7328 0a20 2020 2020 2020 2073 656c  les(.        sel
-00008980: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00008990: 796e 6357 6562 3322 0a20 2020 2029 202d  yncWeb3".    ) -
-000089a0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000089b0: 6665 655f 6869 7374 6f72 7920 3d20 6177  fee_history = aw
-000089c0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000089d0: 2e66 6565 5f68 6973 746f 7279 2831 2c20  .fee_history(1, 
-000089e0: 226c 6174 6573 7422 290a 2020 2020 2020  "latest").      
-000089f0: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
-00008a00: 5f6c 696b 6528 6665 655f 6869 7374 6f72  _like(fee_histor
-00008a10: 795b 2262 6173 6546 6565 5065 7247 6173  y["baseFeePerGas
-00008a20: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
-00008a30: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00008a40: 6665 655f 6869 7374 6f72 795b 2267 6173  fee_history["gas
-00008a50: 5573 6564 5261 7469 6f22 5d29 0a20 2020  UsedRatio"]).   
-00008a60: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00008a70: 6e74 6567 6572 2866 6565 5f68 6973 746f  nteger(fee_histo
-00008a80: 7279 5b22 6f6c 6465 7374 426c 6f63 6b22  ry["oldestBlock"
-00008a90: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
-00008aa0: 7420 6665 655f 6869 7374 6f72 795b 226f  t fee_history["o
-00008ab0: 6c64 6573 7442 6c6f 636b 225d 203e 3d20  ldestBlock"] >= 
-00008ac0: 300a 0a20 2020 2040 7079 7465 7374 2e6d  0..    @pytest.m
-00008ad0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00008ae0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00008af0: 7468 5f6d 6178 5f70 7269 6f72 6974 795f  th_max_priority_
-00008b00: 6665 6528 7365 6c66 2c20 6173 796e 635f  fee(self, async_
-00008b10: 7733 3a20 2241 7379 6e63 5765 6233 2229  w3: "AsyncWeb3")
-00008b20: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00008b30: 2020 6d61 785f 7072 696f 7269 7479 5f66    max_priority_f
-00008b40: 6565 203d 2061 7761 6974 2061 7379 6e63  ee = await async
-00008b50: 5f77 332e 6574 682e 6d61 785f 7072 696f  _w3.eth.max_prio
-00008b60: 7269 7479 5f66 6565 0a20 2020 2020 2020  rity_fee.       
-00008b70: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-00008b80: 6572 286d 6178 5f70 7269 6f72 6974 795f  er(max_priority_
-00008b90: 6665 6529 0a0a 2020 2020 4070 7974 6573  fee)..    @pytes
-00008ba0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00008bb0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00008bc0: 745f 6574 685f 6d61 785f 7072 696f 7269  t_eth_max_priori
-00008bd0: 7479 5f66 6565 5f77 6974 685f 6665 655f  ty_fee_with_fee_
-00008be0: 6869 7374 6f72 795f 6361 6c63 756c 6174  history_calculat
-00008bf0: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
-00008c00: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00008c10: 796e 6357 6562 3322 2c20 7265 7175 6573  yncWeb3", reques
-00008c20: 745f 6d6f 636b 6572 3a20 5479 7065 5b52  t_mocker: Type[R
-00008c30: 6571 7565 7374 4d6f 636b 6572 5d0a 2020  equestMocker].  
-00008c40: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00008c50: 2020 2020 2061 7379 6e63 2077 6974 6820       async with 
-00008c60: 7265 7175 6573 745f 6d6f 636b 6572 280a  request_mocker(.
-00008c70: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
-00008c80: 635f 7733 2c0a 2020 2020 2020 2020 2020  c_w3,.          
-00008c90: 2020 6d6f 636b 5f65 7272 6f72 733d 7b52    mock_errors={R
-00008ca0: 5043 456e 6470 6f69 6e74 2822 6574 685f  PCEndpoint("eth_
-00008cb0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00008cc0: 7247 6173 2229 3a20 7b7d 7d2c 0a20 2020  rGas"): {}},.   
-00008cd0: 2020 2020 2020 2020 206d 6f63 6b5f 7265           mock_re
-00008ce0: 7375 6c74 733d 7b52 5043 456e 6470 6f69  sults={RPCEndpoi
-00008cf0: 6e74 2822 6574 685f 6665 6548 6973 746f  nt("eth_feeHisto
-00008d00: 7279 2229 3a20 7b22 7265 7761 7264 223a  ry"): {"reward":
-00008d10: 205b 5b30 5d5d 7d7d 2c0a 2020 2020 2020   [[0]]}},.      
-00008d20: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00008d30: 2077 6974 6820 7079 7465 7374 2e77 6172   with pytest.war
-00008d40: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00008d50: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
-00008d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008d70: 206d 6174 6368 3d28 0a20 2020 2020 2020   match=(.       
-00008d80: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-00008d90: 6572 6520 7761 7320 616e 2069 7373 7565  ere was an issue
-00008da0: 2077 6974 6820 7468 6520 6d65 7468 6f64   with the method
-00008db0: 2065 7468 5f6d 6178 5072 696f 7269 7479   eth_maxPriority
-00008dc0: 4665 6550 6572 4761 732e 2022 0a20 2020  FeePerGas. ".   
-00008dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008de0: 2022 4361 6c63 756c 6174 696e 6720 7573   "Calculating us
-00008df0: 696e 6720 6574 685f 6665 6548 6973 746f  ing eth_feeHisto
-00008e00: 7279 2e22 0a20 2020 2020 2020 2020 2020  ry.".           
-00008e10: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00008e20: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00008e30: 2020 2020 2020 2070 7269 6f72 6974 795f         priority_
-00008e40: 6665 6520 3d20 6177 6169 7420 6173 796e  fee = await asyn
-00008e50: 635f 7733 2e65 7468 2e6d 6178 5f70 7269  c_w3.eth.max_pri
-00008e60: 6f72 6974 795f 6665 650a 2020 2020 2020  ority_fee.      
-00008e70: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00008e80: 2069 735f 696e 7465 6765 7228 7072 696f   is_integer(prio
-00008e90: 7269 7479 5f66 6565 290a 2020 2020 2020  rity_fee).      
-00008ea0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00008eb0: 2070 7269 6f72 6974 795f 6665 6520 3d3d   priority_fee ==
-00008ec0: 2050 5249 4f52 4954 595f 4645 455f 4d49   PRIORITY_FEE_MI
-00008ed0: 4e0a 0a20 2020 2040 7079 7465 7374 2e6d  N..    @pytest.m
-00008ee0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00008ef0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00008f00: 7468 5f67 6574 426c 6f63 6b42 7948 6173  th_getBlockByHas
-00008f10: 6828 0a20 2020 2020 2020 2073 656c 662c  h(.        self,
-00008f20: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00008f30: 6357 6562 3322 2c20 6173 796e 635f 656d  cWeb3", async_em
-00008f40: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00008f50: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00008f60: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00008f70: 6b20 3d20 6177 6169 7420 6173 796e 635f  k = await async_
-00008f80: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-00008f90: 2861 7379 6e63 5f65 6d70 7479 5f62 6c6f  (async_empty_blo
-00008fa0: 636b 5b22 6861 7368 225d 290a 2020 2020  ck["hash"]).    
-00008fb0: 2020 2020 6173 7365 7274 2062 6c6f 636b      assert block
-00008fc0: 5b22 6861 7368 225d 203d 3d20 6173 796e  ["hash"] == asyn
-00008fd0: 635f 656d 7074 795f 626c 6f63 6b5b 2268  c_empty_block["h
-00008fe0: 6173 6822 5d0a 0a20 2020 2040 7079 7465  ash"]..    @pyte
-00008ff0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00009000: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00009010: 7374 5f65 7468 5f67 6574 426c 6f63 6b42  st_eth_getBlockB
-00009020: 7948 6173 685f 6e6f 745f 666f 756e 6428  yHash_not_found(
-00009030: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00009040: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-00009050: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
-00009060: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00009070: 2842 6c6f 636b 4e6f 7446 6f75 6e64 293a  (BlockNotFound):
-00009080: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
-00009090: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-000090a0: 6765 745f 626c 6f63 6b28 554e 4b4e 4f57  get_block(UNKNOW
-000090b0: 4e5f 4841 5348 290a 0a20 2020 2040 7079  N_HASH)..    @py
-000090c0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-000090d0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-000090e0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
-000090f0: 6b42 7948 6173 685f 7065 6e64 696e 6728  kByHash_pending(
-00009100: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00009110: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-00009120: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-00009130: 6f63 6b20 3d20 6177 6169 7420 6173 796e  ock = await asyn
-00009140: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00009150: 636b 2822 7065 6e64 696e 6722 290a 2020  ck("pending").  
-00009160: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
-00009170: 636b 5b22 6861 7368 225d 2069 7320 4e6f  ck["hash"] is No
-00009180: 6e65 0a0a 2020 2020 4070 7974 6573 742e  ne..    @pytest.
-00009190: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-000091a0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-000091b0: 6574 685f 6765 7442 6c6f 636b 4279 4e75  eth_getBlockByNu
-000091c0: 6d62 6572 5f77 6974 685f 696e 7465 6765  mber_with_intege
-000091d0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-000091e0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-000091f0: 6357 6562 3322 2c20 6173 796e 635f 656d  cWeb3", async_em
-00009200: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00009210: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00009220: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00009230: 6b20 3d20 6177 6169 7420 6173 796e 635f  k = await async_
-00009240: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-00009250: 2861 7379 6e63 5f65 6d70 7479 5f62 6c6f  (async_empty_blo
-00009260: 636b 5b22 6e75 6d62 6572 225d 290a 2020  ck["number"]).  
-00009270: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
-00009280: 636b 5b22 6e75 6d62 6572 225d 203d 3d20  ck["number"] == 
-00009290: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
-000092a0: 6b5b 226e 756d 6265 7222 5d0a 0a20 2020  k["number"]..   
-000092b0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-000092c0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-000092d0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-000092e0: 426c 6f63 6b42 794e 756d 6265 725f 6c61  BlockByNumber_la
-000092f0: 7465 7374 280a 2020 2020 2020 2020 7365  test(.        se
-00009300: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
-00009310: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
-00009320: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
-00009330: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
-00009340: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-00009350: 7572 7265 6e74 5f62 6c6f 636b 5f6e 756d  urrent_block_num
-00009360: 6265 7220 3d20 6177 6169 7420 6173 796e  ber = await asyn
-00009370: 635f 7733 2e65 7468 2e62 6c6f 636b 5f6e  c_w3.eth.block_n
-00009380: 756d 6265 720a 2020 2020 2020 2020 626c  umber.        bl
-00009390: 6f63 6b20 3d20 6177 6169 7420 6173 796e  ock = await asyn
-000093a0: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-000093b0: 636b 2822 6c61 7465 7374 2229 0a20 2020  ck("latest").   
-000093c0: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
-000093d0: 6b5b 226e 756d 6265 7222 5d20 3d3d 2063  k["number"] == c
-000093e0: 7572 7265 6e74 5f62 6c6f 636b 5f6e 756d  urrent_block_num
-000093f0: 6265 720a 0a20 2020 2040 7079 7465 7374  ber..    @pytest
-00009400: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00009410: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00009420: 5f65 7468 5f67 6574 426c 6f63 6b42 794e  _eth_getBlockByN
-00009430: 756d 6265 725f 6e6f 745f 666f 756e 6428  umber_not_found(
-00009440: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-00009450: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00009460: 6562 3322 2c20 6173 796e 635f 656d 7074  eb3", async_empt
-00009470: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
-00009480: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
-00009490: 3a0a 2020 2020 2020 2020 7769 7468 2070  :.        with p
-000094a0: 7974 6573 742e 7261 6973 6573 2842 6c6f  ytest.raises(Blo
-000094b0: 636b 4e6f 7446 6f75 6e64 293a 0a20 2020  ckNotFound):.   
-000094c0: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-000094d0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-000094e0: 626c 6f63 6b28 426c 6f63 6b4e 756d 6265  block(BlockNumbe
-000094f0: 7228 3132 3334 3529 290a 0a20 2020 2040  r(12345))..    @
-00009500: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00009510: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00009520: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-00009530: 6f63 6b42 794e 756d 6265 725f 7065 6e64  ockByNumber_pend
-00009540: 696e 6728 0a20 2020 2020 2020 2073 656c  ing(.        sel
-00009550: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00009560: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00009570: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
-00009580: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-00009590: 4e6f 6e65 3a0a 2020 2020 2020 2020 6375  None:.        cu
-000095a0: 7272 656e 745f 626c 6f63 6b5f 6e75 6d62  rrent_block_numb
-000095b0: 6572 203d 2061 7761 6974 2061 7379 6e63  er = await async
-000095c0: 5f77 332e 6574 682e 626c 6f63 6b5f 6e75  _w3.eth.block_nu
-000095d0: 6d62 6572 0a20 2020 2020 2020 2062 6c6f  mber.        blo
-000095e0: 636b 203d 2061 7761 6974 2061 7379 6e63  ck = await async
-000095f0: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
-00009600: 6b28 2270 656e 6469 6e67 2229 0a20 2020  k("pending").   
-00009610: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
-00009620: 6b5b 226e 756d 6265 7222 5d20 3d3d 2063  k["number"] == c
-00009630: 7572 7265 6e74 5f62 6c6f 636b 5f6e 756d  urrent_block_num
-00009640: 6265 7220 2b20 310a 0a20 2020 2040 7079  ber + 1..    @py
-00009650: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00009660: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00009670: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
-00009680: 6b42 794e 756d 6265 725f 6561 726c 6965  kByNumber_earlie
-00009690: 7374 280a 2020 2020 2020 2020 7365 6c66  st(.        self
-000096a0: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-000096b0: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
-000096c0: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
-000096d0: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
-000096e0: 6f6e 653a 0a20 2020 2020 2020 2067 656e  one:.        gen
-000096f0: 6573 6973 5f62 6c6f 636b 203d 2061 7761  esis_block = awa
-00009700: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00009710: 6765 745f 626c 6f63 6b28 426c 6f63 6b4e  get_block(BlockN
-00009720: 756d 6265 7228 3029 290a 2020 2020 2020  umber(0)).      
-00009730: 2020 626c 6f63 6b20 3d20 6177 6169 7420    block = await 
-00009740: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00009750: 5f62 6c6f 636b 2822 6561 726c 6965 7374  _block("earliest
-00009760: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
-00009770: 7420 626c 6f63 6b5b 226e 756d 6265 7222  t block["number"
-00009780: 5d20 3d3d 2030 0a20 2020 2020 2020 2061  ] == 0.        a
-00009790: 7373 6572 7420 626c 6f63 6b5b 2268 6173  ssert block["has
-000097a0: 6822 5d20 3d3d 2067 656e 6573 6973 5f62  h"] == genesis_b
-000097b0: 6c6f 636b 5b22 6861 7368 225d 0a0a 2020  lock["hash"]..  
-000097c0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-000097d0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-000097e0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-000097f0: 7442 6c6f 636b 4279 4e75 6d62 6572 5f73  tBlockByNumber_s
-00009800: 6166 6528 0a20 2020 2020 2020 2073 656c  afe(.        sel
-00009810: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-00009820: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-00009830: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
-00009840: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-00009850: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-00009860: 6f63 6b20 3d20 6177 6169 7420 6173 796e  ock = await asyn
-00009870: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00009880: 636b 2822 7361 6665 2229 0a20 2020 2020  ck("safe").     
-00009890: 2020 2061 7373 6572 7420 626c 6f63 6b20     assert block 
-000098a0: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-000098b0: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
-000098c0: 7461 6e63 6528 626c 6f63 6b5b 226e 756d  tance(block["num
-000098d0: 6265 7222 5d2c 2069 6e74 290a 0a20 2020  ber"], int)..   
-000098e0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-000098f0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-00009900: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00009910: 426c 6f63 6b42 794e 756d 6265 725f 6669  BlockByNumber_fi
-00009920: 6e61 6c69 7a65 6428 0a20 2020 2020 2020  nalized(.       
-00009930: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-00009940: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-00009950: 796e 635f 656d 7074 795f 626c 6f63 6b3a  ync_empty_block:
-00009960: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
-00009970: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00009980: 2020 626c 6f63 6b20 3d20 6177 6169 7420    block = await 
-00009990: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-000099a0: 5f62 6c6f 636b 2822 6669 6e61 6c69 7a65  _block("finalize
-000099b0: 6422 290a 2020 2020 2020 2020 6173 7365  d").        asse
-000099c0: 7274 2062 6c6f 636b 2069 7320 6e6f 7420  rt block is not 
-000099d0: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
-000099e0: 6572 7420 6973 696e 7374 616e 6365 2862  ert isinstance(b
-000099f0: 6c6f 636b 5b22 6e75 6d62 6572 225d 2c20  lock["number"], 
-00009a00: 696e 7429 0a0a 2020 2020 4070 7974 6573  int)..    @pytes
-00009a10: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00009a20: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00009a30: 745f 6574 685f 6765 7442 6c6f 636b 5265  t_eth_getBlockRe
-00009a40: 6365 6970 7473 5f68 6173 6828 0a20 2020  ceipts_hash(.   
-00009a50: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00009a60: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00009a70: 2c20 6173 796e 635f 656d 7074 795f 626c  , async_empty_bl
-00009a80: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
-00009a90: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00009aa0: 2020 2020 2020 7265 6365 6970 7473 203d        receipts =
-00009ab0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00009ac0: 6574 682e 6765 745f 626c 6f63 6b5f 7265  eth.get_block_re
-00009ad0: 6365 6970 7473 2861 7379 6e63 5f65 6d70  ceipts(async_emp
-00009ae0: 7479 5f62 6c6f 636b 5b22 6861 7368 225d  ty_block["hash"]
-00009af0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00009b00: 2069 7369 6e73 7461 6e63 6528 7265 6365   isinstance(rece
-00009b10: 6970 7473 2c20 6c69 7374 290a 0a20 2020  ipts, list)..   
-00009b20: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-00009b30: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-00009b40: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00009b50: 426c 6f63 6b52 6563 6569 7074 735f 6e6f  BlockReceipts_no
-00009b60: 745f 666f 756e 6428 7365 6c66 2c20 6173  t_found(self, as
-00009b70: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-00009b80: 6233 2229 202d 3e20 4e6f 6e65 3a0a 2020  b3") -> None:.  
-00009b90: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00009ba0: 742e 7261 6973 6573 2842 6c6f 636b 4e6f  t.raises(BlockNo
-00009bb0: 7446 6f75 6e64 293a 0a20 2020 2020 2020  tFound):.       
-00009bc0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-00009bd0: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
-00009be0: 6b5f 7265 6365 6970 7473 2855 4e4b 4e4f  k_receipts(UNKNO
-00009bf0: 574e 5f48 4153 4829 0a0a 2020 2020 4070  WN_HASH)..    @p
-00009c00: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00009c10: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-00009c20: 2074 6573 745f 6574 685f 6765 7442 6c6f   test_eth_getBlo
-00009c30: 636b 5265 6365 6970 7473 5f77 6974 685f  ckReceipts_with_
-00009c40: 696e 7465 6765 7228 0a20 2020 2020 2020  integer(.       
-00009c50: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
-00009c60: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
-00009c70: 796e 635f 656d 7074 795f 626c 6f63 6b3a  ync_empty_block:
-00009c80: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
-00009c90: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00009ca0: 2020 7265 6365 6970 7473 203d 2061 7761    receipts = awa
-00009cb0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00009cc0: 6765 745f 626c 6f63 6b5f 7265 6365 6970  get_block_receip
-00009cd0: 7473 2861 7379 6e63 5f65 6d70 7479 5f62  ts(async_empty_b
-00009ce0: 6c6f 636b 5b22 6e75 6d62 6572 225d 290a  lock["number"]).
-00009cf0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00009d00: 7369 6e73 7461 6e63 6528 7265 6365 6970  sinstance(receip
-00009d10: 7473 2c20 6c69 7374 290a 0a20 2020 2040  ts, list)..    @
-00009d20: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00009d30: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00009d40: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-00009d50: 6f63 6b52 6563 6569 7074 735f 7361 6665  ockReceipts_safe
-00009d60: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00009d70: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00009d80: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
-00009d90: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-00009da0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-00009db0: 653a 0a20 2020 2020 2020 2072 6563 6569  e:.        recei
-00009dc0: 7074 7320 3d20 6177 6169 7420 6173 796e  pts = await asyn
-00009dd0: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
-00009de0: 636b 5f72 6563 6569 7074 7328 2273 6166  ck_receipts("saf
-00009df0: 6522 290a 2020 2020 2020 2020 6173 7365  e").        asse
-00009e00: 7274 2069 7369 6e73 7461 6e63 6528 7265  rt isinstance(re
-00009e10: 6365 6970 7473 2c20 6c69 7374 290a 0a20  ceipts, list).. 
-00009e20: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00009e30: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00009e40: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
-00009e50: 6574 426c 6f63 6b52 6563 6569 7074 735f  etBlockReceipts_
-00009e60: 6669 6e61 6c69 7a65 6428 0a20 2020 2020  finalized(.     
-00009e70: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00009e80: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-00009e90: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
-00009ea0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00009eb0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00009ec0: 2020 2020 7265 6365 6970 7473 203d 2061      receipts = a
-00009ed0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00009ee0: 682e 6765 745f 626c 6f63 6b5f 7265 6365  h.get_block_rece
-00009ef0: 6970 7473 2822 6669 6e61 6c69 7a65 6422  ipts("finalized"
-00009f00: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00009f10: 2069 7369 6e73 7461 6e63 6528 7265 6365   isinstance(rece
-00009f20: 6970 7473 2c20 6c69 7374 290a 0a20 2020  ipts, list)..   
-00009f30: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-00009f40: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-00009f50: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00009f60: 5f62 6c6f 636b 5f62 795f 6e75 6d62 6572  _block_by_number
-00009f70: 5f66 756c 6c5f 7472 616e 7361 6374 696f  _full_transactio
-00009f80: 6e73 280a 2020 2020 2020 2020 7365 6c66  ns(.        self
-00009f90: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-00009fa0: 6e63 5765 6233 222c 2061 7379 6e63 5f62  ncWeb3", async_b
-00009fb0: 6c6f 636b 5f77 6974 685f 7478 6e3a 2042  lock_with_txn: B
-00009fc0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-00009fd0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00009fe0: 626c 6f63 6b20 3d20 6177 6169 7420 6173  block = await as
-00009ff0: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
-0000a000: 6c6f 636b 2861 7379 6e63 5f62 6c6f 636b  lock(async_block
-0000a010: 5f77 6974 685f 7478 6e5b 226e 756d 6265  _with_txn["numbe
-0000a020: 7222 5d2c 2054 7275 6529 0a20 2020 2020  r"], True).     
-0000a030: 2020 2074 7261 6e73 6163 7469 6f6e 203d     transaction =
-0000a040: 2063 6173 7428 5478 4461 7461 2c20 626c   cast(TxData, bl
-0000a050: 6f63 6b5b 2274 7261 6e73 6163 7469 6f6e  ock["transaction
-0000a060: 7322 5d5b 305d 290a 2020 2020 2020 2020  s"][0]).        
-0000a070: 6173 7365 7274 2074 7261 6e73 6163 7469  assert transacti
-0000a080: 6f6e 5b22 6861 7368 225d 203d 3d20 6173  on["hash"] == as
-0000a090: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-0000a0a0: 786e 5b22 7472 616e 7361 6374 696f 6e73  xn["transactions
-0000a0b0: 225d 5b30 5d0a 0a20 2020 2040 7079 7465  "][0]..    @pyte
-0000a0c0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-0000a0d0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-0000a0e0: 7374 5f65 7468 5f67 6574 5f72 6177 5f74  st_eth_get_raw_t
-0000a0f0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-0000a100: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-0000a110: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-0000a120: 206d 696e 6564 5f74 786e 5f68 6173 683a   mined_txn_hash:
-0000a130: 2048 6578 5374 720a 2020 2020 2920 2d3e   HexStr.    ) ->
-0000a140: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-0000a150: 6177 5f74 7261 6e73 6163 7469 6f6e 203d  aw_transaction =
-0000a160: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-0000a170: 6574 682e 6765 745f 7261 775f 7472 616e  eth.get_raw_tran
-0000a180: 7361 6374 696f 6e28 6d69 6e65 645f 7478  saction(mined_tx
-0000a190: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
-0000a1a0: 6173 7365 7274 2069 735f 6279 7465 7328  assert is_bytes(
-0000a1b0: 7261 775f 7472 616e 7361 6374 696f 6e29  raw_transaction)
-0000a1c0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-0000a1d0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-0000a1e0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-0000a1f0: 685f 6765 745f 7261 775f 7472 616e 7361  h_get_raw_transa
-0000a200: 6374 696f 6e5f 7261 6973 6573 5f65 7272  ction_raises_err
-0000a210: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
-0000a220: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-0000a230: 6e63 5765 6233 220a 2020 2020 2920 2d3e  ncWeb3".    ) ->
-0000a240: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
-0000a250: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-0000a260: 7328 0a20 2020 2020 2020 2020 2020 2054  s(.            T
-0000a270: 7261 6e73 6163 7469 6f6e 4e6f 7446 6f75  ransactionNotFou
-0000a280: 6e64 2c20 6d61 7463 683d 6622 5472 616e  nd, match=f"Tran
-0000a290: 7361 6374 696f 6e20 7769 7468 2068 6173  saction with has
-0000a2a0: 683a 2027 7b55 4e4b 4e4f 574e 5f48 4153  h: '{UNKNOWN_HAS
-0000a2b0: 487d 2722 0a20 2020 2020 2020 2029 3a0a  H}'".        ):.
-0000a2c0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-0000a2d0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-0000a2e0: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
-0000a2f0: 6f6e 2855 4e4b 4e4f 574e 5f48 4153 4829  on(UNKNOWN_HASH)
-0000a300: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-0000a310: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-0000a320: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-0000a330: 685f 6765 745f 7261 775f 7472 616e 7361  h_get_raw_transa
-0000a340: 6374 696f 6e5f 6279 5f62 6c6f 636b 280a  ction_by_block(.
-0000a350: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000a360: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
-0000a370: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
-0000a380: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
-0000a390: 5f77 6974 685f 7478 6e3a 2042 6c6f 636b  _with_txn: Block
-0000a3a0: 4461 7461 2c0a 2020 2020 2020 2020 6173  Data,.        as
-0000a3b0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-0000a3c0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0000a3d0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-0000a3e0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-0000a3f0: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
-0000a400: 2065 7468 5f67 6574 5261 7754 7261 6e73   eth_getRawTrans
-0000a410: 6163 7469 6f6e 4279 426c 6f63 6b4e 756d  actionByBlockNum
-0000a420: 6265 7241 6e64 496e 6465 783a 2062 6c6f  berAndIndex: blo
-0000a430: 636b 2069 6465 6e74 6966 6965 720a 2020  ck identifier.  
-0000a440: 2020 2020 2020 2320 7365 6e64 2061 2074        # send a t
-0000a450: 786e 2074 6f20 6d61 6b65 2073 7572 6520  xn to make sure 
-0000a460: 7065 6e64 696e 6720 626c 6f63 6b20 6861  pending block ha
-0000a470: 7320 6174 206c 6561 7374 206f 6e65 2074  s at least one t
-0000a480: 786e 0a20 2020 2020 2020 2061 7761 6974  xn.        await
-0000a490: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-0000a4a0: 6e64 5f74 7261 6e73 6163 7469 6f6e 280a  nd_transaction(.
-0000a4b0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0000a4c0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0000a4d0: 726f 6d22 3a20 6173 796e 635f 6b65 7966  rom": async_keyf
-0000a4e0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0000a4f0: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-0000a500: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000a510: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
-0000a520: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0000a530: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-0000a540: 2020 2020 2020 2020 2020 2020 2020 2276                "v
-0000a550: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-0000a560: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0000a570: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
-0000a580: 656e 6469 6e67 5f62 6c6f 636b 203d 2061  ending_block = a
-0000a590: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-0000a5a0: 682e 6765 745f 626c 6f63 6b28 2270 656e  h.get_block("pen
-0000a5b0: 6469 6e67 2229 0a20 2020 2020 2020 206c  ding").        l
-0000a5c0: 6173 745f 7065 6e64 696e 675f 7478 6e5f  ast_pending_txn_
-0000a5d0: 696e 6465 7820 3d20 6c65 6e28 7065 6e64  index = len(pend
-0000a5e0: 696e 675f 626c 6f63 6b5b 2274 7261 6e73  ing_block["trans
-0000a5f0: 6163 7469 6f6e 7322 5d29 202d 2031 0a20  actions"]) - 1. 
-0000a600: 2020 2020 2020 2072 6177 5f74 786e 203d         raw_txn =
-0000a610: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-0000a620: 6574 682e 6765 745f 7261 775f 7472 616e  eth.get_raw_tran
-0000a630: 7361 6374 696f 6e5f 6279 5f62 6c6f 636b  saction_by_block
-0000a640: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0000a650: 656e 6469 6e67 222c 206c 6173 745f 7065  ending", last_pe
-0000a660: 6e64 696e 675f 7478 6e5f 696e 6465 780a  nding_txn_index.
-0000a670: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000a680: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
-0000a690: 7328 7261 775f 7478 6e29 0a0a 2020 2020  s(raw_txn)..    
-0000a6a0: 2020 2020 2320 6574 685f 6765 7452 6177      # eth_getRaw
-0000a6b0: 5472 616e 7361 6374 696f 6e42 7942 6c6f  TransactionByBlo
-0000a6c0: 636b 4e75 6d62 6572 416e 6449 6e64 6578  ckNumberAndIndex
-0000a6d0: 3a20 626c 6f63 6b20 6e75 6d62 6572 0a20  : block number. 
-0000a6e0: 2020 2020 2020 2061 7379 6e63 5f62 6c6f         async_blo
-0000a6f0: 636b 5f77 6974 685f 7478 6e5f 6e75 6d62  ck_with_txn_numb
-0000a700: 6572 203d 2061 7379 6e63 5f62 6c6f 636b  er = async_block
-0000a710: 5f77 6974 685f 7478 6e5b 226e 756d 6265  _with_txn["numbe
-0000a720: 7222 5d0a 2020 2020 2020 2020 7261 775f  r"].        raw_
-0000a730: 7472 616e 7361 6374 696f 6e20 3d20 6177  transaction = aw
-0000a740: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000a750: 2e67 6574 5f72 6177 5f74 7261 6e73 6163  .get_raw_transac
-0000a760: 7469 6f6e 5f62 795f 626c 6f63 6b28 0a20  tion_by_block(. 
-0000a770: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-0000a780: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-0000a790: 6e75 6d62 6572 2c20 300a 2020 2020 2020  number, 0.      
-0000a7a0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-0000a7b0: 7274 2069 735f 6279 7465 7328 7261 775f  rt is_bytes(raw_
-0000a7c0: 7472 616e 7361 6374 696f 6e29 0a0a 2020  transaction)..  
-0000a7d0: 2020 2020 2020 2320 6574 685f 6765 7452        # eth_getR
-0000a7e0: 6177 5472 616e 7361 6374 696f 6e42 7942  awTransactionByB
-0000a7f0: 6c6f 636b 4861 7368 416e 6449 6e64 6578  lockHashAndIndex
-0000a800: 3a20 626c 6f63 6b20 6861 7368 0a20 2020  : block hash.   
-0000a810: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
-0000a820: 5f77 6974 685f 7478 6e5f 6861 7368 203d  _with_txn_hash =
-0000a830: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
-0000a840: 685f 7478 6e5b 2268 6173 6822 5d0a 2020  h_txn["hash"].  
-0000a850: 2020 2020 2020 7261 775f 7472 616e 7361        raw_transa
-0000a860: 6374 696f 6e20 3d20 6177 6169 7420 6173  ction = await as
-0000a870: 796e 635f 7733 2e65 7468 2e67 6574 5f72  ync_w3.eth.get_r
-0000a880: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
-0000a890: 795f 626c 6f63 6b28 0a20 2020 2020 2020  y_block(.       
-0000a8a0: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
-0000a8b0: 5f77 6974 685f 7478 6e5f 6861 7368 2c20  _with_txn_hash, 
-0000a8c0: 300a 2020 2020 2020 2020 290a 2020 2020  0.        ).    
-0000a8d0: 2020 2020 6173 7365 7274 2069 735f 6279      assert is_by
-0000a8e0: 7465 7328 7261 775f 7472 616e 7361 6374  tes(raw_transact
-0000a8f0: 696f 6e29 0a0a 2020 2020 4070 7974 6573  ion)..    @pytes
-0000a900: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-0000a910: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-0000a920: 7061 7261 6d65 7472 697a 6528 2275 6e6b  parametrize("unk
-0000a930: 6e6f 776e 5f62 6c6f 636b 5f6e 756d 5f6f  nown_block_num_o
-0000a940: 725f 6861 7368 222c 2028 3132 3334 3536  r_hash", (123456
-0000a950: 3738 3939 3939 392c 2055 4e4b 4e4f 574e  7899999, UNKNOWN
-0000a960: 5f48 4153 4829 290a 2020 2020 6173 796e  _HASH)).    asyn
-0000a970: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
-0000a980: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
-0000a990: 6f6e 5f62 795f 626c 6f63 6b5f 7261 6973  on_by_block_rais
-0000a9a0: 6573 5f65 7272 6f72 280a 2020 2020 2020  es_error(.      
-0000a9b0: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-0000a9c0: 3a20 2241 7379 6e63 5765 6233 222c 2075  : "AsyncWeb3", u
-0000a9d0: 6e6b 6e6f 776e 5f62 6c6f 636b 5f6e 756d  nknown_block_num
-0000a9e0: 5f6f 725f 6861 7368 3a20 556e 696f 6e5b  _or_hash: Union[
-0000a9f0: 696e 742c 2048 6578 4279 7465 735d 0a20  int, HexBytes]. 
-0000aa00: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000aa10: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-0000aa20: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
-0000aa30: 2020 2020 2020 5472 616e 7361 6374 696f        Transactio
-0000aa40: 6e4e 6f74 466f 756e 642c 0a20 2020 2020  nNotFound,.     
-0000aa50: 2020 2020 2020 206d 6174 6368 3d28 0a20         match=(. 
-0000aa60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000aa70: 2254 7261 6e73 6163 7469 6f6e 2069 6e64  "Transaction ind
-0000aa80: 6578 3a20 3020 6f6e 2062 6c6f 636b 2069  ex: 0 on block i
-0000aa90: 643a 2022 0a20 2020 2020 2020 2020 2020  d: ".           
-0000aaa0: 2020 2020 2066 227b 746f 5f68 6578 5f69       f"{to_hex_i
-0000aab0: 665f 696e 7465 6765 7228 756e 6b6e 6f77  f_integer(unknow
-0000aac0: 6e5f 626c 6f63 6b5f 6e75 6d5f 6f72 5f68  n_block_num_or_h
-0000aad0: 6173 6829 2172 7d20 220a 2020 2020 2020  ash)!r} ".      
-0000aae0: 2020 2020 2020 2020 2020 6622 6e6f 7420            f"not 
-0000aaf0: 666f 756e 642e 220a 2020 2020 2020 2020  found.".        
-0000ab00: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
-0000ab10: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-0000ab20: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000ab30: 2e67 6574 5f72 6177 5f74 7261 6e73 6163  .get_raw_transac
-0000ab40: 7469 6f6e 5f62 795f 626c 6f63 6b28 0a20  tion_by_block(. 
-0000ab50: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0000ab60: 6e6b 6e6f 776e 5f62 6c6f 636b 5f6e 756d  nknown_block_num
-0000ab70: 5f6f 725f 6861 7368 2c20 300a 2020 2020  _or_hash, 0.    
-0000ab80: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0000ab90: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-0000aba0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-0000abb0: 6620 7465 7374 5f65 7468 5f67 6574 5f72  f test_eth_get_r
-0000abc0: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
-0000abd0: 795f 626c 6f63 6b5f 7261 6973 6573 5f65  y_block_raises_e
-0000abe0: 7272 6f72 5f62 6c6f 636b 5f69 6465 6e74  rror_block_ident
-0000abf0: 6966 6965 7228 0a20 2020 2020 2020 2073  ifier(.        s
-0000ac00: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-0000ac10: 4173 796e 6357 6562 3322 0a20 2020 2029  AsyncWeb3".    )
-0000ac20: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000ac30: 2020 756e 6b6e 6f77 6e5f 6964 656e 7469    unknown_identi
-0000ac40: 6669 6572 203d 2022 756e 6b6e 6f77 6e22  fier = "unknown"
-0000ac50: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0000ac60: 7465 7374 2e72 6169 7365 7328 0a20 2020  test.raises(.   
-0000ac70: 2020 2020 2020 2020 2057 6562 3356 616c           Web3Val
-0000ac80: 7565 4572 726f 722c 0a20 2020 2020 2020  ueError,.       
-0000ac90: 2020 2020 206d 6174 6368 3d28 0a20 2020       match=(.   
-0000aca0: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
-0000acb0: 6c75 6520 6469 6420 6e6f 7420 6d61 7463  lue did not matc
-0000acc0: 6820 616e 7920 6f66 2074 6865 2072 6563  h any of the rec
-0000acd0: 6f67 6e69 7a65 6420 626c 6f63 6b20 6964  ognized block id
-0000ace0: 656e 7469 6669 6572 733a 2022 0a20 2020  entifiers: ".   
-0000acf0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-0000ad00: 756e 6b6e 6f77 6e5f 6964 656e 7469 6669  unknown_identifi
-0000ad10: 6572 7d22 0a20 2020 2020 2020 2020 2020  er}".           
-0000ad20: 2029 2c0a 2020 2020 2020 2020 293a 0a20   ),.        ):. 
-0000ad30: 2020 2020 2020 2020 2020 2061 7761 6974             await
-0000ad40: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-0000ad50: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
-0000ad60: 6e5f 6279 5f62 6c6f 636b 2875 6e6b 6e6f  n_by_block(unkno
-0000ad70: 776e 5f69 6465 6e74 6966 6965 722c 2030  wn_identifier, 0
-0000ad80: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-0000ad90: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-0000ada0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-0000adb0: 7468 5f67 6574 5f62 616c 616e 6365 2873  th_get_balance(s
-0000adc0: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-0000add0: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
-0000ade0: 6f6e 653a 0a20 2020 2020 2020 2063 6f69  one:.        coi
-0000adf0: 6e62 6173 6520 3d20 6177 6169 7420 6173  nbase = await as
-0000ae00: 796e 635f 7733 2e65 7468 2e63 6f69 6e62  ync_w3.eth.coinb
-0000ae10: 6173 650a 0a20 2020 2020 2020 2077 6974  ase..        wit
-0000ae20: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0000ae30: 496e 7661 6c69 6441 6464 7265 7373 293a  InvalidAddress):
-0000ae40: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
-0000ae50: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-0000ae60: 6765 745f 6261 6c61 6e63 6528 0a20 2020  get_balance(.   
-0000ae70: 2020 2020 2020 2020 2020 2020 2043 6865               Che
-0000ae80: 636b 7375 6d41 6464 7265 7373 2848 6578  cksumAddress(Hex
-0000ae90: 4164 6472 6573 7328 4865 7853 7472 2863  Address(HexStr(c
-0000aea0: 6f69 6e62 6173 652e 6c6f 7765 7228 2929  oinbase.lower())
-0000aeb0: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
-0000aec0: 0a0a 2020 2020 2020 2020 6261 6c61 6e63  ..        balanc
-0000aed0: 6520 3d20 6177 6169 7420 6173 796e 635f  e = await async_
-0000aee0: 7733 2e65 7468 2e67 6574 5f62 616c 616e  w3.eth.get_balan
-0000aef0: 6365 2863 6f69 6e62 6173 6529 0a0a 2020  ce(coinbase)..  
-0000af00: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-0000af10: 696e 7465 6765 7228 6261 6c61 6e63 6529  integer(balance)
-0000af20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000af30: 6261 6c61 6e63 6520 3e3d 2030 0a0a 2020  balance >= 0..  
-0000af40: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-0000af50: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-0000af60: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-0000af70: 745f 636f 6465 280a 2020 2020 2020 2020  t_code(.        
-0000af80: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-0000af90: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-0000afa0: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
-0000afb0: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-0000afc0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-0000afd0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000afe0: 2063 6f64 6520 3d20 6177 6169 7420 6173   code = await as
-0000aff0: 796e 635f 7733 2e65 7468 2e67 6574 5f63  ync_w3.eth.get_c
-0000b000: 6f64 6528 6173 796e 635f 6d61 7468 5f63  ode(async_math_c
-0000b010: 6f6e 7472 6163 745f 6164 6472 6573 7329  ontract_address)
-0000b020: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000b030: 6973 696e 7374 616e 6365 2863 6f64 652c  isinstance(code,
-0000b040: 2048 6578 4279 7465 7329 0a20 2020 2020   HexBytes).     
-0000b050: 2020 2061 7373 6572 7420 6c65 6e28 636f     assert len(co
-0000b060: 6465 2920 3e20 300a 0a20 2020 2040 7079  de) > 0..    @py
-0000b070: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-0000b080: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-0000b090: 7465 7374 5f65 7468 5f67 6574 5f63 6f64  test_eth_get_cod
-0000b0a0: 655f 696e 7661 6c69 645f 6164 6472 6573  e_invalid_addres
-0000b0b0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0000b0c0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000b0d0: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000b0e0: 2020 2020 2020 2020 6173 796e 635f 6d61          async_ma
-0000b0f0: 7468 5f63 6f6e 7472 6163 743a 2022 4173  th_contract: "As
-0000b100: 796e 6343 6f6e 7472 6163 7422 2c0a 2020  yncContract",.  
-0000b110: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-0000b120: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0000b130: 2e72 6169 7365 7328 496e 7661 6c69 6441  .raises(InvalidA
-0000b140: 6464 7265 7373 293a 0a20 2020 2020 2020  ddress):.       
-0000b150: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-0000b160: 5f77 332e 6574 682e 6765 745f 636f 6465  _w3.eth.get_code
-0000b170: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000b180: 2020 4368 6563 6b73 756d 4164 6472 6573    ChecksumAddres
-0000b190: 7328 4865 7841 6464 7265 7373 2848 6578  s(HexAddress(Hex
-0000b1a0: 5374 7228 6173 796e 635f 6d61 7468 5f63  Str(async_math_c
-0000b1b0: 6f6e 7472 6163 742e 6164 6472 6573 732e  ontract.address.
-0000b1c0: 6c6f 7765 7228 2929 2929 0a20 2020 2020  lower()))).     
-0000b1d0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-0000b1e0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000b1f0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000b200: 2074 6573 745f 6574 685f 6765 745f 636f   test_eth_get_co
-0000b210: 6465 5f77 6974 685f 626c 6f63 6b5f 6964  de_with_block_id
-0000b220: 656e 7469 6669 6572 280a 2020 2020 2020  entifier(.      
-0000b230: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
-0000b240: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
-0000b250: 7379 6e63 5f65 6d69 7474 6572 5f63 6f6e  sync_emitter_con
-0000b260: 7472 6163 743a 2022 4173 796e 6343 6f6e  tract: "AsyncCon
-0000b270: 7472 6163 7422 0a20 2020 2029 202d 3e20  tract".    ) -> 
-0000b280: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-0000b290: 6f63 6b5f 6964 203d 2061 7761 6974 2061  ock_id = await a
-0000b2a0: 7379 6e63 5f77 332e 6574 682e 626c 6f63  sync_w3.eth.bloc
-0000b2b0: 6b5f 6e75 6d62 6572 0a20 2020 2020 2020  k_number.       
-0000b2c0: 2063 6f64 6520 3d20 6177 6169 7420 6173   code = await as
-0000b2d0: 796e 635f 7733 2e65 7468 2e67 6574 5f63  ync_w3.eth.get_c
-0000b2e0: 6f64 6528 6173 796e 635f 656d 6974 7465  ode(async_emitte
-0000b2f0: 725f 636f 6e74 7261 6374 2e61 6464 7265  r_contract.addre
-0000b300: 7373 2c20 626c 6f63 6b5f 6964 290a 2020  ss, block_id).  
-0000b310: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-0000b320: 6e73 7461 6e63 6528 636f 6465 2c20 4865  nstance(code, He
-0000b330: 7842 7974 6573 290a 2020 2020 2020 2020  xBytes).        
-0000b340: 6173 7365 7274 206c 656e 2863 6f64 6529  assert len(code)
-0000b350: 203e 2030 0a0a 2020 2020 4070 7974 6573   > 0..    @pytes
-0000b360: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-0000b370: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-0000b380: 745f 6574 685f 6372 6561 7465 5f61 6363  t_eth_create_acc
-0000b390: 6573 735f 6c69 7374 280a 2020 2020 2020  ess_list(.      
-0000b3a0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000b3b0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-0000b3c0: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
-0000b3d0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-0000b3e0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0000b3f0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0000b400: 4164 6472 6573 732c 0a20 2020 2020 2020  Address,.       
-0000b410: 2061 7379 6e63 5f6d 6174 685f 636f 6e74   async_math_cont
-0000b420: 7261 6374 3a20 2241 7379 6e63 436f 6e74  ract: "AsyncCont
-0000b430: 7261 6374 222c 0a20 2020 2029 202d 3e20  ract",.    ) -> 
-0000b440: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
-0000b450: 6275 696c 6420 7478 6e0a 2020 2020 2020  build txn.      
-0000b460: 2020 7478 6e20 3d20 6177 6169 7420 6173    txn = await as
-0000b470: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
-0000b480: 742e 6675 6e63 7469 6f6e 732e 696e 6372  t.functions.incr
-0000b490: 656d 656e 7443 6f75 6e74 6572 2831 292e  ementCounter(1).
-0000b4a0: 6275 696c 645f 7472 616e 7361 6374 696f  build_transactio
-0000b4b0: 6e28 0a20 2020 2020 2020 2020 2020 207b  n(.            {
-0000b4c0: 2266 726f 6d22 3a20 6173 796e 635f 6b65  "from": async_ke
-0000b4d0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0000b4e0: 6472 6573 735f 6475 616c 5f74 7970 657d  dress_dual_type}
-0000b4f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000b500: 2020 2020 2320 6372 6561 7465 2061 6363      # create acc
-0000b510: 6573 7320 6c69 7374 0a20 2020 2020 2020  ess list.       
-0000b520: 2072 6573 706f 6e73 6520 3d20 6177 6169   response = awai
-0000b530: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
-0000b540: 7265 6174 655f 6163 6365 7373 5f6c 6973  reate_access_lis
-0000b550: 7428 7478 6e29 0a0a 2020 2020 2020 2020  t(txn)..        
-0000b560: 6173 7365 7274 2069 735f 6469 6374 2872  assert is_dict(r
-0000b570: 6573 706f 6e73 6529 0a20 2020 2020 2020  esponse).       
-0000b580: 2061 6363 6573 735f 6c69 7374 203d 2072   access_list = r
-0000b590: 6573 706f 6e73 655b 2261 6363 6573 734c  esponse["accessL
-0000b5a0: 6973 7422 5d0a 2020 2020 2020 2020 6173  ist"].        as
-0000b5b0: 7365 7274 206c 656e 2861 6363 6573 735f  sert len(access_
-0000b5c0: 6c69 7374 2920 3e20 300a 2020 2020 2020  list) > 0.      
-0000b5d0: 2020 6173 7365 7274 2061 6363 6573 735f    assert access_
-0000b5e0: 6c69 7374 5b30 5d5b 2261 6464 7265 7373  list[0]["address
-0000b5f0: 225d 2069 7320 6e6f 7420 4e6f 6e65 0a20  "] is not None. 
-0000b600: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0000b610: 5f63 6865 636b 7375 6d5f 6164 6472 6573  _checksum_addres
-0000b620: 7328 6163 6365 7373 5f6c 6973 745b 305d  s(access_list[0]
-0000b630: 5b22 6164 6472 6573 7322 5d29 0a20 2020  ["address"]).   
-0000b640: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0000b650: 6163 6365 7373 5f6c 6973 745b 305d 5b22  access_list[0]["
-0000b660: 7374 6f72 6167 654b 6579 7322 5d5b 305d  storageKeys"][0]
-0000b670: 2920 3d3d 2033 320a 2020 2020 2020 2020  ) == 32.        
-0000b680: 6173 7365 7274 2069 6e74 2872 6573 706f  assert int(respo
-0000b690: 6e73 655b 2267 6173 5573 6564 225d 2920  nse["gasUsed"]) 
-0000b6a0: 3e3d 2030 0a0a 2020 2020 2020 2020 2320  >= 0..        # 
-0000b6b0: 6173 7365 7274 2074 6865 2072 6573 756c  assert the resul
-0000b6c0: 7420 6361 6e20 6265 2075 7365 6420 6469  t can be used di
-0000b6d0: 7265 6374 6c79 2069 6e20 6120 7472 616e  rectly in a tran
-0000b6e0: 7361 6374 696f 6e20 6469 6374 0a20 2020  saction dict.   
-0000b6f0: 2020 2020 2074 786e 5b22 6163 6365 7373       txn["access
-0000b700: 4c69 7374 225d 203d 2072 6573 706f 6e73  List"] = respons
-0000b710: 655b 2261 6363 6573 734c 6973 7422 5d0a  e["accessList"].
-0000b720: 2020 2020 2020 2020 7478 6e5b 2267 6173          txn["gas
-0000b730: 225d 203d 2072 6573 706f 6e73 655b 2267  "] = response["g
-0000b740: 6173 5573 6564 225d 0a0a 2020 2020 2020  asUsed"]..      
-0000b750: 2020 2320 7365 6e64 2074 786e 2077 6974    # send txn wit
-0000b760: 6820 6163 6365 7373 206c 6973 740a 2020  h access list.  
-0000b770: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
-0000b780: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
-0000b790: 616e 7361 6374 696f 6e28 7478 6e29 0a0a  ansaction(txn)..
-0000b7a0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000b7b0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-0000b7c0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-0000b7d0: 6765 745f 7472 616e 7361 6374 696f 6e5f  get_transaction_
-0000b7e0: 636f 756e 7428 0a20 2020 2020 2020 2073  count(.        s
-0000b7f0: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-0000b800: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-0000b810: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-0000b820: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-0000b830: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0000b840: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0000b850: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-0000b860: 6f6e 653a 0a20 2020 2020 2020 2074 7261  one:.        tra
-0000b870: 6e73 6163 7469 6f6e 5f63 6f75 6e74 203d  nsaction_count =
-0000b880: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-0000b890: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-0000b8a0: 696f 6e5f 636f 756e 7428 0a20 2020 2020  ion_count(.     
-0000b8b0: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
-0000b8c0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-0000b8d0: 7265 7373 5f64 7561 6c5f 7479 7065 0a20  ress_dual_type. 
-0000b8e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000b8f0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-0000b900: 6572 2874 7261 6e73 6163 7469 6f6e 5f63  er(transaction_c
-0000b910: 6f75 6e74 290a 2020 2020 2020 2020 6173  ount).        as
-0000b920: 7365 7274 2074 7261 6e73 6163 7469 6f6e  sert transaction
-0000b930: 5f63 6f75 6e74 203e 3d20 300a 0a20 2020  _count >= 0..   
-0000b940: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000b950: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000b960: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
-0000b970: 6c28 0a20 2020 2020 2020 2073 656c 662c  l(.        self,
-0000b980: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-0000b990: 6357 6562 3322 2c20 6173 796e 635f 6d61  cWeb3", async_ma
-0000b9a0: 7468 5f63 6f6e 7472 6163 743a 2022 4173  th_contract: "As
-0000b9b0: 796e 6343 6f6e 7472 6163 7422 0a20 2020  yncContract".   
-0000b9c0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0000b9d0: 2020 2020 636f 696e 6261 7365 203d 2061      coinbase = a
-0000b9e0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-0000b9f0: 682e 636f 696e 6261 7365 0a20 2020 2020  h.coinbase.     
-0000ba00: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
-0000ba10: 6173 796e 635f 6d61 7468 5f63 6f6e 7472  async_math_contr
-0000ba20: 6163 742e 5f70 7265 7061 7265 5f74 7261  act._prepare_tra
-0000ba30: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-0000ba40: 2020 2020 2020 666e 5f6e 616d 653d 2261        fn_name="a
-0000ba50: 6464 222c 0a20 2020 2020 2020 2020 2020  dd",.           
-0000ba60: 2066 6e5f 6172 6773 3d28 372c 2031 3129   fn_args=(7, 11)
-0000ba70: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
-0000ba80: 616e 7361 6374 696f 6e3d 7b22 6672 6f6d  ansaction={"from
-0000ba90: 223a 2063 6f69 6e62 6173 652c 2022 746f  ": coinbase, "to
-0000baa0: 223a 2061 7379 6e63 5f6d 6174 685f 636f  ": async_math_co
-0000bab0: 6e74 7261 6374 2e61 6464 7265 7373 7d2c  ntract.address},
-0000bac0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000bad0: 2020 2063 616c 6c5f 7265 7375 6c74 203d     call_result =
-0000bae0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-0000baf0: 6574 682e 6361 6c6c 2874 786e 5f70 6172  eth.call(txn_par
-0000bb00: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
-0000bb10: 6572 7420 6973 5f73 7472 696e 6728 6361  ert is_string(ca
-0000bb20: 6c6c 5f72 6573 756c 7429 0a20 2020 2020  ll_result).     
-0000bb30: 2020 2028 7265 7375 6c74 2c29 203d 2061     (result,) = a
-0000bb40: 7379 6e63 5f77 332e 636f 6465 632e 6465  sync_w3.codec.de
-0000bb50: 636f 6465 285b 2275 696e 7432 3536 225d  code(["uint256"]
-0000bb60: 2c20 6361 6c6c 5f72 6573 756c 7429 0a20  , call_result). 
-0000bb70: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-0000bb80: 7375 6c74 203d 3d20 3138 0a0a 2020 2020  sult == 18..    
-0000bb90: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-0000bba0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-0000bbb0: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
-0000bbc0: 5f77 6974 685f 6f76 6572 7269 6465 5f63  _with_override_c
-0000bbd0: 6f64 6528 0a20 2020 2020 2020 2073 656c  ode(.        sel
-0000bbe0: 662c 0a20 2020 2020 2020 2061 7379 6e63  f,.        async
-0000bbf0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-0000bc00: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-0000bc10: 7265 7665 7274 5f63 6f6e 7472 6163 743a  revert_contract:
-0000bc20: 2022 4173 796e 6343 6f6e 7472 6163 7422   "AsyncContract"
-0000bc30: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-0000bc40: 0a20 2020 2020 2020 2063 6f69 6e62 6173  .        coinbas
-0000bc50: 6520 3d20 6177 6169 7420 6173 796e 635f  e = await async_
-0000bc60: 7733 2e65 7468 2e63 6f69 6e62 6173 650a  w3.eth.coinbase.
-0000bc70: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0000bc80: 6d73 203d 2061 7379 6e63 5f72 6576 6572  ms = async_rever
-0000bc90: 745f 636f 6e74 7261 6374 2e5f 7072 6570  t_contract._prep
-0000bca0: 6172 655f 7472 616e 7361 6374 696f 6e28  are_transaction(
-0000bcb0: 0a20 2020 2020 2020 2020 2020 2066 6e5f  .            fn_
-0000bcc0: 6e61 6d65 3d22 6e6f 726d 616c 4675 6e63  name="normalFunc
-0000bcd0: 7469 6f6e 222c 0a20 2020 2020 2020 2020  tion",.         
-0000bce0: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
-0000bcf0: 2266 726f 6d22 3a20 636f 696e 6261 7365  "from": coinbase
-0000bd00: 2c20 2274 6f22 3a20 6173 796e 635f 7265  , "to": async_re
-0000bd10: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
-0000bd20: 6472 6573 737d 2c0a 2020 2020 2020 2020  dress},.        
-0000bd30: 290a 2020 2020 2020 2020 6361 6c6c 5f72  ).        call_r
-0000bd40: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-0000bd50: 796e 635f 7733 2e65 7468 2e63 616c 6c28  ync_w3.eth.call(
-0000bd60: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-0000bd70: 2020 2020 2872 6573 756c 742c 2920 3d20      (result,) = 
-0000bd80: 6173 796e 635f 7733 2e63 6f64 6563 2e64  async_w3.codec.d
-0000bd90: 6563 6f64 6528 5b22 626f 6f6c 225d 2c20  ecode(["bool"], 
-0000bda0: 6361 6c6c 5f72 6573 756c 7429 0a20 2020  call_result).   
-0000bdb0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0000bdc0: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
-0000bdd0: 2020 2020 2320 6f76 6572 7269 6465 2072      # override r
-0000bde0: 756e 7469 6d65 2062 7974 6563 6f64 653a  untime bytecode:
-0000bdf0: 2060 6e6f 726d 616c 4675 6e63 7469 6f6e   `normalFunction
-0000be00: 6020 7265 7475 726e 7320 6066 616c 7365  ` returns `false
-0000be10: 600a 2020 2020 2020 2020 6f76 6572 7269  `.        overri
-0000be20: 6465 5f63 6f64 6520 3d20 4865 7853 7472  de_code = HexStr
-0000be30: 280a 2020 2020 2020 2020 2020 2020 2230  (.            "0
-0000be40: 7836 3038 3036 3034 3035 3233 3438 3031  x608060405234801
-0000be50: 3536 3030 6635 3736 3030 3038 3066 6435  5600f57600080fd5
-0000be60: 6235 3036 3030 3433 3631 3036 3033 6335  b5060043610603c5
-0000be70: 3736 3030 3033 3536 3065 3031 6338 3036  760003560e01c806
-0000be80: 3331 3835 6333 3861 3431 3436 3034 3135  3185c38a41460415
-0000be90: 3738 3036 3363 3036 6139 3763 6231 3436  78063c06a97cb146
-0000bea0: 3034 3935 3738 3036 3364 3637 6534 6238  049578063d67e4b8
-0000beb0: 3431 3436 3035 3135 3735 6236 3030 3038  4146051575b60008
-0000bec0: 3066 6435 6236 3034 3736 3037 3135 3635  0fd5b60476071565
-0000bed0: 6230 3035 6236 3034 6636 3064 6635 3635  b005b604f60df565
-0000bee0: 6230 3035 6236 3035 3736 3065 3435 3635  b005b605760e4565
-0000bef0: 6236 3034 3035 3138 3038 3231 3531 3531  b604051808215151
-0000bf00: 3531 3538 3135 3236 3032 3030 3139 3135  5158152602001915
-0000bf10: 3035 3036 3034 3035 3138 3039 3130 3339  0506040518091039
-0000bf20: 3066 3335 6236 3034 3035 3137 6630 3863  0f35b6040517f08c
-0000bf30: 3337 3961 3030 3030 3030 3030 3030 3030  379a000000000000
+00001d20: 7374 2857 6569 2c20 7478 6e5f 7061 7261  st(Wei, txn_para
+00001d30: 6d73 5b22 6761 7350 7269 6365 225d 202a  ms["gasPrice"] *
+00001d40: 2032 2929 2c20 7661 6c75 653d 5765 6928   2)), value=Wei(
+00001d50: 3229 0a20 2020 2020 2020 2029 0a20 2020  2).        ).   
+00001d60: 2020 2020 206d 6f64 6966 6965 645f 7478       modified_tx
+00001d70: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
+00001d80: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
+00001d90: 6163 7469 6f6e 286d 6f64 6966 6965 645f  action(modified_
+00001da0: 7478 6e5f 6861 7368 290a 0a20 2020 2020  txn_hash)..     
+00001db0: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
+00001dc0: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
+00001dd0: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
+00001de0: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
+00001df0: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
+00001e00: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
+00001e10: 726f 6d22 5d29 0a20 2020 2020 2020 2029  rom"]).        )
+00001e20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00001e30: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+00001e40: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00001e50: 6966 6965 645f 7478 6e5b 2274 6f22 5d2c  ified_txn["to"],
+00001e60: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
+00001e70: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
+00001e80: 735b 2274 6f22 5d29 0a20 2020 2020 2020  s["to"]).       
+00001e90: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+00001ea0: 7420 6d6f 6469 6669 6564 5f74 786e 5b22  t modified_txn["
+00001eb0: 7661 6c75 6522 5d20 3d3d 2032 0a20 2020  value"] == 2.   
+00001ec0: 2020 2020 2061 7373 6572 7420 6d6f 6469       assert modi
+00001ed0: 6669 6564 5f74 786e 5b22 6761 7322 5d20  fied_txn["gas"] 
+00001ee0: 3d3d 2032 3130 3030 0a20 2020 2020 2020  == 21000.       
+00001ef0: 2061 7373 6572 7420 6d6f 6469 6669 6564   assert modified
+00001f00: 5f74 786e 5b22 6761 7350 7269 6365 225d  _txn["gasPrice"]
+00001f10: 203d 3d20 6361 7374 2869 6e74 2c20 7478   == cast(int, tx
+00001f20: 6e5f 7061 7261 6d73 5b22 6761 7350 7269  n_params["gasPri
+00001f30: 6365 225d 2920 2a20 320a 0a20 2020 2040  ce"]) * 2..    @
+00001f40: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00001f50: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00001f60: 6620 7465 7374 5f65 7468 5f6d 6f64 6966  f test_eth_modif
+00001f70: 795f 7472 616e 7361 6374 696f 6e28 0a20  y_transaction(. 
+00001f80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00001f90: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
+00001fa0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
+00001fb0: 2020 2020 6173 796e 635f 6b65 7966 696c      async_keyfil
+00001fc0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00001fd0: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
+00001fe0: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
+00001ff0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00002000: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
+00002010: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
+00002020: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+00002030: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
+00002040: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00002050: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00002060: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+00002070: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00002080: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00002090: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000020a0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+000020b0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+000020c0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+000020d0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+000020e0: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+000020f0: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+00002100: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
+00002110: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+00002120: 5065 7247 6173 223a 2061 7379 6e63 5f77  PerGas": async_w
+00002130: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
+00002140: 6922 292c 0a20 2020 2020 2020 207d 0a20  i"),.        }. 
+00002150: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
+00002160: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00002170: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00002180: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+00002190: 290a 0a20 2020 2020 2020 206d 6f64 6966  )..        modif
+000021a0: 6965 645f 7478 6e5f 6861 7368 203d 2061  ied_txn_hash = a
+000021b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000021c0: 682e 6d6f 6469 6679 5f74 7261 6e73 6163  h.modify_transac
+000021d0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+000021e0: 2020 7478 6e5f 6861 7368 2c0a 2020 2020    txn_hash,.    
+000021f0: 2020 2020 2020 2020 7661 6c75 653d 5765          value=We
+00002200: 6928 3229 2c0a 2020 2020 2020 2020 2020  i(2),.          
+00002210: 2020 6d61 7850 7269 6f72 6974 7946 6565    maxPriorityFee
+00002220: 5065 7247 6173 3d28 6361 7374 2857 6569  PerGas=(cast(Wei
+00002230: 2c20 7478 6e5f 7061 7261 6d73 5b22 6d61  , txn_params["ma
+00002240: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00002250: 6173 225d 202a 2032 2929 2c0a 2020 2020  as"] * 2)),.    
+00002260: 2020 2020 2020 2020 6d61 7846 6565 5065          maxFeePe
+00002270: 7247 6173 3d28 6361 7374 2857 6569 2c20  rGas=(cast(Wei, 
+00002280: 7478 6e5f 7061 7261 6d73 5b22 6d61 7846  txn_params["maxF
+00002290: 6565 5065 7247 6173 225d 202a 2032 2929  eePerGas"] * 2))
+000022a0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000022b0: 2020 2020 6d6f 6469 6669 6564 5f74 786e      modified_txn
+000022c0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+000022d0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+000022e0: 6374 696f 6e28 6d6f 6469 6669 6564 5f74  ction(modified_t
+000022f0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
+00002300: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00002310: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
+00002320: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
+00002330: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
+00002340: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+00002350: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
+00002360: 6f6d 225d 290a 2020 2020 2020 2020 290a  om"]).        ).
+00002370: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00002380: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
+00002390: 2020 2020 2020 2020 2020 2020 6d6f 6469              modi
+000023a0: 6669 6564 5f74 786e 5b22 746f 225d 2c20  fied_txn["to"], 
+000023b0: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+000023c0: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+000023d0: 5b22 746f 225d 290a 2020 2020 2020 2020  ["to"]).        
+000023e0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+000023f0: 206d 6f64 6966 6965 645f 7478 6e5b 2276   modified_txn["v
+00002400: 616c 7565 225d 203d 3d20 320a 2020 2020  alue"] == 2.    
+00002410: 2020 2020 6173 7365 7274 206d 6f64 6966      assert modif
+00002420: 6965 645f 7478 6e5b 2267 6173 225d 203d  ied_txn["gas"] =
+00002430: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
+00002440: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+00002450: 2020 2020 206d 6f64 6966 6965 645f 7478       modified_tx
+00002460: 6e5b 226d 6178 5072 696f 7269 7479 4665  n["maxPriorityFe
+00002470: 6550 6572 4761 7322 5d0a 2020 2020 2020  ePerGas"].      
+00002480: 2020 2020 2020 3d3d 2063 6173 7428 5765        == cast(We
+00002490: 692c 2074 786e 5f70 6172 616d 735b 226d  i, txn_params["m
+000024a0: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+000024b0: 4761 7322 5d29 202a 2032 0a20 2020 2020  Gas"]) * 2.     
+000024c0: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+000024d0: 6572 7420 6d6f 6469 6669 6564 5f74 786e  ert modified_txn
+000024e0: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+000024f0: 203d 3d20 6361 7374 2857 6569 2c20 7478   == cast(Wei, tx
+00002500: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
+00002510: 5065 7247 6173 225d 2920 2a20 320a 0a20  PerGas"]) * 2.. 
+00002520: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00002530: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+00002540: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
+00002550: 5f65 7468 5f73 6967 6e5f 7472 616e 7361  _eth_sign_transa
+00002560: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
+00002570: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
+00002580: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00002590: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
+000025a0: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
+000025b0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+000025c0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
+000025d0: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
+000025e0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
+000025f0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+00002600: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00002610: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
+00002620: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00002630: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00002640: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00002650: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
+00002660: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00002670: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00002680: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+00002690: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+000026a0: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+000026b0: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+000026c0: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
+000026d0: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+000026e0: 2832 2c20 2267 7765 6922 292c 0a20 2020  (2, "gwei"),.   
+000026f0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+00002700: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+00002710: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+00002720: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
+00002730: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
+00002740: 3a20 4e6f 6e63 6528 3029 2c0a 2020 2020  : Nonce(0),.    
+00002750: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
+00002760: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
+00002770: 6e63 5f77 332e 6574 682e 7369 676e 5f74  nc_w3.eth.sign_t
+00002780: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00002790: 6172 616d 7329 0a20 2020 2020 2020 2073  arams).        s
+000027a0: 6967 6e61 746f 7279 5f61 6363 6f75 6e74  ignatory_account
+000027b0: 203d 2061 7379 6e63 5f77 332e 6574 682e   = async_w3.eth.
+000027c0: 6163 636f 756e 742e 7265 636f 7665 725f  account.recover_
+000027d0: 7472 616e 7361 6374 696f 6e28 7265 7375  transaction(resu
+000027e0: 6c74 5b22 7261 7722 5d29 0a20 2020 2020  lt["raw"]).     
+000027f0: 2020 2061 7373 6572 7420 6173 796e 635f     assert async_
+00002800: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00002810: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00002820: 6520 3d3d 2073 6967 6e61 746f 7279 5f61  e == signatory_a
+00002830: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
+00002840: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+00002850: 225d 5b22 746f 225d 203d 3d20 7478 6e5f  "]["to"] == txn_
+00002860: 7061 7261 6d73 5b22 746f 225d 0a20 2020  params["to"].   
+00002870: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+00002880: 6c74 5b22 7478 225d 5b22 7661 6c75 6522  lt["tx"]["value"
+00002890: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+000028a0: 2276 616c 7565 225d 0a20 2020 2020 2020  "value"].       
+000028b0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+000028c0: 7478 225d 5b22 6761 7322 5d20 3d3d 2074  tx"]["gas"] == t
+000028d0: 786e 5f70 6172 616d 735b 2267 6173 225d  xn_params["gas"]
+000028e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000028f0: 7265 7375 6c74 5b22 7478 225d 5b22 6d61  result["tx"]["ma
+00002900: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
+00002910: 7478 6e5f 7061 7261 6d73 5b22 6d61 7846  txn_params["maxF
+00002920: 6565 5065 7247 6173 225d 0a20 2020 2020  eePerGas"].     
+00002930: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+00002940: 2020 2020 2020 2020 7265 7375 6c74 5b22          result["
+00002950: 7478 225d 5b22 6d61 7850 7269 6f72 6974  tx"]["maxPriorit
+00002960: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
+00002970: 7478 6e5f 7061 7261 6d73 5b22 6d61 7850  txn_params["maxP
+00002980: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00002990: 225d 0a20 2020 2020 2020 2029 0a20 2020  "].        ).   
+000029a0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+000029b0: 6c74 5b22 7478 225d 5b22 6e6f 6e63 6522  lt["tx"]["nonce"
+000029c0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+000029d0: 226e 6f6e 6365 225d 0a0a 2020 2020 4070  "nonce"]..    @p
+000029e0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+000029f0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00002a00: 2074 6573 745f 6574 685f 7369 676e 5f74   test_eth_sign_t
+00002a10: 7970 6564 5f64 6174 6128 0a20 2020 2020  yped_data(.     
+00002a20: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00002a30: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00002a40: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
+00002a50: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00002a60: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00002a70: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
+00002a80: 6d41 6464 7265 7373 2c0a 2020 2020 2020  mAddress,.      
+00002a90: 2020 6173 796e 635f 736b 6970 5f69 665f    async_skip_if_
+00002aa0: 7465 7374 7270 633a 2043 616c 6c61 626c  testrpc: Callabl
+00002ab0: 655b 5b22 4173 796e 6357 6562 3322 5d2c  e[["AsyncWeb3"],
+00002ac0: 204e 6f6e 655d 2c0a 2020 2020 2920 2d3e   None],.    ) ->
+00002ad0: 204e 6f6e 653a 0a20 2020 2020 2020 2076   None:.        v
+00002ae0: 616c 6964 4a53 4f4e 4d65 7373 6167 6520  alidJSONMessage 
+00002af0: 3d20 2222 220a 2020 2020 2020 2020 2020  = """.          
+00002b00: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00002b10: 2020 2020 2274 7970 6573 223a 207b 0a20      "types": {. 
+00002b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b30: 2020 2022 4549 5037 3132 446f 6d61 696e     "EIP712Domain
+00002b40: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+00002b50: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
+00002b60: 616d 6522 3a20 226e 616d 6522 2c20 2274  ame": "name", "t
+00002b70: 7970 6522 3a20 2273 7472 696e 6722 7d2c  ype": "string"},
+00002b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002b90: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+00002ba0: 3a20 2276 6572 7369 6f6e 222c 2022 7479  : "version", "ty
+00002bb0: 7065 223a 2022 7374 7269 6e67 227d 2c0a  pe": "string"},.
+00002bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002bd0: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
+00002be0: 2022 6368 6169 6e49 6422 2c20 2274 7970   "chainId", "typ
+00002bf0: 6522 3a20 2275 696e 7432 3536 227d 2c0a  e": "uint256"},.
+00002c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c10: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
+00002c20: 2022 7665 7269 6679 696e 6743 6f6e 7472   "verifyingContr
+00002c30: 6163 7422 2c20 2274 7970 6522 3a20 2261  act", "type": "a
+00002c40: 6464 7265 7373 227d 0a20 2020 2020 2020  ddress"}.       
+00002c50: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+00002c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c70: 2020 2020 2250 6572 736f 6e22 3a20 5b0a      "Person": [.
+00002c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c90: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
+00002ca0: 2022 6e61 6d65 222c 2022 7479 7065 223a   "name", "type":
+00002cb0: 2022 7374 7269 6e67 227d 2c0a 2020 2020   "string"},.    
+00002cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002cd0: 2020 2020 7b22 6e61 6d65 223a 2022 7761      {"name": "wa
+00002ce0: 6c6c 6574 222c 2022 7479 7065 223a 2022  llet", "type": "
+00002cf0: 6164 6472 6573 7322 7d0a 2020 2020 2020  address"}.      
+00002d00: 2020 2020 2020 2020 2020 2020 2020 5d2c                ],
+00002d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002d20: 2020 2020 2022 4d61 696c 223a 205b 0a20       "Mail": [. 
+00002d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d40: 2020 2020 2020 207b 226e 616d 6522 3a20         {"name": 
+00002d50: 2266 726f 6d22 2c20 2274 7970 6522 3a20  "from", "type": 
+00002d60: 2250 6572 736f 6e22 7d2c 0a20 2020 2020  "Person"},.     
+00002d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d80: 2020 207b 226e 616d 6522 3a20 2274 6f22     {"name": "to"
+00002d90: 2c20 2274 7970 6522 3a20 2250 6572 736f  , "type": "Perso
+00002da0: 6e22 7d2c 0a20 2020 2020 2020 2020 2020  n"},.           
+00002db0: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
+00002dc0: 616d 6522 3a20 2263 6f6e 7465 6e74 7322  ame": "contents"
+00002dd0: 2c20 2274 7970 6522 3a20 2273 7472 696e  , "type": "strin
+00002de0: 6722 7d0a 2020 2020 2020 2020 2020 2020  g"}.            
+00002df0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00002e00: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00002e10: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
+00002e20: 696d 6172 7954 7970 6522 3a20 224d 6169  imaryType": "Mai
+00002e30: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+00002e40: 2020 2020 2264 6f6d 6169 6e22 3a20 7b0a      "domain": {.
+00002e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002e60: 2020 2020 226e 616d 6522 3a20 2245 7468      "name": "Eth
+00002e70: 6572 204d 6169 6c22 2c0a 2020 2020 2020  er Mail",.      
+00002e80: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+00002e90: 6572 7369 6f6e 223a 2022 3122 2c0a 2020  ersion": "1",.  
+00002ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002eb0: 2020 2263 6861 696e 4964 223a 2022 3078    "chainId": "0x
+00002ec0: 3031 222c 0a20 2020 2020 2020 2020 2020  01",.           
+00002ed0: 2020 2020 2020 2020 2022 7665 7269 6679           "verify
+00002ee0: 696e 6743 6f6e 7472 6163 7422 3a20 2230  ingContract": "0
+00002ef0: 7843 6343 4363 6363 6343 4343 4363 4343  xCcCCccccCCCCcCC
+00002f00: 4343 4343 6343 6343 6363 4363 4343 4363  CCCCcCcCccCcCCCc
+00002f10: 4363 6363 6363 6363 4322 0a20 2020 2020  CcccccccC".     
+00002f20: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00002f30: 2020 2020 2020 2020 2020 2020 2020 226d                "m
+00002f40: 6573 7361 6765 223a 207b 0a20 2020 2020  essage": {.     
+00002f50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00002f60: 6672 6f6d 223a 207b 0a20 2020 2020 2020  from": {.       
+00002f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002f80: 2022 6e61 6d65 223a 2022 436f 7722 2c0a   "name": "Cow",.
+00002f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002fa0: 2020 2020 2020 2020 2277 616c 6c65 7422          "wallet"
+00002fb0: 3a20 2230 7843 4432 6133 6439 4639 3338  : "0xCD2a3d9F938
+00002fc0: 4531 3343 4439 3437 4563 3035 4162 4337  E13CD947Ec05AbC7
+00002fd0: 4645 3733 3444 6638 4444 3832 3622 0a20  FE734Df8DD826". 
+00002fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ff0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00003000: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00003010: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00003020: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00003030: 3a20 2242 6f62 222c 0a20 2020 2020 2020  : "Bob",.       
+00003040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003050: 2022 7761 6c6c 6574 223a 2022 3078 6242   "wallet": "0xbB
+00003060: 6242 4242 4262 6242 4242 6262 6242 6262  bBBBBbbBBBbbbBbb
+00003070: 4262 6262 6242 4262 4262 6262 6242 6242  BbbbbBBbBbbbbBbB
+00003080: 6262 4242 6242 220a 2020 2020 2020 2020  bbBBbB".        
+00003090: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+000030a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030b0: 2020 2022 636f 6e74 656e 7473 223a 2022     "contents": "
+000030c0: 4865 6c6c 6f2c 2042 6f62 2122 0a20 2020  Hello, Bob!".   
+000030d0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+000030e0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+000030f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00003100: 2061 7379 6e63 5f73 6b69 705f 6966 5f74   async_skip_if_t
+00003110: 6573 7472 7063 2861 7379 6e63 5f77 3329  estrpc(async_w3)
+00003120: 0a20 2020 2020 2020 2073 6967 6e61 7475  .        signatu
+00003130: 7265 203d 2048 6578 4279 7465 7328 0a20  re = HexBytes(. 
+00003140: 2020 2020 2020 2020 2020 2061 7761 6974             await
+00003150: 2061 7379 6e63 5f77 332e 6574 682e 7369   async_w3.eth.si
+00003160: 676e 5f74 7970 6564 5f64 6174 6128 0a20  gn_typed_data(. 
+00003170: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00003180: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00003190: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+000031a0: 6c5f 7479 7065 2c20 6a73 6f6e 2e6c 6f61  l_type, json.loa
+000031b0: 6473 2876 616c 6964 4a53 4f4e 4d65 7373  ds(validJSONMess
+000031c0: 6167 6529 0a20 2020 2020 2020 2020 2020  age).           
+000031d0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+000031e0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000031f0: 7369 676e 6174 7572 6529 203d 3d20 3332  signature) == 32
+00003200: 202b 2033 3220 2b20 310a 0a20 2020 2040   + 32 + 1..    @
+00003210: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00003220: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00003230: 6620 7465 7374 5f69 6e76 616c 6964 5f65  f test_invalid_e
+00003240: 7468 5f73 6967 6e5f 7479 7065 645f 6461  th_sign_typed_da
+00003250: 7461 280a 2020 2020 2020 2020 7365 6c66  ta(.        self
+00003260: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+00003270: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00003280: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+00003290: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+000032a0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+000032b0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+000032c0: 732c 0a20 2020 2020 2020 2061 7379 6e63  s,.        async
+000032d0: 5f73 6b69 705f 6966 5f74 6573 7472 7063  _skip_if_testrpc
+000032e0: 3a20 4361 6c6c 6162 6c65 5b5b 2241 7379  : Callable[["Asy
+000032f0: 6e63 5765 6233 225d 2c20 4e6f 6e65 5d2c  ncWeb3"], None],
+00003300: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00003310: 2020 2020 2020 2020 6173 796e 635f 736b          async_sk
+00003320: 6970 5f69 665f 7465 7374 7270 6328 6173  ip_if_testrpc(as
+00003330: 796e 635f 7733 290a 2020 2020 2020 2020  ync_w3).        
+00003340: 696e 7661 6c69 645f 7479 7065 645f 6d65  invalid_typed_me
+00003350: 7373 6167 6520 3d20 2222 220a 2020 2020  ssage = """.    
+00003360: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00003370: 2020 2020 2020 2020 2020 2274 7970 6573            "types
+00003380: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+00003390: 2020 2020 2020 2020 2022 4549 5037 3132           "EIP712
+000033a0: 446f 6d61 696e 223a 205b 0a20 2020 2020  Domain": [.     
+000033b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033c0: 2020 207b 226e 616d 6522 3a20 226e 616d     {"name": "nam
+000033d0: 6522 2c20 2274 7970 6522 3a20 2273 7472  e", "type": "str
+000033e0: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
+000033f0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00003400: 226e 616d 6522 3a20 2276 6572 7369 6f6e  "name": "version
+00003410: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
+00003420: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
+00003430: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00003440: 6e61 6d65 223a 2022 6368 6169 6e49 6422  name": "chainId"
+00003450: 2c20 2274 7970 6522 3a20 2275 696e 7432  , "type": "uint2
+00003460: 3536 227d 2c0a 2020 2020 2020 2020 2020  56"},.          
+00003470: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00003480: 6e61 6d65 223a 2022 7665 7269 6679 696e  name": "verifyin
+00003490: 6743 6f6e 7472 6163 7422 2c20 2274 7970  gContract", "typ
+000034a0: 6522 3a20 2261 6464 7265 7373 227d 0a20  e": "address"}. 
+000034b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034c0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+000034d0: 2020 2020 2020 2020 2020 2250 6572 736f            "Perso
+000034e0: 6e22 3a20 5b0a 2020 2020 2020 2020 2020  n": [.          
+000034f0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00003500: 6e61 6d65 223a 2022 6e61 6d65 222c 2022  name": "name", "
+00003510: 7479 7065 223a 2022 7374 7269 6e67 227d  type": "string"}
+00003520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003530: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+00003540: 223a 2022 7761 6c6c 6574 222c 2022 7479  ": "wallet", "ty
+00003550: 7065 223a 2022 6164 6472 6573 7322 7d0a  pe": "address"}.
+00003560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003570: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+00003580: 2020 2020 2020 2020 2020 2022 4d61 696c             "Mail
+00003590: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+000035a0: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
+000035b0: 616d 6522 3a20 2266 726f 6d22 2c20 2274  ame": "from", "t
+000035c0: 7970 6522 3a20 2250 6572 736f 6e22 7d2c  ype": "Person"},
+000035d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000035e0: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+000035f0: 3a20 2274 6f22 2c20 2274 7970 6522 3a20  : "to", "type": 
+00003600: 2250 6572 736f 6e5b 325d 227d 2c0a 2020  "Person[2]"},.  
+00003610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003620: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
+00003630: 636f 6e74 656e 7473 222c 2022 7479 7065  contents", "type
+00003640: 223a 2022 7374 7269 6e67 227d 0a20 2020  ": "string"}.   
+00003650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003660: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00003670: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00003680: 2020 2020 2020 2270 7269 6d61 7279 5479        "primaryTy
+00003690: 7065 223a 2022 4d61 696c 222c 0a20 2020  pe": "Mail",.   
+000036a0: 2020 2020 2020 2020 2020 2020 2022 646f               "do
+000036b0: 6d61 696e 223a 207b 0a20 2020 2020 2020  main": {.       
+000036c0: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+000036d0: 6d65 223a 2022 4574 6865 7220 4d61 696c  me": "Ether Mail
+000036e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000036f0: 2020 2020 2020 2022 7665 7273 696f 6e22         "version"
+00003700: 3a20 2231 222c 0a20 2020 2020 2020 2020  : "1",.         
+00003710: 2020 2020 2020 2020 2020 2022 6368 6169             "chai
+00003720: 6e49 6422 3a20 2230 7830 3122 2c0a 2020  nId": "0x01",.  
+00003730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003740: 2020 2276 6572 6966 7969 6e67 436f 6e74    "verifyingCont
+00003750: 7261 6374 223a 2022 3078 4363 4343 6363  ract": "0xCcCCcc
+00003760: 6363 4343 4343 6343 4343 4343 4363 4363  ccCCCCcCCCCCCcCc
+00003770: 4363 6343 6343 4343 6343 6363 6363 6363  CccCcCCCcCcccccc
+00003780: 6343 220a 2020 2020 2020 2020 2020 2020  cC".            
+00003790: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+000037a0: 2020 2020 2020 2022 6d65 7373 6167 6522         "message"
+000037b0: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
+000037c0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
+000037d0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000037e0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+000037f0: 3a20 2243 6f77 222c 0a20 2020 2020 2020  : "Cow",.       
+00003800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003810: 2022 7761 6c6c 6574 223a 2022 3078 4344   "wallet": "0xCD
+00003820: 3261 3364 3946 3933 3845 3133 4344 3934  2a3d9F938E13CD94
+00003830: 3745 6330 3541 6243 3746 4537 3334 4466  7Ec05AbC7FE734Df
+00003840: 3844 4438 3236 220a 2020 2020 2020 2020  8DD826".        
+00003850: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00003860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003870: 2020 2022 746f 223a 205b 7b0a 2020 2020     "to": [{.    
+00003880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003890: 2020 2020 226e 616d 6522 3a20 2242 6f62      "name": "Bob
+000038a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000038b0: 2020 2020 2020 2020 2020 2022 7761 6c6c             "wall
+000038c0: 6574 223a 2022 3078 6242 6242 4242 4262  et": "0xbBbBBBBb
+000038d0: 6242 4242 6262 6242 6262 4262 6262 6242  bBBBbbbBbbBbbbbB
+000038e0: 4262 4262 6262 6242 6242 6262 4242 6242  BbBbbbbBbBbbBBbB
+000038f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00003900: 2020 2020 2020 7d5d 2c0a 2020 2020 2020        }],.      
+00003910: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00003920: 6f6e 7465 6e74 7322 3a20 2248 656c 6c6f  ontents": "Hello
+00003930: 2c20 426f 6221 220a 2020 2020 2020 2020  , Bob!".        
+00003940: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00003950: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00003960: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
+00003970: 2070 7974 6573 742e 7261 6973 6573 280a   pytest.raises(.
+00003980: 2020 2020 2020 2020 2020 2020 5765 6233              Web3
+00003990: 5661 6c75 6545 7272 6f72 2c0a 2020 2020  ValueError,.    
+000039a0: 2020 2020 2020 2020 6d61 7463 683d 7222          match=r"
+000039b0: 2e2a 4578 7065 6374 6564 2032 2069 7465  .*Expected 2 ite
+000039c0: 6d73 2066 6f72 2061 7272 6179 2074 7970  ms for array typ
+000039d0: 6520 5065 7273 6f6e 5c5b 325c 5d2c 2067  e Person\[2\], g
+000039e0: 6f74 2031 2069 7465 6d73 2e2a 222c 0a20  ot 1 items.*",. 
+000039f0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00003a00: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+00003a10: 635f 7733 2e65 7468 2e73 6967 6e5f 7479  c_w3.eth.sign_ty
+00003a20: 7065 645f 6461 7461 280a 2020 2020 2020  ped_data(.      
+00003a30: 2020 2020 2020 2020 2020 6173 796e 635f            async_
+00003a40: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00003a50: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00003a60: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00003a70: 2020 206a 736f 6e2e 6c6f 6164 7328 696e     json.loads(in
+00003a80: 7661 6c69 645f 7479 7065 645f 6d65 7373  valid_typed_mess
+00003a90: 6167 6529 2c0a 2020 2020 2020 2020 2020  age),.          
+00003aa0: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+00003ab0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00003ac0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00003ad0: 5f61 7379 6e63 5f65 7468 5f73 6967 6e5f  _async_eth_sign_
+00003ae0: 7472 616e 7361 6374 696f 6e5f 6c65 6761  transaction_lega
+00003af0: 6379 280a 2020 2020 2020 2020 7365 6c66  cy(.        self
+00003b00: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+00003b10: 6e63 5765 6233 222c 2061 7379 6e63 5f6b  ncWeb3", async_k
+00003b20: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00003b30: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
+00003b40: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00003b50: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00003b60: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00003b70: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00003b80: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+00003b90: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
+00003ba0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00003bb0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
+00003bc0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00003bd0: 6e74 5f61 6464 7265 7373 2c0a 2020 2020  nt_address,.    
+00003be0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00003bf0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00003c00: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00003c10: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00003c20: 6761 7350 7269 6365 223a 2061 7761 6974  gasPrice": await
+00003c30: 2061 7379 6e63 5f77 332e 6574 682e 6761   async_w3.eth.ga
+00003c40: 735f 7072 6963 652c 0a20 2020 2020 2020  s_price,.       
+00003c50: 2020 2020 2022 6e6f 6e63 6522 3a20 4e6f       "nonce": No
+00003c60: 6e63 6528 3029 2c0a 2020 2020 2020 2020  nce(0),.        
+00003c70: 7d0a 2020 2020 2020 2020 7265 7375 6c74  }.        result
+00003c80: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00003c90: 332e 6574 682e 7369 676e 5f74 7261 6e73  3.eth.sign_trans
+00003ca0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00003cb0: 7329 0a20 2020 2020 2020 2073 6967 6e61  s).        signa
+00003cc0: 746f 7279 5f61 6363 6f75 6e74 203d 2061  tory_account = a
+00003cd0: 7379 6e63 5f77 332e 6574 682e 6163 636f  sync_w3.eth.acco
+00003ce0: 756e 742e 7265 636f 7665 725f 7472 616e  unt.recover_tran
+00003cf0: 7361 6374 696f 6e28 7265 7375 6c74 5b22  saction(result["
+00003d00: 7261 7722 5d29 0a20 2020 2020 2020 2061  raw"]).        a
+00003d10: 7373 6572 7420 6173 796e 635f 6b65 7966  ssert async_keyf
+00003d20: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00003d30: 6573 7320 3d3d 2073 6967 6e61 746f 7279  ess == signatory
+00003d40: 5f61 6363 6f75 6e74 0a20 2020 2020 2020  _account.       
+00003d50: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+00003d60: 7478 225d 5b22 746f 225d 203d 3d20 7478  tx"]["to"] == tx
+00003d70: 6e5f 7061 7261 6d73 5b22 746f 225d 0a20  n_params["to"]. 
+00003d80: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00003d90: 7375 6c74 5b22 7478 225d 5b22 7661 6c75  sult["tx"]["valu
+00003da0: 6522 5d20 3d3d 2074 786e 5f70 6172 616d  e"] == txn_param
+00003db0: 735b 2276 616c 7565 225d 0a20 2020 2020  s["value"].     
+00003dc0: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+00003dd0: 5b22 7478 225d 5b22 6761 7322 5d20 3d3d  ["tx"]["gas"] ==
+00003de0: 2074 786e 5f70 6172 616d 735b 2267 6173   txn_params["gas
+00003df0: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+00003e00: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
+00003e10: 6761 7350 7269 6365 225d 203d 3d20 7478  gasPrice"] == tx
+00003e20: 6e5f 7061 7261 6d73 5b22 6761 7350 7269  n_params["gasPri
+00003e30: 6365 225d 0a20 2020 2020 2020 2061 7373  ce"].        ass
+00003e40: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
+00003e50: 5b22 6e6f 6e63 6522 5d20 3d3d 2074 786e  ["nonce"] == txn
+00003e60: 5f70 6172 616d 735b 226e 6f6e 6365 225d  _params["nonce"]
+00003e70: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00003e80: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00003e90: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
+00003ea0: 796e 635f 6574 685f 7369 676e 5f74 7261  ync_eth_sign_tra
+00003eb0: 6e73 6163 7469 6f6e 5f68 6578 5f66 6565  nsaction_hex_fee
+00003ec0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00003ed0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00003ee0: 6357 6562 3322 2c20 6173 796e 635f 6b65  cWeb3", async_ke
+00003ef0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+00003f00: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
+00003f10: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+00003f20: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
+00003f30: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
+00003f40: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00003f50: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
+00003f60: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
+00003f70: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
+00003f80: 2020 2020 2020 2274 6f22 3a20 6173 796e        "to": asyn
+00003f90: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
+00003fa0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00003fb0: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+00003fc0: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+00003fd0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+00003fe0: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00003ff0: 6178 4665 6550 6572 4761 7322 3a20 6865  axFeePerGas": he
+00004000: 7828 6173 796e 635f 7733 2e74 6f5f 7765  x(async_w3.to_we
+00004010: 6928 322c 2022 6777 6569 2229 292c 0a20  i(2, "gwei")),. 
+00004020: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+00004030: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00004040: 223a 2068 6578 2861 7379 6e63 5f77 332e  ": hex(async_w3.
+00004050: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
+00004060: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+00004070: 226e 6f6e 6365 223a 204e 6f6e 6365 2830  "nonce": Nonce(0
+00004080: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+00004090: 2020 2020 2072 6573 756c 7420 3d20 6177       result = aw
+000040a0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+000040b0: 2e73 6967 6e5f 7472 616e 7361 6374 696f  .sign_transactio
+000040c0: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
+000040d0: 2020 2020 2020 7369 676e 6174 6f72 795f        signatory_
+000040e0: 6163 636f 756e 7420 3d20 6173 796e 635f  account = async_
+000040f0: 7733 2e65 7468 2e61 6363 6f75 6e74 2e72  w3.eth.account.r
+00004100: 6563 6f76 6572 5f74 7261 6e73 6163 7469  ecover_transacti
+00004110: 6f6e 2872 6573 756c 745b 2272 6177 225d  on(result["raw"]
+00004120: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00004130: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+00004140: 6363 6f75 6e74 5f61 6464 7265 7373 203d  ccount_address =
+00004150: 3d20 7369 676e 6174 6f72 795f 6163 636f  = signatory_acco
+00004160: 756e 740a 2020 2020 2020 2020 6173 7365  unt.        asse
+00004170: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+00004180: 2274 6f22 5d20 3d3d 2074 786e 5f70 6172  "to"] == txn_par
+00004190: 616d 735b 2274 6f22 5d0a 2020 2020 2020  ams["to"].      
+000041a0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+000041b0: 2274 7822 5d5b 2276 616c 7565 225d 203d  "tx"]["value"] =
+000041c0: 3d20 7478 6e5f 7061 7261 6d73 5b22 7661  = txn_params["va
+000041d0: 6c75 6522 5d0a 2020 2020 2020 2020 6173  lue"].        as
+000041e0: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
+000041f0: 5d5b 2267 6173 225d 203d 3d20 7478 6e5f  ]["gas"] == txn_
+00004200: 7061 7261 6d73 5b22 6761 7322 5d0a 2020  params["gas"].  
+00004210: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+00004220: 756c 745b 2274 7822 5d5b 226d 6178 4665  ult["tx"]["maxFe
+00004230: 6550 6572 4761 7322 5d20 3d3d 2069 6e74  ePerGas"] == int
+00004240: 2873 7472 2874 786e 5f70 6172 616d 735b  (str(txn_params[
+00004250: 226d 6178 4665 6550 6572 4761 7322 5d29  "maxFeePerGas"])
+00004260: 2c20 3136 290a 2020 2020 2020 2020 6173  , 16).        as
+00004270: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
+00004280: 5d5b 226d 6178 5072 696f 7269 7479 4665  ]["maxPriorityFe
+00004290: 6550 6572 4761 7322 5d20 3d3d 2069 6e74  ePerGas"] == int
+000042a0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+000042b0: 7228 7478 6e5f 7061 7261 6d73 5b22 6d61  r(txn_params["ma
+000042c0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+000042d0: 6173 225d 292c 2031 360a 2020 2020 2020  as"]), 16.      
+000042e0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+000042f0: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+00004300: 226e 6f6e 6365 225d 203d 3d20 7478 6e5f  "nonce"] == txn_
+00004310: 7061 7261 6d73 5b22 6e6f 6e63 6522 5d0a  params["nonce"].
+00004320: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00004330: 6b2e 6173 796e 6369 6f0a 2020 2020 4070  k.asyncio.    @p
+00004340: 7974 6573 742e 6d61 726b 2e78 6661 696c  ytest.mark.xfail
+00004350: 280a 2020 2020 2020 2020 7265 6173 6f6e  (.        reason
+00004360: 3d22 6173 796e 6320 6e61 6d65 5f74 6f5f  ="async name_to_
+00004370: 6164 6472 6573 735f 6d69 6464 6c65 7761  address_middlewa
+00004380: 7265 2068 6173 206e 6f74 2062 6565 6e20  re has not been 
+00004390: 696d 706c 656d 656e 7465 6420 7965 7422  implemented yet"
+000043a0: 0a20 2020 2029 0a20 2020 2061 7379 6e63  .    ).    async
+000043b0: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
+000043c0: 6574 685f 7369 676e 5f74 7261 6e73 6163  eth_sign_transac
+000043d0: 7469 6f6e 5f65 6e73 5f6e 616d 6573 280a  tion_ens_names(.
+000043e0: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+000043f0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00004400: 6233 222c 2061 7379 6e63 5f6b 6579 6669  b3", async_keyfi
+00004410: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00004420: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
+00004430: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+00004440: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
+00004450: 656e 735f 6164 6472 6573 7365 7328 0a20  ens_addresses(. 
+00004460: 2020 2020 2020 2020 2020 2061 7379 6e63             async
+00004470: 5f77 332c 207b 2275 6e6c 6f63 6b65 642d  _w3, {"unlocked-
+00004480: 6163 636f 756e 742e 6574 6822 3a20 6173  account.eth": as
+00004490: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+000044a0: 756e 745f 6164 6472 6573 737d 0a20 2020  unt_address}.   
+000044b0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+000044c0: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+000044d0: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+000044e0: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
+000044f0: 6f6d 223a 2022 756e 6c6f 636b 6564 2d61  om": "unlocked-a
+00004500: 6363 6f75 6e74 2e65 7468 222c 0a20 2020  ccount.eth",.   
+00004510: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+00004520: 223a 2022 756e 6c6f 636b 6564 2d61 6363  ": "unlocked-acc
+00004530: 6f75 6e74 2e65 7468 222c 0a20 2020 2020  ount.eth",.     
+00004540: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00004550: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00004560: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00004570: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00004580: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00004590: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+000045a0: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+000045b0: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
+000045c0: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+000045d0: 7479 4665 6550 6572 4761 7322 3a20 6173  tyFeePerGas": as
+000045e0: 796e 635f 7733 2e74 6f5f 7765 6928 312c  ync_w3.to_wei(1,
+000045f0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00004600: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
+00004610: 223a 204e 6f6e 6365 2830 292c 0a20 2020  ": Nonce(0),.   
+00004620: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00004630: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00004640: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00004650: 7468 2e73 6967 6e5f 7472 616e 7361 6374  th.sign_transact
+00004660: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+00004670: 2020 2020 2020 2020 2020 2020 7369 676e              sign
+00004680: 6174 6f72 795f 6163 636f 756e 7420 3d20  atory_account = 
+00004690: 6173 796e 635f 7733 2e65 7468 2e61 6363  async_w3.eth.acc
+000046a0: 6f75 6e74 2e72 6563 6f76 6572 5f74 7261  ount.recover_tra
+000046b0: 6e73 6163 7469 6f6e 2872 6573 756c 745b  nsaction(result[
+000046c0: 2272 6177 225d 290a 2020 2020 2020 2020  "raw"]).        
+000046d0: 2020 2020 6173 7365 7274 2061 7379 6e63      assert async
+000046e0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
+000046f0: 5f61 6464 7265 7373 203d 3d20 7369 676e  _address == sign
+00004700: 6174 6f72 795f 6163 636f 756e 740a 2020  atory_account.  
+00004710: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00004720: 2072 6573 756c 745b 2274 7822 5d5b 2274   result["tx"]["t
+00004730: 6f22 5d20 3d3d 2061 7379 6e63 5f6b 6579  o"] == async_key
+00004740: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00004750: 7265 7373 0a20 2020 2020 2020 2020 2020  ress.           
+00004760: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+00004770: 7478 225d 5b22 7661 6c75 6522 5d20 3d3d  tx"]["value"] ==
+00004780: 2074 786e 5f70 6172 616d 735b 2276 616c   txn_params["val
+00004790: 7565 225d 0a20 2020 2020 2020 2020 2020  ue"].           
+000047a0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+000047b0: 7478 225d 5b22 6761 7322 5d20 3d3d 2074  tx"]["gas"] == t
+000047c0: 786e 5f70 6172 616d 735b 2267 6173 225d  xn_params["gas"]
+000047d0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+000047e0: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
+000047f0: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+00004800: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
+00004810: 6d61 7846 6565 5065 7247 6173 225d 0a20  maxFeePerGas"]. 
+00004820: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00004830: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
+00004840: 2020 2020 7265 7375 6c74 5b22 7478 225d      result["tx"]
+00004850: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
+00004860: 5065 7247 6173 225d 0a20 2020 2020 2020  PerGas"].       
+00004870: 2020 2020 2020 2020 203d 3d20 7478 6e5f           == txn_
+00004880: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
+00004890: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+000048a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000048b0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000048c0: 7265 7375 6c74 5b22 7478 225d 5b22 6e6f  result["tx"]["no
+000048d0: 6e63 6522 5d20 3d3d 2074 786e 5f70 6172  nce"] == txn_par
+000048e0: 616d 735b 226e 6f6e 6365 225d 0a0a 2020  ams["nonce"]..  
+000048f0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00004900: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00004910: 2064 6566 2074 6573 745f 6574 685f 7365   def test_eth_se
+00004920: 6e64 5f74 7261 6e73 6163 7469 6f6e 280a  nd_transaction(.
+00004930: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00004940: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+00004950: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+00004960: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
+00004970: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00004980: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
+00004990: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+000049a0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+000049b0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+000049c0: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+000049d0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+000049e0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
+000049f0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00004a00: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00004a10: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
+00004a20: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+00004a30: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+00004a40: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00004a50: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00004a60: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00004a70: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00004a80: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+00004a90: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+00004aa0: 7733 2e74 6f5f 7765 6928 332c 2022 6777  w3.to_wei(3, "gw
+00004ab0: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
+00004ac0: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
+00004ad0: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
+00004ae0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
+00004af0: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
+00004b00: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00004b10: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00004b20: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00004b30: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00004b40: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+00004b50: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00004b60: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+00004b70: 696f 6e28 7478 6e5f 6861 7368 290a 0a20  ion(txn_hash).. 
+00004b80: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00004b90: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
+00004ba0: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
+00004bb0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00004bc0: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
+00004bd0: 6d22 5d29 290a 2020 2020 2020 2020 6173  m"])).        as
+00004be0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00004bf0: 7265 7373 2874 786e 5b22 746f 225d 2c20  ress(txn["to"], 
+00004c00: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+00004c10: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+00004c20: 5b22 746f 225d 2929 0a20 2020 2020 2020  ["to"])).       
+00004c30: 2061 7373 6572 7420 7478 6e5b 2276 616c   assert txn["val
+00004c40: 7565 225d 203d 3d20 310a 2020 2020 2020  ue"] == 1.      
+00004c50: 2020 6173 7365 7274 2074 786e 5b22 6761    assert txn["ga
+00004c60: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
+00004c70: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+00004c80: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
+00004c90: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
+00004ca0: 6178 4665 6550 6572 4761 7322 5d0a 2020  axFeePerGas"].  
+00004cb0: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+00004cc0: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
+00004cd0: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
+00004ce0: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
+00004cf0: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+00004d00: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+00004d10: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
+00004d20: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00004d30: 4665 6550 6572 4761 7322 5d0a 0a20 2020  FeePerGas"]..   
+00004d40: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00004d50: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00004d60: 6465 6620 7465 7374 5f65 7468 5f73 656e  def test_eth_sen
+00004d70: 645f 7472 616e 7361 6374 696f 6e5f 6465  d_transaction_de
+00004d80: 6661 756c 745f 6665 6573 280a 2020 2020  fault_fees(.    
+00004d90: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00004da0: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
+00004db0: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
+00004dc0: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+00004dd0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+00004de0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+00004df0: 756d 4164 6472 6573 732c 0a20 2020 2029  umAddress,.    )
+00004e00: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00004e10: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00004e20: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00004e30: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
+00004e40: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00004e50: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00004e60: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00004e70: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
+00004e80: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00004e90: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00004ea0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00004eb0: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+00004ec0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00004ed0: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+00004ee0: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+00004ef0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+00004f00: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+00004f10: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00004f20: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+00004f30: 786e 203d 2061 7761 6974 2061 7379 6e63  xn = await async
+00004f40: 5f77 332e 6574 682e 6765 745f 7472 616e  _w3.eth.get_tran
+00004f50: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+00004f60: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00004f70: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+00004f80: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+00004f90: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+00004fa0: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+00004fb0: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+00004fc0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00004fd0: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+00004fe0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+00004ff0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+00005000: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+00005010: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+00005020: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+00005030: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+00005040: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
+00005050: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00005060: 6973 5f69 6e74 6567 6572 2874 786e 5b22  is_integer(txn["
+00005070: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00005080: 7247 6173 225d 290a 2020 2020 2020 2020  rGas"]).        
+00005090: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+000050a0: 7228 7478 6e5b 226d 6178 4665 6550 6572  r(txn["maxFeePer
+000050b0: 4761 7322 5d29 0a20 2020 2020 2020 2061  Gas"]).        a
+000050c0: 7373 6572 7420 7478 6e5b 2267 6173 5072  ssert txn["gasPr
+000050d0: 6963 6522 5d20 3d3d 2074 786e 5b22 6d61  ice"] == txn["ma
+000050e0: 7846 6565 5065 7247 6173 225d 0a0a 2020  xFeePerGas"]..  
+000050f0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00005100: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00005110: 2064 6566 2074 6573 745f 6574 685f 7365   def test_eth_se
+00005120: 6e64 5f74 7261 6e73 6163 7469 6f6e 5f68  nd_transaction_h
+00005130: 6578 5f66 6565 7328 0a20 2020 2020 2020  ex_fees(.       
+00005140: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00005150: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00005160: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
+00005170: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+00005180: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+00005190: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+000051a0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
+000051b0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+000051c0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+000051d0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+000051e0: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
+000051f0: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
+00005200: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+00005210: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00005220: 2022 746f 223a 2061 7379 6e63 5f6b 6579   "to": async_key
+00005230: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00005240: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+00005250: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+00005260: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+00005270: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+00005280: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+00005290: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+000052a0: 223a 2068 6578 2832 3530 202a 2031 302a  ": hex(250 * 10*
+000052b0: 2a39 292c 0a20 2020 2020 2020 2020 2020  *9),.           
+000052c0: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
+000052d0: 5065 7247 6173 223a 2068 6578 2832 202a  PerGas": hex(2 *
+000052e0: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
+000052f0: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+00005300: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
+00005310: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
+00005320: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
+00005330: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
+00005340: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
+00005350: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
+00005360: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
+00005370: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00005380: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+00005390: 2874 786e 5b22 6672 6f6d 225d 2c20 6361  (txn["from"], ca
+000053a0: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
+000053b0: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
+000053c0: 6672 6f6d 225d 2929 0a20 2020 2020 2020  from"])).       
+000053d0: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
+000053e0: 6164 6472 6573 7328 7478 6e5b 2274 6f22  address(txn["to"
+000053f0: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
+00005400: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
+00005410: 616d 735b 2274 6f22 5d29 290a 2020 2020  ams["to"])).    
+00005420: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
+00005430: 7661 6c75 6522 5d20 3d3d 2031 0a20 2020  value"] == 1.   
+00005440: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+00005450: 2267 6173 225d 203d 3d20 3231 3030 300a  "gas"] == 21000.
+00005460: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+00005470: 786e 5b22 6d61 7846 6565 5065 7247 6173  xn["maxFeePerGas
+00005480: 225d 203d 3d20 3235 3020 2a20 3130 2a2a  "] == 250 * 10**
+00005490: 390a 2020 2020 2020 2020 6173 7365 7274  9.        assert
+000054a0: 2074 786e 5b22 6d61 7850 7269 6f72 6974   txn["maxPriorit
+000054b0: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
+000054c0: 3220 2a20 3130 2a2a 390a 0a20 2020 2040  2 * 10**9..    @
+000054d0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+000054e0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+000054f0: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
+00005500: 7472 616e 7361 6374 696f 6e5f 6e6f 5f67  transaction_no_g
+00005510: 6173 280a 2020 2020 2020 2020 7365 6c66  as(.        self
+00005520: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+00005530: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00005540: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+00005550: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00005560: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00005570: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00005580: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+00005590: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+000055a0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+000055b0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+000055c0: 6672 6f6d 223a 2061 7379 6e63 5f6b 6579  from": async_key
+000055d0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+000055e0: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+000055f0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00005600: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
+00005610: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00005620: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00005630: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+00005640: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+00005650: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00005660: 7322 3a20 5765 6928 3235 3020 2a20 3130  s": Wei(250 * 10
+00005670: 2a2a 3929 2c0a 2020 2020 2020 2020 2020  **9),.          
+00005680: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
+00005690: 6550 6572 4761 7322 3a20 5765 6928 3220  ePerGas": Wei(2 
+000056a0: 2a20 3130 2a2a 3929 2c0a 2020 2020 2020  * 10**9),.      
+000056b0: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+000056c0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+000056d0: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+000056e0: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+000056f0: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+00005700: 786e 203d 2061 7761 6974 2061 7379 6e63  xn = await async
+00005710: 5f77 332e 6574 682e 6765 745f 7472 616e  _w3.eth.get_tran
+00005720: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+00005730: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00005740: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+00005750: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+00005760: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+00005770: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+00005780: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+00005790: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+000057a0: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+000057b0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+000057c0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+000057d0: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+000057e0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+000057f0: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+00005800: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+00005810: 5b22 6761 7322 5d20 3d3d 2031 3231 3030  ["gas"] == 12100
+00005820: 3020 2023 2032 3130 3030 202b 2062 7566  0  # 21000 + buf
+00005830: 6665 720a 0a20 2020 2040 7079 7465 7374  fer..    @pytest
+00005840: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00005850: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00005860: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
+00005870: 6374 696f 6e5f 7769 7468 5f67 6173 5f70  ction_with_gas_p
+00005880: 7269 6365 280a 2020 2020 2020 2020 7365  rice(.        se
+00005890: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+000058a0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+000058b0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+000058c0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
+000058d0: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+000058e0: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+000058f0: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
+00005900: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00005910: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00005920: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00005930: 2022 6672 6f6d 223a 2061 7379 6e63 5f6b   "from": async_k
+00005940: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00005950: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00005960: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00005970: 6f22 3a20 6173 796e 635f 6b65 7966 696c  o": async_keyfil
+00005980: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00005990: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+000059a0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+000059b0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+000059c0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+000059d0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+000059e0: 2267 6173 5072 6963 6522 3a20 5765 6928  "gasPrice": Wei(
+000059f0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00005a00: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+00005a10: 5765 6928 3235 3020 2a20 3130 2a2a 3929  Wei(250 * 10**9)
+00005a20: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00005a30: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00005a40: 4761 7322 3a20 5765 6928 3220 2a20 3130  Gas": Wei(2 * 10
+00005a50: 2a2a 3929 2c0a 2020 2020 2020 2020 7d0a  **9),.        }.
+00005a60: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00005a70: 6573 742e 7261 6973 6573 2854 7261 6e73  est.raises(Trans
+00005a80: 6163 7469 6f6e 5479 7065 4d69 736d 6174  actionTypeMismat
+00005a90: 6368 293a 0a20 2020 2020 2020 2020 2020  ch):.           
+00005aa0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00005ab0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+00005ac0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+00005ad0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00005ae0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00005af0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+00005b00: 685f 7365 6e64 5f74 7261 6e73 6163 7469  h_send_transacti
+00005b10: 6f6e 5f6e 6f5f 7072 696f 7269 7479 5f66  on_no_priority_f
+00005b20: 6565 280a 2020 2020 2020 2020 7365 6c66  ee(.        self
+00005b30: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+00005b40: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00005b50: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+00005b60: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00005b70: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00005b80: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00005b90: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+00005ba0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00005bb0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00005bc0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00005bd0: 6672 6f6d 223a 2061 7379 6e63 5f6b 6579  from": async_key
+00005be0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00005bf0: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+00005c00: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00005c10: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
+00005c20: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00005c30: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00005c40: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+00005c50: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+00005c60: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+00005c70: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00005c80: 6178 4665 6550 6572 4761 7322 3a20 5765  axFeePerGas": We
+00005c90: 6928 3235 3020 2a20 3130 2a2a 3929 2c0a  i(250 * 10**9),.
+00005ca0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00005cb0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00005cc0: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
+00005cd0: 2020 496e 7661 6c69 6454 7261 6e73 6163    InvalidTransac
+00005ce0: 7469 6f6e 2c20 6d61 7463 683d 226d 6178  tion, match="max
+00005cf0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00005d00: 7320 6d75 7374 2062 6520 6465 6669 6e65  s must be define
+00005d10: 6422 0a20 2020 2020 2020 2029 3a0a 2020  d".        ):.  
+00005d20: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+00005d30: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
+00005d40: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00005d50: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
+00005d60: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00005d70: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00005d80: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
+00005d90: 7472 616e 7361 6374 696f 6e5f 6e6f 5f6d  transaction_no_m
+00005da0: 6178 5f66 6565 280a 2020 2020 2020 2020  ax_fee(.        
+00005db0: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+00005dc0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00005dd0: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+00005de0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00005df0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00005e00: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
+00005e10: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+00005e20: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d61  None:.        ma
+00005e30: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00005e40: 6173 203d 2061 7379 6e63 5f77 332e 746f  as = async_w3.to
+00005e50: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
+00005e60: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00005e70: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00005e80: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00005e90: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
+00005ea0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00005eb0: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00005ec0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00005ed0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00005ee0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00005ef0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00005f00: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00005f10: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00005f20: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00005f30: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00005f40: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00005f50: 7322 3a20 6d61 7850 7269 6f72 6974 7946  s": maxPriorityF
+00005f60: 6565 5065 7247 6173 2c0a 2020 2020 2020  eePerGas,.      
+00005f70: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+00005f80: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+00005f90: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
+00005fa0: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00005fb0: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+00005fc0: 786e 203d 2061 7761 6974 2061 7379 6e63  xn = await async
+00005fd0: 5f77 332e 6574 682e 6765 745f 7472 616e  _w3.eth.get_tran
+00005fe0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+00005ff0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00006000: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+00006010: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+00006020: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+00006030: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+00006040: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+00006050: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00006060: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+00006070: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+00006080: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+00006090: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+000060a0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+000060b0: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+000060c0: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+000060d0: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
+000060e0: 0a0a 2020 2020 2020 2020 626c 6f63 6b20  ..        block 
+000060f0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00006100: 2e65 7468 2e67 6574 5f62 6c6f 636b 2822  .eth.get_block("
+00006110: 6c61 7465 7374 2229 0a20 2020 2020 2020  latest").       
+00006120: 2061 7373 6572 7420 7478 6e5b 226d 6178   assert txn["max
+00006130: 4665 6550 6572 4761 7322 5d20 3d3d 206d  FeePerGas"] == m
+00006140: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00006150: 4761 7320 2b20 3220 2a20 626c 6f63 6b5b  Gas + 2 * block[
+00006160: 2262 6173 6546 6565 5065 7247 6173 225d  "baseFeePerGas"]
+00006170: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00006180: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00006190: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+000061a0: 685f 7365 6e64 5f74 7261 6e73 6163 7469  h_send_transacti
+000061b0: 6f6e 5f6d 6178 5f66 6565 5f6c 6573 735f  on_max_fee_less_
+000061c0: 7468 616e 5f74 6970 280a 2020 2020 2020  than_tip(.      
+000061d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000061e0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+000061f0: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+00006200: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00006210: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00006220: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00006230: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
+00006240: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00006250: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+00006260: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00006270: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+00006280: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00006290: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+000062a0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000062b0: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
+000062c0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+000062d0: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+000062e0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+000062f0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+00006300: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00006310: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00006320: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00006330: 7322 3a20 5765 6928 3120 2a20 3130 2a2a  s": Wei(1 * 10**
+00006340: 3929 2c0a 2020 2020 2020 2020 2020 2020  9),.            
+00006350: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00006360: 6572 4761 7322 3a20 5765 6928 3220 2a20  erGas": Wei(2 * 
+00006370: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
+00006380: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+00006390: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+000063a0: 2020 2020 2020 2020 2020 496e 7661 6c69            Invali
+000063b0: 6454 7261 6e73 6163 7469 6f6e 2c20 6d61  dTransaction, ma
+000063c0: 7463 683d 226d 6178 4665 6550 6572 4761  tch="maxFeePerGa
+000063d0: 7320 6d75 7374 2062 6520 3e3d 206d 6178  s must be >= max
+000063e0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+000063f0: 7322 0a20 2020 2020 2020 2029 3a0a 2020  s".        ):.  
+00006400: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+00006410: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
+00006420: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00006430: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
+00006440: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00006450: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00006460: 6620 7465 7374 5f76 616c 6964 6174 696f  f test_validatio
+00006470: 6e5f 6d69 6464 6c65 7761 7265 5f63 6861  n_middleware_cha
+00006480: 696e 5f69 645f 6d69 736d 6174 6368 280a  in_id_mismatch(.
+00006490: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000064a0: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+000064b0: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+000064c0: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
+000064d0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+000064e0: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
+000064f0: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+00006500: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00006510: 2020 2020 2020 7772 6f6e 675f 6368 6169        wrong_chai
+00006520: 6e5f 6964 203d 2031 3233 3435 3637 3839  n_id = 123456789
+00006530: 300a 2020 2020 2020 2020 6163 7475 616c  0.        actual
+00006540: 5f63 6861 696e 5f69 6420 3d20 6177 6169  _chain_id = awai
+00006550: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+00006560: 6861 696e 5f69 640a 0a20 2020 2020 2020  hain_id..       
+00006570: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
+00006580: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00006590: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
+000065a0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+000065b0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+000065c0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+000065d0: 2020 2022 746f 223a 2061 7379 6e63 5f6b     "to": async_k
+000065e0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+000065f0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00006600: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+00006610: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+00006620: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+00006630: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+00006640: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
+00006650: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
+00006660: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
+00006670: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+00006680: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00006690: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
+000066a0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+000066b0: 0a20 2020 2020 2020 2020 2020 2022 6368  .            "ch
+000066c0: 6169 6e49 6422 3a20 7772 6f6e 675f 6368  ainId": wrong_ch
+000066d0: 6169 6e5f 6964 2c0a 2020 2020 2020 2020  ain_id,.        
+000066e0: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+000066f0: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+00006700: 2020 2020 2020 2020 2020 5765 6233 5661            Web3Va
+00006710: 6c69 6461 7469 6f6e 4572 726f 722c 0a20  lidationError,. 
+00006720: 2020 2020 2020 2020 2020 206d 6174 6368             match
+00006730: 3d66 2254 6865 2074 7261 6e73 6163 7469  =f"The transacti
+00006740: 6f6e 2064 6563 6c61 7265 6420 6368 6169  on declared chai
+00006750: 6e20 4944 207b 7772 6f6e 675f 6368 6169  n ID {wrong_chai
+00006760: 6e5f 6964 7d2c 2022 0a20 2020 2020 2020  n_id}, ".       
+00006770: 2020 2020 2066 2262 7574 2074 6865 2063       f"but the c
+00006780: 6f6e 6e65 6374 6564 206e 6f64 6520 6973  onnected node is
+00006790: 206f 6e20 7b61 6374 7561 6c5f 6368 6169   on {actual_chai
+000067a0: 6e5f 6964 7d22 2c0a 2020 2020 2020 2020  n_id}",.        
+000067b0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+000067c0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000067d0: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
+000067e0: 6f6e 2874 786e 5f70 6172 616d 7329 0a0a  on(txn_params)..
+000067f0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00006800: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00006810: 6e63 2064 6566 2074 6573 745f 4578 7472  nc def test_Extr
+00006820: 6144 6174 6154 6f50 4f41 4d69 6464 6c65  aDataToPOAMiddle
+00006830: 7761 7265 280a 2020 2020 2020 2020 7365  ware(.        se
+00006840: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00006850: 7379 6e63 5765 6233 222c 2072 6571 7565  syncWeb3", reque
+00006860: 7374 5f6d 6f63 6b65 723a 2054 7970 655b  st_mocker: Type[
+00006870: 5265 7175 6573 744d 6f63 6b65 725d 0a20  RequestMocker]. 
+00006880: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00006890: 2020 2020 2020 6173 796e 635f 7733 2e6d        async_w3.m
+000068a0: 6964 646c 6577 6172 655f 6f6e 696f 6e2e  iddleware_onion.
+000068b0: 696e 6a65 6374 2845 7874 7261 4461 7461  inject(ExtraData
+000068c0: 546f 504f 414d 6964 646c 6577 6172 652c  ToPOAMiddleware,
+000068d0: 2022 706f 6122 2c20 6c61 7965 723d 3029   "poa", layer=0)
+000068e0: 0a20 2020 2020 2020 2065 7874 7261 5f64  .        extra_d
+000068f0: 6174 6120 3d20 6622 3078 7b27 6666 2720  ata = f"0x{'ff' 
+00006900: 2a20 3333 7d22 0a0a 2020 2020 2020 2020  * 33}"..        
+00006910: 6173 796e 6320 7769 7468 2072 6571 7565  async with reque
+00006920: 7374 5f6d 6f63 6b65 7228 0a20 2020 2020  st_mocker(.     
+00006930: 2020 2020 2020 2061 7379 6e63 5f77 332c         async_w3,
+00006940: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00006950: 6b5f 7265 7375 6c74 733d 7b22 6574 685f  k_results={"eth_
+00006960: 6765 7442 6c6f 636b 4279 4e75 6d62 6572  getBlockByNumber
+00006970: 223a 207b 2265 7874 7261 4461 7461 223a  ": {"extraData":
+00006980: 2065 7874 7261 5f64 6174 617d 7d2c 0a20   extra_data}},. 
+00006990: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+000069a0: 2020 2020 2020 626c 6f63 6b20 3d20 6177        block = aw
+000069b0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+000069c0: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
+000069d0: 7374 2229 0a0a 2020 2020 2020 2020 6173  st")..        as
+000069e0: 7365 7274 2022 6578 7472 6144 6174 6122  sert "extraData"
+000069f0: 206e 6f74 2069 6e20 626c 6f63 6b0a 2020   not in block.  
+00006a00: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+00006a10: 636b 5b22 7072 6f6f 664f 6641 7574 686f  ck["proofOfAutho
+00006a20: 7269 7479 4461 7461 225d 203d 3d20 746f  rityData"] == to
+00006a30: 5f62 7974 6573 2868 6578 7374 723d 6578  _bytes(hexstr=ex
+00006a40: 7472 615f 6461 7461 290a 0a20 2020 2020  tra_data)..     
+00006a50: 2020 2023 2063 6c65 616e 2075 700a 2020     # clean up.  
+00006a60: 2020 2020 2020 6173 796e 635f 7733 2e6d        async_w3.m
+00006a70: 6964 646c 6577 6172 655f 6f6e 696f 6e2e  iddleware_onion.
+00006a80: 7265 6d6f 7665 2822 706f 6122 290a 0a20  remove("poa").. 
+00006a90: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00006aa0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+00006ab0: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
+00006ac0: 5f65 7468 5f73 656e 645f 7261 775f 7472  _eth_send_raw_tr
+00006ad0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00006ae0: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
+00006af0: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
+00006b00: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00006b10: 706b 6579 3a20 4865 7853 7472 0a20 2020  pkey: HexStr.   
+00006b20: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00006b30: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
+00006b40: 756e 7420 3d20 6173 796e 635f 7733 2e65  unt = async_w3.e
+00006b50: 7468 2e61 6363 6f75 6e74 2e66 726f 6d5f  th.account.from_
+00006b60: 6b65 7928 6b65 7966 696c 655f 6163 636f  key(keyfile_acco
+00006b70: 756e 745f 706b 6579 290a 2020 2020 2020  unt_pkey).      
+00006b80: 2020 7478 6e20 3d20 7b0a 2020 2020 2020    txn = {.      
+00006b90: 2020 2020 2020 2263 6861 696e 4964 223a        "chainId":
+00006ba0: 2031 3331 3237 3733 3232 3934 3035 3337   131277322940537
+00006bb0: 2c20 2023 2074 6865 2063 6861 696e 4964  ,  # the chainId
+00006bc0: 2073 6574 2066 6f72 2074 6865 2066 6978   set for the fix
+00006bd0: 7475 7265 0a20 2020 2020 2020 2020 2020  ture.           
+00006be0: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
+00006bf0: 5f61 6363 6f75 6e74 2e61 6464 7265 7373  _account.address
+00006c00: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00006c10: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
+00006c20: 756e 742e 6164 6472 6573 732c 0a20 2020  unt.address,.   
+00006c30: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+00006c40: 3a20 5765 6928 3029 2c0a 2020 2020 2020  : Wei(0),.      
+00006c50: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+00006c60: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+00006c70: 226e 6f6e 6365 223a 2061 7761 6974 2061  "nonce": await a
+00006c80: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00006c90: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+00006ca0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00006cb0: 2020 206b 6579 6669 6c65 5f61 6363 6f75     keyfile_accou
+00006cc0: 6e74 2e61 6464 7265 7373 2c20 2270 656e  nt.address, "pen
+00006cd0: 6469 6e67 220a 2020 2020 2020 2020 2020  ding".          
+00006ce0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00006cf0: 2022 6761 7350 7269 6365 223a 2031 302a   "gasPrice": 10*
+00006d00: 2a39 2c0a 2020 2020 2020 2020 7d0a 2020  *9,.        }.  
+00006d10: 2020 2020 2020 7369 676e 6564 203d 206b        signed = k
+00006d20: 6579 6669 6c65 5f61 6363 6f75 6e74 2e73  eyfile_account.s
+00006d30: 6967 6e5f 7472 616e 7361 6374 696f 6e28  ign_transaction(
+00006d40: 7478 6e29 0a20 2020 2020 2020 2074 786e  txn).        txn
+00006d50: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
+00006d60: 796e 635f 7733 2e65 7468 2e73 656e 645f  ync_w3.eth.send_
+00006d70: 7261 775f 7472 616e 7361 6374 696f 6e28  raw_transaction(
+00006d80: 7369 676e 6564 2e72 6177 5f74 7261 6e73  signed.raw_trans
+00006d90: 6163 7469 6f6e 290a 2020 2020 2020 2020  action).        
+00006da0: 6173 7365 7274 2074 786e 5f68 6173 6820  assert txn_hash 
+00006db0: 3d3d 2048 6578 4279 7465 7328 7369 676e  == HexBytes(sign
+00006dc0: 6564 2e68 6173 6829 0a0a 2020 2020 4070  ed.hash)..    @p
+00006dd0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00006de0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00006df0: 2074 6573 745f 4761 7350 7269 6365 5374   test_GasPriceSt
+00006e00: 7261 7465 6779 4d69 6464 6c65 7761 7265  rategyMiddleware
+00006e10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00006e20: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+00006e30: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+00006e40: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+00006e50: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00006e60: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+00006e70: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00006e80: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00006e90: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00006ea0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00006eb0: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00006ec0: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
+00006ed0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00006ee0: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00006ef0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00006f00: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00006f10: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00006f20: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00006f30: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00006f40: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00006f50: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00006f60: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00006f70: 2020 7477 6f5f 6777 6569 5f69 6e5f 7765    two_gwei_in_we
+00006f80: 6920 3d20 6173 796e 635f 7733 2e74 6f5f  i = async_w3.to_
+00006f90: 7765 6928 322c 2022 6777 6569 2229 0a0a  wei(2, "gwei")..
+00006fa0: 2020 2020 2020 2020 6465 6620 6761 735f          def gas_
+00006fb0: 7072 6963 655f 7374 7261 7465 6779 2877  price_strategy(w
+00006fc0: 333a 2022 5765 6233 222c 2074 786e 3a20  3: "Web3", txn: 
+00006fd0: 5478 5061 7261 6d73 2920 2d3e 2057 6569  TxParams) -> Wei
+00006fe0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00006ff0: 7475 726e 2074 776f 5f67 7765 695f 696e  turn two_gwei_in
+00007000: 5f77 6569 0a0a 2020 2020 2020 2020 6173  _wei..        as
+00007010: 796e 635f 7733 2e65 7468 2e73 6574 5f67  ync_w3.eth.set_g
+00007020: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+00007030: 7928 6761 735f 7072 6963 655f 7374 7261  y(gas_price_stra
+00007040: 7465 6779 290a 0a20 2020 2020 2020 2074  tegy)..        t
+00007050: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
+00007060: 6173 796e 635f 7733 2e65 7468 2e73 656e  async_w3.eth.sen
+00007070: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00007080: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+00007090: 2020 7478 6e20 3d20 6177 6169 7420 6173    txn = await as
+000070a0: 796e 635f 7733 2e65 7468 2e67 6574 5f74  ync_w3.eth.get_t
+000070b0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+000070c0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
+000070d0: 7365 7274 2074 786e 5b22 6761 7350 7269  sert txn["gasPri
+000070e0: 6365 225d 203d 3d20 7477 6f5f 6777 6569  ce"] == two_gwei
+000070f0: 5f69 6e5f 7765 690a 2020 2020 2020 2020  _in_wei.        
+00007100: 6173 796e 635f 7733 2e65 7468 2e73 6574  async_w3.eth.set
+00007110: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+00007120: 6567 7928 4e6f 6e65 2920 2023 2072 6573  egy(None)  # res
+00007130: 6574 2073 7472 6174 6567 790a 0a20 2020  et strategy..   
+00007140: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00007150: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00007160: 6465 6620 7465 7374 5f67 6173 5f70 7269  def test_gas_pri
+00007170: 6365 5f73 7472 6174 6567 795f 6d69 6464  ce_strategy_midd
+00007180: 6c65 7761 7265 5f68 6578 5f76 616c 7565  leware_hex_value
+00007190: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000071a0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+000071b0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+000071c0: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+000071d0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+000071e0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+000071f0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00007200: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00007210: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00007220: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00007230: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00007240: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
+00007250: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00007260: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00007270: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00007280: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00007290: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+000072a0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+000072b0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+000072c0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+000072d0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+000072e0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000072f0: 2020 7477 6f5f 6777 6569 5f69 6e5f 7765    two_gwei_in_we
+00007300: 6920 3d20 6173 796e 635f 7733 2e74 6f5f  i = async_w3.to_
+00007310: 7765 6928 322c 2022 6777 6569 2229 0a0a  wei(2, "gwei")..
+00007320: 2020 2020 2020 2020 6465 6620 6761 735f          def gas_
+00007330: 7072 6963 655f 7374 7261 7465 6779 285f  price_strategy(_
+00007340: 7733 3a20 2257 6562 3322 2c20 5f74 786e  w3: "Web3", _txn
+00007350: 3a20 5478 5061 7261 6d73 2920 2d3e 2073  : TxParams) -> s
+00007360: 7472 3a0a 2020 2020 2020 2020 2020 2020  tr:.            
+00007370: 7265 7475 726e 2068 6578 2874 776f 5f67  return hex(two_g
+00007380: 7765 695f 696e 5f77 6569 290a 0a20 2020  wei_in_wei)..   
+00007390: 2020 2020 2061 7379 6e63 5f77 332e 6574       async_w3.et
+000073a0: 682e 7365 745f 6761 735f 7072 6963 655f  h.set_gas_price_
+000073b0: 7374 7261 7465 6779 2867 6173 5f70 7269  strategy(gas_pri
+000073c0: 6365 5f73 7472 6174 6567 7929 2020 2320  ce_strategy)  # 
+000073d0: 7479 7065 3a20 6967 6e6f 7265 0a0a 2020  type: ignore..  
+000073e0: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
+000073f0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00007400: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+00007410: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+00007420: 0a20 2020 2020 2020 2074 786e 203d 2061  .        txn = a
+00007430: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00007440: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00007450: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
+00007460: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+00007470: 2267 6173 5072 6963 6522 5d20 3d3d 2074  "gasPrice"] == t
+00007480: 776f 5f67 7765 695f 696e 5f77 6569 0a20  wo_gwei_in_wei. 
+00007490: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
+000074a0: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
+000074b0: 655f 7374 7261 7465 6779 284e 6f6e 6529  e_strategy(None)
+000074c0: 2020 2320 7265 7365 7420 7374 7261 7465    # reset strate
+000074d0: 6779 0a0a 2020 2020 4070 7974 6573 742e  gy..    @pytest.
+000074e0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+000074f0: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
+00007500: 7261 6d65 7472 697a 6528 0a20 2020 2020  rametrize(.     
+00007510: 2020 2022 6d61 785f 6665 6522 2c20 2831     "max_fee", (1
+00007520: 3030 3030 3030 3030 302c 204e 6f6e 6529  000000000, None)
+00007530: 2c20 6964 733d 5b22 7769 7468 5f6d 6178  , ids=["with_max
+00007540: 5f66 6565 222c 2022 7769 7468 6f75 745f  _fee", "without_
+00007550: 6d61 785f 6665 6522 5d0a 2020 2020 290a  max_fee"].    ).
+00007560: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00007570: 7374 5f67 6173 5f70 7269 6365 5f66 726f  st_gas_price_fro
+00007580: 6d5f 7374 7261 7465 6779 5f62 7970 6173  m_strategy_bypas
+00007590: 7365 645f 666f 725f 6479 6e61 6d69 635f  sed_for_dynamic_
+000075a0: 6665 655f 7478 6e28 0a20 2020 2020 2020  fee_txn(.       
+000075b0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+000075c0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+000075d0: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
+000075e0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+000075f0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+00007600: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+00007610: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00007620: 6d61 785f 6665 653a 2057 6569 2c0a 2020  max_fee: Wei,.  
+00007630: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00007640: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
+00007650: 795f 6665 6520 3d20 6173 796e 635f 7733  y_fee = async_w3
+00007660: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
+00007670: 2229 0a20 2020 2020 2020 2074 786e 5f70  ").        txn_p
+00007680: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
+00007690: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000076a0: 2266 726f 6d22 3a20 6173 796e 635f 6b65  "from": async_ke
+000076b0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+000076c0: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+000076d0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+000076e0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
+000076f0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00007700: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00007710: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00007720: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00007730: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00007740: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00007750: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00007760: 7247 6173 223a 206d 6178 5f70 7269 6f72  rGas": max_prior
+00007770: 6974 795f 6665 652c 0a20 2020 2020 2020  ity_fee,.       
+00007780: 207d 0a20 2020 2020 2020 2069 6620 6d61   }.        if ma
+00007790: 785f 6665 6520 6973 206e 6f74 204e 6f6e  x_fee is not Non
+000077a0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+000077b0: 786e 5f70 6172 616d 7320 3d20 6173 736f  xn_params = asso
+000077c0: 6328 7478 6e5f 7061 7261 6d73 2c20 226d  c(txn_params, "m
+000077d0: 6178 4665 6550 6572 4761 7322 2c20 6d61  axFeePerGas", ma
+000077e0: 785f 6665 6529 0a0a 2020 2020 2020 2020  x_fee)..        
+000077f0: 6465 6620 6761 735f 7072 6963 655f 7374  def gas_price_st
+00007800: 7261 7465 6779 2877 333a 2022 5765 6233  rategy(w3: "Web3
+00007810: 222c 2074 786e 3a20 5478 5061 7261 6d73  ", txn: TxParams
+00007820: 2920 2d3e 2057 6569 3a0a 2020 2020 2020  ) -> Wei:.      
+00007830: 2020 2020 2020 7265 7475 726e 2061 7379        return asy
+00007840: 6e63 5f77 332e 746f 5f77 6569 2832 2c20  nc_w3.to_wei(2, 
+00007850: 2267 7765 6922 290a 0a20 2020 2020 2020  "gwei")..       
+00007860: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
+00007870: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
+00007880: 7465 6779 2867 6173 5f70 7269 6365 5f73  tegy(gas_price_s
+00007890: 7472 6174 6567 7929 0a0a 2020 2020 2020  trategy)..      
+000078a0: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
+000078b0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+000078c0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+000078d0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+000078e0: 2020 2020 2074 786e 203d 2061 7761 6974       txn = await
+000078f0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00007900: 745f 7472 616e 7361 6374 696f 6e28 7478  t_transaction(tx
+00007910: 6e5f 6861 7368 290a 0a20 2020 2020 2020  n_hash)..       
+00007920: 206c 6174 6573 745f 626c 6f63 6b20 3d20   latest_block = 
+00007930: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00007940: 7468 2e67 6574 5f62 6c6f 636b 2822 6c61  th.get_block("la
+00007950: 7465 7374 2229 0a20 2020 2020 2020 2061  test").        a
+00007960: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+00007970: 2020 2020 7478 6e5b 226d 6178 4665 6550      txn["maxFeeP
+00007980: 6572 4761 7322 5d20 3d3d 206d 6178 5f66  erGas"] == max_f
+00007990: 6565 0a20 2020 2020 2020 2020 2020 2069  ee.            i
+000079a0: 6620 6d61 785f 6665 6520 6973 206e 6f74  f max_fee is not
+000079b0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+000079c0: 2020 656c 7365 2032 202a 206c 6174 6573    else 2 * lates
+000079d0: 745f 626c 6f63 6b5b 2262 6173 6546 6565  t_block["baseFee
+000079e0: 5065 7247 6173 225d 202b 206d 6178 5f70  PerGas"] + max_p
+000079f0: 7269 6f72 6974 795f 6665 650a 2020 2020  riority_fee.    
+00007a00: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00007a10: 7365 7274 2074 786e 5b22 6d61 7850 7269  sert txn["maxPri
+00007a20: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+00007a30: 203d 3d20 6d61 785f 7072 696f 7269 7479   == max_priority
+00007a40: 5f66 6565 0a20 2020 2020 2020 2061 7373  _fee.        ass
+00007a50: 6572 7420 7478 6e5b 2267 6173 5072 6963  ert txn["gasPric
+00007a60: 6522 5d20 3d3d 2074 786e 5b22 6d61 7846  e"] == txn["maxF
+00007a70: 6565 5065 7247 6173 225d 0a0a 2020 2020  eePerGas"]..    
+00007a80: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
+00007a90: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+00007aa0: 7472 6174 6567 7928 4e6f 6e65 2920 2023  trategy(None)  #
+00007ab0: 2072 6573 6574 2073 7472 6174 6567 790a   reset strategy.
+00007ac0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00007ad0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00007ae0: 796e 6320 6465 6620 7465 7374 5f67 6173  ync def test_gas
+00007af0: 5f70 7269 6365 5f66 726f 6d5f 7374 7261  _price_from_stra
+00007b00: 7465 6779 5f62 7970 6173 7365 645f 666f  tegy_bypassed_fo
+00007b10: 725f 6479 6e61 6d69 635f 6665 655f 7478  r_dynamic_fee_tx
+00007b20: 6e5f 6e6f 5f74 6970 280a 2020 2020 2020  n_no_tip(.      
+00007b30: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00007b40: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00007b50: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+00007b60: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00007b70: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00007b80: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00007b90: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
+00007ba0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00007bb0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+00007bc0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00007bd0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+00007be0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00007bf0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00007c00: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00007c10: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
+00007c20: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+00007c30: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+00007c40: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00007c50: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+00007c60: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00007c70: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00007c80: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00007c90: 7322 3a20 5765 6928 3130 3030 3030 3030  s": Wei(10000000
+00007ca0: 3030 292c 0a20 2020 2020 2020 207d 0a0a  00),.        }..
+00007cb0: 2020 2020 2020 2020 6465 6620 6761 735f          def gas_
+00007cc0: 7072 6963 655f 7374 7261 7465 6779 285f  price_strategy(_
+00007cd0: 7733 3a20 2257 6562 3322 2c20 5f74 786e  w3: "Web3", _txn
+00007ce0: 3a20 5478 5061 7261 6d73 2920 2d3e 2057  : TxParams) -> W
+00007cf0: 6569 3a0a 2020 2020 2020 2020 2020 2020  ei:.            
+00007d00: 7265 7475 726e 2061 7379 6e63 5f77 332e  return async_w3.
+00007d10: 746f 5f77 6569 2832 2c20 2267 7765 6922  to_wei(2, "gwei"
+00007d20: 290a 0a20 2020 2020 2020 2061 7379 6e63  )..        async
+00007d30: 5f77 332e 6574 682e 7365 745f 6761 735f  _w3.eth.set_gas_
+00007d40: 7072 6963 655f 7374 7261 7465 6779 2867  price_strategy(g
+00007d50: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+00007d60: 7929 0a0a 2020 2020 2020 2020 7769 7468  y)..        with
+00007d70: 2070 7974 6573 742e 7261 6973 6573 280a   pytest.raises(.
+00007d80: 2020 2020 2020 2020 2020 2020 496e 7661              Inva
+00007d90: 6c69 6454 7261 6e73 6163 7469 6f6e 2c20  lidTransaction, 
+00007da0: 6d61 7463 683d 226d 6178 5072 696f 7269  match="maxPriori
+00007db0: 7479 4665 6550 6572 4761 7320 6d75 7374  tyFeePerGas must
+00007dc0: 2062 6520 6465 6669 6e65 6422 0a20 2020   be defined".   
+00007dd0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00007de0: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
+00007df0: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
+00007e00: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
+00007e10: 6d73 290a 0a20 2020 2020 2020 2061 7379  ms)..        asy
+00007e20: 6e63 5f77 332e 6574 682e 7365 745f 6761  nc_w3.eth.set_ga
+00007e30: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
+00007e40: 284e 6f6e 6529 2020 2320 7265 7365 7420  (None)  # reset 
+00007e50: 7374 7261 7465 6779 0a0a 2020 2020 4070  strategy..    @p
+00007e60: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00007e70: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00007e80: 2074 6573 745f 6574 685f 6573 7469 6d61   test_eth_estima
+00007e90: 7465 5f67 6173 280a 2020 2020 2020 2020  te_gas(.        
+00007ea0: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+00007eb0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00007ec0: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+00007ed0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00007ee0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00007ef0: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
+00007f00: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+00007f10: 4e6f 6e65 3a0a 2020 2020 2020 2020 6761  None:.        ga
+00007f20: 735f 6573 7469 6d61 7465 203d 2061 7761  s_estimate = awa
+00007f30: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00007f40: 6573 7469 6d61 7465 5f67 6173 280a 2020  estimate_gas(.  
+00007f50: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00007f60: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00007f70: 6d22 3a20 6173 796e 635f 6b65 7966 696c  m": async_keyfil
+00007f80: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00007f90: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+00007fa0: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+00007fb0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
+00007fc0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00007fd0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00007fe0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+00007ff0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+00008000: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00008010: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+00008020: 6572 7420 6973 5f69 6e74 6567 6572 2867  ert is_integer(g
+00008030: 6173 5f65 7374 696d 6174 6529 0a20 2020  as_estimate).   
+00008040: 2020 2020 2061 7373 6572 7420 6761 735f       assert gas_
+00008050: 6573 7469 6d61 7465 203e 2030 0a0a 2020  estimate > 0..  
+00008060: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00008070: 7379 6e63 696f 0a20 2020 2040 7079 7465  syncio.    @pyte
+00008080: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00008090: 697a 6528 0a20 2020 2020 2020 2022 7061  ize(.        "pa
+000080a0: 7261 6d73 222c 0a20 2020 2020 2020 2028  rams",.        (
+000080b0: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+000080c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000080d0: 6e6f 6e63 6522 3a20 312c 2020 2320 696e  nonce": 1,  # in
+000080e0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+000080f0: 2020 2262 616c 616e 6365 223a 2031 2c20    "balance": 1, 
+00008100: 2023 2069 6e74 0a20 2020 2020 2020 2020   # int.         
+00008110: 2020 2020 2020 2022 636f 6465 223a 2048         "code": H
+00008120: 6578 5374 7228 2230 7822 292c 2020 2320  exStr("0x"),  # 
+00008130: 4865 7853 7472 0a20 2020 2020 2020 2020  HexStr.         
+00008140: 2020 2020 2020 2023 2077 6974 6820 7374         # with st
+00008150: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
+00008160: 2020 2020 2273 7461 7465 223a 207b 4865      "state": {He
+00008170: 7853 7472 2866 2230 787b 2730 3027 202a  xStr(f"0x{'00' *
+00008180: 2033 327d 2229 3a20 4865 7853 7472 2866   32}"): HexStr(f
+00008190: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
+000081a0: 7d2c 0a20 2020 2020 2020 2020 2020 207d  },.            }
+000081b0: 2c0a 2020 2020 2020 2020 2020 2020 7b0a  ,.            {.
+000081c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081d0: 226e 6f6e 6365 223a 2048 6578 5374 7228  "nonce": HexStr(
+000081e0: 2230 7831 2229 2c20 2023 2048 6578 5374  "0x1"),  # HexSt
+000081f0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00008200: 2020 2262 616c 616e 6365 223a 2048 6578    "balance": Hex
+00008210: 5374 7228 2230 7831 2229 2c20 2023 2048  Str("0x1"),  # H
+00008220: 6578 5374 720a 2020 2020 2020 2020 2020  exStr.          
+00008230: 2020 2020 2020 2263 6f64 6522 3a20 6222        "code": b"
+00008240: 5c78 3030 222c 2020 2320 6279 7465 730a  \x00",  # bytes.
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 2320 7769 7468 2073 7461 7465 4469 6666  # with stateDiff
+00008270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008280: 2022 7374 6174 6544 6966 6622 3a20 7b48   "stateDiff": {H
+00008290: 6578 5374 7228 6622 3078 7b27 3030 2720  exStr(f"0x{'00' 
+000082a0: 2a20 3332 7d22 293a 2048 6578 5374 7228  * 32}"): HexStr(
+000082b0: 6622 3078 7b27 3030 2720 2a20 3332 7d22  f"0x{'00' * 32}"
+000082c0: 297d 2c0a 2020 2020 2020 2020 2020 2020  )},.            
+000082d0: 7d2c 0a20 2020 2020 2020 2029 2c0a 2020  },.        ),.  
+000082e0: 2020 290a 2020 2020 6173 796e 6320 6465    ).    async de
+000082f0: 6620 7465 7374 5f65 7468 5f65 7374 696d  f test_eth_estim
+00008300: 6174 655f 6761 735f 7769 7468 5f6f 7665  ate_gas_with_ove
+00008310: 7272 6964 655f 7061 7261 6d5f 7479 7065  rride_param_type
+00008320: 5f63 6865 636b 280a 2020 2020 2020 2020  _check(.        
+00008330: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+00008340: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00008350: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+00008360: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
+00008370: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
+00008380: 222c 0a20 2020 2020 2020 2070 6172 616d  ",.        param
+00008390: 733a 2053 7461 7465 4f76 6572 7269 6465  s: StateOverride
+000083a0: 5061 7261 6d73 2c0a 2020 2020 2920 2d3e  Params,.    ) ->
+000083b0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+000083c0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+000083d0: 616d 7320 3d20 7b22 6672 6f6d 223a 2061  ams = {"from": a
+000083e0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000083f0: 682e 636f 696e 6261 7365 7d0a 0a20 2020  h.coinbase}..   
+00008400: 2020 2020 2023 2061 7373 6572 7420 646f       # assert do
+00008410: 6573 206e 6f74 2072 6169 7365 0a20 2020  es not raise.   
+00008420: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+00008430: 5f77 332e 6574 682e 6573 7469 6d61 7465  _w3.eth.estimate
+00008440: 5f67 6173 280a 2020 2020 2020 2020 2020  _gas(.          
+00008450: 2020 7478 6e5f 7061 7261 6d73 2c20 4e6f    txn_params, No
+00008460: 6e65 2c20 7b61 7379 6e63 5f6d 6174 685f  ne, {async_math_
+00008470: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+00008480: 3a20 7061 7261 6d73 7d0a 2020 2020 2020  : params}.      
+00008490: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+000084a0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+000084b0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+000084c0: 5f65 7468 5f66 6565 5f68 6973 746f 7279  _eth_fee_history
+000084d0: 2873 656c 662c 2061 7379 6e63 5f77 333a  (self, async_w3:
+000084e0: 2022 4173 796e 6357 6562 3322 2920 2d3e   "AsyncWeb3") ->
+000084f0: 204e 6f6e 653a 0a20 2020 2020 2020 2066   None:.        f
+00008500: 6565 5f68 6973 746f 7279 203d 2061 7761  ee_history = awa
+00008510: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00008520: 6665 655f 6869 7374 6f72 7928 312c 2022  fee_history(1, "
+00008530: 6c61 7465 7374 222c 205b 3530 5d29 0a20  latest", [50]). 
+00008540: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00008550: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
+00008560: 6973 746f 7279 5b22 6261 7365 4665 6550  istory["baseFeeP
+00008570: 6572 4761 7322 5d29 0a20 2020 2020 2020  erGas"]).       
+00008580: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
+00008590: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
+000085a0: 5b22 6761 7355 7365 6452 6174 696f 225d  ["gasUsedRatio"]
+000085b0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+000085c0: 2069 735f 696e 7465 6765 7228 6665 655f   is_integer(fee_
+000085d0: 6869 7374 6f72 795b 226f 6c64 6573 7442  history["oldestB
+000085e0: 6c6f 636b 225d 290a 2020 2020 2020 2020  lock"]).        
+000085f0: 6173 7365 7274 2066 6565 5f68 6973 746f  assert fee_histo
+00008600: 7279 5b22 6f6c 6465 7374 426c 6f63 6b22  ry["oldestBlock"
+00008610: 5d20 3e3d 2030 0a20 2020 2020 2020 2061  ] >= 0.        a
+00008620: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+00008630: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
+00008640: 7265 7761 7264 225d 290a 2020 2020 2020  reward"]).      
+00008650: 2020 6966 206c 656e 2866 6565 5f68 6973    if len(fee_his
+00008660: 746f 7279 5b22 7265 7761 7264 225d 2920  tory["reward"]) 
+00008670: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+00008680: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
+00008690: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
+000086a0: 5b22 7265 7761 7264 225d 5b30 5d29 0a0a  ["reward"][0])..
+000086b0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+000086c0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+000086d0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+000086e0: 6665 655f 6869 7374 6f72 795f 7769 7468  fee_history_with
+000086f0: 5f69 6e74 6567 6572 280a 2020 2020 2020  _integer(.      
+00008700: 2020 7365 6c66 2c20 6173 796e 635f 7733    self, async_w3
+00008710: 3a20 2241 7379 6e63 5765 6233 222c 2061  : "AsyncWeb3", a
+00008720: 7379 6e63 5f65 6d70 7479 5f62 6c6f 636b  sync_empty_block
+00008730: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
+00008740: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00008750: 2020 2066 6565 5f68 6973 746f 7279 203d     fee_history =
+00008760: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00008770: 6574 682e 6665 655f 6869 7374 6f72 7928  eth.fee_history(
+00008780: 0a20 2020 2020 2020 2020 2020 2031 2c20  .            1, 
+00008790: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
+000087a0: 6b5b 226e 756d 6265 7222 5d2c 205b 3530  k["number"], [50
+000087b0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
+000087c0: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
+000087d0: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
+000087e0: 6f72 795b 2262 6173 6546 6565 5065 7247  ory["baseFeePerG
+000087f0: 6173 225d 290a 2020 2020 2020 2020 6173  as"]).        as
+00008800: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
+00008810: 6528 6665 655f 6869 7374 6f72 795b 2267  e(fee_history["g
+00008820: 6173 5573 6564 5261 7469 6f22 5d29 0a20  asUsedRatio"]). 
+00008830: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00008840: 5f69 6e74 6567 6572 2866 6565 5f68 6973  _integer(fee_his
+00008850: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
+00008860: 6b22 5d29 0a20 2020 2020 2020 2061 7373  k"]).        ass
+00008870: 6572 7420 6665 655f 6869 7374 6f72 795b  ert fee_history[
+00008880: 226f 6c64 6573 7442 6c6f 636b 225d 203e  "oldestBlock"] >
+00008890: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
+000088a0: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
+000088b0: 6665 655f 6869 7374 6f72 795b 2272 6577  fee_history["rew
+000088c0: 6172 6422 5d29 0a20 2020 2020 2020 2069  ard"]).        i
+000088d0: 6620 6c65 6e28 6665 655f 6869 7374 6f72  f len(fee_histor
+000088e0: 795b 2272 6577 6172 6422 5d29 203e 2030  y["reward"]) > 0
+000088f0: 3a0a 2020 2020 2020 2020 2020 2020 6173  :.            as
+00008900: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
+00008910: 6528 6665 655f 6869 7374 6f72 795b 2272  e(fee_history["r
+00008920: 6577 6172 6422 5d5b 305d 290a 0a20 2020  eward"][0])..   
+00008930: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00008940: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00008950: 6465 6620 7465 7374 5f65 7468 5f66 6565  def test_eth_fee
+00008960: 5f68 6973 746f 7279 5f6e 6f5f 7265 7761  _history_no_rewa
+00008970: 7264 5f70 6572 6365 6e74 696c 6573 280a  rd_percentiles(.
+00008980: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00008990: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+000089a0: 6233 220a 2020 2020 2920 2d3e 204e 6f6e  b3".    ) -> Non
+000089b0: 653a 0a20 2020 2020 2020 2066 6565 5f68  e:.        fee_h
+000089c0: 6973 746f 7279 203d 2061 7761 6974 2061  istory = await a
+000089d0: 7379 6e63 5f77 332e 6574 682e 6665 655f  sync_w3.eth.fee_
+000089e0: 6869 7374 6f72 7928 312c 2022 6c61 7465  history(1, "late
+000089f0: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
+00008a00: 6572 7420 6973 5f6c 6973 745f 6c69 6b65  ert is_list_like
+00008a10: 2866 6565 5f68 6973 746f 7279 5b22 6261  (fee_history["ba
+00008a20: 7365 4665 6550 6572 4761 7322 5d29 0a20  seFeePerGas"]). 
+00008a30: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00008a40: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
+00008a50: 6973 746f 7279 5b22 6761 7355 7365 6452  istory["gasUsedR
+00008a60: 6174 696f 225d 290a 2020 2020 2020 2020  atio"]).        
+00008a70: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+00008a80: 7228 6665 655f 6869 7374 6f72 795b 226f  r(fee_history["o
+00008a90: 6c64 6573 7442 6c6f 636b 225d 290a 2020  ldestBlock"]).  
+00008aa0: 2020 2020 2020 6173 7365 7274 2066 6565        assert fee
+00008ab0: 5f68 6973 746f 7279 5b22 6f6c 6465 7374  _history["oldest
+00008ac0: 426c 6f63 6b22 5d20 3e3d 2030 0a0a 2020  Block"] >= 0..  
+00008ad0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00008ae0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00008af0: 2064 6566 2074 6573 745f 6574 685f 6d61   def test_eth_ma
+00008b00: 785f 7072 696f 7269 7479 5f66 6565 2873  x_priority_fee(s
+00008b10: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00008b20: 4173 796e 6357 6562 3322 2920 2d3e 204e  AsyncWeb3") -> N
+00008b30: 6f6e 653a 0a20 2020 2020 2020 206d 6178  one:.        max
+00008b40: 5f70 7269 6f72 6974 795f 6665 6520 3d20  _priority_fee = 
+00008b50: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00008b60: 7468 2e6d 6178 5f70 7269 6f72 6974 795f  th.max_priority_
+00008b70: 6665 650a 2020 2020 2020 2020 6173 7365  fee.        asse
+00008b80: 7274 2069 735f 696e 7465 6765 7228 6d61  rt is_integer(ma
+00008b90: 785f 7072 696f 7269 7479 5f66 6565 290a  x_priority_fee).
+00008ba0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00008bb0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00008bc0: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+00008bd0: 5f6d 6178 5f70 7269 6f72 6974 795f 6665  _max_priority_fe
+00008be0: 655f 7769 7468 5f66 6565 5f68 6973 746f  e_with_fee_histo
+00008bf0: 7279 5f63 616c 6375 6c61 7469 6f6e 280a  ry_calculation(.
+00008c00: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00008c10: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00008c20: 6233 222c 2072 6571 7565 7374 5f6d 6f63  b3", request_moc
+00008c30: 6b65 723a 2054 7970 655b 5265 7175 6573  ker: Type[Reques
+00008c40: 744d 6f63 6b65 725d 0a20 2020 2029 202d  tMocker].    ) -
+00008c50: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00008c60: 6173 796e 6320 7769 7468 2072 6571 7565  async with reque
+00008c70: 7374 5f6d 6f63 6b65 7228 0a20 2020 2020  st_mocker(.     
+00008c80: 2020 2020 2020 2061 7379 6e63 5f77 332c         async_w3,
+00008c90: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00008ca0: 6b5f 6572 726f 7273 3d7b 5250 4345 6e64  k_errors={RPCEnd
+00008cb0: 706f 696e 7428 2265 7468 5f6d 6178 5072  point("eth_maxPr
+00008cc0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00008cd0: 293a 207b 7d7d 2c0a 2020 2020 2020 2020  ): {}},.        
+00008ce0: 2020 2020 6d6f 636b 5f72 6573 756c 7473      mock_results
+00008cf0: 3d7b 5250 4345 6e64 706f 696e 7428 2265  ={RPCEndpoint("e
+00008d00: 7468 5f66 6565 4869 7374 6f72 7922 293a  th_feeHistory"):
+00008d10: 207b 2272 6577 6172 6422 3a20 5b5b 305d   {"reward": [[0]
+00008d20: 5d7d 7d2c 0a20 2020 2020 2020 2029 3a0a  ]}},.        ):.
+00008d30: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00008d40: 2070 7974 6573 742e 7761 726e 7328 0a20   pytest.warns(. 
+00008d50: 2020 2020 2020 2020 2020 2020 2020 2055                 U
+00008d60: 7365 7257 6172 6e69 6e67 2c0a 2020 2020  serWarning,.    
+00008d70: 2020 2020 2020 2020 2020 2020 6d61 7463              matc
+00008d80: 683d 280a 2020 2020 2020 2020 2020 2020  h=(.            
+00008d90: 2020 2020 2020 2020 2254 6865 7265 2077          "There w
+00008da0: 6173 2061 6e20 6973 7375 6520 7769 7468  as an issue with
+00008db0: 2074 6865 206d 6574 686f 6420 6574 685f   the method eth_
+00008dc0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00008dd0: 7247 6173 2e20 220a 2020 2020 2020 2020  rGas. ".        
+00008de0: 2020 2020 2020 2020 2020 2020 2243 616c              "Cal
+00008df0: 6375 6c61 7469 6e67 2075 7369 6e67 2065  culating using e
+00008e00: 7468 5f66 6565 4869 7374 6f72 792e 220a  th_feeHistory.".
+00008e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e20: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+00008e30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008e40: 2020 7072 696f 7269 7479 5f66 6565 203d    priority_fee =
+00008e50: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00008e60: 6574 682e 6d61 785f 7072 696f 7269 7479  eth.max_priority
+00008e70: 5f66 6565 0a20 2020 2020 2020 2020 2020  _fee.           
+00008e80: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+00008e90: 6e74 6567 6572 2870 7269 6f72 6974 795f  nteger(priority_
+00008ea0: 6665 6529 0a20 2020 2020 2020 2020 2020  fee).           
+00008eb0: 2020 2020 2061 7373 6572 7420 7072 696f       assert prio
+00008ec0: 7269 7479 5f66 6565 203d 3d20 5052 494f  rity_fee == PRIO
+00008ed0: 5249 5459 5f46 4545 5f4d 494e 0a0a 2020  RITY_FEE_MIN..  
+00008ee0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00008ef0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00008f00: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00008f10: 7442 6c6f 636b 4279 4861 7368 280a 2020  tBlockByHash(.  
+00008f20: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00008f30: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00008f40: 222c 2061 7379 6e63 5f65 6d70 7479 5f62  ", async_empty_b
+00008f50: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
+00008f60: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00008f70: 2020 2020 2020 2062 6c6f 636b 203d 2061         block = a
+00008f80: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00008f90: 682e 6765 745f 626c 6f63 6b28 6173 796e  h.get_block(asyn
+00008fa0: 635f 656d 7074 795f 626c 6f63 6b5b 2268  c_empty_block["h
+00008fb0: 6173 6822 5d29 0a20 2020 2020 2020 2061  ash"]).        a
+00008fc0: 7373 6572 7420 626c 6f63 6b5b 2268 6173  ssert block["has
+00008fd0: 6822 5d20 3d3d 2061 7379 6e63 5f65 6d70  h"] == async_emp
+00008fe0: 7479 5f62 6c6f 636b 5b22 6861 7368 225d  ty_block["hash"]
+00008ff0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00009000: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00009010: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+00009020: 685f 6765 7442 6c6f 636b 4279 4861 7368  h_getBlockByHash
+00009030: 5f6e 6f74 5f66 6f75 6e64 2873 656c 662c  _not_found(self,
+00009040: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00009050: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+00009060: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00009070: 7465 7374 2e72 6169 7365 7328 426c 6f63  test.raises(Bloc
+00009080: 6b4e 6f74 466f 756e 6429 3a0a 2020 2020  kNotFound):.    
+00009090: 2020 2020 2020 2020 6177 6169 7420 6173          await as
+000090a0: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+000090b0: 6c6f 636b 2855 4e4b 4e4f 574e 5f48 4153  lock(UNKNOWN_HAS
+000090c0: 4829 0a0a 2020 2020 4070 7974 6573 742e  H)..    @pytest.
+000090d0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+000090e0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+000090f0: 6574 685f 6765 7442 6c6f 636b 4279 4861  eth_getBlockByHa
+00009100: 7368 5f70 656e 6469 6e67 2873 656c 662c  sh_pending(self,
+00009110: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00009120: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+00009130: 0a20 2020 2020 2020 2062 6c6f 636b 203d  .        block =
+00009140: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00009150: 6574 682e 6765 745f 626c 6f63 6b28 2270  eth.get_block("p
+00009160: 656e 6469 6e67 2229 0a20 2020 2020 2020  ending").       
+00009170: 2061 7373 6572 7420 626c 6f63 6b5b 2268   assert block["h
+00009180: 6173 6822 5d20 6973 204e 6f6e 650a 0a20  ash"] is None.. 
+00009190: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+000091a0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+000091b0: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
+000091c0: 6574 426c 6f63 6b42 794e 756d 6265 725f  etBlockByNumber_
+000091d0: 7769 7468 5f69 6e74 6567 6572 280a 2020  with_integer(.  
+000091e0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+000091f0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00009200: 222c 2061 7379 6e63 5f65 6d70 7479 5f62  ", async_empty_b
+00009210: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
+00009220: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00009230: 2020 2020 2020 2062 6c6f 636b 203d 2061         block = a
+00009240: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00009250: 682e 6765 745f 626c 6f63 6b28 6173 796e  h.get_block(asyn
+00009260: 635f 656d 7074 795f 626c 6f63 6b5b 226e  c_empty_block["n
+00009270: 756d 6265 7222 5d29 0a20 2020 2020 2020  umber"]).       
+00009280: 2061 7373 6572 7420 626c 6f63 6b5b 226e   assert block["n
+00009290: 756d 6265 7222 5d20 3d3d 2061 7379 6e63  umber"] == async
+000092a0: 5f65 6d70 7479 5f62 6c6f 636b 5b22 6e75  _empty_block["nu
+000092b0: 6d62 6572 225d 0a0a 2020 2020 4070 7974  mber"]..    @pyt
+000092c0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+000092d0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000092e0: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+000092f0: 4279 4e75 6d62 6572 5f6c 6174 6573 7428  ByNumber_latest(
+00009300: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
+00009310: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00009320: 6562 3322 2c20 6173 796e 635f 656d 7074  eb3", async_empt
+00009330: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+00009340: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00009350: 3a0a 2020 2020 2020 2020 6375 7272 656e  :.        curren
+00009360: 745f 626c 6f63 6b5f 6e75 6d62 6572 203d  t_block_number =
+00009370: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00009380: 6574 682e 626c 6f63 6b5f 6e75 6d62 6572  eth.block_number
+00009390: 0a20 2020 2020 2020 2062 6c6f 636b 203d  .        block =
+000093a0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+000093b0: 6574 682e 6765 745f 626c 6f63 6b28 226c  eth.get_block("l
+000093c0: 6174 6573 7422 290a 2020 2020 2020 2020  atest").        
+000093d0: 6173 7365 7274 2062 6c6f 636b 5b22 6e75  assert block["nu
+000093e0: 6d62 6572 225d 203d 3d20 6375 7272 656e  mber"] == curren
+000093f0: 745f 626c 6f63 6b5f 6e75 6d62 6572 0a0a  t_block_number..
+00009400: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00009410: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00009420: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
+00009430: 6765 7442 6c6f 636b 4279 4e75 6d62 6572  getBlockByNumber
+00009440: 5f6e 6f74 5f66 6f75 6e64 280a 2020 2020  _not_found(.    
+00009450: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+00009460: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00009470: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
+00009480: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
+00009490: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+000094a0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+000094b0: 2e72 6169 7365 7328 426c 6f63 6b4e 6f74  .raises(BlockNot
+000094c0: 466f 756e 6429 3a0a 2020 2020 2020 2020  Found):.        
+000094d0: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
+000094e0: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+000094f0: 2842 6c6f 636b 4e75 6d62 6572 2831 3233  (BlockNumber(123
+00009500: 3435 2929 0a0a 2020 2020 4070 7974 6573  45))..    @pytes
+00009510: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00009520: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00009530: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+00009540: 4e75 6d62 6572 5f70 656e 6469 6e67 280a  Number_pending(.
+00009550: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00009560: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00009570: 6233 222c 2061 7379 6e63 5f65 6d70 7479  b3", async_empty
+00009580: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00009590: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+000095a0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
+000095b0: 5f62 6c6f 636b 5f6e 756d 6265 7220 3d20  _block_number = 
+000095c0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+000095d0: 7468 2e62 6c6f 636b 5f6e 756d 6265 720a  th.block_number.
+000095e0: 2020 2020 2020 2020 626c 6f63 6b20 3d20          block = 
+000095f0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00009600: 7468 2e67 6574 5f62 6c6f 636b 2822 7065  th.get_block("pe
+00009610: 6e64 696e 6722 290a 2020 2020 2020 2020  nding").        
+00009620: 6173 7365 7274 2062 6c6f 636b 5b22 6e75  assert block["nu
+00009630: 6d62 6572 225d 203d 3d20 6375 7272 656e  mber"] == curren
+00009640: 745f 626c 6f63 6b5f 6e75 6d62 6572 202b  t_block_number +
+00009650: 2031 0a0a 2020 2020 4070 7974 6573 742e   1..    @pytest.
+00009660: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00009670: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00009680: 6574 685f 6765 7442 6c6f 636b 4279 4e75  eth_getBlockByNu
+00009690: 6d62 6572 5f65 6172 6c69 6573 7428 0a20  mber_earliest(. 
+000096a0: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+000096b0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+000096c0: 3322 2c20 6173 796e 635f 656d 7074 795f  3", async_empty_
+000096d0: 626c 6f63 6b3a 2042 6c6f 636b 4461 7461  block: BlockData
+000096e0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000096f0: 2020 2020 2020 2020 6765 6e65 7369 735f          genesis_
+00009700: 626c 6f63 6b20 3d20 6177 6169 7420 6173  block = await as
+00009710: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+00009720: 6c6f 636b 2842 6c6f 636b 4e75 6d62 6572  lock(BlockNumber
+00009730: 2830 2929 0a20 2020 2020 2020 2062 6c6f  (0)).        blo
+00009740: 636b 203d 2061 7761 6974 2061 7379 6e63  ck = await async
+00009750: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
+00009760: 6b28 2265 6172 6c69 6573 7422 290a 2020  k("earliest").  
+00009770: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+00009780: 636b 5b22 6e75 6d62 6572 225d 203d 3d20  ck["number"] == 
+00009790: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+000097a0: 2062 6c6f 636b 5b22 6861 7368 225d 203d   block["hash"] =
+000097b0: 3d20 6765 6e65 7369 735f 626c 6f63 6b5b  = genesis_block[
+000097c0: 2268 6173 6822 5d0a 0a20 2020 2040 7079  "hash"]..    @py
+000097d0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+000097e0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+000097f0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+00009800: 6b42 794e 756d 6265 725f 7361 6665 280a  kByNumber_safe(.
+00009810: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+00009820: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00009830: 6233 222c 2061 7379 6e63 5f65 6d70 7479  b3", async_empty
+00009840: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
+00009850: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
+00009860: 0a20 2020 2020 2020 2062 6c6f 636b 203d  .        block =
+00009870: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00009880: 6574 682e 6765 745f 626c 6f63 6b28 2273  eth.get_block("s
+00009890: 6166 6522 290a 2020 2020 2020 2020 6173  afe").        as
+000098a0: 7365 7274 2062 6c6f 636b 2069 7320 6e6f  sert block is no
+000098b0: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
+000098c0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+000098d0: 2862 6c6f 636b 5b22 6e75 6d62 6572 225d  (block["number"]
+000098e0: 2c20 696e 7429 0a0a 2020 2020 4070 7974  , int)..    @pyt
+000098f0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00009900: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00009910: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00009920: 4279 4e75 6d62 6572 5f66 696e 616c 697a  ByNumber_finaliz
+00009930: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
+00009940: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+00009950: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
+00009960: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
+00009970: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00009980: 6f6e 653a 0a20 2020 2020 2020 2062 6c6f  one:.        blo
+00009990: 636b 203d 2061 7761 6974 2061 7379 6e63  ck = await async
+000099a0: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
+000099b0: 6b28 2266 696e 616c 697a 6564 2229 0a20  k("finalized"). 
+000099c0: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
+000099d0: 6f63 6b20 6973 206e 6f74 204e 6f6e 650a  ock is not None.
+000099e0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000099f0: 7369 6e73 7461 6e63 6528 626c 6f63 6b5b  sinstance(block[
+00009a00: 226e 756d 6265 7222 5d2c 2069 6e74 290a  "number"], int).
+00009a10: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00009a20: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00009a30: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+00009a40: 5f67 6574 426c 6f63 6b52 6563 6569 7074  _getBlockReceipt
+00009a50: 735f 6861 7368 280a 2020 2020 2020 2020  s_hash(.        
+00009a60: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00009a70: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00009a80: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
+00009a90: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00009aa0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00009ab0: 2072 6563 6569 7074 7320 3d20 6177 6169   receipts = awai
+00009ac0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+00009ad0: 6574 5f62 6c6f 636b 5f72 6563 6569 7074  et_block_receipt
+00009ae0: 7328 6173 796e 635f 656d 7074 795f 626c  s(async_empty_bl
+00009af0: 6f63 6b5b 2268 6173 6822 5d29 0a20 2020  ock["hash"]).   
+00009b00: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+00009b10: 7374 616e 6365 2872 6563 6569 7074 732c  stance(receipts,
+00009b20: 206c 6973 7429 0a0a 2020 2020 4070 7974   list)..    @pyt
+00009b30: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00009b40: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00009b50: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00009b60: 5265 6365 6970 7473 5f6e 6f74 5f66 6f75  Receipts_not_fou
+00009b70: 6e64 2873 656c 662c 2061 7379 6e63 5f77  nd(self, async_w
+00009b80: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
+00009b90: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00009ba0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00009bb0: 7365 7328 426c 6f63 6b4e 6f74 466f 756e  ses(BlockNotFoun
+00009bc0: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+00009bd0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00009be0: 7468 2e67 6574 5f62 6c6f 636b 5f72 6563  th.get_block_rec
+00009bf0: 6569 7074 7328 554e 4b4e 4f57 4e5f 4841  eipts(UNKNOWN_HA
+00009c00: 5348 290a 0a20 2020 2040 7079 7465 7374  SH)..    @pytest
+00009c10: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00009c20: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00009c30: 5f65 7468 5f67 6574 426c 6f63 6b52 6563  _eth_getBlockRec
+00009c40: 6569 7074 735f 7769 7468 5f69 6e74 6567  eipts_with_integ
+00009c50: 6572 280a 2020 2020 2020 2020 7365 6c66  er(.        self
+00009c60: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+00009c70: 6e63 5765 6233 222c 2061 7379 6e63 5f65  ncWeb3", async_e
+00009c80: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
+00009c90: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00009ca0: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
+00009cb0: 6569 7074 7320 3d20 6177 6169 7420 6173  eipts = await as
+00009cc0: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+00009cd0: 6c6f 636b 5f72 6563 6569 7074 7328 6173  lock_receipts(as
+00009ce0: 796e 635f 656d 7074 795f 626c 6f63 6b5b  ync_empty_block[
+00009cf0: 226e 756d 6265 7222 5d29 0a20 2020 2020  "number"]).     
+00009d00: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+00009d10: 616e 6365 2872 6563 6569 7074 732c 206c  ance(receipts, l
+00009d20: 6973 7429 0a0a 2020 2020 4070 7974 6573  ist)..    @pytes
+00009d30: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00009d40: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00009d50: 745f 6574 685f 6765 7442 6c6f 636b 5265  t_eth_getBlockRe
+00009d60: 6365 6970 7473 5f73 6166 6528 0a20 2020  ceipts_safe(.   
+00009d70: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
+00009d80: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00009d90: 2c20 6173 796e 635f 656d 7074 795f 626c  , async_empty_bl
+00009da0: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
+00009db0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00009dc0: 2020 2020 2020 7265 6365 6970 7473 203d        receipts =
+00009dd0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00009de0: 6574 682e 6765 745f 626c 6f63 6b5f 7265  eth.get_block_re
+00009df0: 6365 6970 7473 2822 7361 6665 2229 0a20  ceipts("safe"). 
+00009e00: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00009e10: 696e 7374 616e 6365 2872 6563 6569 7074  instance(receipt
+00009e20: 732c 206c 6973 7429 0a0a 2020 2020 4070  s, list)..    @p
+00009e30: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00009e40: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00009e50: 2074 6573 745f 6574 685f 6765 7442 6c6f   test_eth_getBlo
+00009e60: 636b 5265 6365 6970 7473 5f66 696e 616c  ckReceipts_final
+00009e70: 697a 6564 280a 2020 2020 2020 2020 7365  ized(.        se
+00009e80: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00009e90: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00009ea0: 5f65 6d70 7479 5f62 6c6f 636b 3a20 426c  _empty_block: Bl
+00009eb0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00009ec0: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+00009ed0: 6563 6569 7074 7320 3d20 6177 6169 7420  eceipts = await 
+00009ee0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00009ef0: 5f62 6c6f 636b 5f72 6563 6569 7074 7328  _block_receipts(
+00009f00: 2266 696e 616c 697a 6564 2229 0a20 2020  "finalized").   
+00009f10: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+00009f20: 7374 616e 6365 2872 6563 6569 7074 732c  stance(receipts,
+00009f30: 206c 6973 7429 0a0a 2020 2020 4070 7974   list)..    @pyt
+00009f40: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+00009f50: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+00009f60: 6573 745f 6574 685f 6765 745f 626c 6f63  est_eth_get_bloc
+00009f70: 6b5f 6279 5f6e 756d 6265 725f 6675 6c6c  k_by_number_full
+00009f80: 5f74 7261 6e73 6163 7469 6f6e 7328 0a20  _transactions(. 
+00009f90: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+00009fa0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00009fb0: 3322 2c20 6173 796e 635f 626c 6f63 6b5f  3", async_block_
+00009fc0: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
+00009fd0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
+00009fe0: 653a 0a20 2020 2020 2020 2062 6c6f 636b  e:.        block
+00009ff0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000a000: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
+0000a010: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+0000a020: 5f74 786e 5b22 6e75 6d62 6572 225d 2c20  _txn["number"], 
+0000a030: 5472 7565 290a 2020 2020 2020 2020 7472  True).        tr
+0000a040: 616e 7361 6374 696f 6e20 3d20 6361 7374  ansaction = cast
+0000a050: 2854 7844 6174 612c 2062 6c6f 636b 5b22  (TxData, block["
+0000a060: 7472 616e 7361 6374 696f 6e73 225d 5b30  transactions"][0
+0000a070: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
+0000a080: 7420 7472 616e 7361 6374 696f 6e5b 2268  t transaction["h
+0000a090: 6173 6822 5d20 3d3d 2061 7379 6e63 5f62  ash"] == async_b
+0000a0a0: 6c6f 636b 5f77 6974 685f 7478 6e5b 2274  lock_with_txn["t
+0000a0b0: 7261 6e73 6163 7469 6f6e 7322 5d5b 305d  ransactions"][0]
+0000a0c0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+0000a0d0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+0000a0e0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+0000a0f0: 685f 6765 745f 7261 775f 7472 616e 7361  h_get_raw_transa
+0000a100: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
+0000a110: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+0000a120: 4173 796e 6357 6562 3322 2c20 6d69 6e65  AsyncWeb3", mine
+0000a130: 645f 7478 6e5f 6861 7368 3a20 4865 7853  d_txn_hash: HexS
+0000a140: 7472 0a20 2020 2029 202d 3e20 4e6f 6e65  tr.    ) -> None
+0000a150: 3a0a 2020 2020 2020 2020 7261 775f 7472  :.        raw_tr
+0000a160: 616e 7361 6374 696f 6e20 3d20 6177 6169  ansaction = awai
+0000a170: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+0000a180: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
+0000a190: 6f6e 286d 696e 6564 5f74 786e 5f68 6173  on(mined_txn_has
+0000a1a0: 6829 0a20 2020 2020 2020 2061 7373 6572  h).        asser
+0000a1b0: 7420 6973 5f62 7974 6573 2872 6177 5f74  t is_bytes(raw_t
+0000a1c0: 7261 6e73 6163 7469 6f6e 290a 0a20 2020  ransaction)..   
+0000a1d0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+0000a1e0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+0000a1f0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0000a200: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0000a210: 5f72 6169 7365 735f 6572 726f 7228 0a20  _raises_error(. 
+0000a220: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+0000a230: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+0000a240: 3322 0a20 2020 2029 202d 3e20 4e6f 6e65  3".    ) -> None
+0000a250: 3a0a 2020 2020 2020 2020 7769 7468 2070  :.        with p
+0000a260: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+0000a270: 2020 2020 2020 2020 2020 5472 616e 7361            Transa
+0000a280: 6374 696f 6e4e 6f74 466f 756e 642c 206d  ctionNotFound, m
+0000a290: 6174 6368 3d66 2254 7261 6e73 6163 7469  atch=f"Transacti
+0000a2a0: 6f6e 2077 6974 6820 6861 7368 3a20 277b  on with hash: '{
+0000a2b0: 554e 4b4e 4f57 4e5f 4841 5348 7d27 220a  UNKNOWN_HASH}'".
+0000a2c0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0000a2d0: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
+0000a2e0: 6e63 5f77 332e 6574 682e 6765 745f 7261  nc_w3.eth.get_ra
+0000a2f0: 775f 7472 616e 7361 6374 696f 6e28 554e  w_transaction(UN
+0000a300: 4b4e 4f57 4e5f 4841 5348 290a 0a20 2020  KNOWN_HASH)..   
+0000a310: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+0000a320: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+0000a330: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0000a340: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0000a350: 5f62 795f 626c 6f63 6b28 0a20 2020 2020  _by_block(.     
+0000a360: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000a370: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+0000a380: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
+0000a390: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+0000a3a0: 5f74 786e 3a20 426c 6f63 6b44 6174 612c  _txn: BlockData,
+0000a3b0: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+0000a3c0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0000a3d0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0000a3e0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0000a3f0: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+0000a400: 3a0a 2020 2020 2020 2020 2320 6574 685f  :.        # eth_
+0000a410: 6765 7452 6177 5472 616e 7361 6374 696f  getRawTransactio
+0000a420: 6e42 7942 6c6f 636b 4e75 6d62 6572 416e  nByBlockNumberAn
+0000a430: 6449 6e64 6578 3a20 626c 6f63 6b20 6964  dIndex: block id
+0000a440: 656e 7469 6669 6572 0a20 2020 2020 2020  entifier.       
+0000a450: 2023 2073 656e 6420 6120 7478 6e20 746f   # send a txn to
+0000a460: 206d 616b 6520 7375 7265 2070 656e 6469   make sure pendi
+0000a470: 6e67 2062 6c6f 636b 2068 6173 2061 7420  ng block has at 
+0000a480: 6c65 6173 7420 6f6e 6520 7478 6e0a 2020  least one txn.  
+0000a490: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+0000a4a0: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
+0000a4b0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+0000a4c0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0000a4d0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+0000a4e0: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+0000a4f0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0000a500: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0000a510: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+0000a520: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+0000a530: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+0000a540: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+0000a550: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0000a560: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0000a570: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0000a580: 290a 2020 2020 2020 2020 7065 6e64 696e  ).        pendin
+0000a590: 675f 626c 6f63 6b20 3d20 6177 6169 7420  g_block = await 
+0000a5a0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+0000a5b0: 5f62 6c6f 636b 2822 7065 6e64 696e 6722  _block("pending"
+0000a5c0: 290a 2020 2020 2020 2020 6c61 7374 5f70  ).        last_p
+0000a5d0: 656e 6469 6e67 5f74 786e 5f69 6e64 6578  ending_txn_index
+0000a5e0: 203d 206c 656e 2870 656e 6469 6e67 5f62   = len(pending_b
+0000a5f0: 6c6f 636b 5b22 7472 616e 7361 6374 696f  lock["transactio
+0000a600: 6e73 225d 2920 2d20 310a 2020 2020 2020  ns"]) - 1.      
+0000a610: 2020 7261 775f 7478 6e20 3d20 6177 6169    raw_txn = awai
+0000a620: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+0000a630: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
+0000a640: 6f6e 5f62 795f 626c 6f63 6b28 0a20 2020  on_by_block(.   
+0000a650: 2020 2020 2020 2020 2022 7065 6e64 696e           "pendin
+0000a660: 6722 2c20 6c61 7374 5f70 656e 6469 6e67  g", last_pending
+0000a670: 5f74 786e 5f69 6e64 6578 0a20 2020 2020  _txn_index.     
+0000a680: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+0000a690: 6572 7420 6973 5f62 7974 6573 2872 6177  ert is_bytes(raw
+0000a6a0: 5f74 786e 290a 0a20 2020 2020 2020 2023  _txn)..        #
+0000a6b0: 2065 7468 5f67 6574 5261 7754 7261 6e73   eth_getRawTrans
+0000a6c0: 6163 7469 6f6e 4279 426c 6f63 6b4e 756d  actionByBlockNum
+0000a6d0: 6265 7241 6e64 496e 6465 783a 2062 6c6f  berAndIndex: blo
+0000a6e0: 636b 206e 756d 6265 720a 2020 2020 2020  ck number.      
+0000a6f0: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
+0000a700: 7468 5f74 786e 5f6e 756d 6265 7220 3d20  th_txn_number = 
+0000a710: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+0000a720: 5f74 786e 5b22 6e75 6d62 6572 225d 0a20  _txn["number"]. 
+0000a730: 2020 2020 2020 2072 6177 5f74 7261 6e73         raw_trans
+0000a740: 6163 7469 6f6e 203d 2061 7761 6974 2061  action = await a
+0000a750: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+0000a760: 7261 775f 7472 616e 7361 6374 696f 6e5f  raw_transaction_
+0000a770: 6279 5f62 6c6f 636b 280a 2020 2020 2020  by_block(.      
+0000a780: 2020 2020 2020 6173 796e 635f 626c 6f63        async_bloc
+0000a790: 6b5f 7769 7468 5f74 786e 5f6e 756d 6265  k_with_txn_numbe
+0000a7a0: 722c 2030 0a20 2020 2020 2020 2029 0a20  r, 0.        ). 
+0000a7b0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0000a7c0: 5f62 7974 6573 2872 6177 5f74 7261 6e73  _bytes(raw_trans
+0000a7d0: 6163 7469 6f6e 290a 0a20 2020 2020 2020  action)..       
+0000a7e0: 2023 2065 7468 5f67 6574 5261 7754 7261   # eth_getRawTra
+0000a7f0: 6e73 6163 7469 6f6e 4279 426c 6f63 6b48  nsactionByBlockH
+0000a800: 6173 6841 6e64 496e 6465 783a 2062 6c6f  ashAndIndex: blo
+0000a810: 636b 2068 6173 680a 2020 2020 2020 2020  ck hash.        
+0000a820: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+0000a830: 5f74 786e 5f68 6173 6820 3d20 6173 796e  _txn_hash = asyn
+0000a840: 635f 626c 6f63 6b5f 7769 7468 5f74 786e  c_block_with_txn
+0000a850: 5b22 6861 7368 225d 0a20 2020 2020 2020  ["hash"].       
+0000a860: 2072 6177 5f74 7261 6e73 6163 7469 6f6e   raw_transaction
+0000a870: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000a880: 332e 6574 682e 6765 745f 7261 775f 7472  3.eth.get_raw_tr
+0000a890: 616e 7361 6374 696f 6e5f 6279 5f62 6c6f  ansaction_by_blo
+0000a8a0: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
+0000a8b0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
+0000a8c0: 5f74 786e 5f68 6173 682c 2030 0a20 2020  _txn_hash, 0.   
+0000a8d0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+0000a8e0: 7373 6572 7420 6973 5f62 7974 6573 2872  ssert is_bytes(r
+0000a8f0: 6177 5f74 7261 6e73 6163 7469 6f6e 290a  aw_transaction).
+0000a900: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+0000a910: 6b2e 6173 796e 6369 6f0a 2020 2020 4070  k.asyncio.    @p
+0000a920: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+0000a930: 6574 7269 7a65 2822 756e 6b6e 6f77 6e5f  etrize("unknown_
+0000a940: 626c 6f63 6b5f 6e75 6d5f 6f72 5f68 6173  block_num_or_has
+0000a950: 6822 2c20 2831 3233 3435 3637 3839 3939  h", (12345678999
+0000a960: 3939 2c20 554e 4b4e 4f57 4e5f 4841 5348  99, UNKNOWN_HASH
+0000a970: 2929 0a20 2020 2061 7379 6e63 2064 6566  )).    async def
+0000a980: 2074 6573 745f 6574 685f 6765 745f 7261   test_eth_get_ra
+0000a990: 775f 7472 616e 7361 6374 696f 6e5f 6279  w_transaction_by
+0000a9a0: 5f62 6c6f 636b 5f72 6169 7365 735f 6572  _block_raises_er
+0000a9b0: 726f 7228 0a20 2020 2020 2020 2073 656c  ror(.        sel
+0000a9c0: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+0000a9d0: 796e 6357 6562 3322 2c20 756e 6b6e 6f77  yncWeb3", unknow
+0000a9e0: 6e5f 626c 6f63 6b5f 6e75 6d5f 6f72 5f68  n_block_num_or_h
+0000a9f0: 6173 683a 2055 6e69 6f6e 5b69 6e74 2c20  ash: Union[int, 
+0000aa00: 4865 7842 7974 6573 5d0a 2020 2020 2920  HexBytes].    ) 
+0000aa10: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000aa20: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0000aa30: 7365 7328 0a20 2020 2020 2020 2020 2020  ses(.           
+0000aa40: 2054 7261 6e73 6163 7469 6f6e 4e6f 7446   TransactionNotF
+0000aa50: 6f75 6e64 2c0a 2020 2020 2020 2020 2020  ound,.          
+0000aa60: 2020 6d61 7463 683d 280a 2020 2020 2020    match=(.      
+0000aa70: 2020 2020 2020 2020 2020 6622 5472 616e            f"Tran
+0000aa80: 7361 6374 696f 6e20 696e 6465 783a 2030  saction index: 0
+0000aa90: 206f 6e20 626c 6f63 6b20 6964 3a20 220a   on block id: ".
+0000aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aab0: 6622 7b74 6f5f 6865 785f 6966 5f69 6e74  f"{to_hex_if_int
+0000aac0: 6567 6572 2875 6e6b 6e6f 776e 5f62 6c6f  eger(unknown_blo
+0000aad0: 636b 5f6e 756d 5f6f 725f 6861 7368 2921  ck_num_or_hash)!
+0000aae0: 727d 2022 0a20 2020 2020 2020 2020 2020  r} ".           
+0000aaf0: 2020 2020 2066 226e 6f74 2066 6f75 6e64       f"not found
+0000ab00: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0000ab10: 2c0a 2020 2020 2020 2020 293a 0a20 2020  ,.        ):.   
+0000ab20: 2020 2020 2020 2020 2061 7761 6974 2061           await a
+0000ab30: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+0000ab40: 7261 775f 7472 616e 7361 6374 696f 6e5f  raw_transaction_
+0000ab50: 6279 5f62 6c6f 636b 280a 2020 2020 2020  by_block(.      
+0000ab60: 2020 2020 2020 2020 2020 756e 6b6e 6f77            unknow
+0000ab70: 6e5f 626c 6f63 6b5f 6e75 6d5f 6f72 5f68  n_block_num_or_h
+0000ab80: 6173 682c 2030 0a20 2020 2020 2020 2020  ash, 0.         
+0000ab90: 2020 2029 0a0a 2020 2020 4070 7974 6573     )..    @pytes
+0000aba0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000abb0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000abc0: 745f 6574 685f 6765 745f 7261 775f 7472  t_eth_get_raw_tr
+0000abd0: 616e 7361 6374 696f 6e5f 6279 5f62 6c6f  ansaction_by_blo
+0000abe0: 636b 5f72 6169 7365 735f 6572 726f 725f  ck_raises_error_
+0000abf0: 626c 6f63 6b5f 6964 656e 7469 6669 6572  block_identifier
+0000ac00: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0000ac10: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+0000ac20: 5765 6233 220a 2020 2020 2920 2d3e 204e  Web3".    ) -> N
+0000ac30: 6f6e 653a 0a20 2020 2020 2020 2075 6e6b  one:.        unk
+0000ac40: 6e6f 776e 5f69 6465 6e74 6966 6965 7220  nown_identifier 
+0000ac50: 3d20 2275 6e6b 6e6f 776e 220a 2020 2020  = "unknown".    
+0000ac60: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+0000ac70: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
+0000ac80: 2020 2020 5765 6233 5661 6c75 6545 7272      Web3ValueErr
+0000ac90: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+0000aca0: 6d61 7463 683d 280a 2020 2020 2020 2020  match=(.        
+0000acb0: 2020 2020 2020 2020 2256 616c 7565 2064          "Value d
+0000acc0: 6964 206e 6f74 206d 6174 6368 2061 6e79  id not match any
+0000acd0: 206f 6620 7468 6520 7265 636f 676e 697a   of the recogniz
+0000ace0: 6564 2062 6c6f 636b 2069 6465 6e74 6966  ed block identif
+0000acf0: 6965 7273 3a20 220a 2020 2020 2020 2020  iers: ".        
+0000ad00: 2020 2020 2020 2020 6622 7b75 6e6b 6e6f          f"{unkno
+0000ad10: 776e 5f69 6465 6e74 6966 6965 727d 220a  wn_identifier}".
+0000ad20: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0000ad30: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0000ad40: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+0000ad50: 635f 7733 2e65 7468 2e67 6574 5f72 6177  c_w3.eth.get_raw
+0000ad60: 5f74 7261 6e73 6163 7469 6f6e 5f62 795f  _transaction_by_
+0000ad70: 626c 6f63 6b28 756e 6b6e 6f77 6e5f 6964  block(unknown_id
+0000ad80: 656e 7469 6669 6572 2c20 3029 0a0a 2020  entifier, 0)..  
+0000ad90: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+0000ada0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+0000adb0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+0000adc0: 745f 6261 6c61 6e63 6528 7365 6c66 2c20  t_balance(self, 
+0000add0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+0000ade0: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+0000adf0: 2020 2020 2020 2020 636f 696e 6261 7365          coinbase
+0000ae00: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000ae10: 332e 6574 682e 636f 696e 6261 7365 0a0a  3.eth.coinbase..
+0000ae20: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+0000ae30: 6573 742e 7261 6973 6573 2849 6e76 616c  est.raises(Inval
+0000ae40: 6964 4164 6472 6573 7329 3a0a 2020 2020  idAddress):.    
+0000ae50: 2020 2020 2020 2020 6177 6169 7420 6173          await as
+0000ae60: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
+0000ae70: 616c 616e 6365 280a 2020 2020 2020 2020  alance(.        
+0000ae80: 2020 2020 2020 2020 4368 6563 6b73 756d          Checksum
+0000ae90: 4164 6472 6573 7328 4865 7841 6464 7265  Address(HexAddre
+0000aea0: 7373 2848 6578 5374 7228 636f 696e 6261  ss(HexStr(coinba
+0000aeb0: 7365 2e6c 6f77 6572 2829 2929 290a 2020  se.lower()))).  
+0000aec0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000aed0: 2020 2020 2062 616c 616e 6365 203d 2061       balance = a
+0000aee0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000aef0: 682e 6765 745f 6261 6c61 6e63 6528 636f  h.get_balance(co
+0000af00: 696e 6261 7365 290a 0a20 2020 2020 2020  inbase)..       
+0000af10: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+0000af20: 6572 2862 616c 616e 6365 290a 2020 2020  er(balance).    
+0000af30: 2020 2020 6173 7365 7274 2062 616c 616e      assert balan
+0000af40: 6365 203e 3d20 300a 0a20 2020 2040 7079  ce >= 0..    @py
+0000af50: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000af60: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000af70: 7465 7374 5f65 7468 5f67 6574 5f63 6f64  test_eth_get_cod
+0000af80: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0000af90: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+0000afa0: 6357 6562 3322 2c20 6173 796e 635f 6d61  cWeb3", async_ma
+0000afb0: 7468 5f63 6f6e 7472 6163 745f 6164 6472  th_contract_addr
+0000afc0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+0000afd0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+0000afe0: 6e65 3a0a 2020 2020 2020 2020 636f 6465  ne:.        code
+0000aff0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000b000: 332e 6574 682e 6765 745f 636f 6465 2861  3.eth.get_code(a
+0000b010: 7379 6e63 5f6d 6174 685f 636f 6e74 7261  sync_math_contra
+0000b020: 6374 5f61 6464 7265 7373 290a 2020 2020  ct_address).    
+0000b030: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
+0000b040: 7461 6e63 6528 636f 6465 2c20 4865 7842  tance(code, HexB
+0000b050: 7974 6573 290a 2020 2020 2020 2020 6173  ytes).        as
+0000b060: 7365 7274 206c 656e 2863 6f64 6529 203e  sert len(code) >
+0000b070: 2030 0a0a 2020 2020 4070 7974 6573 742e   0..    @pytest.
+0000b080: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+0000b090: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+0000b0a0: 6574 685f 6765 745f 636f 6465 5f69 6e76  eth_get_code_inv
+0000b0b0: 616c 6964 5f61 6464 7265 7373 280a 2020  alid_address(.  
+0000b0c0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000b0d0: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+0000b0e0: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+0000b0f0: 2020 2061 7379 6e63 5f6d 6174 685f 636f     async_math_co
+0000b100: 6e74 7261 6374 3a20 2241 7379 6e63 436f  ntract: "AsyncCo
+0000b110: 6e74 7261 6374 222c 0a20 2020 2029 202d  ntract",.    ) -
+0000b120: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0000b130: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+0000b140: 6573 2849 6e76 616c 6964 4164 6472 6573  es(InvalidAddres
+0000b150: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0000b160: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+0000b170: 7468 2e67 6574 5f63 6f64 6528 0a20 2020  th.get_code(.   
+0000b180: 2020 2020 2020 2020 2020 2020 2043 6865               Che
+0000b190: 636b 7375 6d41 6464 7265 7373 2848 6578  cksumAddress(Hex
+0000b1a0: 4164 6472 6573 7328 4865 7853 7472 2861  Address(HexStr(a
+0000b1b0: 7379 6e63 5f6d 6174 685f 636f 6e74 7261  sync_math_contra
+0000b1c0: 6374 2e61 6464 7265 7373 2e6c 6f77 6572  ct.address.lower
+0000b1d0: 2829 2929 290a 2020 2020 2020 2020 2020  ()))).          
+0000b1e0: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+0000b1f0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000b200: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000b210: 5f65 7468 5f67 6574 5f63 6f64 655f 7769  _eth_get_code_wi
+0000b220: 7468 5f62 6c6f 636b 5f69 6465 6e74 6966  th_block_identif
+0000b230: 6965 7228 0a20 2020 2020 2020 2073 656c  ier(.        sel
+0000b240: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
+0000b250: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
+0000b260: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
+0000b270: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
+0000b280: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
+0000b290: 0a20 2020 2020 2020 2062 6c6f 636b 5f69  .        block_i
+0000b2a0: 6420 3d20 6177 6169 7420 6173 796e 635f  d = await async_
+0000b2b0: 7733 2e65 7468 2e62 6c6f 636b 5f6e 756d  w3.eth.block_num
+0000b2c0: 6265 720a 2020 2020 2020 2020 636f 6465  ber.        code
+0000b2d0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000b2e0: 332e 6574 682e 6765 745f 636f 6465 2861  3.eth.get_code(a
+0000b2f0: 7379 6e63 5f65 6d69 7474 6572 5f63 6f6e  sync_emitter_con
+0000b300: 7472 6163 742e 6164 6472 6573 732c 2062  tract.address, b
+0000b310: 6c6f 636b 5f69 6429 0a20 2020 2020 2020  lock_id).       
+0000b320: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+0000b330: 6365 2863 6f64 652c 2048 6578 4279 7465  ce(code, HexByte
+0000b340: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+0000b350: 7420 6c65 6e28 636f 6465 2920 3e20 300a  t len(code) > 0.
+0000b360: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+0000b370: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+0000b380: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+0000b390: 5f63 7265 6174 655f 6163 6365 7373 5f6c  _create_access_l
+0000b3a0: 6973 7428 0a20 2020 2020 2020 2073 656c  ist(.        sel
+0000b3b0: 662c 0a20 2020 2020 2020 2061 7379 6e63  f,.        async
+0000b3c0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+0000b3d0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000b3e0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0000b3f0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0000b400: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0000b410: 7373 2c0a 2020 2020 2020 2020 6173 796e  ss,.        asyn
+0000b420: 635f 6d61 7468 5f63 6f6e 7472 6163 743a  c_math_contract:
+0000b430: 2022 4173 796e 6343 6f6e 7472 6163 7422   "AsyncContract"
+0000b440: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0000b450: 0a20 2020 2020 2020 2023 2062 7569 6c64  .        # build
+0000b460: 2074 786e 0a20 2020 2020 2020 2074 786e   txn.        txn
+0000b470: 203d 2061 7761 6974 2061 7379 6e63 5f6d   = await async_m
+0000b480: 6174 685f 636f 6e74 7261 6374 2e66 756e  ath_contract.fun
+0000b490: 6374 696f 6e73 2e69 6e63 7265 6d65 6e74  ctions.increment
+0000b4a0: 436f 756e 7465 7228 3129 2e62 7569 6c64  Counter(1).build
+0000b4b0: 5f74 7261 6e73 6163 7469 6f6e 280a 2020  _transaction(.  
+0000b4c0: 2020 2020 2020 2020 2020 7b22 6672 6f6d            {"from
+0000b4d0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
+0000b4e0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0000b4f0: 5f64 7561 6c5f 7479 7065 7d0a 2020 2020  _dual_type}.    
+0000b500: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0000b510: 2063 7265 6174 6520 6163 6365 7373 206c   create access l
+0000b520: 6973 740a 2020 2020 2020 2020 7265 7370  ist.        resp
+0000b530: 6f6e 7365 203d 2061 7761 6974 2061 7379  onse = await asy
+0000b540: 6e63 5f77 332e 6574 682e 6372 6561 7465  nc_w3.eth.create
+0000b550: 5f61 6363 6573 735f 6c69 7374 2874 786e  _access_list(txn
+0000b560: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0000b570: 7420 6973 5f64 6963 7428 7265 7370 6f6e  t is_dict(respon
+0000b580: 7365 290a 2020 2020 2020 2020 6163 6365  se).        acce
+0000b590: 7373 5f6c 6973 7420 3d20 7265 7370 6f6e  ss_list = respon
+0000b5a0: 7365 5b22 6163 6365 7373 4c69 7374 225d  se["accessList"]
+0000b5b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0000b5c0: 6c65 6e28 6163 6365 7373 5f6c 6973 7429  len(access_list)
+0000b5d0: 203e 2030 0a20 2020 2020 2020 2061 7373   > 0.        ass
+0000b5e0: 6572 7420 6163 6365 7373 5f6c 6973 745b  ert access_list[
+0000b5f0: 305d 5b22 6164 6472 6573 7322 5d20 6973  0]["address"] is
+0000b600: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+0000b610: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
+0000b620: 6b73 756d 5f61 6464 7265 7373 2861 6363  ksum_address(acc
+0000b630: 6573 735f 6c69 7374 5b30 5d5b 2261 6464  ess_list[0]["add
+0000b640: 7265 7373 225d 290a 2020 2020 2020 2020  ress"]).        
+0000b650: 6173 7365 7274 206c 656e 2861 6363 6573  assert len(acces
+0000b660: 735f 6c69 7374 5b30 5d5b 2273 746f 7261  s_list[0]["stora
+0000b670: 6765 4b65 7973 225d 5b30 5d29 203d 3d20  geKeys"][0]) == 
+0000b680: 3332 0a20 2020 2020 2020 2061 7373 6572  32.        asser
+0000b690: 7420 696e 7428 7265 7370 6f6e 7365 5b22  t int(response["
+0000b6a0: 6761 7355 7365 6422 5d29 203e 3d20 300a  gasUsed"]) >= 0.
+0000b6b0: 0a20 2020 2020 2020 2023 2061 7373 6572  .        # asser
+0000b6c0: 7420 7468 6520 7265 7375 6c74 2063 616e  t the result can
+0000b6d0: 2062 6520 7573 6564 2064 6972 6563 746c   be used directl
+0000b6e0: 7920 696e 2061 2074 7261 6e73 6163 7469  y in a transacti
+0000b6f0: 6f6e 2064 6963 740a 2020 2020 2020 2020  on dict.        
+0000b700: 7478 6e5b 2261 6363 6573 734c 6973 7422  txn["accessList"
+0000b710: 5d20 3d20 7265 7370 6f6e 7365 5b22 6163  ] = response["ac
+0000b720: 6365 7373 4c69 7374 225d 0a20 2020 2020  cessList"].     
+0000b730: 2020 2074 786e 5b22 6761 7322 5d20 3d20     txn["gas"] = 
+0000b740: 7265 7370 6f6e 7365 5b22 6761 7355 7365  response["gasUse
+0000b750: 6422 5d0a 0a20 2020 2020 2020 2023 2073  d"]..        # s
+0000b760: 656e 6420 7478 6e20 7769 7468 2061 6363  end txn with acc
+0000b770: 6573 7320 6c69 7374 0a20 2020 2020 2020  ess list.       
+0000b780: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+0000b790: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+0000b7a0: 7469 6f6e 2874 786e 290a 0a20 2020 2040  tion(txn)..    @
+0000b7b0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+0000b7c0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+0000b7d0: 6620 7465 7374 5f65 7468 5f67 6574 5f74  f test_eth_get_t
+0000b7e0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+0000b7f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000b800: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000b810: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+0000b820: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+0000b830: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0000b840: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+0000b850: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+0000b860: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0000b870: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+0000b880: 696f 6e5f 636f 756e 7420 3d20 6177 6169  ion_count = awai
+0000b890: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+0000b8a0: 6574 5f74 7261 6e73 6163 7469 6f6e 5f63  et_transaction_c
+0000b8b0: 6f75 6e74 280a 2020 2020 2020 2020 2020  ount(.          
+0000b8c0: 2020 6173 796e 635f 6b65 7966 696c 655f    async_keyfile_
+0000b8d0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+0000b8e0: 6475 616c 5f74 7970 650a 2020 2020 2020  dual_type.      
+0000b8f0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+0000b900: 7274 2069 735f 696e 7465 6765 7228 7472  rt is_integer(tr
+0000b910: 616e 7361 6374 696f 6e5f 636f 756e 7429  ansaction_count)
+0000b920: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0000b930: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+0000b940: 7420 3e3d 2030 0a0a 2020 2020 4070 7974  t >= 0..    @pyt
+0000b950: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+0000b960: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+0000b970: 6573 745f 6574 685f 6361 6c6c 280a 2020  est_eth_call(.  
+0000b980: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+0000b990: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+0000b9a0: 222c 2061 7379 6e63 5f6d 6174 685f 636f  ", async_math_co
+0000b9b0: 6e74 7261 6374 3a20 2241 7379 6e63 436f  ntract: "AsyncCo
+0000b9c0: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
+0000b9d0: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
+0000b9e0: 6f69 6e62 6173 6520 3d20 6177 6169 7420  oinbase = await 
+0000b9f0: 6173 796e 635f 7733 2e65 7468 2e63 6f69  async_w3.eth.coi
+0000ba00: 6e62 6173 650a 2020 2020 2020 2020 7478  nbase.        tx
+0000ba10: 6e5f 7061 7261 6d73 203d 2061 7379 6e63  n_params = async
+0000ba20: 5f6d 6174 685f 636f 6e74 7261 6374 2e5f  _math_contract._
+0000ba30: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
+0000ba40: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0000ba50: 2066 6e5f 6e61 6d65 3d22 6164 6422 2c0a   fn_name="add",.
+0000ba60: 2020 2020 2020 2020 2020 2020 666e 5f61              fn_a
+0000ba70: 7267 733d 2837 2c20 3131 292c 0a20 2020  rgs=(7, 11),.   
+0000ba80: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
+0000ba90: 7469 6f6e 3d7b 2266 726f 6d22 3a20 636f  tion={"from": co
+0000baa0: 696e 6261 7365 2c20 2274 6f22 3a20 6173  inbase, "to": as
+0000bab0: 796e 635f 6d61 7468 5f63 6f6e 7472 6163  ync_math_contrac
+0000bac0: 742e 6164 6472 6573 737d 2c0a 2020 2020  t.address},.    
+0000bad0: 2020 2020 290a 2020 2020 2020 2020 6361      ).        ca
+0000bae0: 6c6c 5f72 6573 756c 7420 3d20 6177 6169  ll_result = awai
+0000baf0: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+0000bb00: 616c 6c28 7478 6e5f 7061 7261 6d73 290a  all(txn_params).
+0000bb10: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0000bb20: 735f 7374 7269 6e67 2863 616c 6c5f 7265  s_string(call_re
+0000bb30: 7375 6c74 290a 2020 2020 2020 2020 2872  sult).        (r
+0000bb40: 6573 756c 742c 2920 3d20 6173 796e 635f  esult,) = async_
+0000bb50: 7733 2e63 6f64 6563 2e64 6563 6f64 6528  w3.codec.decode(
+0000bb60: 5b22 7569 6e74 3235 3622 5d2c 2063 616c  ["uint256"], cal
+0000bb70: 6c5f 7265 7375 6c74 290a 2020 2020 2020  l_result).      
+0000bb80: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
+0000bb90: 3d3d 2031 380a 0a20 2020 2040 7079 7465  == 18..    @pyte
+0000bba0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000bbb0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+0000bbc0: 7374 5f65 7468 5f63 616c 6c5f 7769 7468  st_eth_call_with
+0000bbd0: 5f6f 7665 7272 6964 655f 636f 6465 280a  _override_code(.
+0000bbe0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000bbf0: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+0000bc00: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+0000bc10: 2020 2020 2061 7379 6e63 5f72 6576 6572       async_rever
+0000bc20: 745f 636f 6e74 7261 6374 3a20 2241 7379  t_contract: "Asy
+0000bc30: 6e63 436f 6e74 7261 6374 222c 0a20 2020  ncContract",.   
+0000bc40: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0000bc50: 2020 2020 636f 696e 6261 7365 203d 2061      coinbase = a
+0000bc60: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+0000bc70: 682e 636f 696e 6261 7365 0a20 2020 2020  h.coinbase.     
+0000bc80: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
+0000bc90: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
+0000bca0: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
+0000bcb0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+0000bcc0: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
+0000bcd0: 226e 6f72 6d61 6c46 756e 6374 696f 6e22  "normalFunction"
+0000bce0: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
+0000bcf0: 616e 7361 6374 696f 6e3d 7b22 6672 6f6d  ansaction={"from
+0000bd00: 223a 2063 6f69 6e62 6173 652c 2022 746f  ": coinbase, "to
+0000bd10: 223a 2061 7379 6e63 5f72 6576 6572 745f  ": async_revert_
+0000bd20: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+0000bd30: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
+0000bd40: 2020 2020 2063 616c 6c5f 7265 7375 6c74       call_result
+0000bd50: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+0000bd60: 332e 6574 682e 6361 6c6c 2874 786e 5f70  3.eth.call(txn_p
+0000bd70: 6172 616d 7329 0a20 2020 2020 2020 2028  arams).        (
+0000bd80: 7265 7375 6c74 2c29 203d 2061 7379 6e63  result,) = async
+0000bd90: 5f77 332e 636f 6465 632e 6465 636f 6465  _w3.codec.decode
+0000bda0: 285b 2262 6f6f 6c22 5d2c 2063 616c 6c5f  (["bool"], call_
+0000bdb0: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
+0000bdc0: 6173 7365 7274 2072 6573 756c 7420 6973  assert result is
+0000bdd0: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+0000bde0: 206f 7665 7272 6964 6520 7275 6e74 696d   override runtim
+0000bdf0: 6520 6279 7465 636f 6465 3a20 606e 6f72  e bytecode: `nor
+0000be00: 6d61 6c46 756e 6374 696f 6e60 2072 6574  malFunction` ret
+0000be10: 7572 6e73 2060 6661 6c73 6560 0a20 2020  urns `false`.   
+0000be20: 2020 2020 206f 7665 7272 6964 655f 636f       override_co
+0000be30: 6465 203d 2048 6578 5374 7228 0a20 2020  de = HexStr(.   
+0000be40: 2020 2020 2020 2020 2022 3078 3630 3830           "0x6080
+0000be50: 3630 3430 3532 3334 3830 3135 3630 3066  604052348015600f
+0000be60: 3537 3630 3030 3830 6664 3562 3530 3630  57600080fd5b5060
+0000be70: 3034 3336 3130 3630 3363 3537 3630 3030  043610603c576000
+0000be80: 3335 3630 6530 3163 3830 3633 3138 3563  3560e01c8063185c
+0000be90: 3338 6134 3134 3630 3431 3537 3830 3633  38a4146041578063
+0000bea0: 6330 3661 3937 6362 3134 3630 3439 3537  c06a97cb14604957
+0000beb0: 3830 3633 6436 3765 3462 3834 3134 3630  8063d67e4b841460
+0000bec0: 3531 3537 3562 3630 3030 3830 6664 3562  51575b600080fd5b
+0000bed0: 3630 3437 3630 3731 3536 3562 3030 3562  60476071565b005b
+0000bee0: 3630 3466 3630 6466 3536 3562 3030 3562  604f60df565b005b
+0000bef0: 3630 3537 3630 6534 3536 3562 3630 3430  605760e4565b6040
+0000bf00: 3531 3830 3832 3135 3135 3135 3135 3831  5180821515151581
+0000bf10: 3532 3630 3230 3031 3931 3530 3530 3630  5260200191505060
+0000bf20: 3430 3531 3830 3931 3033 3930 6633 3562  405180910390f35b
+0000bf30: 3630 3430 3531 3766 3038 6333 3739 6130  6040517f08c379a0
 0000bf40: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 0000bf50: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0000bf60: 3030 3030 3030 3030 3030 3030 3038 3135  0000000000000815
-0000bf70: 3236 3030 3430 3138 3038 3036 3032 3030  2600401808060200
-0000bf80: 3138 3238 3130 3338 3235 3236 3031 6238  18281038252601b8
-0000bf90: 3135 3236 3032 3030 3138 3037 6634 3637  152602001807f467
-0000bfa0: 3536 6536 3337 3436 3936 6636 6532 3036  56e6374696f6e206
-0000bfb0: 3836 3137 3332 3036 3236 3536 3536 6532  86173206265656e2
-0000bfc0: 3037 3236 3537 3636 3537 3237 3436 3536  0726576657274656
-0000bfd0: 3432 6530 3030 3030 3030 3030 3038 3135  42e0000000000815
-0000bfe0: 3235 3036 3032 3030 3139 3135 3035 3036  2506020019150506
-0000bff0: 3034 3035 3138 3039 3130 3339 3066 6435  0405180910390fd5
-0000c000: 6236 3030 3038 3066 6435 6236 3030 3038  b600080fd5b60008
-0000c010: 3039 3035 3039 3035 3666 6561 3236 3436  090509056fea2646
-0000c020: 3937 3036 3637 3335 3832 3231 3232 3062  970667358221220b
-0000c030: 6237 3165 3965 3961 3265 3237 3163 6430  b71e9e9a2e271cd0
-0000c040: 6662 6538 3333 3532 3461 3365 6136 3764  fbe833524a3ea67d
-0000c050: 6639 3566 3235 6561 3133 6165 6635 6230  f95f25ea13aef5b0
-0000c060: 6137 3631 6661 3532 6235 3338 6631 3036  a761fa52b538f106
-0000c070: 3437 3336 6636 6336 3334 3330 3030 3630  4736f6c634300060
-0000c080: 3130 3033 3322 2020 2320 6e6f 7161 3a20  10033"  # noqa: 
-0000c090: 4535 3031 0a20 2020 2020 2020 2029 0a20  E501.        ). 
-0000c0a0: 2020 2020 2020 2063 616c 6c5f 7265 7375         call_resu
-0000c0b0: 6c74 203d 2061 7761 6974 2061 7379 6e63  lt = await async
-0000c0c0: 5f77 332e 6574 682e 6361 6c6c 280a 2020  _w3.eth.call(.  
-0000c0d0: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
-0000c0e0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-0000c0f0: 2020 226c 6174 6573 7422 2c0a 2020 2020    "latest",.    
-0000c100: 2020 2020 2020 2020 7b61 7379 6e63 5f72          {async_r
-0000c110: 6576 6572 745f 636f 6e74 7261 6374 2e61  evert_contract.a
-0000c120: 6464 7265 7373 3a20 7b22 636f 6465 223a  ddress: {"code":
-0000c130: 206f 7665 7272 6964 655f 636f 6465 7d7d   override_code}}
-0000c140: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000c150: 2020 2020 2872 6573 756c 742c 2920 3d20      (result,) = 
-0000c160: 6173 796e 635f 7733 2e63 6f64 6563 2e64  async_w3.codec.d
-0000c170: 6563 6f64 6528 5b22 626f 6f6c 225d 2c20  ecode(["bool"], 
-0000c180: 6361 6c6c 5f72 6573 756c 7429 0a20 2020  call_result).   
-0000c190: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0000c1a0: 6c74 2069 7320 4661 6c73 650a 0a20 2020  lt is False..   
-0000c1b0: 2020 2020 2023 2074 6573 7420 6279 7465       # test byte
-0000c1c0: 730a 0a20 2020 2020 2020 2062 7974 6573  s..        bytes
-0000c1d0: 5f63 616c 6c5f 7265 7375 6c74 203d 2061  _call_result = a
-0000c1e0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-0000c1f0: 682e 6361 6c6c 280a 2020 2020 2020 2020  h.call(.        
-0000c200: 2020 2020 7478 6e5f 7061 7261 6d73 2c0a      txn_params,.
-0000c210: 2020 2020 2020 2020 2020 2020 226c 6174              "lat
-0000c220: 6573 7422 2c0a 2020 2020 2020 2020 2020  est",.          
-0000c230: 2020 7b61 7379 6e63 5f72 6576 6572 745f    {async_revert_
-0000c240: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-0000c250: 3a20 7b22 636f 6465 223a 2074 6f5f 6279  : {"code": to_by
-0000c260: 7465 7328 6865 7873 7472 3d6f 7665 7272  tes(hexstr=overr
-0000c270: 6964 655f 636f 6465 297d 7d2c 0a20 2020  ide_code)}},.   
-0000c280: 2020 2020 2029 0a20 2020 2020 2020 2028       ).        (
-0000c290: 6279 7465 735f 7265 7375 6c74 2c29 203d  bytes_result,) =
-0000c2a0: 2061 7379 6e63 5f77 332e 636f 6465 632e   async_w3.codec.
-0000c2b0: 6465 636f 6465 285b 2262 6f6f 6c22 5d2c  decode(["bool"],
-0000c2c0: 2062 7974 6573 5f63 616c 6c5f 7265 7375   bytes_call_resu
-0000c2d0: 6c74 290a 2020 2020 2020 2020 6173 7365  lt).        asse
-0000c2e0: 7274 2062 7974 6573 5f72 6573 756c 7420  rt bytes_result 
-0000c2f0: 6973 2046 616c 7365 0a0a 2020 2020 4070  is False..    @p
-0000c300: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000c310: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
-0000c320: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000c330: 0a20 2020 2020 2020 2022 7061 7261 6d73  .        "params
-0000c340: 222c 0a20 2020 2020 2020 2028 0a20 2020  ",.        (.   
-0000c350: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0000c360: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
-0000c370: 6522 3a20 312c 2020 2320 696e 740a 2020  e": 1,  # int.  
-0000c380: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-0000c390: 616c 616e 6365 223a 2031 2c20 2023 2069  alance": 1,  # i
-0000c3a0: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
-0000c3b0: 2020 2022 636f 6465 223a 2048 6578 5374     "code": HexSt
-0000c3c0: 7228 2230 7822 292c 2020 2320 4865 7853  r("0x"),  # HexS
-0000c3d0: 7472 0a20 2020 2020 2020 2020 2020 2020  tr.             
-0000c3e0: 2020 2023 2077 6974 6820 7374 6174 650a     # with state.
-0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c400: 2273 7461 7465 223a 207b 4865 7853 7472  "state": {HexStr
-0000c410: 2866 2230 787b 2730 3027 202a 2033 327d  (f"0x{'00' * 32}
-0000c420: 2229 3a20 4865 7853 7472 2866 2230 787b  "): HexStr(f"0x{
-0000c430: 2730 3027 202a 2033 327d 2229 7d2c 0a20  '00' * 32}")},. 
-0000c440: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-0000c450: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0000c460: 2020 2020 2020 2020 2020 2020 226e 6f6e              "non
-0000c470: 6365 223a 2048 6578 5374 7228 2230 7831  ce": HexStr("0x1
-0000c480: 2229 2c20 2023 2048 6578 5374 720a 2020  "),  # HexStr.  
-0000c490: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-0000c4a0: 616c 616e 6365 223a 2048 6578 5374 7228  alance": HexStr(
-0000c4b0: 2230 7831 2229 2c20 2023 2048 6578 5374  "0x1"),  # HexSt
-0000c4c0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000c4d0: 2020 2263 6f64 6522 3a20 6222 5c78 3030    "code": b"\x00
-0000c4e0: 222c 2020 2320 6279 7465 730a 2020 2020  ",  # bytes.    
-0000c4f0: 2020 2020 2020 2020 2020 2020 2320 7769              # wi
-0000c500: 7468 2073 7461 7465 4469 6666 0a20 2020  th stateDiff.   
-0000c510: 2020 2020 2020 2020 2020 2020 2022 7374               "st
-0000c520: 6174 6544 6966 6622 3a20 7b48 6578 5374  ateDiff": {HexSt
-0000c530: 7228 6622 3078 7b27 3030 2720 2a20 3332  r(f"0x{'00' * 32
-0000c540: 7d22 293a 2048 6578 5374 7228 6622 3078  }"): HexStr(f"0x
-0000c550: 7b27 3030 2720 2a20 3332 7d22 297d 2c0a  {'00' * 32}")},.
-0000c560: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0000c570: 2020 2020 2020 2029 2c0a 2020 2020 290a         ),.    ).
-0000c580: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-0000c590: 7374 5f65 7468 5f63 616c 6c5f 7769 7468  st_eth_call_with
-0000c5a0: 5f6f 7665 7272 6964 655f 7061 7261 6d5f  _override_param_
-0000c5b0: 7479 7065 5f63 6865 636b 280a 2020 2020  type_check(.    
-0000c5c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000c5d0: 2020 6173 796e 635f 7733 3a20 2241 7379    async_w3: "Asy
-0000c5e0: 6e63 5765 6233 222c 0a20 2020 2020 2020  ncWeb3",.       
-0000c5f0: 2061 7379 6e63 5f6d 6174 685f 636f 6e74   async_math_cont
-0000c600: 7261 6374 3a20 2241 7379 6e63 436f 6e74  ract: "AsyncCont
-0000c610: 7261 6374 222c 0a20 2020 2020 2020 2070  ract",.        p
-0000c620: 6172 616d 733a 2053 7461 7465 4f76 6572  arams: StateOver
-0000c630: 7269 6465 5061 7261 6d73 2c0a 2020 2020  rideParams,.    
-0000c640: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000c650: 2020 2063 6f69 6e62 6173 6520 3d20 6177     coinbase = aw
-0000c660: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-0000c670: 2e63 6f69 6e62 6173 650a 2020 2020 2020  .coinbase.      
-0000c680: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-0000c690: 5061 7261 6d73 203d 207b 2266 726f 6d22  Params = {"from"
-0000c6a0: 3a20 636f 696e 6261 7365 7d0a 0a20 2020  : coinbase}..   
-0000c6b0: 2020 2020 2023 2061 7373 6572 7420 646f       # assert do
-0000c6c0: 6573 206e 6f74 2072 6169 7365 0a20 2020  es not raise.   
-0000c6d0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
-0000c6e0: 5f77 332e 6574 682e 6361 6c6c 280a 2020  _w3.eth.call(.  
-0000c6f0: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
-0000c700: 7261 6d73 2c20 226c 6174 6573 7422 2c20  rams, "latest", 
-0000c710: 7b61 7379 6e63 5f6d 6174 685f 636f 6e74  {async_math_cont
-0000c720: 7261 6374 2e61 6464 7265 7373 3a20 7061  ract.address: pa
-0000c730: 7261 6d73 7d0a 2020 2020 2020 2020 290a  rams}.        ).
-0000c740: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-0000c750: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-0000c760: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
-0000c770: 5f63 616c 6c5f 7769 7468 5f30 5f72 6573  _call_with_0_res
-0000c780: 756c 7428 0a20 2020 2020 2020 2073 656c  ult(.        sel
-0000c790: 662c 2061 7379 6e63 5f77 333a 2022 4173  f, async_w3: "As
-0000c7a0: 796e 6357 6562 3322 2c20 6173 796e 635f  yncWeb3", async_
-0000c7b0: 6d61 7468 5f63 6f6e 7472 6163 743a 2022  math_contract: "
-0000c7c0: 4173 796e 6343 6f6e 7472 6163 7422 0a20  AsyncContract". 
-0000c7d0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000c7e0: 2020 2020 2020 636f 696e 6261 7365 203d        coinbase =
-0000c7f0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-0000c800: 6574 682e 636f 696e 6261 7365 0a20 2020  eth.coinbase.   
-0000c810: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
-0000c820: 3d20 6173 796e 635f 6d61 7468 5f63 6f6e  = async_math_con
-0000c830: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
-0000c840: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-0000c850: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
-0000c860: 2261 6464 222c 0a20 2020 2020 2020 2020  "add",.         
-0000c870: 2020 2066 6e5f 6172 6773 3d28 302c 2030     fn_args=(0, 0
-0000c880: 292c 0a20 2020 2020 2020 2020 2020 2074  ),.            t
-0000c890: 7261 6e73 6163 7469 6f6e 3d7b 2266 726f  ransaction={"fro
-0000c8a0: 6d22 3a20 636f 696e 6261 7365 2c20 2274  m": coinbase, "t
-0000c8b0: 6f22 3a20 6173 796e 635f 6d61 7468 5f63  o": async_math_c
-0000c8c0: 6f6e 7472 6163 742e 6164 6472 6573 737d  ontract.address}
-0000c8d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000c8e0: 2020 2020 6361 6c6c 5f72 6573 756c 7420      call_result 
-0000c8f0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-0000c900: 2e65 7468 2e63 616c 6c28 7478 6e5f 7061  .eth.call(txn_pa
-0000c910: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-0000c920: 7365 7274 2069 735f 7374 7269 6e67 2863  sert is_string(c
-0000c930: 616c 6c5f 7265 7375 6c74 290a 2020 2020  all_result).    
-0000c940: 2020 2020 2872 6573 756c 742c 2920 3d20      (result,) = 
-0000c950: 6173 796e 635f 7733 2e63 6f64 6563 2e64  async_w3.codec.d
-0000c960: 6563 6f64 6528 5b22 7569 6e74 3235 3622  ecode(["uint256"
-0000c970: 5d2c 2063 616c 6c5f 7265 7375 6c74 290a  ], call_result).
-0000c980: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0000c990: 6573 756c 7420 3d3d 2030 0a0a 2020 2020  esult == 0..    
-0000c9a0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-0000c9b0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-0000c9c0: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
-0000c9d0: 5f72 6576 6572 745f 7769 7468 5f6d 7367  _revert_with_msg
-0000c9e0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000c9f0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-0000ca00: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-0000ca10: 2020 2020 2020 2061 7379 6e63 5f72 6576         async_rev
-0000ca20: 6572 745f 636f 6e74 7261 6374 3a20 2241  ert_contract: "A
-0000ca30: 7379 6e63 436f 6e74 7261 6374 222c 0a20  syncContract",. 
-0000ca40: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
-0000ca50: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-0000ca60: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
-0000ca70: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
-0000ca80: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-0000ca90: 6e5f 7061 7261 6d73 203d 2061 7379 6e63  n_params = async
-0000caa0: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
-0000cab0: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
-0000cac0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-0000cad0: 2020 2066 6e5f 6e61 6d65 3d22 7265 7665     fn_name="reve
-0000cae0: 7274 5769 7468 4d65 7373 6167 6522 2c0a  rtWithMessage",.
-0000caf0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0000cb00: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
-0000cb10: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0000cb20: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-0000cb30: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
-0000cb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cb50: 2022 746f 223a 2061 7379 6e63 5f72 6576   "to": async_rev
-0000cb60: 6572 745f 636f 6e74 7261 6374 2e61 6464  ert_contract.add
-0000cb70: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-0000cb80: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
-0000cb90: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-0000cba0: 7374 2e72 6169 7365 7328 0a20 2020 2020  st.raises(.     
-0000cbb0: 2020 2020 2020 2043 6f6e 7472 6163 744c         ContractL
-0000cbc0: 6f67 6963 4572 726f 722c 206d 6174 6368  ogicError, match
-0000cbd0: 3d22 6578 6563 7574 696f 6e20 7265 7665  ="execution reve
-0000cbe0: 7274 6564 3a20 4675 6e63 7469 6f6e 2068  rted: Function h
-0000cbf0: 6173 2062 6565 6e20 7265 7665 7274 6564  as been reverted
-0000cc00: 220a 2020 2020 2020 2020 293a 0a20 2020  ".        ):.   
-0000cc10: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-0000cc20: 7379 6e63 5f77 332e 6574 682e 6361 6c6c  sync_w3.eth.call
-0000cc30: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-0000cc40: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-0000cc50: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-0000cc60: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
-0000cc70: 6c6c 5f72 6576 6572 745f 7769 7468 6f75  ll_revert_withou
-0000cc80: 745f 6d73 6728 0a20 2020 2020 2020 2073  t_msg(.        s
-0000cc90: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-0000cca0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-0000ccb0: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-0000ccc0: 635f 7265 7665 7274 5f63 6f6e 7472 6163  c_revert_contrac
-0000ccd0: 743a 2022 4173 796e 6343 6f6e 7472 6163  t: "AsyncContrac
-0000cce0: 7422 2c0a 2020 2020 2020 2020 6173 796e  t",.        asyn
-0000ccf0: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-0000cd00: 745f 6164 6472 6573 733a 2043 6865 636b  t_address: Check
-0000cd10: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-0000cd20: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000cd30: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0000cd40: 6169 7365 7328 436f 6e74 7261 6374 4c6f  aises(ContractLo
-0000cd50: 6769 6345 7272 6f72 2c20 6d61 7463 683d  gicError, match=
-0000cd60: 2265 7865 6375 7469 6f6e 2072 6576 6572  "execution rever
-0000cd70: 7465 6422 293a 0a20 2020 2020 2020 2020  ted"):.         
-0000cd80: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
-0000cd90: 6173 796e 635f 7265 7665 7274 5f63 6f6e  async_revert_con
-0000cda0: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
-0000cdb0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-0000cdc0: 2020 2020 2020 2020 2020 2020 666e 5f6e              fn_n
-0000cdd0: 616d 653d 2272 6576 6572 7457 6974 686f  ame="revertWitho
-0000cde0: 7574 4d65 7373 6167 6522 2c0a 2020 2020  utMessage",.    
-0000cdf0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0000ce00: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
-0000ce10: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0000ce20: 726f 6d22 3a20 6173 796e 635f 6b65 7966  rom": async_keyf
-0000ce30: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0000ce40: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-0000ce50: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
-0000ce60: 7379 6e63 5f72 6576 6572 745f 636f 6e74  sync_revert_cont
-0000ce70: 7261 6374 2e61 6464 7265 7373 2c0a 2020  ract.address,.  
-0000ce80: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0000ce90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000cea0: 2020 2020 2020 2020 2020 2061 7761 6974             await
-0000ceb0: 2061 7379 6e63 5f77 332e 6574 682e 6361   async_w3.eth.ca
-0000cec0: 6c6c 2874 786e 5f70 6172 616d 7329 0a0a  ll(txn_params)..
-0000ced0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000cee0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-0000cef0: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-0000cf00: 6361 6c6c 5f72 6576 6572 745f 6375 7374  call_revert_cust
-0000cf10: 6f6d 5f65 7272 6f72 5f77 6974 685f 6d73  om_error_with_ms
-0000cf20: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
-0000cf30: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000cf40: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000cf50: 2020 2020 2020 2020 6173 796e 635f 7265          async_re
-0000cf60: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-0000cf70: 4173 796e 6343 6f6e 7472 6163 7422 2c0a  AsyncContract",.
-0000cf80: 2020 2020 2020 2020 6173 796e 635f 6b65          async_ke
-0000cf90: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0000cfa0: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-0000cfb0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-0000cfc0: 204e 6f6e 653a 0a20 2020 2020 2020 2064   None:.        d
-0000cfd0: 6174 6120 3d20 6173 796e 635f 7265 7665  ata = async_reve
-0000cfe0: 7274 5f63 6f6e 7472 6163 742e 656e 636f  rt_contract.enco
-0000cff0: 6465 5f61 6269 280a 2020 2020 2020 2020  de_abi(.        
-0000d000: 2020 2020 666e 5f6e 616d 653d 2255 6e61      fn_name="Una
-0000d010: 7574 686f 7269 7a65 6457 6974 684d 6573  uthorizedWithMes
-0000d020: 7361 6765 222c 2061 7267 733d 5b22 596f  sage", args=["Yo
-0000d030: 7520 6172 6520 6e6f 7420 6175 7468 6f72  u are not author
-0000d040: 697a 6564 225d 0a20 2020 2020 2020 2029  ized"].        )
-0000d050: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-0000d060: 616d 7320 3d20 6173 796e 635f 7265 7665  ams = async_reve
-0000d070: 7274 5f63 6f6e 7472 6163 742e 5f70 7265  rt_contract._pre
-0000d080: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
-0000d090: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
-0000d0a0: 5f6e 616d 653d 2263 7573 746f 6d45 7272  _name="customErr
-0000d0b0: 6f72 5769 7468 4d65 7373 6167 6522 2c0a  orWithMessage",.
-0000d0c0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-0000d0d0: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
-0000d0e0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0000d0f0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-0000d100: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
-0000d110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d120: 2022 746f 223a 2061 7379 6e63 5f72 6576   "to": async_rev
-0000d130: 6572 745f 636f 6e74 7261 6374 2e61 6464  ert_contract.add
-0000d140: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-0000d150: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
-0000d160: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-0000d170: 7374 2e72 6169 7365 7328 436f 6e74 7261  st.raises(Contra
-0000d180: 6374 4375 7374 6f6d 4572 726f 722c 206d  ctCustomError, m
-0000d190: 6174 6368 3d64 6174 6129 3a0a 2020 2020  atch=data):.    
-0000d1a0: 2020 2020 2020 2020 6177 6169 7420 6173          await as
-0000d1b0: 796e 635f 7733 2e65 7468 2e63 616c 6c28  ync_w3.eth.call(
-0000d1c0: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-0000d1d0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000d1e0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000d1f0: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
-0000d200: 6c5f 7265 7665 7274 5f63 7573 746f 6d5f  l_revert_custom_
-0000d210: 6572 726f 725f 7769 7468 6f75 745f 6d73  error_without_ms
-0000d220: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
-0000d230: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000d240: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000d250: 2020 2020 2020 2020 6173 796e 635f 7265          async_re
-0000d260: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-0000d270: 4173 796e 6343 6f6e 7472 6163 7422 2c0a  AsyncContract",.
-0000d280: 2020 2020 2020 2020 6173 796e 635f 6b65          async_ke
-0000d290: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0000d2a0: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-0000d2b0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-0000d2c0: 204e 6f6e 653a 0a20 2020 2020 2020 2064   None:.        d
-0000d2d0: 6174 6120 3d20 6173 796e 635f 7265 7665  ata = async_reve
-0000d2e0: 7274 5f63 6f6e 7472 6163 742e 656e 636f  rt_contract.enco
-0000d2f0: 6465 5f61 6269 2866 6e5f 6e61 6d65 3d22  de_abi(fn_name="
-0000d300: 556e 6175 7468 6f72 697a 6564 2229 0a20  Unauthorized"). 
-0000d310: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0000d320: 7320 3d20 6173 796e 635f 7265 7665 7274  s = async_revert
-0000d330: 5f63 6f6e 7472 6163 742e 5f70 7265 7061  _contract._prepa
-0000d340: 7265 5f74 7261 6e73 6163 7469 6f6e 280a  re_transaction(.
-0000d350: 2020 2020 2020 2020 2020 2020 666e 5f6e              fn_n
-0000d360: 616d 653d 2263 7573 746f 6d45 7272 6f72  ame="customError
-0000d370: 5769 7468 6f75 744d 6573 7361 6765 222c  WithoutMessage",
-0000d380: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-0000d390: 6e73 6163 7469 6f6e 3d7b 0a20 2020 2020  nsaction={.     
-0000d3a0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0000d3b0: 223a 2061 7379 6e63 5f6b 6579 6669 6c65  ": async_keyfile
-0000d3c0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0000d3d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d3e0: 2020 2274 6f22 3a20 6173 796e 635f 7265    "to": async_re
-0000d3f0: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
-0000d400: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
-0000d410: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
-0000d420: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0000d430: 6573 742e 7261 6973 6573 2843 6f6e 7472  est.raises(Contr
-0000d440: 6163 7443 7573 746f 6d45 7272 6f72 2c20  actCustomError, 
-0000d450: 6d61 7463 683d 6461 7461 293a 0a20 2020  match=data):.   
-0000d460: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-0000d470: 7379 6e63 5f77 332e 6574 682e 6361 6c6c  sync_w3.eth.call
-0000d480: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-0000d490: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
-0000d4a0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-0000d4b0: 2020 2020 2270 616e 6963 5f65 7272 6f72      "panic_error
-0000d4c0: 2c70 6172 616d 7322 2c0a 2020 2020 2020  ,params",.      
-0000d4d0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0000d4e0: 2822 3031 222c 205b 5d29 2c0a 2020 2020  ("01", []),.    
-0000d4f0: 2020 2020 2020 2020 2822 3131 222c 205b          ("11", [
-0000d500: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000d510: 2822 3132 222c 205b 305d 292c 0a20 2020  ("12", [0]),.   
-0000d520: 2020 2020 2020 2020 2028 2232 3122 2c20           ("21", 
-0000d530: 5b2d 315d 292c 0a20 2020 2020 2020 2020  [-1]),.         
-0000d540: 2020 2028 2232 3222 2c20 5b5d 292c 0a20     ("22", []),. 
-0000d550: 2020 2020 2020 2020 2020 2028 2233 3122             ("31"
-0000d560: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
-0000d570: 2020 2028 2233 3222 2c20 5b5d 292c 0a20     ("32", []),. 
-0000d580: 2020 2020 2020 2020 2020 2028 2234 3122             ("41"
-0000d590: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
-0000d5a0: 2020 2028 2235 3122 2c20 5b5d 292c 0a20     ("51", []),. 
-0000d5b0: 2020 2020 2020 2029 2c0a 2020 2020 290a         ),.    ).
-0000d5c0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000d5d0: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-0000d5e0: 6e63 2064 6566 2074 6573 745f 636f 6e74  nc def test_cont
-0000d5f0: 7261 6374 5f70 616e 6963 5f65 7272 6f72  ract_panic_error
-0000d600: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0000d610: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000d620: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-0000d630: 2020 2020 2020 2020 6173 796e 635f 7061          async_pa
-0000d640: 6e69 635f 6572 726f 7273 5f63 6f6e 7472  nic_errors_contr
-0000d650: 6163 743a 2022 4173 796e 6343 6f6e 7472  act: "AsyncContr
-0000d660: 6163 7422 2c0a 2020 2020 2020 2020 7061  act",.        pa
-0000d670: 6e69 635f 6572 726f 723a 2073 7472 2c0a  nic_error: str,.
-0000d680: 2020 2020 2020 2020 7061 7261 6d73 3a20          params: 
-0000d690: 4c69 7374 5b41 6e79 5d2c 0a20 2020 2029  List[Any],.    )
-0000d6a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000d6b0: 2020 6d65 7468 6f64 203d 2067 6574 6174    method = getat
-0000d6c0: 7472 280a 2020 2020 2020 2020 2020 2020  tr(.            
-0000d6d0: 6173 796e 635f 7061 6e69 635f 6572 726f  async_panic_erro
-0000d6e0: 7273 5f63 6f6e 7472 6163 742e 6675 6e63  rs_contract.func
-0000d6f0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0000d700: 2020 2066 2265 7272 6f72 436f 6465 7b70     f"errorCode{p
-0000d710: 616e 6963 5f65 7272 6f72 7d22 2c0a 2020  anic_error}",.  
-0000d720: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000d730: 6572 726f 725f 6d73 6720 3d20 5041 4e49  error_msg = PANI
-0000d740: 435f 4552 524f 525f 434f 4445 535b 7061  C_ERROR_CODES[pa
-0000d750: 6e69 635f 6572 726f 725d 0a0a 2020 2020  nic_error]..    
-0000d760: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0000d770: 7261 6973 6573 2843 6f6e 7472 6163 7450  raises(ContractP
-0000d780: 616e 6963 4572 726f 722c 206d 6174 6368  anicError, match
-0000d790: 3d72 652e 6573 6361 7065 2865 7272 6f72  =re.escape(error
-0000d7a0: 5f6d 7367 2929 3a0a 2020 2020 2020 2020  _msg)):.        
-0000d7b0: 2020 2020 6177 6169 7420 6d65 7468 6f64      await method
-0000d7c0: 282a 7061 7261 6d73 292e 6361 6c6c 2829  (*params).call()
-0000d7d0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-0000d7e0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-0000d7f0: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
-0000d800: 685f 6361 6c6c 5f6f 6666 6368 6169 6e5f  h_call_offchain_
-0000d810: 6c6f 6f6b 7570 280a 2020 2020 2020 2020  lookup(.        
-0000d820: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
-0000d830: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-0000d840: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
-0000d850: 6e63 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  nc_offchain_look
-0000d860: 7570 5f63 6f6e 7472 6163 743a 2022 4173  up_contract: "As
-0000d870: 796e 6343 6f6e 7472 6163 7422 2c0a 2020  yncContract",.  
-0000d880: 2020 2020 2020 6173 796e 635f 6b65 7966        async_keyf
-0000d890: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0000d8a0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
-0000d8b0: 7265 7373 2c0a 2020 2020 2020 2020 6d6f  ress,.        mo
-0000d8c0: 6e6b 6579 7061 7463 683a 2022 4d6f 6e6b  nkeypatch: "Monk
-0000d8d0: 6579 5061 7463 6822 2c0a 2020 2020 2920  eyPatch",.    ) 
-0000d8e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000d8f0: 206e 6f72 6d61 6c69 7a65 645f 636f 6e74   normalized_cont
-0000d900: 7261 6374 5f61 6464 7265 7373 203d 2074  ract_address = t
-0000d910: 6f5f 6865 785f 6966 5f62 7974 6573 280a  o_hex_if_bytes(.
-0000d920: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
-0000d930: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
-0000d940: 705f 636f 6e74 7261 6374 2e61 6464 7265  p_contract.addre
-0000d950: 7373 0a20 2020 2020 2020 2029 2e6c 6f77  ss.        ).low
-0000d960: 6572 2829 0a0a 2020 2020 2020 2020 6173  er()..        as
-0000d970: 796e 635f 6d6f 636b 5f6f 6666 6368 6169  ync_mock_offchai
-0000d980: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
-0000d990: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
-0000d9a0: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
-0000d9b0: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-0000d9c0: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
-0000d9d0: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
-0000d9e0: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
-0000d9f0: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-0000da00: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
-0000da10: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
-0000da20: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
-0000da30: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-0000da40: 2020 2020 2020 2020 6d6f 636b 6564 5f6a          mocked_j
-0000da50: 736f 6e5f 6461 7461 3d57 4542 3350 595f  son_data=WEB3PY_
-0000da60: 4153 5f48 4558 4259 5445 532c 0a20 2020  AS_HEXBYTES,.   
-0000da70: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000da80: 6573 706f 6e73 655f 6361 6c6c 6572 203d  esponse_caller =
-0000da90: 2061 7761 6974 2061 7379 6e63 5f6f 6666   await async_off
-0000daa0: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000dab0: 7472 6163 742e 6361 6c6c 6572 2829 2e74  tract.caller().t
-0000dac0: 6573 744f 6666 6368 6169 6e4c 6f6f 6b75  estOffchainLooku
-0000dad0: 7028 2020 2320 6e6f 7161 3a20 4535 3031  p(  # noqa: E501
-0000dae0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-0000daf0: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
-0000db00: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
-0000db10: 4154 410a 2020 2020 2020 2020 290a 2020  ATA.        ).  
-0000db20: 2020 2020 2020 7265 7370 6f6e 7365 5f66        response_f
-0000db30: 756e 6374 696f 6e5f 6361 6c6c 203d 2061  unction_call = a
-0000db40: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
-0000db50: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-0000db60: 6163 742e 6675 6e63 7469 6f6e 732e 7465  act.functions.te
-0000db70: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
-0000db80: 2820 2023 206e 6f71 613a 2045 3530 3120  (  # noqa: E501 
-0000db90: 7479 7065 3a20 6967 6e6f 7265 0a20 2020  type: ignore.   
-0000dba0: 2020 2020 2020 2020 204f 4646 4348 4149           OFFCHAI
-0000dbb0: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
-0000dbc0: 5441 0a20 2020 2020 2020 2029 2e63 616c  TA.        ).cal
-0000dbd0: 6c28 290a 2020 2020 2020 2020 6173 7365  l().        asse
-0000dbe0: 7274 2061 7379 6e63 5f77 332e 636f 6465  rt async_w3.code
-0000dbf0: 632e 6465 636f 6465 285b 2273 7472 696e  c.decode(["strin
-0000dc00: 6722 5d2c 2072 6573 706f 6e73 655f 6361  g"], response_ca
-0000dc10: 6c6c 6572 295b 305d 203d 3d20 2277 6562  ller)[0] == "web
-0000dc20: 3370 7922 0a20 2020 2020 2020 2061 7373  3py".        ass
-0000dc30: 6572 7420 6173 796e 635f 7733 2e63 6f64  ert async_w3.cod
-0000dc40: 6563 2e64 6563 6f64 6528 5b22 7374 7269  ec.decode(["stri
-0000dc50: 6e67 225d 2c20 7265 7370 6f6e 7365 5f66  ng"], response_f
-0000dc60: 756e 6374 696f 6e5f 6361 6c6c 295b 305d  unction_call)[0]
-0000dc70: 203d 3d20 2277 6562 3370 7922 0a0a 2020   == "web3py"..  
-0000dc80: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-0000dc90: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-0000dca0: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
-0000dcb0: 6c6c 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ll_offchain_look
-0000dcc0: 7570 5f72 6169 7365 735f 7768 656e 5f63  up_raises_when_c
-0000dcd0: 6369 705f 7265 6164 5f69 735f 6469 7361  cip_read_is_disa
-0000dce0: 626c 6564 280a 2020 2020 2020 2020 7365  bled(.        se
-0000dcf0: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-0000dd00: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-0000dd10: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-0000dd20: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-0000dd30: 5f63 6f6e 7472 6163 743a 2022 4173 796e  _contract: "Asyn
-0000dd40: 6343 6f6e 7472 6163 7422 2c0a 2020 2020  cContract",.    
-0000dd50: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000dd60: 2020 2072 6574 7572 6e5f 6461 7461 203d     return_data =
-0000dd70: 2028 0a20 2020 2020 2020 2020 2020 204f   (.            O
-0000dd80: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f34  FFCHAIN_LOOKUP_4
-0000dd90: 4259 5445 5f44 4154 410a 2020 2020 2020  BYTE_DATA.      
-0000dda0: 2020 2020 2020 2b20 6162 695f 656e 636f        + abi_enco
-0000ddb0: 6465 645f 6f66 6663 6861 696e 5f6c 6f6f  ded_offchain_loo
-0000ddc0: 6b75 705f 636f 6e74 7261 6374 5f61 6464  kup_contract_add
-0000ddd0: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
-0000dde0: 2020 2020 2020 6173 796e 635f 7733 2c20        async_w3, 
-0000ddf0: 6173 796e 635f 6f66 6663 6861 696e 5f6c  async_offchain_l
-0000de00: 6f6f 6b75 705f 636f 6e74 7261 6374 0a20  ookup_contract. 
-0000de10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000de20: 2020 2020 2020 2020 202b 204f 4646 4348           + OFFCH
-0000de30: 4149 4e5f 4c4f 4f4b 5550 5f52 4554 5552  AIN_LOOKUP_RETUR
-0000de40: 4e5f 4441 5441 0a20 2020 2020 2020 2029  N_DATA.        )
-0000de50: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
-0000de60: 4173 796e 6343 6f6e 7472 6163 7443 616c  AsyncContractCal
-0000de70: 6c65 720a 2020 2020 2020 2020 7769 7468  ler.        with
-0000de80: 2070 7974 6573 742e 7261 6973 6573 284f   pytest.raises(O
-0000de90: 6666 6368 6169 6e4c 6f6f 6b75 7029 2061  ffchainLookup) a
-0000dea0: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-0000deb0: 2061 7761 6974 2061 7379 6e63 5f6f 6666   await async_off
-0000dec0: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000ded0: 7472 6163 742e 6361 6c6c 6572 280a 2020  tract.caller(.  
-0000dee0: 2020 2020 2020 2020 2020 2020 2020 6363                cc
-0000def0: 6970 5f72 6561 645f 656e 6162 6c65 643d  ip_read_enabled=
-0000df00: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0000df10: 2020 292e 7465 7374 4f66 6663 6861 696e    ).testOffchain
-0000df20: 4c6f 6f6b 7570 284f 4646 4348 4149 4e5f  Lookup(OFFCHAIN_
-0000df30: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
-0000df40: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0000df50: 2065 2e76 616c 7565 2e64 6174 6120 3d3d   e.value.data ==
-0000df60: 2072 6574 7572 6e5f 6461 7461 0a0a 2020   return_data..  
-0000df70: 2020 2020 2020 2320 7465 7374 2041 7379        # test Asy
-0000df80: 6e63 436f 6e74 7261 6374 4675 6e63 7469  ncContractFuncti
-0000df90: 6f6e 2063 616c 6c0a 2020 2020 2020 2020  on call.        
-0000dfa0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0000dfb0: 6573 284f 6666 6368 6169 6e4c 6f6f 6b75  es(OffchainLooku
-0000dfc0: 7029 2061 7320 6578 6369 6e66 6f3a 0a20  p) as excinfo:. 
-0000dfd0: 2020 2020 2020 2020 2020 2061 7761 6974             await
-0000dfe0: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
-0000dff0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-0000e000: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-0000e010: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
-0000e020: 2020 2020 2020 2020 2020 2020 2020 4f46                OF
-0000e030: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-0000e040: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
-0000e050: 2020 2020 292e 6361 6c6c 2863 6369 705f      ).call(ccip_
-0000e060: 7265 6164 5f65 6e61 626c 6564 3d46 616c  read_enabled=Fal
-0000e070: 7365 290a 2020 2020 2020 2020 6173 7365  se).        asse
-0000e080: 7274 2065 7863 696e 666f 2e76 616c 7565  rt excinfo.value
-0000e090: 2e64 6174 6120 3d3d 2072 6574 7572 6e5f  .data == return_
-0000e0a0: 6461 7461 0a0a 2020 2020 2020 2020 2320  data..        # 
-0000e0b0: 7465 7374 2067 6c6f 6261 6c20 666c 6167  test global flag
-0000e0c0: 206f 6e20 7468 6520 7072 6f76 6964 6572   on the provider
-0000e0d0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000e0e0: 332e 7072 6f76 6964 6572 2e67 6c6f 6261  3.provider.globa
-0000e0f0: 6c5f 6363 6970 5f72 6561 645f 656e 6162  l_ccip_read_enab
-0000e100: 6c65 6420 3d20 4661 6c73 650a 0a20 2020  led = False..   
-0000e110: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0000e120: 2e72 6169 7365 7328 4f66 6663 6861 696e  .raises(Offchain
-0000e130: 4c6f 6f6b 7570 2920 6173 2065 7863 5f69  Lookup) as exc_i
-0000e140: 6e66 6f3a 0a20 2020 2020 2020 2020 2020  nfo:.           
-0000e150: 2061 7761 6974 2061 7379 6e63 5f6f 6666   await async_off
-0000e160: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
-0000e170: 7472 6163 742e 6675 6e63 7469 6f6e 732e  tract.functions.
-0000e180: 7465 7374 4f66 6663 6861 696e 4c6f 6f6b  testOffchainLook
-0000e190: 7570 2820 2023 206e 6f71 613a 2045 3530  up(  # noqa: E50
-0000e1a0: 3120 7479 7065 3a20 6967 6e6f 7265 0a20  1 type: ignore. 
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 204f                 O
-0000e1c0: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
-0000e1d0: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
-0000e1e0: 2020 2020 2029 2e63 616c 6c28 290a 2020       ).call().  
-0000e1f0: 2020 2020 2020 6173 7365 7274 2065 7863        assert exc
-0000e200: 5f69 6e66 6f2e 7661 6c75 652e 6461 7461  _info.value.data
-0000e210: 203d 3d20 7265 7475 726e 5f64 6174 610a   == return_data.
-0000e220: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-0000e230: 332e 7072 6f76 6964 6572 2e67 6c6f 6261  3.provider.globa
-0000e240: 6c5f 6363 6970 5f72 6561 645f 656e 6162  l_ccip_read_enab
-0000e250: 6c65 6420 3d20 5472 7565 2020 2320 636c  led = True  # cl
-0000e260: 6561 6e75 700a 0a20 2020 2040 7079 7465  eanup..    @pyte
-0000e270: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-0000e280: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-0000e290: 7374 5f65 7468 5f63 616c 6c5f 6f66 6663  st_eth_call_offc
-0000e2a0: 6861 696e 5f6c 6f6f 6b75 705f 6361 6c6c  hain_lookup_call
-0000e2b0: 5f66 6c61 675f 6f76 6572 7269 6465 735f  _flag_overrides_
-0000e2c0: 7072 6f76 6964 6572 5f66 6c61 6728 0a20  provider_flag(. 
-0000e2d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000e2e0: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-0000e2f0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-0000e300: 2020 2020 6173 796e 635f 6f66 6663 6861      async_offcha
-0000e310: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-0000e320: 6374 3a20 2241 7379 6e63 436f 6e74 7261  ct: "AsyncContra
-0000e330: 6374 222c 0a20 2020 2020 2020 2061 7379  ct",.        asy
-0000e340: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-0000e350: 6e74 5f61 6464 7265 7373 3a20 4368 6563  nt_address: Chec
-0000e360: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-0000e370: 2020 2020 206d 6f6e 6b65 7970 6174 6368       monkeypatch
-0000e380: 3a20 224d 6f6e 6b65 7950 6174 6368 222c  : "MonkeyPatch",
-0000e390: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0000e3a0: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
-0000e3b0: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
-0000e3c0: 6573 7320 3d20 746f 5f68 6578 5f69 665f  ess = to_hex_if_
-0000e3d0: 6279 7465 7328 0a20 2020 2020 2020 2020  bytes(.         
-0000e3e0: 2020 2061 7379 6e63 5f6f 6666 6368 6169     async_offchai
-0000e3f0: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
-0000e400: 742e 6164 6472 6573 730a 2020 2020 2020  t.address.      
-0000e410: 2020 292e 6c6f 7765 7228 290a 0a20 2020    ).lower()..   
-0000e420: 2020 2020 2061 7379 6e63 5f6d 6f63 6b5f       async_mock_
-0000e430: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000e440: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
-0000e450: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
-0000e460: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
-0000e470: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
-0000e480: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
-0000e490: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
-0000e4a0: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
-0000e4b0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-0000e4c0: 7d2f 7b4f 4646 4348 4149 4e5f 4c4f 4f4b  }/{OFFCHAIN_LOOK
-0000e4d0: 5550 5f54 4553 545f 4441 5441 7d2e 6a73  UP_TEST_DATA}.js
-0000e4e0: 6f6e 222c 2020 2320 6e6f 7161 3a20 4535  on",  # noqa: E5
-0000e4f0: 3031 0a20 2020 2020 2020 2020 2020 206d  01.            m
-0000e500: 6f63 6b65 645f 6a73 6f6e 5f64 6174 613d  ocked_json_data=
-0000e510: 5745 4233 5059 5f41 535f 4845 5842 5954  WEB3PY_AS_HEXBYT
-0000e520: 4553 2c0a 2020 2020 2020 2020 290a 0a20  ES,.        ).. 
-0000e530: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
-0000e540: 7072 6f76 6964 6572 2e67 6c6f 6261 6c5f  provider.global_
-0000e550: 6363 6970 5f72 6561 645f 656e 6162 6c65  ccip_read_enable
-0000e560: 6420 3d20 4661 6c73 650a 0a20 2020 2020  d = False..     
-0000e570: 2020 2072 6573 706f 6e73 6520 3d20 6177     response = aw
-0000e580: 6169 7420 6173 796e 635f 6f66 6663 6861  ait async_offcha
-0000e590: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-0000e5a0: 6374 2e66 756e 6374 696f 6e73 2e74 6573  ct.functions.tes
-0000e5b0: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
-0000e5c0: 0a20 2020 2020 2020 2020 2020 204f 4646  .            OFF
-0000e5d0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
-0000e5e0: 545f 4441 5441 0a20 2020 2020 2020 2029  T_DATA.        )
-0000e5f0: 2e63 616c 6c28 6363 6970 5f72 6561 645f  .call(ccip_read_
-0000e600: 656e 6162 6c65 643d 5472 7565 290a 2020  enabled=True).  
-0000e610: 2020 2020 2020 6173 7365 7274 2061 7379        assert asy
-0000e620: 6e63 5f77 332e 636f 6465 632e 6465 636f  nc_w3.codec.deco
-0000e630: 6465 285b 2273 7472 696e 6722 5d2c 2072  de(["string"], r
-0000e640: 6573 706f 6e73 6529 5b30 5d20 3d3d 2022  esponse)[0] == "
-0000e650: 7765 6233 7079 220a 0a20 2020 2020 2020  web3py"..       
-0000e660: 2061 7379 6e63 5f77 332e 7072 6f76 6964   async_w3.provid
-0000e670: 6572 2e67 6c6f 6261 6c5f 6363 6970 5f72  er.global_ccip_r
-0000e680: 6561 645f 656e 6162 6c65 6420 3d20 5472  ead_enabled = Tr
-0000e690: 7565 2020 2320 636c 6561 6e75 700a 0a20  ue  # cleanup.. 
-0000e6a0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-0000e6b0: 6173 796e 6369 6f0a 2020 2020 4070 7974  asyncio.    @pyt
-0000e6c0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0000e6d0: 7269 7a65 2822 6d61 785f 7265 6469 7265  rize("max_redire
-0000e6e0: 6374 7322 2c20 7261 6e67 6528 2d31 2c20  cts", range(-1, 
-0000e6f0: 3429 290a 2020 2020 6173 796e 6320 6465  4)).    async de
-0000e700: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
-0000e710: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000e720: 7261 6973 6573 5f69 665f 6d61 785f 7265  raises_if_max_re
-0000e730: 6469 7265 6374 735f 6973 5f6c 6573 735f  directs_is_less_
-0000e740: 7468 616e 5f34 280a 2020 2020 2020 2020  than_4(.        
-0000e750: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
-0000e760: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-0000e770: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
-0000e780: 6e63 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  nc_offchain_look
-0000e790: 7570 5f63 6f6e 7472 6163 743a 2022 4173  up_contract: "As
-0000e7a0: 796e 6343 6f6e 7472 6163 7422 2c0a 2020  yncContract",.  
-0000e7b0: 2020 2020 2020 6d61 785f 7265 6469 7265        max_redire
-0000e7c0: 6374 733a 2069 6e74 2c0a 2020 2020 2920  cts: int,.    ) 
-0000e7d0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000e7e0: 2064 6566 6175 6c74 5f6d 6178 5f72 6564   default_max_red
-0000e7f0: 6972 6563 7473 203d 2061 7379 6e63 5f77  irects = async_w
-0000e800: 332e 7072 6f76 6964 6572 2e63 6369 705f  3.provider.ccip_
-0000e810: 7265 6164 5f6d 6178 5f72 6564 6972 6563  read_max_redirec
-0000e820: 7473 0a0a 2020 2020 2020 2020 6173 796e  ts..        asyn
-0000e830: 635f 7733 2e70 726f 7669 6465 722e 6363  c_w3.provider.cc
-0000e840: 6970 5f72 6561 645f 6d61 785f 7265 6469  ip_read_max_redi
-0000e850: 7265 6374 7320 3d20 6d61 785f 7265 6469  rects = max_redi
-0000e860: 7265 6374 730a 2020 2020 2020 2020 7769  rects.        wi
-0000e870: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-0000e880: 2857 6562 3356 616c 7565 4572 726f 722c  (Web3ValueError,
-0000e890: 206d 6174 6368 3d22 6174 206c 6561 7374   match="at least
-0000e8a0: 2034 2229 3a0a 2020 2020 2020 2020 2020   4"):.          
-0000e8b0: 2020 6177 6169 7420 6173 796e 635f 6f66    await async_of
-0000e8c0: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-0000e8d0: 6e74 7261 6374 2e63 616c 6c65 7228 292e  ntract.caller().
-0000e8e0: 7465 7374 4f66 6663 6861 696e 4c6f 6f6b  testOffchainLook
-0000e8f0: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
-0000e900: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
-0000e910: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
-0000e920: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000e930: 2020 2020 2061 7379 6e63 5f77 332e 7072       async_w3.pr
-0000e940: 6f76 6964 6572 2e63 6369 705f 7265 6164  ovider.ccip_read
-0000e950: 5f6d 6178 5f72 6564 6972 6563 7473 203d  _max_redirects =
-0000e960: 2064 6566 6175 6c74 5f6d 6178 5f72 6564   default_max_red
-0000e970: 6972 6563 7473 2020 2320 636c 6561 6e75  irects  # cleanu
-0000e980: 700a 0a20 2020 2040 7079 7465 7374 2e6d  p..    @pytest.m
-0000e990: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-0000e9a0: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-0000e9b0: 7468 5f63 616c 6c5f 6f66 6663 6861 696e  th_call_offchain
-0000e9c0: 5f6c 6f6f 6b75 705f 7261 6973 6573 5f66  _lookup_raises_f
-0000e9d0: 6f72 5f69 6d70 726f 7065 726c 795f 666f  or_improperly_fo
-0000e9e0: 726d 6174 7465 645f 7265 7374 5f72 6571  rmatted_rest_req
-0000e9f0: 7565 7374 5f72 6573 706f 6e73 6528 2020  uest_response(  
-0000ea00: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
-0000ea10: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000ea20: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-0000ea30: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-0000ea40: 2020 6173 796e 635f 6f66 6663 6861 696e    async_offchain
-0000ea50: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
-0000ea60: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
-0000ea70: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-0000ea80: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-0000ea90: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-0000eaa0: 756d 4164 6472 6573 732c 0a20 2020 2020  umAddress,.     
-0000eab0: 2020 206d 6f6e 6b65 7970 6174 6368 3a20     monkeypatch: 
-0000eac0: 224d 6f6e 6b65 7950 6174 6368 222c 0a20  "MonkeyPatch",. 
-0000ead0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000eae0: 2020 2020 2020 6e6f 726d 616c 697a 6564        normalized
-0000eaf0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-0000eb00: 7320 3d20 746f 5f68 6578 5f69 665f 6279  s = to_hex_if_by
-0000eb10: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-0000eb20: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
-0000eb30: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-0000eb40: 6164 6472 6573 730a 2020 2020 2020 2020  address.        
-0000eb50: 292e 6c6f 7765 7228 290a 0a20 2020 2020  ).lower()..     
-0000eb60: 2020 2061 7379 6e63 5f6d 6f63 6b5f 6f66     async_mock_of
-0000eb70: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
-0000eb80: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
-0000eb90: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
-0000eba0: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
-0000ebb0: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
-0000ebc0: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
-0000ebd0: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
-0000ebe0: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
-0000ebf0: 6e74 7261 6374 5f61 6464 7265 7373 7d2f  ntract_address}/
-0000ec00: 7b4f 4646 4348 4149 4e5f 4c4f 4f4b 5550  {OFFCHAIN_LOOKUP
-0000ec10: 5f54 4553 545f 4441 5441 7d2e 6a73 6f6e  _TEST_DATA}.json
-0000ec20: 222c 2020 2320 6e6f 7161 3a20 4535 3031  ",  # noqa: E501
-0000ec30: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-0000ec40: 6b65 645f 6a73 6f6e 5f64 6174 613d 5745  ked_json_data=WE
-0000ec50: 4233 5059 5f41 535f 4845 5842 5954 4553  B3PY_AS_HEXBYTES
-0000ec60: 2c0a 2020 2020 2020 2020 2020 2020 6a73  ,.            js
-0000ec70: 6f6e 5f64 6174 615f 6669 656c 643d 226e  on_data_field="n
-0000ec80: 6f74 5f64 6174 6122 2c0a 2020 2020 2020  ot_data",.      
-0000ec90: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-0000eca0: 2070 7974 6573 742e 7261 6973 6573 2857   pytest.raises(W
-0000ecb0: 6562 3356 616c 6964 6174 696f 6e45 7272  eb3ValidationErr
-0000ecc0: 6f72 2c20 6d61 7463 683d 226d 6973 7369  or, match="missi
-0000ecd0: 6e67 2027 6461 7461 2720 6669 656c 6422  ng 'data' field"
-0000ece0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-0000ecf0: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
-0000ed00: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-0000ed10: 6163 742e 6361 6c6c 6572 2829 2e74 6573  act.caller().tes
-0000ed20: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
-0000ed30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ed40: 204f 4646 4348 4149 4e5f 4c4f 4f4b 5550   OFFCHAIN_LOOKUP
-0000ed50: 5f54 4553 545f 4441 5441 0a20 2020 2020  _TEST_DATA.     
-0000ed60: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-0000ed70: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000ed80: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
-0000ed90: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000eda0: 2273 7461 7475 735f 636f 6465 5f6e 6f6e  "status_code_non
-0000edb0: 5f34 7878 5f65 7272 6f72 222c 205b 3130  _4xx_error", [10
-0000edc0: 302c 2033 3030 2c20 3530 302c 2036 3030  0, 300, 500, 600
-0000edd0: 5d29 0a20 2020 2061 7379 6e63 2064 6566  ]).    async def
-0000ede0: 2074 6573 745f 6574 685f 6361 6c6c 5f6f   test_eth_call_o
-0000edf0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f74  ffchain_lookup_t
-0000ee00: 7269 6573 5f6e 6578 745f 7572 6c5f 666f  ries_next_url_fo
-0000ee10: 725f 6e6f 6e5f 3478 785f 6572 726f 725f  r_non_4xx_error_
-0000ee20: 7374 6174 7573 5f61 6e64 5f74 6573 7473  status_and_tests
-0000ee30: 5f50 4f53 5428 2020 2320 6e6f 7161 3a20  _POST(  # noqa: 
-0000ee40: 4535 3031 0a20 2020 2020 2020 2073 656c  E501.        sel
-0000ee50: 662c 0a20 2020 2020 2020 2061 7379 6e63  f,.        async
-0000ee60: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-0000ee70: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-0000ee80: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000ee90: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
-0000eea0: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
-0000eeb0: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
-0000eec0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0000eed0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-0000eee0: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
-0000eef0: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
-0000ef00: 6174 6368 222c 0a20 2020 2020 2020 2073  atch",.        s
-0000ef10: 7461 7475 735f 636f 6465 5f6e 6f6e 5f34  tatus_code_non_4
-0000ef20: 7878 5f65 7272 6f72 3a20 696e 742c 0a20  xx_error: int,. 
-0000ef30: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0000ef40: 2020 2020 2020 6e6f 726d 616c 697a 6564        normalized
-0000ef50: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-0000ef60: 7320 3d20 746f 5f68 6578 5f69 665f 6279  s = to_hex_if_by
-0000ef70: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-0000ef80: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
-0000ef90: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-0000efa0: 6164 6472 6573 730a 2020 2020 2020 2020  address.        
-0000efb0: 292e 6c6f 7765 7228 290a 0a20 2020 2020  ).lower()..     
-0000efc0: 2020 2023 2054 6865 206e 6578 7420 7572     # The next ur
-0000efd0: 6c20 696e 206f 7572 2074 6573 7420 636f  l in our test co
-0000efe0: 6e74 7261 6374 2064 6f65 736e 2774 2063  ntract doesn't c
-0000eff0: 6f6e 7461 696e 2027 7b64 6174 617d 272c  ontain '{data}',
-0000f000: 2074 7269 6767 6572 696e 670a 2020 2020   triggering.    
-0000f010: 2020 2020 2320 7468 6520 504f 5354 2072      # the POST r
-0000f020: 6571 7565 7374 206c 6f67 6963 2e20 5468  equest logic. Th
-0000f030: 6520 6964 6561 2068 6572 6520 6973 2074  e idea here is t
-0000f040: 6f20 7265 7475 726e 2061 2062 6164 2073  o return a bad s
-0000f050: 7461 7475 7320 666f 7220 7468 650a 2020  tatus for the.  
-0000f060: 2020 2020 2020 2320 6669 7273 7420 7572        # first ur
-0000f070: 6c20 2847 4554 2920 616e 6420 6120 7375  l (GET) and a su
-0000f080: 6363 6573 7320 7374 6174 7573 2066 6f72  ccess status for
-0000f090: 2074 6865 2073 6563 6f6e 6420 6361 6c6c   the second call
-0000f0a0: 2028 504f 5354 2920 746f 2074 6573 740a   (POST) to test.
-0000f0b0: 2020 2020 2020 2020 2320 626f 7468 2074          # both t
-0000f0c0: 6861 7420 7765 206d 6f76 6520 6f6e 2074  hat we move on t
-0000f0d0: 6f20 7468 6520 6e65 7874 2075 726c 2077  o the next url w
-0000f0e0: 6974 6820 6e6f 6e2d 3478 7820 7374 6174  ith non-4xx stat
-0000f0f0: 7573 2061 6e64 2074 6861 7420 7468 650a  us and that the.
-0000f100: 2020 2020 2020 2020 2320 504f 5354 206c          # POST l
-0000f110: 6f67 6963 2069 7320 616c 736f 2077 6f72  ogic is also wor
-0000f120: 6b69 6e67 2061 7320 6578 7065 6374 6564  king as expected
-0000f130: 2e0a 2020 2020 2020 2020 6173 796e 635f  ..        async_
-0000f140: 6d6f 636b 5f6f 6666 6368 6169 6e5f 6c6f  mock_offchain_lo
-0000f150: 6f6b 7570 5f72 6571 7565 7374 5f72 6573  okup_request_res
-0000f160: 706f 6e73 6528 0a20 2020 2020 2020 2020  ponse(.         
-0000f170: 2020 206d 6f6e 6b65 7970 6174 6368 2c0a     monkeypatch,.
-0000f180: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
-0000f190: 6564 5f72 6571 7565 7374 5f75 726c 3d66  ed_request_url=f
-0000f1a0: 2268 7474 7073 3a2f 2f77 6562 332e 7079  "https://web3.py
-0000f1b0: 2f67 6174 6577 6179 2f7b 6e6f 726d 616c  /gateway/{normal
-0000f1c0: 697a 6564 5f63 6f6e 7472 6163 745f 6164  ized_contract_ad
-0000f1d0: 6472 6573 737d 2f7b 4f46 4643 4841 494e  dress}/{OFFCHAIN
-0000f1e0: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
-0000f1f0: 417d 2e6a 736f 6e22 2c20 2023 206e 6f71  A}.json",  # noq
-0000f200: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
-0000f210: 2020 2020 6d6f 636b 6564 5f73 7461 7475      mocked_statu
-0000f220: 735f 636f 6465 3d73 7461 7475 735f 636f  s_code=status_co
-0000f230: 6465 5f6e 6f6e 5f34 7878 5f65 7272 6f72  de_non_4xx_error
-0000f240: 2c0a 2020 2020 2020 2020 2020 2020 6d6f  ,.            mo
-0000f250: 636b 6564 5f6a 736f 6e5f 6461 7461 3d57  cked_json_data=W
-0000f260: 4542 3350 595f 4153 5f48 4558 4259 5445  EB3PY_AS_HEXBYTE
-0000f270: 532c 0a20 2020 2020 2020 2029 0a20 2020  S,.        ).   
-0000f280: 2020 2020 2061 7379 6e63 5f6d 6f63 6b5f       async_mock_
-0000f290: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-0000f2a0: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
-0000f2b0: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
-0000f2c0: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
-0000f2d0: 2020 2020 2020 2068 7474 705f 6d65 7468         http_meth
-0000f2e0: 6f64 3d22 504f 5354 222c 0a20 2020 2020  od="POST",.     
-0000f2f0: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
-0000f300: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
-0000f310: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
-0000f320: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
-0000f330: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-0000f340: 7d2e 6a73 6f6e 222c 2020 2320 6e6f 7161  }.json",  # noqa
-0000f350: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
-0000f360: 2020 206d 6f63 6b65 645f 7374 6174 7573     mocked_status
-0000f370: 5f63 6f64 653d 3230 302c 0a20 2020 2020  _code=200,.     
-0000f380: 2020 2020 2020 206d 6f63 6b65 645f 6a73         mocked_js
-0000f390: 6f6e 5f64 6174 613d 5745 4233 5059 5f41  on_data=WEB3PY_A
-0000f3a0: 535f 4845 5842 5954 4553 2c0a 2020 2020  S_HEXBYTES,.    
-0000f3b0: 2020 2020 2020 2020 7365 6e64 6572 3d6e          sender=n
-0000f3c0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
-0000f3d0: 6374 5f61 6464 7265 7373 2c0a 2020 2020  ct_address,.    
-0000f3e0: 2020 2020 2020 2020 6361 6c6c 6461 7461          calldata
-0000f3f0: 3d4f 4646 4348 4149 4e5f 4c4f 4f4b 5550  =OFFCHAIN_LOOKUP
-0000f400: 5f54 4553 545f 4441 5441 2c0a 2020 2020  _TEST_DATA,.    
-0000f410: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000f420: 7370 6f6e 7365 203d 2061 7761 6974 2061  sponse = await a
-0000f430: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
-0000f440: 6f6b 7570 5f63 6f6e 7472 6163 742e 6361  okup_contract.ca
-0000f450: 6c6c 6572 2829 2e74 6573 744f 6666 6368  ller().testOffch
-0000f460: 6169 6e4c 6f6f 6b75 7028 0a20 2020 2020  ainLookup(.     
-0000f470: 2020 2020 2020 204f 4646 4348 4149 4e5f         OFFCHAIN_
-0000f480: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
-0000f490: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000f4a0: 2020 2061 7373 6572 7420 6173 796e 635f     assert async_
-0000f4b0: 7733 2e63 6f64 6563 2e64 6563 6f64 6528  w3.codec.decode(
-0000f4c0: 5b22 7374 7269 6e67 225d 2c20 7265 7370  ["string"], resp
-0000f4d0: 6f6e 7365 295b 305d 203d 3d20 2277 6562  onse)[0] == "web
-0000f4e0: 3370 7922 0a0a 2020 2020 4070 7974 6573  3py"..    @pytes
-0000f4f0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-0000f500: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-0000f510: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
-0000f520: 6169 6e5f 6c6f 6f6b 7570 5f63 616c 6c73  ain_lookup_calls
-0000f530: 5f72 6169 7365 5f66 6f72 5f73 7461 7475  _raise_for_statu
-0000f540: 735f 666f 725f 3478 785f 7374 6174 7573  s_for_4xx_status
-0000f550: 5f63 6f64 6528 0a20 2020 2020 2020 2073  _code(.        s
-0000f560: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-0000f570: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-0000f580: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-0000f590: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
-0000f5a0: 705f 636f 6e74 7261 6374 3a20 2241 7379  p_contract: "Asy
-0000f5b0: 6e63 436f 6e74 7261 6374 222c 0a20 2020  ncContract",.   
-0000f5c0: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
-0000f5d0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0000f5e0: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
-0000f5f0: 6573 732c 0a20 2020 2020 2020 206d 6f6e  ess,.        mon
-0000f600: 6b65 7970 6174 6368 3a20 224d 6f6e 6b65  keypatch: "Monke
-0000f610: 7950 6174 6368 222c 0a20 2020 2029 202d  yPatch",.    ) -
-0000f620: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000f630: 6e6f 726d 616c 697a 6564 5f63 6f6e 7472  normalized_contr
-0000f640: 6163 745f 6164 6472 6573 7320 3d20 746f  act_address = to
-0000f650: 5f68 6578 5f69 665f 6279 7465 7328 0a20  _hex_if_bytes(. 
-0000f660: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-0000f670: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-0000f680: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
-0000f690: 730a 2020 2020 2020 2020 292e 6c6f 7765  s.        ).lowe
-0000f6a0: 7228 290a 0a20 2020 2020 2020 2061 7379  r()..        asy
-0000f6b0: 6e63 5f6d 6f63 6b5f 6f66 6663 6861 696e  nc_mock_offchain
-0000f6c0: 5f6c 6f6f 6b75 705f 7265 7175 6573 745f  _lookup_request_
-0000f6d0: 7265 7370 6f6e 7365 280a 2020 2020 2020  response(.      
-0000f6e0: 2020 2020 2020 6d6f 6e6b 6579 7061 7463        monkeypatc
-0000f6f0: 682c 0a20 2020 2020 2020 2020 2020 206d  h,.            m
-0000f700: 6f63 6b65 645f 7265 7175 6573 745f 7572  ocked_request_ur
-0000f710: 6c3d 6622 6874 7470 733a 2f2f 7765 6233  l=f"https://web3
-0000f720: 2e70 792f 6761 7465 7761 792f 7b6e 6f72  .py/gateway/{nor
-0000f730: 6d61 6c69 7a65 645f 636f 6e74 7261 6374  malized_contract
-0000f740: 5f61 6464 7265 7373 7d2f 7b4f 4646 4348  _address}/{OFFCH
-0000f750: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
-0000f760: 4441 5441 7d2e 6a73 6f6e 222c 2020 2320  DATA}.json",  # 
-0000f770: 6e6f 7161 3a20 4535 3031 0a20 2020 2020  noqa: E501.     
-0000f780: 2020 2020 2020 206d 6f63 6b65 645f 7374         mocked_st
-0000f790: 6174 7573 5f63 6f64 653d 7261 6e64 696e  atus_code=randin
-0000f7a0: 7428 3430 302c 2034 3939 292c 0a20 2020  t(400, 499),.   
-0000f7b0: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
-0000f7c0: 6a73 6f6e 5f64 6174 613d 5745 4233 5059  json_data=WEB3PY
-0000f7d0: 5f41 535f 4845 5842 5954 4553 2c0a 2020  _AS_HEXBYTES,.  
-0000f7e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000f7f0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0000f800: 6573 2845 7863 6570 7469 6f6e 2c20 6d61  es(Exception, ma
-0000f810: 7463 683d 2263 616c 6c65 6420 7261 6973  tch="called rais
-0000f820: 655f 666f 725f 7374 6174 7573 5c5c 285c  e_for_status\\(\
-0000f830: 5c29 2229 3a0a 2020 2020 2020 2020 2020  \)"):.          
-0000f840: 2020 6177 6169 7420 6173 796e 635f 6f66    await async_of
-0000f850: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-0000f860: 6e74 7261 6374 2e63 616c 6c65 7228 292e  ntract.caller().
-0000f870: 7465 7374 4f66 6663 6861 696e 4c6f 6f6b  testOffchainLook
-0000f880: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
-0000f890: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
-0000f8a0: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
-0000f8b0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000f8c0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-0000f8d0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-0000f8e0: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
-0000f8f0: 6c5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  l_offchain_looku
-0000f900: 705f 7261 6973 6573 5f77 6865 6e5f 616c  p_raises_when_al
-0000f910: 6c5f 7375 7070 6c69 6564 5f75 726c 735f  l_supplied_urls_
-0000f920: 6661 696c 280a 2020 2020 2020 2020 7365  fail(.        se
-0000f930: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-0000f940: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
-0000f950: 705f 636f 6e74 7261 6374 3a20 2241 7379  p_contract: "Asy
-0000f960: 6e63 436f 6e74 7261 6374 222c 0a20 2020  ncContract",.   
-0000f970: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0000f980: 2020 2020 2320 4745 5420 616e 6420 504f      # GET and PO
-0000f990: 5354 2072 6571 7565 7374 7320 7368 6f75  ST requests shou
-0000f9a0: 6c64 2066 6169 6c20 7369 6e63 6520 7265  ld fail since re
-0000f9b0: 7370 6f6e 7365 7320 6172 6520 6e6f 7420  sponses are not 
-0000f9c0: 6d6f 636b 6564 0a20 2020 2020 2020 2077  mocked.        w
-0000f9d0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-0000f9e0: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-0000f9f0: 756c 7469 706c 6546 6169 6c65 6452 6571  ultipleFailedReq
-0000fa00: 7565 7374 732c 206d 6174 6368 3d22 4f66  uests, match="Of
-0000fa10: 6663 6861 696e 206c 6f6f 6b75 7020 6661  fchain lookup fa
-0000fa20: 696c 6564 2066 6f72 2073 7570 706c 6965  iled for supplie
-0000fa30: 6420 7572 6c73 220a 2020 2020 2020 2020  d urls".        
-0000fa40: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-0000fa50: 7761 6974 2061 7379 6e63 5f6f 6666 6368  wait async_offch
-0000fa60: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-0000fa70: 6163 742e 6361 6c6c 6572 2829 2e74 6573  act.caller().tes
-0000fa80: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
-0000fa90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000faa0: 204f 4646 4348 4149 4e5f 4c4f 4f4b 5550   OFFCHAIN_LOOKUP
-0000fab0: 5f54 4553 545f 4441 5441 0a20 2020 2020  _TEST_DATA.     
-0000fac0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-0000fad0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-0000fae0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-0000faf0: 2074 6573 745f 6574 685f 6361 6c6c 5f63   test_eth_call_c
-0000fb00: 6f6e 7469 6e75 6f75 735f 6f66 6663 6861  ontinuous_offcha
-0000fb10: 696e 5f6c 6f6f 6b75 705f 7261 6973 6573  in_lookup_raises
-0000fb20: 5f77 6974 685f 746f 6f5f 6d61 6e79 5f72  _with_too_many_r
-0000fb30: 6571 7565 7374 7328 0a20 2020 2020 2020  equests(.       
-0000fb40: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-0000fb50: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
-0000fb60: 6f6b 7570 5f63 6f6e 7472 6163 743a 2022  okup_contract: "
-0000fb70: 4173 796e 6343 6f6e 7472 6163 7422 2c0a  AsyncContract",.
-0000fb80: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-0000fb90: 7463 683a 2022 4d6f 6e6b 6579 5061 7463  tch: "MonkeyPatc
-0000fba0: 6822 2c0a 2020 2020 2920 2d3e 204e 6f6e  h",.    ) -> Non
-0000fbb0: 653a 0a20 2020 2020 2020 206e 6f72 6d61  e:.        norma
-0000fbc0: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
-0000fbd0: 6464 7265 7373 203d 2074 6f5f 6865 785f  ddress = to_hex_
-0000fbe0: 6966 5f62 7974 6573 280a 2020 2020 2020  if_bytes(.      
-0000fbf0: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
-0000fc00: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-0000fc10: 7261 6374 2e61 6464 7265 7373 0a20 2020  ract.address.   
-0000fc20: 2020 2020 2029 2e6c 6f77 6572 2829 0a0a       ).lower()..
-0000fc30: 2020 2020 2020 2020 6173 796e 635f 6d6f          async_mo
-0000fc40: 636b 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ck_offchain_look
-0000fc50: 7570 5f72 6571 7565 7374 5f72 6573 706f  up_request_respo
-0000fc60: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
-0000fc70: 206d 6f6e 6b65 7970 6174 6368 2c0a 2020   monkeypatch,.  
-0000fc80: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
-0000fc90: 5f72 6571 7565 7374 5f75 726c 3d66 2268  _request_url=f"h
-0000fca0: 7474 7073 3a2f 2f77 6562 332e 7079 2f67  ttps://web3.py/g
-0000fcb0: 6174 6577 6179 2f7b 6e6f 726d 616c 697a  ateway/{normaliz
-0000fcc0: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
-0000fcd0: 6573 737d 2f30 782e 6a73 6f6e 222c 2020  ess}/0x.json",  
-0000fce0: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
-0000fcf0: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-0000fd00: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-0000fd10: 7328 546f 6f4d 616e 7952 6571 7565 7374  s(TooManyRequest
-0000fd20: 732c 206d 6174 6368 3d22 546f 6f20 6d61  s, match="Too ma
-0000fd30: 6e79 2043 4349 5020 7265 6164 2072 6564  ny CCIP read red
-0000fd40: 6972 6563 7473 2229 3a0a 2020 2020 2020  irects"):.      
-0000fd50: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
-0000fd60: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
-0000fd70: 705f 636f 6e74 7261 6374 2e63 616c 6c65  p_contract.calle
-0000fd80: 7228 292e 636f 6e74 696e 756f 7573 4f66  r().continuousOf
-0000fd90: 6663 6861 696e 4c6f 6f6b 7570 2829 2020  fchainLookup()  
-0000fda0: 2320 6e6f 7161 3a20 4535 3031 2074 7970  # noqa: E501 typ
-0000fdb0: 653a 2069 676e 6f72 650a 0a20 2020 2040  e: ignore..    @
-0000fdc0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-0000fdd0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-0000fde0: 6620 7465 7374 5f61 7379 6e63 5f65 7468  f test_async_eth
-0000fdf0: 5f68 6173 6872 6174 6528 7365 6c66 2c20  _hashrate(self, 
-0000fe00: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-0000fe10: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-0000fe20: 2020 2020 2020 2020 6861 7368 7261 7465          hashrate
-0000fe30: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-0000fe40: 332e 6574 682e 6861 7368 7261 7465 0a20  3.eth.hashrate. 
-0000fe50: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0000fe60: 5f69 6e74 6567 6572 2868 6173 6872 6174  _integer(hashrat
-0000fe70: 6529 0a20 2020 2020 2020 2061 7373 6572  e).        asser
-0000fe80: 7420 6861 7368 7261 7465 203e 3d20 300a  t hashrate >= 0.
-0000fe90: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-0000fea0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-0000feb0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-0000fec0: 6e63 5f65 7468 5f63 6861 696e 5f69 6428  nc_eth_chain_id(
-0000fed0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-0000fee0: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-0000fef0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6368  None:.        ch
-0000ff00: 6169 6e5f 6964 203d 2061 7761 6974 2061  ain_id = await a
-0000ff10: 7379 6e63 5f77 332e 6574 682e 6368 6169  sync_w3.eth.chai
-0000ff20: 6e5f 6964 0a20 2020 2020 2020 2023 2063  n_id.        # c
-0000ff30: 6861 696e 2069 6420 7661 6c75 6520 6672  hain id value fr
-0000ff40: 6f6d 2067 6574 6820 6669 7874 7572 6520  om geth fixture 
-0000ff50: 6765 6e65 7369 7320 6669 6c65 0a20 2020  genesis file.   
-0000ff60: 2020 2020 2061 7373 6572 7420 6368 6169       assert chai
-0000ff70: 6e5f 6964 203d 3d20 3133 3132 3737 3332  n_id == 13127732
-0000ff80: 3239 3430 3533 370a 0a20 2020 2040 7079  2940537..    @py
-0000ff90: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-0000ffa0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-0000ffb0: 7465 7374 5f61 7379 6e63 5f65 7468 5f6d  test_async_eth_m
-0000ffc0: 696e 696e 6728 7365 6c66 2c20 6173 796e  ining(self, asyn
-0000ffd0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-0000ffe0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-0000fff0: 2020 2020 6d69 6e69 6e67 203d 2061 7761      mining = awa
-00010000: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00010010: 6d69 6e69 6e67 0a20 2020 2020 2020 2061  mining.        a
-00010020: 7373 6572 7420 6973 5f62 6f6f 6c65 616e  ssert is_boolean
-00010030: 286d 696e 696e 6729 0a0a 2020 2020 4070  (mining)..    @p
-00010040: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00010050: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-00010060: 2074 6573 745f 6173 796e 635f 6574 685f   test_async_eth_
-00010070: 6765 745f 7472 616e 7361 6374 696f 6e5f  get_transaction_
-00010080: 7265 6365 6970 745f 6d69 6e65 6428 0a20  receipt_mined(. 
-00010090: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000100a0: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-000100b0: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-000100c0: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
-000100d0: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
-000100e0: 6174 612c 0a20 2020 2020 2020 206d 696e  ata,.        min
-000100f0: 6564 5f74 786e 5f68 6173 683a 2048 6578  ed_txn_hash: Hex
-00010100: 5374 722c 0a20 2020 2029 202d 3e20 4e6f  Str,.    ) -> No
-00010110: 6e65 3a0a 2020 2020 2020 2020 7265 6365  ne:.        rece
-00010120: 6970 7420 3d20 6177 6169 7420 6173 796e  ipt = await asyn
-00010130: 635f 7733 2e65 7468 2e67 6574 5f74 7261  c_w3.eth.get_tra
-00010140: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00010150: 286d 696e 6564 5f74 786e 5f68 6173 6829  (mined_txn_hash)
-00010160: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00010170: 6973 5f64 6963 7428 7265 6365 6970 7429  is_dict(receipt)
-00010180: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00010190: 7265 6365 6970 745b 2262 6c6f 636b 4e75  receipt["blockNu
-000101a0: 6d62 6572 225d 203d 3d20 6173 796e 635f  mber"] == async_
-000101b0: 626c 6f63 6b5f 7769 7468 5f74 786e 5b22  block_with_txn["
-000101c0: 6e75 6d62 6572 225d 0a20 2020 2020 2020  number"].       
-000101d0: 2061 7373 6572 7420 7265 6365 6970 745b   assert receipt[
-000101e0: 2262 6c6f 636b 4861 7368 225d 203d 3d20  "blockHash"] == 
-000101f0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00010200: 5f74 786e 5b22 6861 7368 225d 0a20 2020  _txn["hash"].   
-00010210: 2020 2020 2061 7373 6572 7420 7265 6365       assert rece
-00010220: 6970 745b 2274 7261 6e73 6163 7469 6f6e  ipt["transaction
-00010230: 496e 6465 7822 5d20 3d3d 2030 0a20 2020  Index"] == 0.   
-00010240: 2020 2020 2061 7373 6572 7420 7265 6365       assert rece
-00010250: 6970 745b 2274 7261 6e73 6163 7469 6f6e  ipt["transaction
-00010260: 4861 7368 225d 203d 3d20 4865 7842 7974  Hash"] == HexByt
-00010270: 6573 286d 696e 6564 5f74 786e 5f68 6173  es(mined_txn_has
-00010280: 6829 0a20 2020 2020 2020 2061 7373 6572  h).        asser
-00010290: 7420 6973 5f63 6865 636b 7375 6d5f 6164  t is_checksum_ad
-000102a0: 6472 6573 7328 7265 6365 6970 745b 2274  dress(receipt["t
-000102b0: 6f22 5d29 0a20 2020 2020 2020 2061 7373  o"]).        ass
-000102c0: 6572 7420 7265 6365 6970 745b 2266 726f  ert receipt["fro
-000102d0: 6d22 5d20 6973 206e 6f74 204e 6f6e 650a  m"] is not None.
-000102e0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000102f0: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
-00010300: 7373 2872 6563 6569 7074 5b22 6672 6f6d  ss(receipt["from
-00010310: 225d 290a 0a20 2020 2020 2020 2065 6666  "])..        eff
-00010320: 6563 7469 7665 5f67 6173 5f70 7269 6365  ective_gas_price
-00010330: 203d 2072 6563 6569 7074 5b22 6566 6665   = receipt["effe
-00010340: 6374 6976 6547 6173 5072 6963 6522 5d0a  ctiveGasPrice"].
-00010350: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00010360: 7369 6e73 7461 6e63 6528 6566 6665 6374  sinstance(effect
-00010370: 6976 655f 6761 735f 7072 6963 652c 2069  ive_gas_price, i
-00010380: 6e74 290a 2020 2020 2020 2020 6173 7365  nt).        asse
-00010390: 7274 2065 6666 6563 7469 7665 5f67 6173  rt effective_gas
-000103a0: 5f70 7269 6365 203e 2030 0a0a 2020 2020  _price > 0..    
-000103b0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-000103c0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-000103d0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-000103e0: 685f 6765 745f 7472 616e 7361 6374 696f  h_get_transactio
-000103f0: 6e5f 7265 6365 6970 745f 756e 6d69 6e65  n_receipt_unmine
-00010400: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
-00010410: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00010420: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-00010430: 2020 2020 2020 2020 6173 796e 635f 6b65          async_ke
-00010440: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00010450: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
-00010460: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-00010470: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-00010480: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00010490: 6820 3d20 6177 6169 7420 6173 796e 635f  h = await async_
-000104a0: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
-000104b0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-000104c0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-000104d0: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
-000104e0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-000104f0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00010500: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-00010510: 2020 2020 2020 2020 2274 6f22 3a20 6173          "to": as
-00010520: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-00010530: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-00010540: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00010550: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-00010560: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-00010570: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00010580: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00010590: 2020 2020 2020 226d 6178 4665 6550 6572        "maxFeePer
-000105a0: 4761 7322 3a20 6173 796e 635f 7733 2e74  Gas": async_w3.t
-000105b0: 6f5f 7765 6928 332c 2022 6777 6569 2229  o_wei(3, "gwei")
-000105c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000105d0: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-000105e0: 6550 6572 4761 7322 3a20 6173 796e 635f  ePerGas": async_
-000105f0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-00010600: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
-00010610: 2020 7d0a 2020 2020 2020 2020 290a 2020    }.        ).  
-00010620: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00010630: 742e 7261 6973 6573 2854 7261 6e73 6163  t.raises(Transac
-00010640: 7469 6f6e 4e6f 7446 6f75 6e64 293a 0a20  tionNotFound):. 
-00010650: 2020 2020 2020 2020 2020 2061 7761 6974             await
-00010660: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00010670: 745f 7472 616e 7361 6374 696f 6e5f 7265  t_transaction_re
-00010680: 6365 6970 7428 7478 6e5f 6861 7368 290a  ceipt(txn_hash).
-00010690: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-000106a0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
-000106b0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-000106c0: 6e63 5f65 7468 5f67 6574 5f74 7261 6e73  nc_eth_get_trans
-000106d0: 6163 7469 6f6e 5f72 6563 6569 7074 5f77  action_receipt_w
-000106e0: 6974 685f 6c6f 675f 656e 7472 7928 0a20  ith_log_entry(. 
-000106f0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00010700: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-00010710: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-00010720: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
-00010730: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
-00010740: 673a 2042 6c6f 636b 4461 7461 2c0a 2020  g: BlockData,.  
-00010750: 2020 2020 2020 6173 796e 635f 656d 6974        async_emit
-00010760: 7465 725f 636f 6e74 7261 6374 3a20 2241  ter_contract: "A
-00010770: 7379 6e63 436f 6e74 7261 6374 222c 0a20  syncContract",. 
-00010780: 2020 2020 2020 2074 786e 5f68 6173 685f         txn_hash_
-00010790: 7769 7468 5f6c 6f67 3a20 4865 7853 7472  with_log: HexStr
-000107a0: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-000107b0: 0a20 2020 2020 2020 2072 6563 6569 7074  .        receipt
-000107c0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-000107d0: 332e 6574 682e 7761 6974 5f66 6f72 5f74  3.eth.wait_for_t
-000107e0: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
-000107f0: 7074 2874 786e 5f68 6173 685f 7769 7468  pt(txn_hash_with
-00010800: 5f6c 6f67 290a 2020 2020 2020 2020 6173  _log).        as
-00010810: 7365 7274 2069 735f 6469 6374 2872 6563  sert is_dict(rec
-00010820: 6569 7074 290a 2020 2020 2020 2020 6173  eipt).        as
-00010830: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
-00010840: 6f63 6b4e 756d 6265 7222 5d20 3d3d 2061  ockNumber"] == a
-00010850: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-00010860: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
-00010870: 6d62 6572 225d 0a20 2020 2020 2020 2061  mber"].        a
-00010880: 7373 6572 7420 7265 6365 6970 745b 2262  ssert receipt["b
-00010890: 6c6f 636b 4861 7368 225d 203d 3d20 6173  lockHash"] == as
-000108a0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-000108b0: 786e 5f77 6974 685f 6c6f 675b 2268 6173  xn_with_log["has
-000108c0: 6822 5d0a 2020 2020 2020 2020 6173 7365  h"].        asse
-000108d0: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-000108e0: 7361 6374 696f 6e49 6e64 6578 225d 203d  sactionIndex"] =
-000108f0: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-00010900: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-00010910: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-00010920: 2048 6578 4279 7465 7328 7478 6e5f 6861   HexBytes(txn_ha
-00010930: 7368 5f77 6974 685f 6c6f 6729 0a0a 2020  sh_with_log)..  
-00010940: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00010950: 2872 6563 6569 7074 5b22 6c6f 6773 225d  (receipt["logs"]
-00010960: 2920 3d3d 2031 0a20 2020 2020 2020 206c  ) == 1.        l
-00010970: 6f67 5f65 6e74 7279 203d 2072 6563 6569  og_entry = recei
-00010980: 7074 5b22 6c6f 6773 225d 5b30 5d0a 0a20  pt["logs"][0].. 
-00010990: 2020 2020 2020 2061 7373 6572 7420 6c6f         assert lo
-000109a0: 675f 656e 7472 795b 2262 6c6f 636b 4e75  g_entry["blockNu
-000109b0: 6d62 6572 225d 203d 3d20 6173 796e 635f  mber"] == async_
-000109c0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
-000109d0: 6974 685f 6c6f 675b 226e 756d 6265 7222  ith_log["number"
-000109e0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-000109f0: 206c 6f67 5f65 6e74 7279 5b22 626c 6f63   log_entry["bloc
-00010a00: 6b48 6173 6822 5d20 3d3d 2061 7379 6e63  kHash"] == async
-00010a10: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5f  _block_with_txn_
-00010a20: 7769 7468 5f6c 6f67 5b22 6861 7368 225d  with_log["hash"]
-00010a30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00010a40: 6c6f 675f 656e 7472 795b 226c 6f67 496e  log_entry["logIn
-00010a50: 6465 7822 5d20 3d3d 2030 0a20 2020 2020  dex"] == 0.     
-00010a60: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
-00010a70: 655f 6164 6472 6573 7328 6c6f 675f 656e  e_address(log_en
-00010a80: 7472 795b 2261 6464 7265 7373 225d 2c20  try["address"], 
-00010a90: 6173 796e 635f 656d 6974 7465 725f 636f  async_emitter_co
-00010aa0: 6e74 7261 6374 2e61 6464 7265 7373 290a  ntract.address).
-00010ab0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00010ac0: 6f67 5f65 6e74 7279 5b22 7472 616e 7361  og_entry["transa
-00010ad0: 6374 696f 6e49 6e64 6578 225d 203d 3d20  ctionIndex"] == 
-00010ae0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-00010af0: 206c 6f67 5f65 6e74 7279 5b22 7472 616e   log_entry["tran
-00010b00: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-00010b10: 2048 6578 4279 7465 7328 7478 6e5f 6861   HexBytes(txn_ha
-00010b20: 7368 5f77 6974 685f 6c6f 6729 0a0a 2020  sh_with_log)..  
-00010b30: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00010b40: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00010b50: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-00010b60: 6574 685f 7761 6974 5f66 6f72 5f74 7261  eth_wait_for_tra
-00010b70: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00010b80: 5f6d 696e 6564 280a 2020 2020 2020 2020  _mined(.        
-00010b90: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
-00010ba0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-00010bb0: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
-00010bc0: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
-00010bd0: 6e3a 2042 6c6f 636b 4461 7461 2c0a 2020  n: BlockData,.  
-00010be0: 2020 2020 2020 6d69 6e65 645f 7478 6e5f        mined_txn_
-00010bf0: 6861 7368 3a20 4865 7853 7472 2c0a 2020  hash: HexStr,.  
-00010c00: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00010c10: 2020 2020 2072 6563 6569 7074 203d 2061       receipt = a
-00010c20: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00010c30: 682e 7761 6974 5f66 6f72 5f74 7261 6e73  h.wait_for_trans
-00010c40: 6163 7469 6f6e 5f72 6563 6569 7074 286d  action_receipt(m
-00010c50: 696e 6564 5f74 786e 5f68 6173 6829 0a20  ined_txn_hash). 
-00010c60: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00010c70: 5f64 6963 7428 7265 6365 6970 7429 0a20  _dict(receipt). 
-00010c80: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00010c90: 6365 6970 745b 2262 6c6f 636b 4e75 6d62  ceipt["blockNumb
-00010ca0: 6572 225d 203d 3d20 6173 796e 635f 626c  er"] == async_bl
-00010cb0: 6f63 6b5f 7769 7468 5f74 786e 5b22 6e75  ock_with_txn["nu
-00010cc0: 6d62 6572 225d 0a20 2020 2020 2020 2061  mber"].        a
-00010cd0: 7373 6572 7420 7265 6365 6970 745b 2262  ssert receipt["b
-00010ce0: 6c6f 636b 4861 7368 225d 203d 3d20 6173  lockHash"] == as
-00010cf0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00010d00: 786e 5b22 6861 7368 225d 0a20 2020 2020  xn["hash"].     
-00010d10: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
-00010d20: 745b 2274 7261 6e73 6163 7469 6f6e 496e  t["transactionIn
-00010d30: 6465 7822 5d20 3d3d 2030 0a20 2020 2020  dex"] == 0.     
-00010d40: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
-00010d50: 745b 2274 7261 6e73 6163 7469 6f6e 4861  t["transactionHa
-00010d60: 7368 225d 203d 3d20 4865 7842 7974 6573  sh"] == HexBytes
-00010d70: 286d 696e 6564 5f74 786e 5f68 6173 6829  (mined_txn_hash)
-00010d80: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00010d90: 6973 5f63 6865 636b 7375 6d5f 6164 6472  is_checksum_addr
-00010da0: 6573 7328 7265 6365 6970 745b 2274 6f22  ess(receipt["to"
-00010db0: 5d29 0a20 2020 2020 2020 2061 7373 6572  ]).        asser
-00010dc0: 7420 7265 6365 6970 745b 2266 726f 6d22  t receipt["from"
-00010dd0: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
-00010de0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00010df0: 6368 6563 6b73 756d 5f61 6464 7265 7373  checksum_address
-00010e00: 2872 6563 6569 7074 5b22 6672 6f6d 225d  (receipt["from"]
-00010e10: 290a 0a20 2020 2020 2020 2065 6666 6563  )..        effec
-00010e20: 7469 7665 5f67 6173 5f70 7269 6365 203d  tive_gas_price =
-00010e30: 2072 6563 6569 7074 5b22 6566 6665 6374   receipt["effect
-00010e40: 6976 6547 6173 5072 6963 6522 5d0a 2020  iveGasPrice"].  
-00010e50: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00010e60: 6e73 7461 6e63 6528 6566 6665 6374 6976  nstance(effectiv
-00010e70: 655f 6761 735f 7072 6963 652c 2069 6e74  e_gas_price, int
-00010e80: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00010e90: 2065 6666 6563 7469 7665 5f67 6173 5f70   effective_gas_p
-00010ea0: 7269 6365 203e 2030 0a0a 2020 2020 4070  rice > 0..    @p
-00010eb0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00010ec0: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
-00010ed0: 2074 6573 745f 6173 796e 635f 6574 685f   test_async_eth_
-00010ee0: 7761 6974 5f66 6f72 5f74 7261 6e73 6163  wait_for_transac
-00010ef0: 7469 6f6e 5f72 6563 6569 7074 5f75 6e6d  tion_receipt_unm
-00010f00: 696e 6564 280a 2020 2020 2020 2020 7365  ined(.        se
-00010f10: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-00010f20: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00010f30: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-00010f40: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00010f50: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00010f60: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-00010f70: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
-00010f80: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-00010f90: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
-00010fa0: 6e63 5f77 332e 6574 682e 7365 6e64 5f74  nc_w3.eth.send_t
-00010fb0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-00010fc0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00010fd0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00010fe0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-00010ff0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00011000: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00011010: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00011020: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
-00011030: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
-00011040: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00011050: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00011060: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00011070: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00011080: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00011090: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-000110a0: 5065 7247 6173 223a 2061 7379 6e63 5f77  PerGas": async_w
-000110b0: 332e 746f 5f77 6569 2833 2c20 2267 7765  3.to_wei(3, "gwe
-000110c0: 6922 292c 0a20 2020 2020 2020 2020 2020  i"),.           
-000110d0: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
-000110e0: 7946 6565 5065 7247 6173 223a 2061 7379  yFeePerGas": asy
-000110f0: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-00011100: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-00011110: 2020 2020 207d 0a20 2020 2020 2020 2029       }.        )
-00011120: 0a0a 2020 2020 2020 2020 7469 6d65 6f75  ..        timeou
-00011130: 7420 3d20 302e 3031 0a20 2020 2020 2020  t = 0.01.       
-00011140: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00011150: 7365 7328 5469 6d65 4578 6861 7573 7465  ses(TimeExhauste
-00011160: 6429 2061 7320 6578 635f 696e 666f 3a0a  d) as exc_info:.
-00011170: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-00011180: 7420 6173 796e 635f 7733 2e65 7468 2e77  t async_w3.eth.w
-00011190: 6169 745f 666f 725f 7472 616e 7361 6374  ait_for_transact
-000111a0: 696f 6e5f 7265 6365 6970 7428 7478 6e5f  ion_receipt(txn_
-000111b0: 6861 7368 2c20 7469 6d65 6f75 743d 7469  hash, timeout=ti
-000111c0: 6d65 6f75 7429 0a0a 2020 2020 2020 2020  meout)..        
-000111d0: 6173 7365 7274 2028 5f20 696e 2073 7472  assert (_ in str
-000111e0: 2865 7863 5f69 6e66 6f29 2066 6f72 205f  (exc_info) for _
-000111f0: 2069 6e20 5b72 6570 7228 7478 6e5f 6861   in [repr(txn_ha
-00011200: 7368 292c 2074 696d 656f 7574 5d29 0a0a  sh), timeout])..
-00011210: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00011220: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00011230: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
-00011240: 635f 6574 685f 7761 6974 5f66 6f72 5f74  c_eth_wait_for_t
-00011250: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
-00011260: 7074 5f77 6974 685f 6c6f 675f 656e 7472  pt_with_log_entr
-00011270: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-00011280: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00011290: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-000112a0: 2020 2020 2020 2020 6173 796e 635f 626c          async_bl
-000112b0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-000112c0: 685f 6c6f 673a 2042 6c6f 636b 4461 7461  h_log: BlockData
-000112d0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
-000112e0: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
-000112f0: 3a20 2241 7379 6e63 436f 6e74 7261 6374  : "AsyncContract
-00011300: 222c 0a20 2020 2020 2020 2074 786e 5f68  ",.        txn_h
-00011310: 6173 685f 7769 7468 5f6c 6f67 3a20 4865  ash_with_log: He
-00011320: 7853 7472 2c0a 2020 2020 2920 2d3e 204e  xStr,.    ) -> N
-00011330: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
-00011340: 6569 7074 203d 2061 7761 6974 2061 7379  eipt = await asy
-00011350: 6e63 5f77 332e 6574 682e 7761 6974 5f66  nc_w3.eth.wait_f
-00011360: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
-00011370: 6563 6569 7074 2874 786e 5f68 6173 685f  eceipt(txn_hash_
-00011380: 7769 7468 5f6c 6f67 290a 2020 2020 2020  with_log).      
-00011390: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
-000113a0: 2872 6563 6569 7074 290a 2020 2020 2020  (receipt).      
-000113b0: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
-000113c0: 5b22 626c 6f63 6b4e 756d 6265 7222 5d20  ["blockNumber"] 
-000113d0: 3d3d 2061 7379 6e63 5f62 6c6f 636b 5f77  == async_block_w
-000113e0: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-000113f0: 5b22 6e75 6d62 6572 225d 0a20 2020 2020  ["number"].     
-00011400: 2020 2061 7373 6572 7420 7265 6365 6970     assert receip
-00011410: 745b 2262 6c6f 636b 4861 7368 225d 203d  t["blockHash"] =
-00011420: 3d20 6173 796e 635f 626c 6f63 6b5f 7769  = async_block_wi
-00011430: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-00011440: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
-00011450: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
-00011460: 7472 616e 7361 6374 696f 6e49 6e64 6578  transactionIndex
-00011470: 225d 203d 3d20 300a 2020 2020 2020 2020  "] == 0.        
-00011480: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
-00011490: 7472 616e 7361 6374 696f 6e48 6173 6822  transactionHash"
-000114a0: 5d20 3d3d 2048 6578 4279 7465 7328 7478  ] == HexBytes(tx
-000114b0: 6e5f 6861 7368 5f77 6974 685f 6c6f 6729  n_hash_with_log)
-000114c0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000114d0: 206c 656e 2872 6563 6569 7074 5b22 6c6f   len(receipt["lo
-000114e0: 6773 225d 2920 3d3d 2031 0a20 2020 2020  gs"]) == 1.     
-000114f0: 2020 206c 6f67 5f65 6e74 7279 203d 2072     log_entry = r
-00011500: 6563 6569 7074 5b22 6c6f 6773 225d 5b30  eceipt["logs"][0
-00011510: 5d0a 0a20 2020 2020 2020 2061 7373 6572  ]..        asser
-00011520: 7420 6c6f 675f 656e 7472 795b 2262 6c6f  t log_entry["blo
-00011530: 636b 4e75 6d62 6572 225d 203d 3d20 6173  ckNumber"] == as
-00011540: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00011550: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-00011560: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
-00011570: 7365 7274 206c 6f67 5f65 6e74 7279 5b22  sert log_entry["
-00011580: 626c 6f63 6b48 6173 6822 5d20 3d3d 2061  blockHash"] == a
-00011590: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-000115a0: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6861  txn_with_log["ha
-000115b0: 7368 225d 0a20 2020 2020 2020 2061 7373  sh"].        ass
-000115c0: 6572 7420 6c6f 675f 656e 7472 795b 226c  ert log_entry["l
-000115d0: 6f67 496e 6465 7822 5d20 3d3d 2030 0a20  ogIndex"] == 0. 
-000115e0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-000115f0: 5f73 616d 655f 6164 6472 6573 7328 6c6f  _same_address(lo
-00011600: 675f 656e 7472 795b 2261 6464 7265 7373  g_entry["address
-00011610: 225d 2c20 6173 796e 635f 656d 6974 7465  "], async_emitte
-00011620: 725f 636f 6e74 7261 6374 2e61 6464 7265  r_contract.addre
-00011630: 7373 290a 2020 2020 2020 2020 6173 7365  ss).        asse
-00011640: 7274 206c 6f67 5f65 6e74 7279 5b22 7472  rt log_entry["tr
-00011650: 616e 7361 6374 696f 6e49 6e64 6578 225d  ansactionIndex"]
-00011660: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
-00011670: 7365 7274 206c 6f67 5f65 6e74 7279 5b22  sert log_entry["
-00011680: 7472 616e 7361 6374 696f 6e48 6173 6822  transactionHash"
-00011690: 5d20 3d3d 2048 6578 4279 7465 7328 7478  ] == HexBytes(tx
-000116a0: 6e5f 6861 7368 5f77 6974 685f 6c6f 6729  n_hash_with_log)
-000116b0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-000116c0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-000116d0: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-000116e0: 796e 635f 6574 685f 6163 636f 756e 7473  ync_eth_accounts
-000116f0: 2873 656c 662c 2061 7379 6e63 5f77 333a  (self, async_w3:
-00011700: 2022 4173 796e 6357 6562 3322 2920 2d3e   "AsyncWeb3") ->
-00011710: 204e 6f6e 653a 0a20 2020 2020 2020 2061   None:.        a
-00011720: 6363 6f75 6e74 7320 3d20 6177 6169 7420  ccounts = await 
-00011730: 6173 796e 635f 7733 2e65 7468 2e61 6363  async_w3.eth.acc
-00011740: 6f75 6e74 730a 2020 2020 2020 2020 6173  ounts.        as
-00011750: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
-00011760: 6528 6163 636f 756e 7473 290a 2020 2020  e(accounts).    
-00011770: 2020 2020 6173 7365 7274 206c 656e 2861      assert len(a
-00011780: 6363 6f75 6e74 7329 2021 3d20 300a 2020  ccounts) != 0.  
-00011790: 2020 2020 2020 6173 7365 7274 2061 6c6c        assert all
-000117a0: 2869 735f 6368 6563 6b73 756d 5f61 6464  (is_checksum_add
-000117b0: 7265 7373 2861 6363 6f75 6e74 2920 666f  ress(account) fo
-000117c0: 7220 6163 636f 756e 7420 696e 2061 6363  r account in acc
-000117d0: 6f75 6e74 7329 0a20 2020 2020 2020 2061  ounts).        a
-000117e0: 7373 6572 7420 6177 6169 7420 6173 796e  ssert await asyn
-000117f0: 635f 7733 2e65 7468 2e63 6f69 6e62 6173  c_w3.eth.coinbas
-00011800: 6520 696e 2061 6363 6f75 6e74 730a 0a20  e in accounts.. 
-00011810: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00011820: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
-00011830: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
-00011840: 5f65 7468 5f67 6574 5f6c 6f67 735f 7769  _eth_get_logs_wi
-00011850: 7468 6f75 745f 6c6f 6773 280a 2020 2020  thout_logs(.    
-00011860: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
-00011870: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
-00011880: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
-00011890: 685f 7478 6e5f 7769 7468 5f6c 6f67 3a20  h_txn_with_log: 
-000118a0: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
-000118b0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000118c0: 2023 2054 6573 7420 7769 7468 2062 6c6f   # Test with blo
-000118d0: 636b 2072 616e 6765 0a0a 2020 2020 2020  ck range..      
-000118e0: 2020 6669 6c74 6572 5f70 6172 616d 733a    filter_params:
-000118f0: 2046 696c 7465 7250 6172 616d 7320 3d20   FilterParams = 
-00011900: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-00011910: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
-00011920: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
-00011930: 2020 2020 2020 2022 746f 426c 6f63 6b22         "toBlock"
-00011940: 3a20 426c 6f63 6b4e 756d 6265 7228 6173  : BlockNumber(as
-00011950: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00011960: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-00011970: 6265 7222 5d20 2d20 3129 2c0a 2020 2020  ber"] - 1),.    
-00011980: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
-00011990: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
-000119a0: 6e63 5f77 332e 6574 682e 6765 745f 6c6f  nc_w3.eth.get_lo
-000119b0: 6773 2866 696c 7465 725f 7061 7261 6d73  gs(filter_params
-000119c0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000119d0: 206c 656e 2872 6573 756c 7429 203d 3d20   len(result) == 
-000119e0: 300a 0a20 2020 2020 2020 2023 2074 6865  0..        # the
-000119f0: 2072 616e 6765 2069 7320 7772 6f6e 670a   range is wrong.
-00011a00: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
-00011a10: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00011a20: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
-00011a30: 223a 2061 7379 6e63 5f62 6c6f 636b 5f77  ": async_block_w
-00011a40: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-00011a50: 5b22 6e75 6d62 6572 225d 2c0a 2020 2020  ["number"],.    
-00011a60: 2020 2020 2020 2020 2274 6f42 6c6f 636b          "toBlock
-00011a70: 223a 2042 6c6f 636b 4e75 6d62 6572 2861  ": BlockNumber(a
-00011a80: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
-00011a90: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
-00011aa0: 6d62 6572 225d 202d 2031 292c 0a20 2020  mber"] - 1),.   
-00011ab0: 2020 2020 207d 0a20 2020 2020 2020 2077       }.        w
-00011ac0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00011ad0: 7328 5765 6233 5250 4345 7272 6f72 293a  s(Web3RPCError):
-00011ae0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00011af0: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
-00011b00: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
-00011b10: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
-00011b20: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-00011b30: 2077 6974 6820 6061 6464 7265 7373 600a   with `address`.
-00011b40: 0a20 2020 2020 2020 2023 2066 696c 7465  .        # filte
-00011b50: 7220 7769 7468 206f 7468 6572 2061 6464  r with other add
-00011b60: 7265 7373 0a20 2020 2020 2020 2066 696c  ress.        fil
-00011b70: 7465 725f 7061 7261 6d73 203d 207b 0a20  ter_params = {. 
-00011b80: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00011b90: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
-00011ba0: 6265 7228 3029 2c0a 2020 2020 2020 2020  ber(0),.        
-00011bb0: 2020 2020 2261 6464 7265 7373 223a 2055      "address": U
-00011bc0: 4e4b 4e4f 574e 5f41 4444 5245 5353 2c0a  NKNOWN_ADDRESS,.
-00011bd0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00011be0: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
-00011bf0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00011c00: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
-00011c10: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-00011c20: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
-00011c30: 203d 3d20 300a 0a20 2020 2020 2020 2023   == 0..        #
-00011c40: 2054 6573 7420 7769 7468 206d 756c 7469   Test with multi
-00011c50: 706c 6520 6061 6464 7265 7373 600a 0a20  ple `address`.. 
-00011c60: 2020 2020 2020 2023 2066 696c 7465 7220         # filter 
-00011c70: 7769 7468 206f 7468 6572 2061 6464 7265  with other addre
-00011c80: 7373 0a20 2020 2020 2020 2066 696c 7465  ss.        filte
-00011c90: 725f 7061 7261 6d73 203d 207b 0a20 2020  r_params = {.   
-00011ca0: 2020 2020 2020 2020 2022 6672 6f6d 426c           "fromBl
-00011cb0: 6f63 6b22 3a20 426c 6f63 6b4e 756d 6265  ock": BlockNumbe
-00011cc0: 7228 3029 2c0a 2020 2020 2020 2020 2020  r(0),.          
-00011cd0: 2020 2261 6464 7265 7373 223a 205b 554e    "address": [UN
-00011ce0: 4b4e 4f57 4e5f 4144 4452 4553 532c 2055  KNOWN_ADDRESS, U
-00011cf0: 4e4b 4e4f 574e 5f41 4444 5245 5353 5d2c  NKNOWN_ADDRESS],
-00011d00: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00011d10: 2020 2072 6573 756c 7420 3d20 6177 6169     result = awai
-00011d20: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
-00011d30: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
-00011d40: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-00011d50: 7373 6572 7420 6c65 6e28 7265 7375 6c74  ssert len(result
-00011d60: 2920 3d3d 2030 0a0a 2020 2020 4070 7974  ) == 0..    @pyt
-00011d70: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00011d80: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00011d90: 6573 745f 6173 796e 635f 6574 685f 6765  est_async_eth_ge
-00011da0: 745f 6c6f 6773 5f77 6974 685f 6c6f 6773  t_logs_with_logs
-00011db0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00011dc0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-00011dd0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-00011de0: 2020 2020 2020 2061 7379 6e63 5f62 6c6f         async_blo
-00011df0: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-00011e00: 5f6c 6f67 3a20 426c 6f63 6b44 6174 612c  _log: BlockData,
-00011e10: 0a20 2020 2020 2020 2061 7379 6e63 5f65  .        async_e
-00011e20: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
-00011e30: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
-00011e40: 6d41 6464 7265 7373 2c0a 2020 2020 2020  mAddress,.      
-00011e50: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
-00011e60: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
-00011e70: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00011e80: 2020 2020 2320 5465 7374 2077 6974 6820      # Test with 
-00011e90: 626c 6f63 6b20 7261 6e67 650a 0a20 2020  block range..   
-00011ea0: 2020 2020 2023 2074 6865 2072 616e 6765       # the range
-00011eb0: 2069 6e63 6c75 6465 7320 7468 6520 626c   includes the bl
-00011ec0: 6f63 6b20 7768 6572 6520 7468 6520 6c6f  ock where the lo
-00011ed0: 6720 7265 7369 6465 7320 696e 0a20 2020  g resides in.   
-00011ee0: 2020 2020 2066 696c 7465 725f 7061 7261       filter_para
-00011ef0: 6d73 3a20 4669 6c74 6572 5061 7261 6d73  ms: FilterParams
-00011f00: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00011f10: 2022 6672 6f6d 426c 6f63 6b22 3a20 6173   "fromBlock": as
-00011f20: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00011f30: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-00011f40: 6265 7222 5d2c 0a20 2020 2020 2020 2020  ber"],.         
-00011f50: 2020 2022 746f 426c 6f63 6b22 3a20 6173     "toBlock": as
-00011f60: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
-00011f70: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
-00011f80: 6265 7222 5d2c 0a20 2020 2020 2020 207d  ber"],.        }
-00011f90: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-00011fa0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00011fb0: 2e65 7468 2e67 6574 5f6c 6f67 7328 6669  .eth.get_logs(fi
-00011fc0: 6c74 6572 5f70 6172 616d 7329 0a20 2020  lter_params).   
-00011fd0: 2020 2020 2061 7373 6572 745f 636f 6e74       assert_cont
-00011fe0: 6169 6e73 5f6c 6f67 280a 2020 2020 2020  ains_log(.      
-00011ff0: 2020 2020 2020 7265 7375 6c74 2c0a 2020        result,.  
-00012000: 2020 2020 2020 2020 2020 6173 796e 635f            async_
-00012010: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
-00012020: 6974 685f 6c6f 672c 0a20 2020 2020 2020  ith_log,.       
-00012030: 2020 2020 2061 7379 6e63 5f65 6d69 7474       async_emitt
-00012040: 6572 5f63 6f6e 7472 6163 745f 6164 6472  er_contract_addr
-00012050: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-00012060: 2074 786e 5f68 6173 685f 7769 7468 5f6c   txn_hash_with_l
-00012070: 6f67 2c0a 2020 2020 2020 2020 290a 0a20  og,.        ).. 
-00012080: 2020 2020 2020 2023 2073 7065 6369 6679         # specify
-00012090: 206f 6e6c 7920 6066 726f 6d5f 626c 6f63   only `from_bloc
-000120a0: 6b60 2e20 6279 2064 6566 6175 6c74 2060  k`. by default `
-000120b0: 746f 5f62 6c6f 636b 6020 7368 6f75 6c64  to_block` should
-000120c0: 2062 6520 276c 6174 6573 7427 0a20 2020   be 'latest'.   
-000120d0: 2020 2020 2066 696c 7465 725f 7061 7261       filter_para
-000120e0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-000120f0: 2020 2022 6672 6f6d 426c 6f63 6b22 3a20     "fromBlock": 
-00012100: 426c 6f63 6b4e 756d 6265 7228 3029 2c0a  BlockNumber(0),.
-00012110: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00012120: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
-00012130: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00012140: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
-00012150: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-00012160: 7365 7274 5f63 6f6e 7461 696e 735f 6c6f  sert_contains_lo
-00012170: 6728 0a20 2020 2020 2020 2020 2020 2072  g(.            r
-00012180: 6573 756c 742c 0a20 2020 2020 2020 2020  esult,.         
-00012190: 2020 2061 7379 6e63 5f62 6c6f 636b 5f77     async_block_w
-000121a0: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-000121b0: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
-000121c0: 796e 635f 656d 6974 7465 725f 636f 6e74  ync_emitter_cont
-000121d0: 7261 6374 5f61 6464 7265 7373 2c0a 2020  ract_address,.  
-000121e0: 2020 2020 2020 2020 2020 7478 6e5f 6861            txn_ha
-000121f0: 7368 5f77 6974 685f 6c6f 672c 0a20 2020  sh_with_log,.   
-00012200: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00012210: 2320 5465 7374 2077 6974 6820 6061 6464  # Test with `add
-00012220: 7265 7373 600a 0a20 2020 2020 2020 2023  ress`..        #
-00012230: 2066 696c 7465 7220 7769 7468 2065 6d69   filter with emi
-00012240: 7474 6572 5f63 6f6e 7472 6163 742e 6164  tter_contract.ad
-00012250: 6472 6573 730a 2020 2020 2020 2020 6669  dress.        fi
-00012260: 6c74 6572 5f70 6172 616d 7320 3d20 7b0a  lter_params = {.
-00012270: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00012280: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
-00012290: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
-000122a0: 2020 2020 2022 6164 6472 6573 7322 3a20       "address": 
-000122b0: 6173 796e 635f 656d 6974 7465 725f 636f  async_emitter_co
-000122c0: 6e74 7261 6374 5f61 6464 7265 7373 2c0a  ntract_address,.
-000122d0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000122e0: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
-000122f0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00012300: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
-00012310: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-00012320: 7365 7274 5f63 6f6e 7461 696e 735f 6c6f  sert_contains_lo
-00012330: 6728 0a20 2020 2020 2020 2020 2020 2072  g(.            r
-00012340: 6573 756c 742c 0a20 2020 2020 2020 2020  esult,.         
-00012350: 2020 2061 7379 6e63 5f62 6c6f 636b 5f77     async_block_w
-00012360: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-00012370: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
-00012380: 796e 635f 656d 6974 7465 725f 636f 6e74  ync_emitter_cont
-00012390: 7261 6374 5f61 6464 7265 7373 2c0a 2020  ract_address,.  
-000123a0: 2020 2020 2020 2020 2020 7478 6e5f 6861            txn_ha
-000123b0: 7368 5f77 6974 685f 6c6f 672c 0a20 2020  sh_with_log,.   
-000123c0: 2020 2020 2029 0a0a 2020 2020 4070 7974       )..    @pyt
-000123d0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-000123e0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-000123f0: 6573 745f 6173 796e 635f 6574 685f 6765  est_async_eth_ge
-00012400: 745f 6c6f 6773 5f77 6974 685f 6c6f 6773  t_logs_with_logs
-00012410: 5f74 6f70 6963 5f61 7267 7328 0a20 2020  _topic_args(.   
-00012420: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00012430: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
-00012440: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
-00012450: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
-00012460: 7468 5f74 786e 5f77 6974 685f 6c6f 673a  th_txn_with_log:
-00012470: 2042 6c6f 636b 4461 7461 2c0a 2020 2020   BlockData,.    
-00012480: 2020 2020 6173 796e 635f 656d 6974 7465      async_emitte
-00012490: 725f 636f 6e74 7261 6374 5f61 6464 7265  r_contract_addre
-000124a0: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
-000124b0: 6573 732c 0a20 2020 2020 2020 2074 786e  ess,.        txn
-000124c0: 5f68 6173 685f 7769 7468 5f6c 6f67 3a20  _hash_with_log: 
-000124d0: 4865 7853 7472 2c0a 2020 2020 2920 2d3e  HexStr,.    ) ->
-000124e0: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
-000124f0: 2054 6573 7420 7769 7468 204e 6f6e 6520   Test with None 
-00012500: 6576 656e 7420 7369 670a 0a20 2020 2020  event sig..     
-00012510: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
-00012520: 3a20 4669 6c74 6572 5061 7261 6d73 203d  : FilterParams =
-00012530: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00012540: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
-00012550: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
-00012560: 2020 2020 2020 2020 2274 6f70 6963 7322          "topics"
-00012570: 3a20 5b0a 2020 2020 2020 2020 2020 2020  : [.            
-00012580: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-00012590: 2020 2020 2020 2020 2020 4865 7853 7472            HexStr
-000125a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000125b0: 2020 2020 2020 2230 7830 3030 3030 3030        "0x0000000
-000125c0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0000bf60: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0000bf70: 3030 3030 3030 3030 3831 3532 3630 3034  0000000081526004
+0000bf80: 3031 3830 3830 3630 3230 3031 3832 3831  0180806020018281
+0000bf90: 3033 3832 3532 3630 3162 3831 3532 3630  038252601b815260
+0000bfa0: 3230 3031 3830 3766 3436 3735 3665 3633  2001807f46756e63
+0000bfb0: 3734 3639 3666 3665 3230 3638 3631 3733  74696f6e20686173
+0000bfc0: 3230 3632 3635 3635 3665 3230 3732 3635  206265656e207265
+0000bfd0: 3736 3635 3732 3734 3635 3634 3265 3030  7665727465642e00
+0000bfe0: 3030 3030 3030 3030 3831 3532 3530 3630  0000000081525060
+0000bff0: 3230 3031 3931 3530 3530 3630 3430 3531  2001915050604051
+0000c000: 3830 3931 3033 3930 6664 3562 3630 3030  80910390fd5b6000
+0000c010: 3830 6664 3562 3630 3030 3830 3930 3530  80fd5b6000809050
+0000c020: 3930 3536 6665 6132 3634 3639 3730 3636  9056fea264697066
+0000c030: 3733 3538 3232 3132 3230 6262 3731 6539  7358221220bb71e9
+0000c040: 6539 6132 6532 3731 6364 3066 6265 3833  e9a2e271cd0fbe83
+0000c050: 3335 3234 6133 6561 3637 6466 3935 6632  3524a3ea67df95f2
+0000c060: 3565 6131 3361 6566 3562 3061 3736 3166  5ea13aef5b0a761f
+0000c070: 6135 3262 3533 3866 3130 3634 3733 3666  a52b538f1064736f
+0000c080: 3663 3633 3433 3030 3036 3031 3030 3333  6c63430006010033
+0000c090: 2220 2023 206e 6f71 613a 2045 3530 310a  "  # noqa: E501.
+0000c0a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000c0b0: 2020 6361 6c6c 5f72 6573 756c 7420 3d20    call_result = 
+0000c0c0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+0000c0d0: 7468 2e63 616c 6c28 0a20 2020 2020 2020  th.call(.       
+0000c0e0: 2020 2020 2074 786e 5f70 6172 616d 732c       txn_params,
+0000c0f0: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+0000c100: 7465 7374 222c 0a20 2020 2020 2020 2020  test",.         
+0000c110: 2020 207b 6173 796e 635f 7265 7665 7274     {async_revert
+0000c120: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+0000c130: 733a 207b 2263 6f64 6522 3a20 6f76 6572  s: {"code": over
+0000c140: 7269 6465 5f63 6f64 657d 7d2c 0a20 2020  ride_code}},.   
+0000c150: 2020 2020 2029 0a20 2020 2020 2020 2028       ).        (
+0000c160: 7265 7375 6c74 2c29 203d 2061 7379 6e63  result,) = async
+0000c170: 5f77 332e 636f 6465 632e 6465 636f 6465  _w3.codec.decode
+0000c180: 285b 2262 6f6f 6c22 5d2c 2063 616c 6c5f  (["bool"], call_
+0000c190: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
+0000c1a0: 6173 7365 7274 2072 6573 756c 7420 6973  assert result is
+0000c1b0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+0000c1c0: 2320 7465 7374 2062 7974 6573 0a0a 2020  # test bytes..  
+0000c1d0: 2020 2020 2020 6279 7465 735f 6361 6c6c        bytes_call
+0000c1e0: 5f72 6573 756c 7420 3d20 6177 6169 7420  _result = await 
+0000c1f0: 6173 796e 635f 7733 2e65 7468 2e63 616c  async_w3.eth.cal
+0000c200: 6c28 0a20 2020 2020 2020 2020 2020 2074  l(.            t
+0000c210: 786e 5f70 6172 616d 732c 0a20 2020 2020  xn_params,.     
+0000c220: 2020 2020 2020 2022 6c61 7465 7374 222c         "latest",
+0000c230: 0a20 2020 2020 2020 2020 2020 207b 6173  .            {as
+0000c240: 796e 635f 7265 7665 7274 5f63 6f6e 7472  ync_revert_contr
+0000c250: 6163 742e 6164 6472 6573 733a 207b 2263  act.address: {"c
+0000c260: 6f64 6522 3a20 746f 5f62 7974 6573 2868  ode": to_bytes(h
+0000c270: 6578 7374 723d 6f76 6572 7269 6465 5f63  exstr=override_c
+0000c280: 6f64 6529 7d7d 2c0a 2020 2020 2020 2020  ode)}},.        
+0000c290: 290a 2020 2020 2020 2020 2862 7974 6573  ).        (bytes
+0000c2a0: 5f72 6573 756c 742c 2920 3d20 6173 796e  _result,) = asyn
+0000c2b0: 635f 7733 2e63 6f64 6563 2e64 6563 6f64  c_w3.codec.decod
+0000c2c0: 6528 5b22 626f 6f6c 225d 2c20 6279 7465  e(["bool"], byte
+0000c2d0: 735f 6361 6c6c 5f72 6573 756c 7429 0a20  s_call_result). 
+0000c2e0: 2020 2020 2020 2061 7373 6572 7420 6279         assert by
+0000c2f0: 7465 735f 7265 7375 6c74 2069 7320 4661  tes_result is Fa
+0000c300: 6c73 650a 0a20 2020 2040 7079 7465 7374  lse..    @pytest
+0000c310: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000c320: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+0000c330: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+0000c340: 2020 2020 2270 6172 616d 7322 2c0a 2020      "params",.  
+0000c350: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+0000c360: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0000c370: 2020 2020 2020 226e 6f6e 6365 223a 2031        "nonce": 1
+0000c380: 2c20 2023 2069 6e74 0a20 2020 2020 2020  ,  # int.       
+0000c390: 2020 2020 2020 2020 2022 6261 6c61 6e63           "balanc
+0000c3a0: 6522 3a20 312c 2020 2320 696e 740a 2020  e": 1,  # int.  
+0000c3b0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0000c3c0: 6f64 6522 3a20 4865 7853 7472 2822 3078  ode": HexStr("0x
+0000c3d0: 2229 2c20 2023 2048 6578 5374 720a 2020  "),  # HexStr.  
+0000c3e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000c3f0: 7769 7468 2073 7461 7465 0a20 2020 2020  with state.     
+0000c400: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
+0000c410: 6522 3a20 7b48 6578 5374 7228 6622 3078  e": {HexStr(f"0x
+0000c420: 7b27 3030 2720 2a20 3332 7d22 293a 2048  {'00' * 32}"): H
+0000c430: 6578 5374 7228 6622 3078 7b27 3030 2720  exStr(f"0x{'00' 
+0000c440: 2a20 3332 7d22 297d 2c0a 2020 2020 2020  * 32}")},.      
+0000c450: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0000c460: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0000c470: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
+0000c480: 4865 7853 7472 2822 3078 3122 292c 2020  HexStr("0x1"),  
+0000c490: 2320 4865 7853 7472 0a20 2020 2020 2020  # HexStr.       
+0000c4a0: 2020 2020 2020 2020 2022 6261 6c61 6e63           "balanc
+0000c4b0: 6522 3a20 4865 7853 7472 2822 3078 3122  e": HexStr("0x1"
+0000c4c0: 292c 2020 2320 4865 7853 7472 0a20 2020  ),  # HexStr.   
+0000c4d0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+0000c4e0: 6465 223a 2062 225c 7830 3022 2c20 2023  de": b"\x00",  #
+0000c4f0: 2062 7974 6573 0a20 2020 2020 2020 2020   bytes.         
+0000c500: 2020 2020 2020 2023 2077 6974 6820 7374         # with st
+0000c510: 6174 6544 6966 660a 2020 2020 2020 2020  ateDiff.        
+0000c520: 2020 2020 2020 2020 2273 7461 7465 4469          "stateDi
+0000c530: 6666 223a 207b 4865 7853 7472 2866 2230  ff": {HexStr(f"0
+0000c540: 787b 2730 3027 202a 2033 327d 2229 3a20  x{'00' * 32}"): 
+0000c550: 4865 7853 7472 2866 2230 787b 2730 3027  HexStr(f"0x{'00'
+0000c560: 202a 2033 327d 2229 7d2c 0a20 2020 2020   * 32}")},.     
+0000c570: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0000c580: 2020 292c 0a20 2020 2029 0a20 2020 2061    ),.    ).    a
+0000c590: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+0000c5a0: 685f 6361 6c6c 5f77 6974 685f 6f76 6572  h_call_with_over
+0000c5b0: 7269 6465 5f70 6172 616d 5f74 7970 655f  ride_param_type_
+0000c5c0: 6368 6563 6b28 0a20 2020 2020 2020 2073  check(.        s
+0000c5d0: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
+0000c5e0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+0000c5f0: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
+0000c600: 635f 6d61 7468 5f63 6f6e 7472 6163 743a  c_math_contract:
+0000c610: 2022 4173 796e 6343 6f6e 7472 6163 7422   "AsyncContract"
+0000c620: 2c0a 2020 2020 2020 2020 7061 7261 6d73  ,.        params
+0000c630: 3a20 5374 6174 654f 7665 7272 6964 6550  : StateOverrideP
+0000c640: 6172 616d 732c 0a20 2020 2029 202d 3e20  arams,.    ) -> 
+0000c650: 4e6f 6e65 3a0a 2020 2020 2020 2020 636f  None:.        co
+0000c660: 696e 6261 7365 203d 2061 7761 6974 2061  inbase = await a
+0000c670: 7379 6e63 5f77 332e 6574 682e 636f 696e  sync_w3.eth.coin
+0000c680: 6261 7365 0a20 2020 2020 2020 2074 786e  base.        txn
+0000c690: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0000c6a0: 7320 3d20 7b22 6672 6f6d 223a 2063 6f69  s = {"from": coi
+0000c6b0: 6e62 6173 657d 0a0a 2020 2020 2020 2020  nbase}..        
+0000c6c0: 2320 6173 7365 7274 2064 6f65 7320 6e6f  # assert does no
+0000c6d0: 7420 7261 6973 650a 2020 2020 2020 2020  t raise.        
+0000c6e0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+0000c6f0: 7468 2e63 616c 6c28 0a20 2020 2020 2020  th.call(.       
+0000c700: 2020 2020 2074 786e 5f70 6172 616d 732c       txn_params,
+0000c710: 2022 6c61 7465 7374 222c 207b 6173 796e   "latest", {asyn
+0000c720: 635f 6d61 7468 5f63 6f6e 7472 6163 742e  c_math_contract.
+0000c730: 6164 6472 6573 733a 2070 6172 616d 737d  address: params}
+0000c740: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000c750: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+0000c760: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+0000c770: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
+0000c780: 5f77 6974 685f 305f 7265 7375 6c74 280a  _with_0_result(.
+0000c790: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
+0000c7a0: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+0000c7b0: 6233 222c 2061 7379 6e63 5f6d 6174 685f  b3", async_math_
+0000c7c0: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000c7d0: 436f 6e74 7261 6374 220a 2020 2020 2920  Contract".    ) 
+0000c7e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000c7f0: 2063 6f69 6e62 6173 6520 3d20 6177 6169   coinbase = awai
+0000c800: 7420 6173 796e 635f 7733 2e65 7468 2e63  t async_w3.eth.c
+0000c810: 6f69 6e62 6173 650a 2020 2020 2020 2020  oinbase.        
+0000c820: 7478 6e5f 7061 7261 6d73 203d 2061 7379  txn_params = asy
+0000c830: 6e63 5f6d 6174 685f 636f 6e74 7261 6374  nc_math_contract
+0000c840: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
+0000c850: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0000c860: 2020 2066 6e5f 6e61 6d65 3d22 6164 6422     fn_name="add"
+0000c870: 2c0a 2020 2020 2020 2020 2020 2020 666e  ,.            fn
+0000c880: 5f61 7267 733d 2830 2c20 3029 2c0a 2020  _args=(0, 0),.  
+0000c890: 2020 2020 2020 2020 2020 7472 616e 7361            transa
+0000c8a0: 6374 696f 6e3d 7b22 6672 6f6d 223a 2063  ction={"from": c
+0000c8b0: 6f69 6e62 6173 652c 2022 746f 223a 2061  oinbase, "to": a
+0000c8c0: 7379 6e63 5f6d 6174 685f 636f 6e74 7261  sync_math_contra
+0000c8d0: 6374 2e61 6464 7265 7373 7d2c 0a20 2020  ct.address},.   
+0000c8e0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+0000c8f0: 616c 6c5f 7265 7375 6c74 203d 2061 7761  all_result = awa
+0000c900: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+0000c910: 6361 6c6c 2874 786e 5f70 6172 616d 7329  call(txn_params)
+0000c920: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0000c930: 6973 5f73 7472 696e 6728 6361 6c6c 5f72  is_string(call_r
+0000c940: 6573 756c 7429 0a20 2020 2020 2020 2028  esult).        (
+0000c950: 7265 7375 6c74 2c29 203d 2061 7379 6e63  result,) = async
+0000c960: 5f77 332e 636f 6465 632e 6465 636f 6465  _w3.codec.decode
+0000c970: 285b 2275 696e 7432 3536 225d 2c20 6361  (["uint256"], ca
+0000c980: 6c6c 5f72 6573 756c 7429 0a20 2020 2020  ll_result).     
+0000c990: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+0000c9a0: 203d 3d20 300a 0a20 2020 2040 7079 7465   == 0..    @pyte
+0000c9b0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+0000c9c0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+0000c9d0: 7374 5f65 7468 5f63 616c 6c5f 7265 7665  st_eth_call_reve
+0000c9e0: 7274 5f77 6974 685f 6d73 6728 0a20 2020  rt_with_msg(.   
+0000c9f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000ca00: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+0000ca10: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+0000ca20: 2020 6173 796e 635f 7265 7665 7274 5f63    async_revert_c
+0000ca30: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+0000ca40: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+0000ca50: 2020 6173 796e 635f 6b65 7966 696c 655f    async_keyfile_
+0000ca60: 6163 636f 756e 745f 6164 6472 6573 733a  account_address:
+0000ca70: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0000ca80: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+0000ca90: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+0000caa0: 616d 7320 3d20 6173 796e 635f 7265 7665  ams = async_reve
+0000cab0: 7274 5f63 6f6e 7472 6163 742e 5f70 7265  rt_contract._pre
+0000cac0: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
+0000cad0: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
+0000cae0: 5f6e 616d 653d 2272 6576 6572 7457 6974  _name="revertWit
+0000caf0: 684d 6573 7361 6765 222c 0a20 2020 2020  hMessage",.     
+0000cb00: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
+0000cb10: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
+0000cb20: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+0000cb30: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+0000cb40: 6e74 5f61 6464 7265 7373 2c0a 2020 2020  nt_address,.    
+0000cb50: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+0000cb60: 3a20 6173 796e 635f 7265 7665 7274 5f63  : async_revert_c
+0000cb70: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
+0000cb80: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
+0000cb90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000cba0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0000cbb0: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
+0000cbc0: 2020 436f 6e74 7261 6374 4c6f 6769 6345    ContractLogicE
+0000cbd0: 7272 6f72 2c20 6d61 7463 683d 2265 7865  rror, match="exe
+0000cbe0: 6375 7469 6f6e 2072 6576 6572 7465 643a  cution reverted:
+0000cbf0: 2046 756e 6374 696f 6e20 6861 7320 6265   Function has be
+0000cc00: 656e 2072 6576 6572 7465 6422 0a20 2020  en reverted".   
+0000cc10: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0000cc20: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
+0000cc30: 7733 2e65 7468 2e63 616c 6c28 7478 6e5f  w3.eth.call(txn_
+0000cc40: 7061 7261 6d73 290a 0a20 2020 2040 7079  params)..    @py
+0000cc50: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000cc60: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000cc70: 7465 7374 5f65 7468 5f63 616c 6c5f 7265  test_eth_call_re
+0000cc80: 7665 7274 5f77 6974 686f 7574 5f6d 7367  vert_without_msg
+0000cc90: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000cca0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000ccb0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+0000ccc0: 2020 2020 2020 2061 7379 6e63 5f72 6576         async_rev
+0000ccd0: 6572 745f 636f 6e74 7261 6374 3a20 2241  ert_contract: "A
+0000cce0: 7379 6e63 436f 6e74 7261 6374 222c 0a20  syncContract",. 
+0000ccf0: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+0000cd00: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0000cd10: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
+0000cd20: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+0000cd30: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+0000cd40: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0000cd50: 2843 6f6e 7472 6163 744c 6f67 6963 4572  (ContractLogicEr
+0000cd60: 726f 722c 206d 6174 6368 3d22 6578 6563  ror, match="exec
+0000cd70: 7574 696f 6e20 7265 7665 7274 6564 2229  ution reverted")
+0000cd80: 3a0a 2020 2020 2020 2020 2020 2020 7478  :.            tx
+0000cd90: 6e5f 7061 7261 6d73 203d 2061 7379 6e63  n_params = async
+0000cda0: 5f72 6576 6572 745f 636f 6e74 7261 6374  _revert_contract
+0000cdb0: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
+0000cdc0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0000cdd0: 2020 2020 2020 2066 6e5f 6e61 6d65 3d22         fn_name="
+0000cde0: 7265 7665 7274 5769 7468 6f75 744d 6573  revertWithoutMes
+0000cdf0: 7361 6765 222c 0a20 2020 2020 2020 2020  sage",.         
+0000ce00: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
+0000ce10: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
+0000ce20: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+0000ce30: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+0000ce40: 6363 6f75 6e74 5f61 6464 7265 7373 2c0a  ccount_address,.
+0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce60: 2020 2020 2274 6f22 3a20 6173 796e 635f      "to": async_
+0000ce70: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
+0000ce80: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+0000ce90: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0000cea0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ceb0: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+0000cec0: 635f 7733 2e65 7468 2e63 616c 6c28 7478  c_w3.eth.call(tx
+0000ced0: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
+0000cee0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+0000cef0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+0000cf00: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
+0000cf10: 7265 7665 7274 5f63 7573 746f 6d5f 6572  revert_custom_er
+0000cf20: 726f 725f 7769 7468 5f6d 7367 280a 2020  ror_with_msg(.  
+0000cf30: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000cf40: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+0000cf50: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+0000cf60: 2020 2061 7379 6e63 5f72 6576 6572 745f     async_revert_
+0000cf70: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000cf80: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+0000cf90: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
+0000cfa0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0000cfb0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0000cfc0: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+0000cfd0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
+0000cfe0: 2061 7379 6e63 5f72 6576 6572 745f 636f   async_revert_co
+0000cff0: 6e74 7261 6374 2e65 6e63 6f64 655f 6162  ntract.encode_ab
+0000d000: 6928 0a20 2020 2020 2020 2020 2020 2066  i(.            f
+0000d010: 6e5f 6e61 6d65 3d22 556e 6175 7468 6f72  n_name="Unauthor
+0000d020: 697a 6564 5769 7468 4d65 7373 6167 6522  izedWithMessage"
+0000d030: 2c20 6172 6773 3d5b 2259 6f75 2061 7265  , args=["You are
+0000d040: 206e 6f74 2061 7574 686f 7269 7a65 6422   not authorized"
+0000d050: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
+0000d060: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
+0000d070: 2061 7379 6e63 5f72 6576 6572 745f 636f   async_revert_co
+0000d080: 6e74 7261 6374 2e5f 7072 6570 6172 655f  ntract._prepare_
+0000d090: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+0000d0a0: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
+0000d0b0: 3d22 6375 7374 6f6d 4572 726f 7257 6974  ="customErrorWit
+0000d0c0: 684d 6573 7361 6765 222c 0a20 2020 2020  hMessage",.     
+0000d0d0: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
+0000d0e0: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
+0000d0f0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+0000d100: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+0000d110: 6e74 5f61 6464 7265 7373 2c0a 2020 2020  nt_address,.    
+0000d120: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+0000d130: 3a20 6173 796e 635f 7265 7665 7274 5f63  : async_revert_c
+0000d140: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
+0000d150: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
+0000d160: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d170: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0000d180: 6973 6573 2843 6f6e 7472 6163 7443 7573  ises(ContractCus
+0000d190: 746f 6d45 7272 6f72 2c20 6d61 7463 683d  tomError, match=
+0000d1a0: 6461 7461 293a 0a20 2020 2020 2020 2020  data):.         
+0000d1b0: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
+0000d1c0: 332e 6574 682e 6361 6c6c 2874 786e 5f70  3.eth.call(txn_p
+0000d1d0: 6172 616d 7329 0a0a 2020 2020 4070 7974  arams)..    @pyt
+0000d1e0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+0000d1f0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+0000d200: 6573 745f 6574 685f 6361 6c6c 5f72 6576  est_eth_call_rev
+0000d210: 6572 745f 6375 7374 6f6d 5f65 7272 6f72  ert_custom_error
+0000d220: 5f77 6974 686f 7574 5f6d 7367 280a 2020  _without_msg(.  
+0000d230: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000d240: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+0000d250: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+0000d260: 2020 2061 7379 6e63 5f72 6576 6572 745f     async_revert_
+0000d270: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000d280: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+0000d290: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
+0000d2a0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0000d2b0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0000d2c0: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+0000d2d0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
+0000d2e0: 2061 7379 6e63 5f72 6576 6572 745f 636f   async_revert_co
+0000d2f0: 6e74 7261 6374 2e65 6e63 6f64 655f 6162  ntract.encode_ab
+0000d300: 6928 666e 5f6e 616d 653d 2255 6e61 7574  i(fn_name="Unaut
+0000d310: 686f 7269 7a65 6422 290a 2020 2020 2020  horized").      
+0000d320: 2020 7478 6e5f 7061 7261 6d73 203d 2061    txn_params = a
+0000d330: 7379 6e63 5f72 6576 6572 745f 636f 6e74  sync_revert_cont
+0000d340: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
+0000d350: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+0000d360: 2020 2020 2020 2066 6e5f 6e61 6d65 3d22         fn_name="
+0000d370: 6375 7374 6f6d 4572 726f 7257 6974 686f  customErrorWitho
+0000d380: 7574 4d65 7373 6167 6522 2c0a 2020 2020  utMessage",.    
+0000d390: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+0000d3a0: 696f 6e3d 7b0a 2020 2020 2020 2020 2020  ion={.          
+0000d3b0: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
+0000d3c0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+0000d3d0: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
+0000d3e0: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+0000d3f0: 223a 2061 7379 6e63 5f72 6576 6572 745f  ": async_revert_
+0000d400: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+0000d410: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+0000d420: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000d430: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0000d440: 6169 7365 7328 436f 6e74 7261 6374 4375  aises(ContractCu
+0000d450: 7374 6f6d 4572 726f 722c 206d 6174 6368  stomError, match
+0000d460: 3d64 6174 6129 3a0a 2020 2020 2020 2020  =data):.        
+0000d470: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
+0000d480: 7733 2e65 7468 2e63 616c 6c28 7478 6e5f  w3.eth.call(txn_
+0000d490: 7061 7261 6d73 290a 0a20 2020 2040 7079  params)..    @py
+0000d4a0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+0000d4b0: 7472 697a 6528 0a20 2020 2020 2020 2022  trize(.        "
+0000d4c0: 7061 6e69 635f 6572 726f 722c 7061 7261  panic_error,para
+0000d4d0: 6d73 222c 0a20 2020 2020 2020 2028 0a20  ms",.        (. 
+0000d4e0: 2020 2020 2020 2020 2020 2028 2230 3122             ("01"
+0000d4f0: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
+0000d500: 2020 2028 2231 3122 2c20 5b5d 292c 0a20     ("11", []),. 
+0000d510: 2020 2020 2020 2020 2020 2028 2231 3222             ("12"
+0000d520: 2c20 5b30 5d29 2c0a 2020 2020 2020 2020  , [0]),.        
+0000d530: 2020 2020 2822 3231 222c 205b 2d31 5d29      ("21", [-1])
+0000d540: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0000d550: 3232 222c 205b 5d29 2c0a 2020 2020 2020  22", []),.      
+0000d560: 2020 2020 2020 2822 3331 222c 205b 5d29        ("31", [])
+0000d570: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0000d580: 3332 222c 205b 5d29 2c0a 2020 2020 2020  32", []),.      
+0000d590: 2020 2020 2020 2822 3431 222c 205b 5d29        ("41", [])
+0000d5a0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0000d5b0: 3531 222c 205b 5d29 2c0a 2020 2020 2020  51", []),.      
+0000d5c0: 2020 292c 0a20 2020 2029 0a20 2020 2040    ),.    ).    @
+0000d5d0: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+0000d5e0: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+0000d5f0: 6620 7465 7374 5f63 6f6e 7472 6163 745f  f test_contract_
+0000d600: 7061 6e69 635f 6572 726f 7273 280a 2020  panic_errors(.  
+0000d610: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000d620: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+0000d630: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+0000d640: 2020 2061 7379 6e63 5f70 616e 6963 5f65     async_panic_e
+0000d650: 7272 6f72 735f 636f 6e74 7261 6374 3a20  rrors_contract: 
+0000d660: 2241 7379 6e63 436f 6e74 7261 6374 222c  "AsyncContract",
+0000d670: 0a20 2020 2020 2020 2070 616e 6963 5f65  .        panic_e
+0000d680: 7272 6f72 3a20 7374 722c 0a20 2020 2020  rror: str,.     
+0000d690: 2020 2070 6172 616d 733a 204c 6973 745b     params: List[
+0000d6a0: 416e 795d 2c0a 2020 2020 2920 2d3e 204e  Any],.    ) -> N
+0000d6b0: 6f6e 653a 0a20 2020 2020 2020 206d 6574  one:.        met
+0000d6c0: 686f 6420 3d20 6765 7461 7474 7228 0a20  hod = getattr(. 
+0000d6d0: 2020 2020 2020 2020 2020 2061 7379 6e63             async
+0000d6e0: 5f70 616e 6963 5f65 7272 6f72 735f 636f  _panic_errors_co
+0000d6f0: 6e74 7261 6374 2e66 756e 6374 696f 6e73  ntract.functions
+0000d700: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
+0000d710: 6572 726f 7243 6f64 657b 7061 6e69 635f  errorCode{panic_
+0000d720: 6572 726f 727d 222c 0a20 2020 2020 2020  error}",.       
+0000d730: 2029 0a20 2020 2020 2020 2065 7272 6f72   ).        error
+0000d740: 5f6d 7367 203d 2050 414e 4943 5f45 5252  _msg = PANIC_ERR
+0000d750: 4f52 5f43 4f44 4553 5b70 616e 6963 5f65  OR_CODES[panic_e
+0000d760: 7272 6f72 5d0a 0a20 2020 2020 2020 2077  rror]..        w
+0000d770: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0000d780: 7328 436f 6e74 7261 6374 5061 6e69 6345  s(ContractPanicE
+0000d790: 7272 6f72 2c20 6d61 7463 683d 7265 2e65  rror, match=re.e
+0000d7a0: 7363 6170 6528 6572 726f 725f 6d73 6729  scape(error_msg)
+0000d7b0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0000d7c0: 7761 6974 206d 6574 686f 6428 2a70 6172  wait method(*par
+0000d7d0: 616d 7329 2e63 616c 6c28 290a 0a20 2020  ams).call()..   
+0000d7e0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+0000d7f0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+0000d800: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
+0000d810: 6c5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  l_offchain_looku
+0000d820: 7028 0a20 2020 2020 2020 2073 656c 662c  p(.        self,
+0000d830: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
+0000d840: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
+0000d850: 2020 2020 2020 2020 6173 796e 635f 6f66          async_of
+0000d860: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
+0000d870: 6e74 7261 6374 3a20 2241 7379 6e63 436f  ntract: "AsyncCo
+0000d880: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
+0000d890: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+0000d8a0: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
+0000d8b0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+0000d8c0: 0a20 2020 2020 2020 206d 6f6e 6b65 7970  .        monkeyp
+0000d8d0: 6174 6368 3a20 224d 6f6e 6b65 7950 6174  atch: "MonkeyPat
+0000d8e0: 6368 222c 0a20 2020 2029 202d 3e20 4e6f  ch",.    ) -> No
+0000d8f0: 6e65 3a0a 2020 2020 2020 2020 6e6f 726d  ne:.        norm
+0000d900: 616c 697a 6564 5f63 6f6e 7472 6163 745f  alized_contract_
+0000d910: 6164 6472 6573 7320 3d20 746f 5f68 6578  address = to_hex
+0000d920: 5f69 665f 6279 7465 7328 0a20 2020 2020  _if_bytes(.     
+0000d930: 2020 2020 2020 2061 7379 6e63 5f6f 6666         async_off
+0000d940: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+0000d950: 7472 6163 742e 6164 6472 6573 730a 2020  tract.address.  
+0000d960: 2020 2020 2020 292e 6c6f 7765 7228 290a        ).lower().
+0000d970: 0a20 2020 2020 2020 2061 7379 6e63 5f6d  .        async_m
+0000d980: 6f63 6b5f 6f66 6663 6861 696e 5f6c 6f6f  ock_offchain_loo
+0000d990: 6b75 705f 7265 7175 6573 745f 7265 7370  kup_request_resp
+0000d9a0: 6f6e 7365 280a 2020 2020 2020 2020 2020  onse(.          
+0000d9b0: 2020 6d6f 6e6b 6579 7061 7463 682c 0a20    monkeypatch,. 
+0000d9c0: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
+0000d9d0: 645f 7265 7175 6573 745f 7572 6c3d 6622  d_request_url=f"
+0000d9e0: 6874 7470 733a 2f2f 7765 6233 2e70 792f  https://web3.py/
+0000d9f0: 6761 7465 7761 792f 7b6e 6f72 6d61 6c69  gateway/{normali
+0000da00: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
+0000da10: 7265 7373 7d2f 7b4f 4646 4348 4149 4e5f  ress}/{OFFCHAIN_
+0000da20: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
+0000da30: 7d2e 6a73 6f6e 222c 2020 2320 6e6f 7161  }.json",  # noqa
+0000da40: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
+0000da50: 2020 206d 6f63 6b65 645f 6a73 6f6e 5f64     mocked_json_d
+0000da60: 6174 613d 5745 4233 5059 5f41 535f 4845  ata=WEB3PY_AS_HE
+0000da70: 5842 5954 4553 2c0a 2020 2020 2020 2020  XBYTES,.        
+0000da80: 290a 2020 2020 2020 2020 7265 7370 6f6e  ).        respon
+0000da90: 7365 5f63 616c 6c65 7220 3d20 6177 6169  se_caller = awai
+0000daa0: 7420 6173 796e 635f 6f66 6663 6861 696e  t async_offchain
+0000dab0: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000dac0: 2e63 616c 6c65 7228 292e 7465 7374 4f66  .caller().testOf
+0000dad0: 6663 6861 696e 4c6f 6f6b 7570 2820 2023  fchainLookup(  #
+0000dae0: 206e 6f71 613a 2045 3530 3120 7479 7065   noqa: E501 type
+0000daf0: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
+0000db00: 2020 2020 204f 4646 4348 4149 4e5f 4c4f       OFFCHAIN_LO
+0000db10: 4f4b 5550 5f54 4553 545f 4441 5441 0a20  OKUP_TEST_DATA. 
+0000db20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000db30: 2072 6573 706f 6e73 655f 6675 6e63 7469   response_functi
+0000db40: 6f6e 5f63 616c 6c20 3d20 6177 6169 7420  on_call = await 
+0000db50: 6173 796e 635f 6f66 6663 6861 696e 5f6c  async_offchain_l
+0000db60: 6f6f 6b75 705f 636f 6e74 7261 6374 2e66  ookup_contract.f
+0000db70: 756e 6374 696f 6e73 2e74 6573 744f 6666  unctions.testOff
+0000db80: 6368 6169 6e4c 6f6f 6b75 7028 2020 2320  chainLookup(  # 
+0000db90: 6e6f 7161 3a20 4535 3031 2074 7970 653a  noqa: E501 type:
+0000dba0: 2069 676e 6f72 650a 2020 2020 2020 2020   ignore.        
+0000dbb0: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
+0000dbc0: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
+0000dbd0: 2020 2020 2020 292e 6361 6c6c 2829 0a20        ).call(). 
+0000dbe0: 2020 2020 2020 2061 7373 6572 7420 6173         assert as
+0000dbf0: 796e 635f 7733 2e63 6f64 6563 2e64 6563  ync_w3.codec.dec
+0000dc00: 6f64 6528 5b22 7374 7269 6e67 225d 2c20  ode(["string"], 
+0000dc10: 7265 7370 6f6e 7365 5f63 616c 6c65 7229  response_caller)
+0000dc20: 5b30 5d20 3d3d 2022 7765 6233 7079 220a  [0] == "web3py".
+0000dc30: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+0000dc40: 7379 6e63 5f77 332e 636f 6465 632e 6465  sync_w3.codec.de
+0000dc50: 636f 6465 285b 2273 7472 696e 6722 5d2c  code(["string"],
+0000dc60: 2072 6573 706f 6e73 655f 6675 6e63 7469   response_functi
+0000dc70: 6f6e 5f63 616c 6c29 5b30 5d20 3d3d 2022  on_call)[0] == "
+0000dc80: 7765 6233 7079 220a 0a20 2020 2040 7079  web3py"..    @py
+0000dc90: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+0000dca0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+0000dcb0: 7465 7374 5f65 7468 5f63 616c 6c5f 6f66  test_eth_call_of
+0000dcc0: 6663 6861 696e 5f6c 6f6f 6b75 705f 7261  fchain_lookup_ra
+0000dcd0: 6973 6573 5f77 6865 6e5f 6363 6970 5f72  ises_when_ccip_r
+0000dce0: 6561 645f 6973 5f64 6973 6162 6c65 6428  ead_is_disabled(
+0000dcf0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000dd00: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+0000dd10: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+0000dd20: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
+0000dd30: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+0000dd40: 7261 6374 3a20 2241 7379 6e63 436f 6e74  ract: "AsyncCont
+0000dd50: 7261 6374 222c 0a20 2020 2029 202d 3e20  ract",.    ) -> 
+0000dd60: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+0000dd70: 7475 726e 5f64 6174 6120 3d20 280a 2020  turn_data = (.  
+0000dd80: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
+0000dd90: 494e 5f4c 4f4f 4b55 505f 3442 5954 455f  IN_LOOKUP_4BYTE_
+0000dda0: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
+0000ddb0: 202b 2061 6269 5f65 6e63 6f64 6564 5f6f   + abi_encoded_o
+0000ddc0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+0000ddd0: 6f6e 7472 6163 745f 6164 6472 6573 7328  ontract_address(
+0000dde0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ddf0: 2061 7379 6e63 5f77 332c 2061 7379 6e63   async_w3, async
+0000de00: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
+0000de10: 5f63 6f6e 7472 6163 740a 2020 2020 2020  _contract.      
+0000de20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000de30: 2020 2020 2b20 4f46 4643 4841 494e 5f4c      + OFFCHAIN_L
+0000de40: 4f4f 4b55 505f 5245 5455 524e 5f44 4154  OOKUP_RETURN_DAT
+0000de50: 410a 2020 2020 2020 2020 290a 2020 2020  A.        ).    
+0000de60: 2020 2020 2320 7465 7374 2041 7379 6e63      # test Async
+0000de70: 436f 6e74 7261 6374 4361 6c6c 6572 0a20  ContractCaller. 
+0000de80: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0000de90: 7374 2e72 6169 7365 7328 4f66 6663 6861  st.raises(Offcha
+0000dea0: 696e 4c6f 6f6b 7570 2920 6173 2065 3a0a  inLookup) as e:.
+0000deb0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+0000dec0: 7420 6173 796e 635f 6f66 6663 6861 696e  t async_offchain
+0000ded0: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000dee0: 2e63 616c 6c65 7228 0a20 2020 2020 2020  .caller(.       
+0000def0: 2020 2020 2020 2020 2063 6369 705f 7265           ccip_re
+0000df00: 6164 5f65 6e61 626c 6564 3d46 616c 7365  ad_enabled=False
+0000df10: 0a20 2020 2020 2020 2020 2020 2029 2e74  .            ).t
+0000df20: 6573 744f 6666 6368 6169 6e4c 6f6f 6b75  estOffchainLooku
+0000df30: 7028 4f46 4643 4841 494e 5f4c 4f4f 4b55  p(OFFCHAIN_LOOKU
+0000df40: 505f 5445 5354 5f44 4154 4129 0a20 2020  P_TEST_DATA).   
+0000df50: 2020 2020 2061 7373 6572 7420 652e 7661       assert e.va
+0000df60: 6c75 652e 6461 7461 203d 3d20 7265 7475  lue.data == retu
+0000df70: 726e 5f64 6174 610a 0a20 2020 2020 2020  rn_data..       
+0000df80: 2023 2074 6573 7420 4173 796e 6343 6f6e   # test AsyncCon
+0000df90: 7472 6163 7446 756e 6374 696f 6e20 6361  tractFunction ca
+0000dfa0: 6c6c 0a20 2020 2020 2020 2077 6974 6820  ll.        with 
+0000dfb0: 7079 7465 7374 2e72 6169 7365 7328 4f66  pytest.raises(Of
+0000dfc0: 6663 6861 696e 4c6f 6f6b 7570 2920 6173  fchainLookup) as
+0000dfd0: 2065 7863 696e 666f 3a0a 2020 2020 2020   excinfo:.      
+0000dfe0: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+0000dff0: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
+0000e000: 705f 636f 6e74 7261 6374 2e66 756e 6374  p_contract.funct
+0000e010: 696f 6e73 2e74 6573 744f 6666 6368 6169  ions.testOffchai
+0000e020: 6e4c 6f6f 6b75 7028 0a20 2020 2020 2020  nLookup(.       
+0000e030: 2020 2020 2020 2020 204f 4646 4348 4149           OFFCHAI
+0000e040: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
+0000e050: 5441 0a20 2020 2020 2020 2020 2020 2029  TA.            )
+0000e060: 2e63 616c 6c28 6363 6970 5f72 6561 645f  .call(ccip_read_
+0000e070: 656e 6162 6c65 643d 4661 6c73 6529 0a20  enabled=False). 
+0000e080: 2020 2020 2020 2061 7373 6572 7420 6578         assert ex
+0000e090: 6369 6e66 6f2e 7661 6c75 652e 6461 7461  cinfo.value.data
+0000e0a0: 203d 3d20 7265 7475 726e 5f64 6174 610a   == return_data.
+0000e0b0: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
+0000e0c0: 676c 6f62 616c 2066 6c61 6720 6f6e 2074  global flag on t
+0000e0d0: 6865 2070 726f 7669 6465 720a 2020 2020  he provider.    
+0000e0e0: 2020 2020 6173 796e 635f 7733 2e70 726f      async_w3.pro
+0000e0f0: 7669 6465 722e 676c 6f62 616c 5f63 6369  vider.global_cci
+0000e100: 705f 7265 6164 5f65 6e61 626c 6564 203d  p_read_enabled =
+0000e110: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+0000e120: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+0000e130: 6573 284f 6666 6368 6169 6e4c 6f6f 6b75  es(OffchainLooku
+0000e140: 7029 2061 7320 6578 635f 696e 666f 3a0a  p) as exc_info:.
+0000e150: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+0000e160: 7420 6173 796e 635f 6f66 6663 6861 696e  t async_offchain
+0000e170: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
+0000e180: 2e66 756e 6374 696f 6e73 2e74 6573 744f  .functions.testO
+0000e190: 6666 6368 6169 6e4c 6f6f 6b75 7028 2020  ffchainLookup(  
+0000e1a0: 2320 6e6f 7161 3a20 4535 3031 2074 7970  # noqa: E501 typ
+0000e1b0: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
+0000e1c0: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
+0000e1d0: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
+0000e1e0: 4154 410a 2020 2020 2020 2020 2020 2020  ATA.            
+0000e1f0: 292e 6361 6c6c 2829 0a20 2020 2020 2020  ).call().       
+0000e200: 2061 7373 6572 7420 6578 635f 696e 666f   assert exc_info
+0000e210: 2e76 616c 7565 2e64 6174 6120 3d3d 2072  .value.data == r
+0000e220: 6574 7572 6e5f 6461 7461 0a0a 2020 2020  eturn_data..    
+0000e230: 2020 2020 6173 796e 635f 7733 2e70 726f      async_w3.pro
+0000e240: 7669 6465 722e 676c 6f62 616c 5f63 6369  vider.global_cci
+0000e250: 705f 7265 6164 5f65 6e61 626c 6564 203d  p_read_enabled =
+0000e260: 2054 7275 6520 2023 2063 6c65 616e 7570   True  # cleanup
+0000e270: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+0000e280: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+0000e290: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+0000e2a0: 685f 6361 6c6c 5f6f 6666 6368 6169 6e5f  h_call_offchain_
+0000e2b0: 6c6f 6f6b 7570 5f63 616c 6c5f 666c 6167  lookup_call_flag
+0000e2c0: 5f6f 7665 7272 6964 6573 5f70 726f 7669  _overrides_provi
+0000e2d0: 6465 725f 666c 6167 280a 2020 2020 2020  der_flag(.      
+0000e2e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000e2f0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+0000e300: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+0000e310: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
+0000e320: 6f6b 7570 5f63 6f6e 7472 6163 743a 2022  okup_contract: "
+0000e330: 4173 796e 6343 6f6e 7472 6163 7422 2c0a  AsyncContract",.
+0000e340: 2020 2020 2020 2020 6173 796e 635f 6b65          async_ke
+0000e350: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+0000e360: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
+0000e370: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+0000e380: 6d6f 6e6b 6579 7061 7463 683a 2022 4d6f  monkeypatch: "Mo
+0000e390: 6e6b 6579 5061 7463 6822 2c0a 2020 2020  nkeyPatch",.    
+0000e3a0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000e3b0: 2020 206e 6f72 6d61 6c69 7a65 645f 636f     normalized_co
+0000e3c0: 6e74 7261 6374 5f61 6464 7265 7373 203d  ntract_address =
+0000e3d0: 2074 6f5f 6865 785f 6966 5f62 7974 6573   to_hex_if_bytes
+0000e3e0: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
+0000e3f0: 796e 635f 6f66 6663 6861 696e 5f6c 6f6f  ync_offchain_loo
+0000e400: 6b75 705f 636f 6e74 7261 6374 2e61 6464  kup_contract.add
+0000e410: 7265 7373 0a20 2020 2020 2020 2029 2e6c  ress.        ).l
+0000e420: 6f77 6572 2829 0a0a 2020 2020 2020 2020  ower()..        
+0000e430: 6173 796e 635f 6d6f 636b 5f6f 6666 6368  async_mock_offch
+0000e440: 6169 6e5f 6c6f 6f6b 7570 5f72 6571 7565  ain_lookup_reque
+0000e450: 7374 5f72 6573 706f 6e73 6528 0a20 2020  st_response(.   
+0000e460: 2020 2020 2020 2020 206d 6f6e 6b65 7970           monkeyp
+0000e470: 6174 6368 2c0a 2020 2020 2020 2020 2020  atch,.          
+0000e480: 2020 6d6f 636b 6564 5f72 6571 7565 7374    mocked_request
+0000e490: 5f75 726c 3d66 2268 7474 7073 3a2f 2f77  _url=f"https://w
+0000e4a0: 6562 332e 7079 2f67 6174 6577 6179 2f7b  eb3.py/gateway/{
+0000e4b0: 6e6f 726d 616c 697a 6564 5f63 6f6e 7472  normalized_contr
+0000e4c0: 6163 745f 6164 6472 6573 737d 2f7b 4f46  act_address}/{OF
+0000e4d0: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
+0000e4e0: 5354 5f44 4154 417d 2e6a 736f 6e22 2c20  ST_DATA}.json", 
+0000e4f0: 2023 206e 6f71 613a 2045 3530 310a 2020   # noqa: E501.  
+0000e500: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
+0000e510: 5f6a 736f 6e5f 6461 7461 3d57 4542 3350  _json_data=WEB3P
+0000e520: 595f 4153 5f48 4558 4259 5445 532c 0a20  Y_AS_HEXBYTES,. 
+0000e530: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000e540: 2020 6173 796e 635f 7733 2e70 726f 7669    async_w3.provi
+0000e550: 6465 722e 676c 6f62 616c 5f63 6369 705f  der.global_ccip_
+0000e560: 7265 6164 5f65 6e61 626c 6564 203d 2046  read_enabled = F
+0000e570: 616c 7365 0a0a 2020 2020 2020 2020 7265  alse..        re
+0000e580: 7370 6f6e 7365 203d 2061 7761 6974 2061  sponse = await a
+0000e590: 7379 6e63 5f6f 6666 6368 6169 6e5f 6c6f  sync_offchain_lo
+0000e5a0: 6f6b 7570 5f63 6f6e 7472 6163 742e 6675  okup_contract.fu
+0000e5b0: 6e63 7469 6f6e 732e 7465 7374 4f66 6663  nctions.testOffc
+0000e5c0: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+0000e5d0: 2020 2020 2020 2020 4f46 4643 4841 494e          OFFCHAIN
+0000e5e0: 5f4c 4f4f 4b55 505f 5445 5354 5f44 4154  _LOOKUP_TEST_DAT
+0000e5f0: 410a 2020 2020 2020 2020 292e 6361 6c6c  A.        ).call
+0000e600: 2863 6369 705f 7265 6164 5f65 6e61 626c  (ccip_read_enabl
+0000e610: 6564 3d54 7275 6529 0a20 2020 2020 2020  ed=True).       
+0000e620: 2061 7373 6572 7420 6173 796e 635f 7733   assert async_w3
+0000e630: 2e63 6f64 6563 2e64 6563 6f64 6528 5b22  .codec.decode(["
+0000e640: 7374 7269 6e67 225d 2c20 7265 7370 6f6e  string"], respon
+0000e650: 7365 295b 305d 203d 3d20 2277 6562 3370  se)[0] == "web3p
+0000e660: 7922 0a0a 2020 2020 2020 2020 6173 796e  y"..        asyn
+0000e670: 635f 7733 2e70 726f 7669 6465 722e 676c  c_w3.provider.gl
+0000e680: 6f62 616c 5f63 6369 705f 7265 6164 5f65  obal_ccip_read_e
+0000e690: 6e61 626c 6564 203d 2054 7275 6520 2023  nabled = True  #
+0000e6a0: 2063 6c65 616e 7570 0a0a 2020 2020 4070   cleanup..    @p
+0000e6b0: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+0000e6c0: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
+0000e6d0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+0000e6e0: 226d 6178 5f72 6564 6972 6563 7473 222c  "max_redirects",
+0000e6f0: 2072 616e 6765 282d 312c 2034 2929 0a20   range(-1, 4)). 
+0000e700: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000e710: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
+0000e720: 6169 6e5f 6c6f 6f6b 7570 5f72 6169 7365  ain_lookup_raise
+0000e730: 735f 6966 5f6d 6178 5f72 6564 6972 6563  s_if_max_redirec
+0000e740: 7473 5f69 735f 6c65 7373 5f74 6861 6e5f  ts_is_less_than_
+0000e750: 3428 0a20 2020 2020 2020 2073 656c 662c  4(.        self,
+0000e760: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
+0000e770: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
+0000e780: 2020 2020 2020 2020 6173 796e 635f 6f66          async_of
+0000e790: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
+0000e7a0: 6e74 7261 6374 3a20 2241 7379 6e63 436f  ntract: "AsyncCo
+0000e7b0: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
+0000e7c0: 206d 6178 5f72 6564 6972 6563 7473 3a20   max_redirects: 
+0000e7d0: 696e 742c 0a20 2020 2029 202d 3e20 4e6f  int,.    ) -> No
+0000e7e0: 6e65 3a0a 2020 2020 2020 2020 6465 6661  ne:.        defa
+0000e7f0: 756c 745f 6d61 785f 7265 6469 7265 6374  ult_max_redirect
+0000e800: 7320 3d20 6173 796e 635f 7733 2e70 726f  s = async_w3.pro
+0000e810: 7669 6465 722e 6363 6970 5f72 6561 645f  vider.ccip_read_
+0000e820: 6d61 785f 7265 6469 7265 6374 730a 0a20  max_redirects.. 
+0000e830: 2020 2020 2020 2061 7379 6e63 5f77 332e         async_w3.
+0000e840: 7072 6f76 6964 6572 2e63 6369 705f 7265  provider.ccip_re
+0000e850: 6164 5f6d 6178 5f72 6564 6972 6563 7473  ad_max_redirects
+0000e860: 203d 206d 6178 5f72 6564 6972 6563 7473   = max_redirects
+0000e870: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+0000e880: 7465 7374 2e72 6169 7365 7328 5765 6233  test.raises(Web3
+0000e890: 5661 6c75 6545 7272 6f72 2c20 6d61 7463  ValueError, matc
+0000e8a0: 683d 2261 7420 6c65 6173 7420 3422 293a  h="at least 4"):
+0000e8b0: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
+0000e8c0: 6974 2061 7379 6e63 5f6f 6666 6368 6169  it async_offchai
+0000e8d0: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+0000e8e0: 742e 6361 6c6c 6572 2829 2e74 6573 744f  t.caller().testO
+0000e8f0: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
+0000e900: 2020 2020 2020 2020 2020 2020 2020 204f                 O
+0000e910: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
+0000e920: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
+0000e930: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000e940: 6173 796e 635f 7733 2e70 726f 7669 6465  async_w3.provide
+0000e950: 722e 6363 6970 5f72 6561 645f 6d61 785f  r.ccip_read_max_
+0000e960: 7265 6469 7265 6374 7320 3d20 6465 6661  redirects = defa
+0000e970: 756c 745f 6d61 785f 7265 6469 7265 6374  ult_max_redirect
+0000e980: 7320 2023 2063 6c65 616e 7570 0a0a 2020  s  # cleanup..  
+0000e990: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+0000e9a0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+0000e9b0: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
+0000e9c0: 6c6c 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ll_offchain_look
+0000e9d0: 7570 5f72 6169 7365 735f 666f 725f 696d  up_raises_for_im
+0000e9e0: 7072 6f70 6572 6c79 5f66 6f72 6d61 7474  properly_formatt
+0000e9f0: 6564 5f72 6573 745f 7265 7175 6573 745f  ed_rest_request_
+0000ea00: 7265 7370 6f6e 7365 2820 2023 206e 6f71  response(  # noq
+0000ea10: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
+0000ea20: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+0000ea30: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+0000ea40: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+0000ea50: 6e63 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  nc_offchain_look
+0000ea60: 7570 5f63 6f6e 7472 6163 743a 2022 4173  up_contract: "As
+0000ea70: 796e 6343 6f6e 7472 6163 7422 2c0a 2020  yncContract",.  
+0000ea80: 2020 2020 2020 6173 796e 635f 6b65 7966        async_keyf
+0000ea90: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0000eaa0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+0000eab0: 7265 7373 2c0a 2020 2020 2020 2020 6d6f  ress,.        mo
+0000eac0: 6e6b 6579 7061 7463 683a 2022 4d6f 6e6b  nkeypatch: "Monk
+0000ead0: 6579 5061 7463 6822 2c0a 2020 2020 2920  eyPatch",.    ) 
+0000eae0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000eaf0: 206e 6f72 6d61 6c69 7a65 645f 636f 6e74   normalized_cont
+0000eb00: 7261 6374 5f61 6464 7265 7373 203d 2074  ract_address = t
+0000eb10: 6f5f 6865 785f 6966 5f62 7974 6573 280a  o_hex_if_bytes(.
+0000eb20: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
+0000eb30: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
+0000eb40: 705f 636f 6e74 7261 6374 2e61 6464 7265  p_contract.addre
+0000eb50: 7373 0a20 2020 2020 2020 2029 2e6c 6f77  ss.        ).low
+0000eb60: 6572 2829 0a0a 2020 2020 2020 2020 6173  er()..        as
+0000eb70: 796e 635f 6d6f 636b 5f6f 6666 6368 6169  ync_mock_offchai
+0000eb80: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
+0000eb90: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
+0000eba0: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
+0000ebb0: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
+0000ebc0: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
+0000ebd0: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
+0000ebe0: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
+0000ebf0: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
+0000ec00: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
+0000ec10: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000ec20: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
+0000ec30: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
+0000ec40: 2020 2020 2020 2020 6d6f 636b 6564 5f6a          mocked_j
+0000ec50: 736f 6e5f 6461 7461 3d57 4542 3350 595f  son_data=WEB3PY_
+0000ec60: 4153 5f48 4558 4259 5445 532c 0a20 2020  AS_HEXBYTES,.   
+0000ec70: 2020 2020 2020 2020 206a 736f 6e5f 6461           json_da
+0000ec80: 7461 5f66 6965 6c64 3d22 6e6f 745f 6461  ta_field="not_da
+0000ec90: 7461 222c 0a20 2020 2020 2020 2029 0a20  ta",.        ). 
+0000eca0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0000ecb0: 7374 2e72 6169 7365 7328 5765 6233 5661  st.raises(Web3Va
+0000ecc0: 6c69 6461 7469 6f6e 4572 726f 722c 206d  lidationError, m
+0000ecd0: 6174 6368 3d22 6d69 7373 696e 6720 2764  atch="missing 'd
+0000ece0: 6174 6127 2066 6965 6c64 2229 3a0a 2020  ata' field"):.  
+0000ecf0: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+0000ed00: 6173 796e 635f 6f66 6663 6861 696e 5f6c  async_offchain_l
+0000ed10: 6f6f 6b75 705f 636f 6e74 7261 6374 2e63  ookup_contract.c
+0000ed20: 616c 6c65 7228 292e 7465 7374 4f66 6663  aller().testOffc
+0000ed30: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+0000ed40: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+0000ed50: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000ed60: 5f44 4154 410a 2020 2020 2020 2020 2020  _DATA.          
+0000ed70: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+0000ed80: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000ed90: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+0000eda0: 6172 616d 6574 7269 7a65 2822 7374 6174  arametrize("stat
+0000edb0: 7573 5f63 6f64 655f 6e6f 6e5f 3478 785f  us_code_non_4xx_
+0000edc0: 6572 726f 7222 2c20 5b31 3030 2c20 3330  error", [100, 30
+0000edd0: 302c 2035 3030 2c20 3630 305d 290a 2020  0, 500, 600]).  
+0000ede0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000edf0: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
+0000ee00: 696e 5f6c 6f6f 6b75 705f 7472 6965 735f  in_lookup_tries_
+0000ee10: 6e65 7874 5f75 726c 5f66 6f72 5f6e 6f6e  next_url_for_non
+0000ee20: 5f34 7878 5f65 7272 6f72 5f73 7461 7475  _4xx_error_statu
+0000ee30: 735f 616e 645f 7465 7374 735f 504f 5354  s_and_tests_POST
+0000ee40: 2820 2023 206e 6f71 613a 2045 3530 310a  (  # noqa: E501.
+0000ee50: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000ee60: 2020 2020 2020 6173 796e 635f 7733 3a20        async_w3: 
+0000ee70: 2241 7379 6e63 5765 6233 222c 0a20 2020  "AsyncWeb3",.   
+0000ee80: 2020 2020 2061 7379 6e63 5f6f 6666 6368       async_offch
+0000ee90: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
+0000eea0: 6163 743a 2022 4173 796e 6343 6f6e 7472  act: "AsyncContr
+0000eeb0: 6163 7422 2c0a 2020 2020 2020 2020 6173  act",.        as
+0000eec0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+0000eed0: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
+0000eee0: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
+0000eef0: 2020 2020 2020 6d6f 6e6b 6579 7061 7463        monkeypatc
+0000ef00: 683a 2022 4d6f 6e6b 6579 5061 7463 6822  h: "MonkeyPatch"
+0000ef10: 2c0a 2020 2020 2020 2020 7374 6174 7573  ,.        status
+0000ef20: 5f63 6f64 655f 6e6f 6e5f 3478 785f 6572  _code_non_4xx_er
+0000ef30: 726f 723a 2069 6e74 2c0a 2020 2020 2920  ror: int,.    ) 
+0000ef40: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000ef50: 206e 6f72 6d61 6c69 7a65 645f 636f 6e74   normalized_cont
+0000ef60: 7261 6374 5f61 6464 7265 7373 203d 2074  ract_address = t
+0000ef70: 6f5f 6865 785f 6966 5f62 7974 6573 280a  o_hex_if_bytes(.
+0000ef80: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
+0000ef90: 635f 6f66 6663 6861 696e 5f6c 6f6f 6b75  c_offchain_looku
+0000efa0: 705f 636f 6e74 7261 6374 2e61 6464 7265  p_contract.addre
+0000efb0: 7373 0a20 2020 2020 2020 2029 2e6c 6f77  ss.        ).low
+0000efc0: 6572 2829 0a0a 2020 2020 2020 2020 2320  er()..        # 
+0000efd0: 5468 6520 6e65 7874 2075 726c 2069 6e20  The next url in 
+0000efe0: 6f75 7220 7465 7374 2063 6f6e 7472 6163  our test contrac
+0000eff0: 7420 646f 6573 6e27 7420 636f 6e74 6169  t doesn't contai
+0000f000: 6e20 277b 6461 7461 7d27 2c20 7472 6967  n '{data}', trig
+0000f010: 6765 7269 6e67 0a20 2020 2020 2020 2023  gering.        #
+0000f020: 2074 6865 2050 4f53 5420 7265 7175 6573   the POST reques
+0000f030: 7420 6c6f 6769 632e 2054 6865 2069 6465  t logic. The ide
+0000f040: 6120 6865 7265 2069 7320 746f 2072 6574  a here is to ret
+0000f050: 7572 6e20 6120 6261 6420 7374 6174 7573  urn a bad status
+0000f060: 2066 6f72 2074 6865 0a20 2020 2020 2020   for the.       
+0000f070: 2023 2066 6972 7374 2075 726c 2028 4745   # first url (GE
+0000f080: 5429 2061 6e64 2061 2073 7563 6365 7373  T) and a success
+0000f090: 2073 7461 7475 7320 666f 7220 7468 6520   status for the 
+0000f0a0: 7365 636f 6e64 2063 616c 6c20 2850 4f53  second call (POS
+0000f0b0: 5429 2074 6f20 7465 7374 0a20 2020 2020  T) to test.     
+0000f0c0: 2020 2023 2062 6f74 6820 7468 6174 2077     # both that w
+0000f0d0: 6520 6d6f 7665 206f 6e20 746f 2074 6865  e move on to the
+0000f0e0: 206e 6578 7420 7572 6c20 7769 7468 206e   next url with n
+0000f0f0: 6f6e 2d34 7878 2073 7461 7475 7320 616e  on-4xx status an
+0000f100: 6420 7468 6174 2074 6865 0a20 2020 2020  d that the.     
+0000f110: 2020 2023 2050 4f53 5420 6c6f 6769 6320     # POST logic 
+0000f120: 6973 2061 6c73 6f20 776f 726b 696e 6720  is also working 
+0000f130: 6173 2065 7870 6563 7465 642e 0a20 2020  as expected..   
+0000f140: 2020 2020 2061 7379 6e63 5f6d 6f63 6b5f       async_mock_
+0000f150: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000f160: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
+0000f170: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
+0000f180: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
+0000f190: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
+0000f1a0: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
+0000f1b0: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
+0000f1c0: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
+0000f1d0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+0000f1e0: 7d2f 7b4f 4646 4348 4149 4e5f 4c4f 4f4b  }/{OFFCHAIN_LOOK
+0000f1f0: 5550 5f54 4553 545f 4441 5441 7d2e 6a73  UP_TEST_DATA}.js
+0000f200: 6f6e 222c 2020 2320 6e6f 7161 3a20 4535  on",  # noqa: E5
+0000f210: 3031 0a20 2020 2020 2020 2020 2020 206d  01.            m
+0000f220: 6f63 6b65 645f 7374 6174 7573 5f63 6f64  ocked_status_cod
+0000f230: 653d 7374 6174 7573 5f63 6f64 655f 6e6f  e=status_code_no
+0000f240: 6e5f 3478 785f 6572 726f 722c 0a20 2020  n_4xx_error,.   
+0000f250: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
+0000f260: 6a73 6f6e 5f64 6174 613d 5745 4233 5059  json_data=WEB3PY
+0000f270: 5f41 535f 4845 5842 5954 4553 2c0a 2020  _AS_HEXBYTES,.  
+0000f280: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000f290: 6173 796e 635f 6d6f 636b 5f6f 6666 6368  async_mock_offch
+0000f2a0: 6169 6e5f 6c6f 6f6b 7570 5f72 6571 7565  ain_lookup_reque
+0000f2b0: 7374 5f72 6573 706f 6e73 6528 0a20 2020  st_response(.   
+0000f2c0: 2020 2020 2020 2020 206d 6f6e 6b65 7970           monkeyp
+0000f2d0: 6174 6368 2c0a 2020 2020 2020 2020 2020  atch,.          
+0000f2e0: 2020 6874 7470 5f6d 6574 686f 643d 2250    http_method="P
+0000f2f0: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
+0000f300: 2020 6d6f 636b 6564 5f72 6571 7565 7374    mocked_request
+0000f310: 5f75 726c 3d66 2268 7474 7073 3a2f 2f77  _url=f"https://w
+0000f320: 6562 332e 7079 2f67 6174 6577 6179 2f7b  eb3.py/gateway/{
+0000f330: 6e6f 726d 616c 697a 6564 5f63 6f6e 7472  normalized_contr
+0000f340: 6163 745f 6164 6472 6573 737d 2e6a 736f  act_address}.jso
+0000f350: 6e22 2c20 2023 206e 6f71 613a 2045 3530  n",  # noqa: E50
+0000f360: 310a 2020 2020 2020 2020 2020 2020 6d6f  1.            mo
+0000f370: 636b 6564 5f73 7461 7475 735f 636f 6465  cked_status_code
+0000f380: 3d32 3030 2c0a 2020 2020 2020 2020 2020  =200,.          
+0000f390: 2020 6d6f 636b 6564 5f6a 736f 6e5f 6461    mocked_json_da
+0000f3a0: 7461 3d57 4542 3350 595f 4153 5f48 4558  ta=WEB3PY_AS_HEX
+0000f3b0: 4259 5445 532c 0a20 2020 2020 2020 2020  BYTES,.         
+0000f3c0: 2020 2073 656e 6465 723d 6e6f 726d 616c     sender=normal
+0000f3d0: 697a 6564 5f63 6f6e 7472 6163 745f 6164  ized_contract_ad
+0000f3e0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+0000f3f0: 2020 2063 616c 6c64 6174 613d 4f46 4643     calldata=OFFC
+0000f400: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000f410: 5f44 4154 412c 0a20 2020 2020 2020 2029  _DATA,.        )
+0000f420: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0000f430: 6520 3d20 6177 6169 7420 6173 796e 635f  e = await async_
+0000f440: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000f450: 636f 6e74 7261 6374 2e63 616c 6c65 7228  contract.caller(
+0000f460: 292e 7465 7374 4f66 6663 6861 696e 4c6f  ).testOffchainLo
+0000f470: 6f6b 7570 280a 2020 2020 2020 2020 2020  okup(.          
+0000f480: 2020 4f46 4643 4841 494e 5f4c 4f4f 4b55    OFFCHAIN_LOOKU
+0000f490: 505f 5445 5354 5f44 4154 410a 2020 2020  P_TEST_DATA.    
+0000f4a0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+0000f4b0: 7365 7274 2061 7379 6e63 5f77 332e 636f  sert async_w3.co
+0000f4c0: 6465 632e 6465 636f 6465 285b 2273 7472  dec.decode(["str
+0000f4d0: 696e 6722 5d2c 2072 6573 706f 6e73 6529  ing"], response)
+0000f4e0: 5b30 5d20 3d3d 2022 7765 6233 7079 220a  [0] == "web3py".
+0000f4f0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+0000f500: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+0000f510: 796e 6320 6465 6620 7465 7374 5f65 7468  ync def test_eth
+0000f520: 5f63 616c 6c5f 6f66 6663 6861 696e 5f6c  _call_offchain_l
+0000f530: 6f6f 6b75 705f 6361 6c6c 735f 7261 6973  ookup_calls_rais
+0000f540: 655f 666f 725f 7374 6174 7573 5f66 6f72  e_for_status_for
+0000f550: 5f34 7878 5f73 7461 7475 735f 636f 6465  _4xx_status_code
+0000f560: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000f570: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+0000f580: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+0000f590: 2020 2020 2020 2061 7379 6e63 5f6f 6666         async_off
+0000f5a0: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+0000f5b0: 7472 6163 743a 2022 4173 796e 6343 6f6e  tract: "AsyncCon
+0000f5c0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
+0000f5d0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+0000f5e0: 636f 756e 745f 6164 6472 6573 733a 2043  count_address: C
+0000f5f0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+0000f600: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+0000f610: 7463 683a 2022 4d6f 6e6b 6579 5061 7463  tch: "MonkeyPatc
+0000f620: 6822 2c0a 2020 2020 2920 2d3e 204e 6f6e  h",.    ) -> Non
+0000f630: 653a 0a20 2020 2020 2020 206e 6f72 6d61  e:.        norma
+0000f640: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
+0000f650: 6464 7265 7373 203d 2074 6f5f 6865 785f  ddress = to_hex_
+0000f660: 6966 5f62 7974 6573 280a 2020 2020 2020  if_bytes(.      
+0000f670: 2020 2020 2020 6173 796e 635f 6f66 6663        async_offc
+0000f680: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+0000f690: 7261 6374 2e61 6464 7265 7373 0a20 2020  ract.address.   
+0000f6a0: 2020 2020 2029 2e6c 6f77 6572 2829 0a0a       ).lower()..
+0000f6b0: 2020 2020 2020 2020 6173 796e 635f 6d6f          async_mo
+0000f6c0: 636b 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ck_offchain_look
+0000f6d0: 7570 5f72 6571 7565 7374 5f72 6573 706f  up_request_respo
+0000f6e0: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
+0000f6f0: 206d 6f6e 6b65 7970 6174 6368 2c0a 2020   monkeypatch,.  
+0000f700: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
+0000f710: 5f72 6571 7565 7374 5f75 726c 3d66 2268  _request_url=f"h
+0000f720: 7474 7073 3a2f 2f77 6562 332e 7079 2f67  ttps://web3.py/g
+0000f730: 6174 6577 6179 2f7b 6e6f 726d 616c 697a  ateway/{normaliz
+0000f740: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
+0000f750: 6573 737d 2f7b 4f46 4643 4841 494e 5f4c  ess}/{OFFCHAIN_L
+0000f760: 4f4f 4b55 505f 5445 5354 5f44 4154 417d  OOKUP_TEST_DATA}
+0000f770: 2e6a 736f 6e22 2c20 2023 206e 6f71 613a  .json",  # noqa:
+0000f780: 2045 3530 310a 2020 2020 2020 2020 2020   E501.          
+0000f790: 2020 6d6f 636b 6564 5f73 7461 7475 735f    mocked_status_
+0000f7a0: 636f 6465 3d72 616e 6469 6e74 2834 3030  code=randint(400
+0000f7b0: 2c20 3439 3929 2c0a 2020 2020 2020 2020  , 499),.        
+0000f7c0: 2020 2020 6d6f 636b 6564 5f6a 736f 6e5f      mocked_json_
+0000f7d0: 6461 7461 3d57 4542 3350 595f 4153 5f48  data=WEB3PY_AS_H
+0000f7e0: 4558 4259 5445 532c 0a20 2020 2020 2020  EXBYTES,.       
+0000f7f0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0000f800: 7079 7465 7374 2e72 6169 7365 7328 4578  pytest.raises(Ex
+0000f810: 6365 7074 696f 6e2c 206d 6174 6368 3d22  ception, match="
+0000f820: 6361 6c6c 6564 2072 6169 7365 5f66 6f72  called raise_for
+0000f830: 5f73 7461 7475 735c 5c28 5c5c 2922 293a  _status\\(\\)"):
+0000f840: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
+0000f850: 6974 2061 7379 6e63 5f6f 6666 6368 6169  it async_offchai
+0000f860: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+0000f870: 742e 6361 6c6c 6572 2829 2e74 6573 744f  t.caller().testO
+0000f880: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
+0000f890: 2020 2020 2020 2020 2020 2020 2020 204f                 O
+0000f8a0: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
+0000f8b0: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
+0000f8c0: 2020 2020 2029 0a0a 2020 2020 4070 7974       )..    @pyt
+0000f8d0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+0000f8e0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+0000f8f0: 6573 745f 6574 685f 6361 6c6c 5f6f 6666  est_eth_call_off
+0000f900: 6368 6169 6e5f 6c6f 6f6b 7570 5f72 6169  chain_lookup_rai
+0000f910: 7365 735f 7768 656e 5f61 6c6c 5f73 7570  ses_when_all_sup
+0000f920: 706c 6965 645f 7572 6c73 5f66 6169 6c28  plied_urls_fail(
+0000f930: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000f940: 2020 2020 2020 2061 7379 6e63 5f6f 6666         async_off
+0000f950: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+0000f960: 7472 6163 743a 2022 4173 796e 6343 6f6e  tract: "AsyncCon
+0000f970: 7472 6163 7422 2c0a 2020 2020 2920 2d3e  tract",.    ) ->
+0000f980: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+0000f990: 2047 4554 2061 6e64 2050 4f53 5420 7265   GET and POST re
+0000f9a0: 7175 6573 7473 2073 686f 756c 6420 6661  quests should fa
+0000f9b0: 696c 2073 696e 6365 2072 6573 706f 6e73  il since respons
+0000f9c0: 6573 2061 7265 206e 6f74 206d 6f63 6b65  es are not mocke
+0000f9d0: 640a 2020 2020 2020 2020 7769 7468 2070  d.        with p
+0000f9e0: 7974 6573 742e 7261 6973 6573 280a 2020  ytest.raises(.  
+0000f9f0: 2020 2020 2020 2020 2020 4d75 6c74 6970            Multip
+0000fa00: 6c65 4661 696c 6564 5265 7175 6573 7473  leFailedRequests
+0000fa10: 2c20 6d61 7463 683d 224f 6666 6368 6169  , match="Offchai
+0000fa20: 6e20 6c6f 6f6b 7570 2066 6169 6c65 6420  n lookup failed 
+0000fa30: 666f 7220 7375 7070 6c69 6564 2075 726c  for supplied url
+0000fa40: 7322 0a20 2020 2020 2020 2029 3a0a 2020  s".        ):.  
+0000fa50: 2020 2020 2020 2020 2020 6177 6169 7420            await 
+0000fa60: 6173 796e 635f 6f66 6663 6861 696e 5f6c  async_offchain_l
+0000fa70: 6f6f 6b75 705f 636f 6e74 7261 6374 2e63  ookup_contract.c
+0000fa80: 616c 6c65 7228 292e 7465 7374 4f66 6663  aller().testOffc
+0000fa90: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+0000faa0: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+0000fab0: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+0000fac0: 5f44 4154 410a 2020 2020 2020 2020 2020  _DATA.          
+0000fad0: 2020 290a 0a20 2020 2040 7079 7465 7374    )..    @pytest
+0000fae0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+0000faf0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+0000fb00: 5f65 7468 5f63 616c 6c5f 636f 6e74 696e  _eth_call_contin
+0000fb10: 756f 7573 5f6f 6666 6368 6169 6e5f 6c6f  uous_offchain_lo
+0000fb20: 6f6b 7570 5f72 6169 7365 735f 7769 7468  okup_raises_with
+0000fb30: 5f74 6f6f 5f6d 616e 795f 7265 7175 6573  _too_many_reques
+0000fb40: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+0000fb50: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+0000fb60: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+0000fb70: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
+0000fb80: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
+0000fb90: 2020 206d 6f6e 6b65 7970 6174 6368 3a20     monkeypatch: 
+0000fba0: 224d 6f6e 6b65 7950 6174 6368 222c 0a20  "MonkeyPatch",. 
+0000fbb0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0000fbc0: 2020 2020 2020 6e6f 726d 616c 697a 6564        normalized
+0000fbd0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
+0000fbe0: 7320 3d20 746f 5f68 6578 5f69 665f 6279  s = to_hex_if_by
+0000fbf0: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
+0000fc00: 2061 7379 6e63 5f6f 6666 6368 6169 6e5f   async_offchain_
+0000fc10: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
+0000fc20: 6164 6472 6573 730a 2020 2020 2020 2020  address.        
+0000fc30: 292e 6c6f 7765 7228 290a 0a20 2020 2020  ).lower()..     
+0000fc40: 2020 2061 7379 6e63 5f6d 6f63 6b5f 6f66     async_mock_of
+0000fc50: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
+0000fc60: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
+0000fc70: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
+0000fc80: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
+0000fc90: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
+0000fca0: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
+0000fcb0: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
+0000fcc0: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
+0000fcd0: 6e74 7261 6374 5f61 6464 7265 7373 7d2f  ntract_address}/
+0000fce0: 3078 2e6a 736f 6e22 2c20 2023 206e 6f71  0x.json",  # noq
+0000fcf0: 613a 2045 3530 310a 2020 2020 2020 2020  a: E501.        
+0000fd00: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+0000fd10: 7974 6573 742e 7261 6973 6573 2854 6f6f  ytest.raises(Too
+0000fd20: 4d61 6e79 5265 7175 6573 7473 2c20 6d61  ManyRequests, ma
+0000fd30: 7463 683d 2254 6f6f 206d 616e 7920 4343  tch="Too many CC
+0000fd40: 4950 2072 6561 6420 7265 6469 7265 6374  IP read redirect
+0000fd50: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
+0000fd60: 2061 7761 6974 2061 7379 6e63 5f6f 6666   await async_off
+0000fd70: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+0000fd80: 7472 6163 742e 6361 6c6c 6572 2829 2e63  tract.caller().c
+0000fd90: 6f6e 7469 6e75 6f75 734f 6666 6368 6169  ontinuousOffchai
+0000fda0: 6e4c 6f6f 6b75 7028 2920 2023 206e 6f71  nLookup()  # noq
+0000fdb0: 613a 2045 3530 3120 7479 7065 3a20 6967  a: E501 type: ig
+0000fdc0: 6e6f 7265 0a0a 2020 2020 4070 7974 6573  nore..    @pytes
+0000fdd0: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+0000fde0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+0000fdf0: 745f 6173 796e 635f 6574 685f 6861 7368  t_async_eth_hash
+0000fe00: 7261 7465 2873 656c 662c 2061 7379 6e63  rate(self, async
+0000fe10: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+0000fe20: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000fe30: 2020 2068 6173 6872 6174 6520 3d20 6177     hashrate = aw
+0000fe40: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+0000fe50: 2e68 6173 6872 6174 650a 2020 2020 2020  .hashrate.      
+0000fe60: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+0000fe70: 6765 7228 6861 7368 7261 7465 290a 2020  ger(hashrate).  
+0000fe80: 2020 2020 2020 6173 7365 7274 2068 6173        assert has
+0000fe90: 6872 6174 6520 3e3d 2030 0a0a 2020 2020  hrate >= 0..    
+0000fea0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+0000feb0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+0000fec0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+0000fed0: 685f 6368 6169 6e5f 6964 2873 656c 662c  h_chain_id(self,
+0000fee0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+0000fef0: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+0000ff00: 0a20 2020 2020 2020 2063 6861 696e 5f69  .        chain_i
+0000ff10: 6420 3d20 6177 6169 7420 6173 796e 635f  d = await async_
+0000ff20: 7733 2e65 7468 2e63 6861 696e 5f69 640a  w3.eth.chain_id.
+0000ff30: 2020 2020 2020 2020 2320 6368 6169 6e20          # chain 
+0000ff40: 6964 2076 616c 7565 2066 726f 6d20 6765  id value from ge
+0000ff50: 7468 2066 6978 7475 7265 2067 656e 6573  th fixture genes
+0000ff60: 6973 2066 696c 650a 2020 2020 2020 2020  is file.        
+0000ff70: 6173 7365 7274 2063 6861 696e 5f69 6420  assert chain_id 
+0000ff80: 3d3d 2031 3331 3237 3733 3232 3934 3035  == 1312773229405
+0000ff90: 3337 0a0a 2020 2020 4070 7974 6573 742e  37..    @pytest.
+0000ffa0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+0000ffb0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+0000ffc0: 6173 796e 635f 6574 685f 6d69 6e69 6e67  async_eth_mining
+0000ffd0: 2873 656c 662c 2061 7379 6e63 5f77 333a  (self, async_w3:
+0000ffe0: 2022 4173 796e 6357 6562 3322 2920 2d3e   "AsyncWeb3") ->
+0000fff0: 204e 6f6e 653a 0a20 2020 2020 2020 206d   None:.        m
+00010000: 696e 696e 6720 3d20 6177 6169 7420 6173  ining = await as
+00010010: 796e 635f 7733 2e65 7468 2e6d 696e 696e  ync_w3.eth.minin
+00010020: 670a 2020 2020 2020 2020 6173 7365 7274  g.        assert
+00010030: 2069 735f 626f 6f6c 6561 6e28 6d69 6e69   is_boolean(mini
+00010040: 6e67 290a 0a20 2020 2040 7079 7465 7374  ng)..    @pytest
+00010050: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00010060: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00010070: 5f61 7379 6e63 5f65 7468 5f67 6574 5f74  _async_eth_get_t
+00010080: 7261 6e73 6163 7469 6f6e 5f72 6563 6569  ransaction_recei
+00010090: 7074 5f6d 696e 6564 280a 2020 2020 2020  pt_mined(.      
+000100a0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000100b0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+000100c0: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+000100d0: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+000100e0: 7478 6e3a 2042 6c6f 636b 4461 7461 2c0a  txn: BlockData,.
+000100f0: 2020 2020 2020 2020 6d69 6e65 645f 7478          mined_tx
+00010100: 6e5f 6861 7368 3a20 4865 7853 7472 2c0a  n_hash: HexStr,.
+00010110: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00010120: 2020 2020 2020 2072 6563 6569 7074 203d         receipt =
+00010130: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00010140: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+00010150: 696f 6e5f 7265 6365 6970 7428 6d69 6e65  ion_receipt(mine
+00010160: 645f 7478 6e5f 6861 7368 290a 2020 2020  d_txn_hash).    
+00010170: 2020 2020 6173 7365 7274 2069 735f 6469      assert is_di
+00010180: 6374 2872 6563 6569 7074 290a 2020 2020  ct(receipt).    
+00010190: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+000101a0: 7074 5b22 626c 6f63 6b4e 756d 6265 7222  pt["blockNumber"
+000101b0: 5d20 3d3d 2061 7379 6e63 5f62 6c6f 636b  ] == async_block
+000101c0: 5f77 6974 685f 7478 6e5b 226e 756d 6265  _with_txn["numbe
+000101d0: 7222 5d0a 2020 2020 2020 2020 6173 7365  r"].        asse
+000101e0: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
+000101f0: 6b48 6173 6822 5d20 3d3d 2061 7379 6e63  kHash"] == async
+00010200: 5f62 6c6f 636b 5f77 6974 685f 7478 6e5b  _block_with_txn[
+00010210: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
+00010220: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
+00010230: 7472 616e 7361 6374 696f 6e49 6e64 6578  transactionIndex
+00010240: 225d 203d 3d20 300a 2020 2020 2020 2020  "] == 0.        
+00010250: 6173 7365 7274 2072 6563 6569 7074 5b22  assert receipt["
+00010260: 7472 616e 7361 6374 696f 6e48 6173 6822  transactionHash"
+00010270: 5d20 3d3d 2048 6578 4279 7465 7328 6d69  ] == HexBytes(mi
+00010280: 6e65 645f 7478 6e5f 6861 7368 290a 2020  ned_txn_hash).  
+00010290: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+000102a0: 6368 6563 6b73 756d 5f61 6464 7265 7373  checksum_address
+000102b0: 2872 6563 6569 7074 5b22 746f 225d 290a  (receipt["to"]).
+000102c0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+000102d0: 6563 6569 7074 5b22 6672 6f6d 225d 2069  eceipt["from"] i
+000102e0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+000102f0: 2020 2061 7373 6572 7420 6973 5f63 6865     assert is_che
+00010300: 636b 7375 6d5f 6164 6472 6573 7328 7265  cksum_address(re
+00010310: 6365 6970 745b 2266 726f 6d22 5d29 0a0a  ceipt["from"])..
+00010320: 2020 2020 2020 2020 6566 6665 6374 6976          effectiv
+00010330: 655f 6761 735f 7072 6963 6520 3d20 7265  e_gas_price = re
+00010340: 6365 6970 745b 2265 6666 6563 7469 7665  ceipt["effective
+00010350: 4761 7350 7269 6365 225d 0a20 2020 2020  GasPrice"].     
+00010360: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+00010370: 616e 6365 2865 6666 6563 7469 7665 5f67  ance(effective_g
+00010380: 6173 5f70 7269 6365 2c20 696e 7429 0a20  as_price, int). 
+00010390: 2020 2020 2020 2061 7373 6572 7420 6566         assert ef
+000103a0: 6665 6374 6976 655f 6761 735f 7072 6963  fective_gas_pric
+000103b0: 6520 3e20 300a 0a20 2020 2040 7079 7465  e > 0..    @pyte
+000103c0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+000103d0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+000103e0: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
+000103f0: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
+00010400: 6569 7074 5f75 6e6d 696e 6564 280a 2020  eipt_unmined(.  
+00010410: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00010420: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+00010430: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+00010440: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
+00010450: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00010460: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00010470: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+00010480: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00010490: 2020 2020 7478 6e5f 6861 7368 203d 2061      txn_hash = a
+000104a0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000104b0: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
+000104c0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+000104d0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000104e0: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
+000104f0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00010500: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00010510: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00010520: 2020 2022 746f 223a 2061 7379 6e63 5f6b     "to": async_k
+00010530: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00010540: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00010550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010560: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00010570: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00010580: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
+00010590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000105a0: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
+000105b0: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+000105c0: 2833 2c20 2267 7765 6922 292c 0a20 2020  (3, "gwei"),.   
+000105d0: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
+000105e0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+000105f0: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
+00010600: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00010610: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+00010620: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00010630: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00010640: 7365 7328 5472 616e 7361 6374 696f 6e4e  ses(TransactionN
+00010650: 6f74 466f 756e 6429 3a0a 2020 2020 2020  otFound):.      
+00010660: 2020 2020 2020 6177 6169 7420 6173 796e        await asyn
+00010670: 635f 7733 2e65 7468 2e67 6574 5f74 7261  c_w3.eth.get_tra
+00010680: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
+00010690: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
+000106a0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
+000106b0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
+000106c0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+000106d0: 685f 6765 745f 7472 616e 7361 6374 696f  h_get_transactio
+000106e0: 6e5f 7265 6365 6970 745f 7769 7468 5f6c  n_receipt_with_l
+000106f0: 6f67 5f65 6e74 7279 280a 2020 2020 2020  og_entry(.      
+00010700: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00010710: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00010720: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+00010730: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+00010740: 7478 6e5f 7769 7468 5f6c 6f67 3a20 426c  txn_with_log: Bl
+00010750: 6f63 6b44 6174 612c 0a20 2020 2020 2020  ockData,.       
+00010760: 2061 7379 6e63 5f65 6d69 7474 6572 5f63   async_emitter_c
+00010770: 6f6e 7472 6163 743a 2022 4173 796e 6343  ontract: "AsyncC
+00010780: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+00010790: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
+000107a0: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
+000107b0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000107c0: 2020 2020 7265 6365 6970 7420 3d20 6177      receipt = aw
+000107d0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+000107e0: 2e77 6169 745f 666f 725f 7472 616e 7361  .wait_for_transa
+000107f0: 6374 696f 6e5f 7265 6365 6970 7428 7478  ction_receipt(tx
+00010800: 6e5f 6861 7368 5f77 6974 685f 6c6f 6729  n_hash_with_log)
+00010810: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00010820: 6973 5f64 6963 7428 7265 6365 6970 7429  is_dict(receipt)
+00010830: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00010840: 7265 6365 6970 745b 2262 6c6f 636b 4e75  receipt["blockNu
+00010850: 6d62 6572 225d 203d 3d20 6173 796e 635f  mber"] == async_
+00010860: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
+00010870: 6974 685f 6c6f 675b 226e 756d 6265 7222  ith_log["number"
+00010880: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00010890: 2072 6563 6569 7074 5b22 626c 6f63 6b48   receipt["blockH
+000108a0: 6173 6822 5d20 3d3d 2061 7379 6e63 5f62  ash"] == async_b
+000108b0: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+000108c0: 7468 5f6c 6f67 5b22 6861 7368 225d 0a20  th_log["hash"]. 
+000108d0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+000108e0: 6365 6970 745b 2274 7261 6e73 6163 7469  ceipt["transacti
+000108f0: 6f6e 496e 6465 7822 5d20 3d3d 2030 0a20  onIndex"] == 0. 
+00010900: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00010910: 6365 6970 745b 2274 7261 6e73 6163 7469  ceipt["transacti
+00010920: 6f6e 4861 7368 225d 203d 3d20 4865 7842  onHash"] == HexB
+00010930: 7974 6573 2874 786e 5f68 6173 685f 7769  ytes(txn_hash_wi
+00010940: 7468 5f6c 6f67 290a 0a20 2020 2020 2020  th_log)..       
+00010950: 2061 7373 6572 7420 6c65 6e28 7265 6365   assert len(rece
+00010960: 6970 745b 226c 6f67 7322 5d29 203d 3d20  ipt["logs"]) == 
+00010970: 310a 2020 2020 2020 2020 6c6f 675f 656e  1.        log_en
+00010980: 7472 7920 3d20 7265 6365 6970 745b 226c  try = receipt["l
+00010990: 6f67 7322 5d5b 305d 0a0a 2020 2020 2020  ogs"][0]..      
+000109a0: 2020 6173 7365 7274 206c 6f67 5f65 6e74    assert log_ent
+000109b0: 7279 5b22 626c 6f63 6b4e 756d 6265 7222  ry["blockNumber"
+000109c0: 5d20 3d3d 2061 7379 6e63 5f62 6c6f 636b  ] == async_block
+000109d0: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
+000109e0: 6f67 5b22 6e75 6d62 6572 225d 0a20 2020  og["number"].   
+000109f0: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
+00010a00: 656e 7472 795b 2262 6c6f 636b 4861 7368  entry["blockHash
+00010a10: 225d 203d 3d20 6173 796e 635f 626c 6f63  "] == async_bloc
+00010a20: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+00010a30: 6c6f 675b 2268 6173 6822 5d0a 2020 2020  log["hash"].    
+00010a40: 2020 2020 6173 7365 7274 206c 6f67 5f65      assert log_e
+00010a50: 6e74 7279 5b22 6c6f 6749 6e64 6578 225d  ntry["logIndex"]
+00010a60: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
+00010a70: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00010a80: 7265 7373 286c 6f67 5f65 6e74 7279 5b22  ress(log_entry["
+00010a90: 6164 6472 6573 7322 5d2c 2061 7379 6e63  address"], async
+00010aa0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
+00010ab0: 742e 6164 6472 6573 7329 0a20 2020 2020  t.address).     
+00010ac0: 2020 2061 7373 6572 7420 6c6f 675f 656e     assert log_en
+00010ad0: 7472 795b 2274 7261 6e73 6163 7469 6f6e  try["transaction
+00010ae0: 496e 6465 7822 5d20 3d3d 2030 0a20 2020  Index"] == 0.   
+00010af0: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
+00010b00: 656e 7472 795b 2274 7261 6e73 6163 7469  entry["transacti
+00010b10: 6f6e 4861 7368 225d 203d 3d20 4865 7842  onHash"] == HexB
+00010b20: 7974 6573 2874 786e 5f68 6173 685f 7769  ytes(txn_hash_wi
+00010b30: 7468 5f6c 6f67 290a 0a20 2020 2040 7079  th_log)..    @py
+00010b40: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00010b50: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+00010b60: 7465 7374 5f61 7379 6e63 5f65 7468 5f77  test_async_eth_w
+00010b70: 6169 745f 666f 725f 7472 616e 7361 6374  ait_for_transact
+00010b80: 696f 6e5f 7265 6365 6970 745f 6d69 6e65  ion_receipt_mine
+00010b90: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
+00010ba0: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
+00010bb0: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
+00010bc0: 2020 2020 2020 2020 6173 796e 635f 626c          async_bl
+00010bd0: 6f63 6b5f 7769 7468 5f74 786e 3a20 426c  ock_with_txn: Bl
+00010be0: 6f63 6b44 6174 612c 0a20 2020 2020 2020  ockData,.       
+00010bf0: 206d 696e 6564 5f74 786e 5f68 6173 683a   mined_txn_hash:
+00010c00: 2048 6578 5374 722c 0a20 2020 2029 202d   HexStr,.    ) -
+00010c10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00010c20: 7265 6365 6970 7420 3d20 6177 6169 7420  receipt = await 
+00010c30: 6173 796e 635f 7733 2e65 7468 2e77 6169  async_w3.eth.wai
+00010c40: 745f 666f 725f 7472 616e 7361 6374 696f  t_for_transactio
+00010c50: 6e5f 7265 6365 6970 7428 6d69 6e65 645f  n_receipt(mined_
+00010c60: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
+00010c70: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
+00010c80: 2872 6563 6569 7074 290a 2020 2020 2020  (receipt).      
+00010c90: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+00010ca0: 5b22 626c 6f63 6b4e 756d 6265 7222 5d20  ["blockNumber"] 
+00010cb0: 3d3d 2061 7379 6e63 5f62 6c6f 636b 5f77  == async_block_w
+00010cc0: 6974 685f 7478 6e5b 226e 756d 6265 7222  ith_txn["number"
+00010cd0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00010ce0: 2072 6563 6569 7074 5b22 626c 6f63 6b48   receipt["blockH
+00010cf0: 6173 6822 5d20 3d3d 2061 7379 6e63 5f62  ash"] == async_b
+00010d00: 6c6f 636b 5f77 6974 685f 7478 6e5b 2268  lock_with_txn["h
+00010d10: 6173 6822 5d0a 2020 2020 2020 2020 6173  ash"].        as
+00010d20: 7365 7274 2072 6563 6569 7074 5b22 7472  sert receipt["tr
+00010d30: 616e 7361 6374 696f 6e49 6e64 6578 225d  ansactionIndex"]
+00010d40: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
+00010d50: 7365 7274 2072 6563 6569 7074 5b22 7472  sert receipt["tr
+00010d60: 616e 7361 6374 696f 6e48 6173 6822 5d20  ansactionHash"] 
+00010d70: 3d3d 2048 6578 4279 7465 7328 6d69 6e65  == HexBytes(mine
+00010d80: 645f 7478 6e5f 6861 7368 290a 2020 2020  d_txn_hash).    
+00010d90: 2020 2020 6173 7365 7274 2069 735f 6368      assert is_ch
+00010da0: 6563 6b73 756d 5f61 6464 7265 7373 2872  ecksum_address(r
+00010db0: 6563 6569 7074 5b22 746f 225d 290a 2020  eceipt["to"]).  
+00010dc0: 2020 2020 2020 6173 7365 7274 2072 6563        assert rec
+00010dd0: 6569 7074 5b22 6672 6f6d 225d 2069 7320  eipt["from"] is 
+00010de0: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+00010df0: 2061 7373 6572 7420 6973 5f63 6865 636b   assert is_check
+00010e00: 7375 6d5f 6164 6472 6573 7328 7265 6365  sum_address(rece
+00010e10: 6970 745b 2266 726f 6d22 5d29 0a0a 2020  ipt["from"])..  
+00010e20: 2020 2020 2020 6566 6665 6374 6976 655f        effective_
+00010e30: 6761 735f 7072 6963 6520 3d20 7265 6365  gas_price = rece
+00010e40: 6970 745b 2265 6666 6563 7469 7665 4761  ipt["effectiveGa
+00010e50: 7350 7269 6365 225d 0a20 2020 2020 2020  sPrice"].       
+00010e60: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+00010e70: 6365 2865 6666 6563 7469 7665 5f67 6173  ce(effective_gas
+00010e80: 5f70 7269 6365 2c20 696e 7429 0a20 2020  _price, int).   
+00010e90: 2020 2020 2061 7373 6572 7420 6566 6665       assert effe
+00010ea0: 6374 6976 655f 6761 735f 7072 6963 6520  ctive_gas_price 
+00010eb0: 3e20 300a 0a20 2020 2040 7079 7465 7374  > 0..    @pytest
+00010ec0: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00010ed0: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
+00010ee0: 5f61 7379 6e63 5f65 7468 5f77 6169 745f  _async_eth_wait_
+00010ef0: 666f 725f 7472 616e 7361 6374 696f 6e5f  for_transaction_
+00010f00: 7265 6365 6970 745f 756e 6d69 6e65 6428  receipt_unmined(
+00010f10: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00010f20: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+00010f30: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+00010f40: 2020 2020 2020 6173 796e 635f 6b65 7966        async_keyf
+00010f50: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00010f60: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
+00010f70: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+00010f80: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00010f90: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
+00010fa0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00010fb0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+00010fc0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00010fd0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00010fe0: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+00010ff0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00011000: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00011010: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00011020: 2020 2020 2020 2274 6f22 3a20 6173 796e        "to": asyn
+00011030: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
+00011040: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+00011050: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00011060: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00011070: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00011080: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+00011090: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+000110a0: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+000110b0: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+000110c0: 7765 6928 332c 2022 6777 6569 2229 2c0a  wei(3, "gwei"),.
+000110d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110e0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+000110f0: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
+00011100: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
+00011110: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00011120: 7d0a 2020 2020 2020 2020 290a 0a20 2020  }.        )..   
+00011130: 2020 2020 2074 696d 656f 7574 203d 2030       timeout = 0
+00011140: 2e30 310a 2020 2020 2020 2020 7769 7468  .01.        with
+00011150: 2070 7974 6573 742e 7261 6973 6573 2854   pytest.raises(T
+00011160: 696d 6545 7868 6175 7374 6564 2920 6173  imeExhausted) as
+00011170: 2065 7863 5f69 6e66 6f3a 0a20 2020 2020   exc_info:.     
+00011180: 2020 2020 2020 2061 7761 6974 2061 7379         await asy
+00011190: 6e63 5f77 332e 6574 682e 7761 6974 5f66  nc_w3.eth.wait_f
+000111a0: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
+000111b0: 6563 6569 7074 2874 786e 5f68 6173 682c  eceipt(txn_hash,
+000111c0: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
+000111d0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+000111e0: 7420 285f 2069 6e20 7374 7228 6578 635f  t (_ in str(exc_
+000111f0: 696e 666f 2920 666f 7220 5f20 696e 205b  info) for _ in [
+00011200: 7265 7072 2874 786e 5f68 6173 6829 2c20  repr(txn_hash), 
+00011210: 7469 6d65 6f75 745d 290a 0a20 2020 2040  timeout])..    @
+00011220: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00011230: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00011240: 6620 7465 7374 5f61 7379 6e63 5f65 7468  f test_async_eth
+00011250: 5f77 6169 745f 666f 725f 7472 616e 7361  _wait_for_transa
+00011260: 6374 696f 6e5f 7265 6365 6970 745f 7769  ction_receipt_wi
+00011270: 7468 5f6c 6f67 5f65 6e74 7279 280a 2020  th_log_entry(.  
+00011280: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00011290: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+000112a0: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+000112b0: 2020 2061 7379 6e63 5f62 6c6f 636b 5f77     async_block_w
+000112c0: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+000112d0: 3a20 426c 6f63 6b44 6174 612c 0a20 2020  : BlockData,.   
+000112e0: 2020 2020 2061 7379 6e63 5f65 6d69 7474       async_emitt
+000112f0: 6572 5f63 6f6e 7472 6163 743a 2022 4173  er_contract: "As
+00011300: 796e 6343 6f6e 7472 6163 7422 2c0a 2020  yncContract",.  
+00011310: 2020 2020 2020 7478 6e5f 6861 7368 5f77        txn_hash_w
+00011320: 6974 685f 6c6f 673a 2048 6578 5374 722c  ith_log: HexStr,
+00011330: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00011340: 2020 2020 2020 2020 7265 6365 6970 7420          receipt 
+00011350: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00011360: 2e65 7468 2e77 6169 745f 666f 725f 7472  .eth.wait_for_tr
+00011370: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+00011380: 7428 7478 6e5f 6861 7368 5f77 6974 685f  t(txn_hash_with_
+00011390: 6c6f 6729 0a20 2020 2020 2020 2061 7373  log).        ass
+000113a0: 6572 7420 6973 5f64 6963 7428 7265 6365  ert is_dict(rece
+000113b0: 6970 7429 0a20 2020 2020 2020 2061 7373  ipt).        ass
+000113c0: 6572 7420 7265 6365 6970 745b 2262 6c6f  ert receipt["blo
+000113d0: 636b 4e75 6d62 6572 225d 203d 3d20 6173  ckNumber"] == as
+000113e0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
+000113f0: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
+00011400: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
+00011410: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
+00011420: 6f63 6b48 6173 6822 5d20 3d3d 2061 7379  ockHash"] == asy
+00011430: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+00011440: 6e5f 7769 7468 5f6c 6f67 5b22 6861 7368  n_with_log["hash
+00011450: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+00011460: 7420 7265 6365 6970 745b 2274 7261 6e73  t receipt["trans
+00011470: 6163 7469 6f6e 496e 6465 7822 5d20 3d3d  actionIndex"] ==
+00011480: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+00011490: 7420 7265 6365 6970 745b 2274 7261 6e73  t receipt["trans
+000114a0: 6163 7469 6f6e 4861 7368 225d 203d 3d20  actionHash"] == 
+000114b0: 4865 7842 7974 6573 2874 786e 5f68 6173  HexBytes(txn_has
+000114c0: 685f 7769 7468 5f6c 6f67 290a 0a20 2020  h_with_log)..   
+000114d0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000114e0: 7265 6365 6970 745b 226c 6f67 7322 5d29  receipt["logs"])
+000114f0: 203d 3d20 310a 2020 2020 2020 2020 6c6f   == 1.        lo
+00011500: 675f 656e 7472 7920 3d20 7265 6365 6970  g_entry = receip
+00011510: 745b 226c 6f67 7322 5d5b 305d 0a0a 2020  t["logs"][0]..  
+00011520: 2020 2020 2020 6173 7365 7274 206c 6f67        assert log
+00011530: 5f65 6e74 7279 5b22 626c 6f63 6b4e 756d  _entry["blockNum
+00011540: 6265 7222 5d20 3d3d 2061 7379 6e63 5f62  ber"] == async_b
+00011550: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00011560: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+00011570: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011580: 6c6f 675f 656e 7472 795b 2262 6c6f 636b  log_entry["block
+00011590: 4861 7368 225d 203d 3d20 6173 796e 635f  Hash"] == async_
+000115a0: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
+000115b0: 6974 685f 6c6f 675b 2268 6173 6822 5d0a  ith_log["hash"].
+000115c0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000115d0: 6f67 5f65 6e74 7279 5b22 6c6f 6749 6e64  og_entry["logInd
+000115e0: 6578 225d 203d 3d20 300a 2020 2020 2020  ex"] == 0.      
+000115f0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00011600: 5f61 6464 7265 7373 286c 6f67 5f65 6e74  _address(log_ent
+00011610: 7279 5b22 6164 6472 6573 7322 5d2c 2061  ry["address"], a
+00011620: 7379 6e63 5f65 6d69 7474 6572 5f63 6f6e  sync_emitter_con
+00011630: 7472 6163 742e 6164 6472 6573 7329 0a20  tract.address). 
+00011640: 2020 2020 2020 2061 7373 6572 7420 6c6f         assert lo
+00011650: 675f 656e 7472 795b 2274 7261 6e73 6163  g_entry["transac
+00011660: 7469 6f6e 496e 6465 7822 5d20 3d3d 2030  tionIndex"] == 0
+00011670: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011680: 6c6f 675f 656e 7472 795b 2274 7261 6e73  log_entry["trans
+00011690: 6163 7469 6f6e 4861 7368 225d 203d 3d20  actionHash"] == 
+000116a0: 4865 7842 7974 6573 2874 786e 5f68 6173  HexBytes(txn_has
+000116b0: 685f 7769 7468 5f6c 6f67 290a 0a20 2020  h_with_log)..   
+000116c0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+000116d0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+000116e0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+000116f0: 7468 5f61 6363 6f75 6e74 7328 7365 6c66  th_accounts(self
+00011700: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
+00011710: 6e63 5765 6233 2229 202d 3e20 4e6f 6e65  ncWeb3") -> None
+00011720: 3a0a 2020 2020 2020 2020 6163 636f 756e  :.        accoun
+00011730: 7473 203d 2061 7761 6974 2061 7379 6e63  ts = await async
+00011740: 5f77 332e 6574 682e 6163 636f 756e 7473  _w3.eth.accounts
+00011750: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011760: 6973 5f6c 6973 745f 6c69 6b65 2861 6363  is_list_like(acc
+00011770: 6f75 6e74 7329 0a20 2020 2020 2020 2061  ounts).        a
+00011780: 7373 6572 7420 6c65 6e28 6163 636f 756e  ssert len(accoun
+00011790: 7473 2920 213d 2030 0a20 2020 2020 2020  ts) != 0.       
+000117a0: 2061 7373 6572 7420 616c 6c28 6973 5f63   assert all(is_c
+000117b0: 6865 636b 7375 6d5f 6164 6472 6573 7328  hecksum_address(
+000117c0: 6163 636f 756e 7429 2066 6f72 2061 6363  account) for acc
+000117d0: 6f75 6e74 2069 6e20 6163 636f 756e 7473  ount in accounts
+000117e0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+000117f0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00011800: 6574 682e 636f 696e 6261 7365 2069 6e20  eth.coinbase in 
+00011810: 6163 636f 756e 7473 0a0a 2020 2020 4070  accounts..    @p
+00011820: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
+00011830: 696f 0a20 2020 2061 7379 6e63 2064 6566  io.    async def
+00011840: 2074 6573 745f 6173 796e 635f 6574 685f   test_async_eth_
+00011850: 6765 745f 6c6f 6773 5f77 6974 686f 7574  get_logs_without
+00011860: 5f6c 6f67 7328 0a20 2020 2020 2020 2073  _logs(.        s
+00011870: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
+00011880: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
+00011890: 635f 626c 6f63 6b5f 7769 7468 5f74 786e  c_block_with_txn
+000118a0: 5f77 6974 685f 6c6f 673a 2042 6c6f 636b  _with_log: Block
+000118b0: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
+000118c0: 6e65 3a0a 2020 2020 2020 2020 2320 5465  ne:.        # Te
+000118d0: 7374 2077 6974 6820 626c 6f63 6b20 7261  st with block ra
+000118e0: 6e67 650a 0a20 2020 2020 2020 2066 696c  nge..        fil
+000118f0: 7465 725f 7061 7261 6d73 3a20 4669 6c74  ter_params: Filt
+00011900: 6572 5061 7261 6d73 203d 207b 0a20 2020  erParams = {.   
+00011910: 2020 2020 2020 2020 2022 6672 6f6d 426c           "fromBl
+00011920: 6f63 6b22 3a20 426c 6f63 6b4e 756d 6265  ock": BlockNumbe
+00011930: 7228 3029 2c0a 2020 2020 2020 2020 2020  r(0),.          
+00011940: 2020 2274 6f42 6c6f 636b 223a 2042 6c6f    "toBlock": Blo
+00011950: 636b 4e75 6d62 6572 2861 7379 6e63 5f62  ckNumber(async_b
+00011960: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00011970: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+00011980: 202d 2031 292c 0a20 2020 2020 2020 207d   - 1),.        }
+00011990: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+000119a0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+000119b0: 2e65 7468 2e67 6574 5f6c 6f67 7328 6669  .eth.get_logs(fi
+000119c0: 6c74 6572 5f70 6172 616d 7329 0a20 2020  lter_params).   
+000119d0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000119e0: 7265 7375 6c74 2920 3d3d 2030 0a0a 2020  result) == 0..  
+000119f0: 2020 2020 2020 2320 7468 6520 7261 6e67        # the rang
+00011a00: 6520 6973 2077 726f 6e67 0a20 2020 2020  e is wrong.     
+00011a10: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
+00011a20: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00011a30: 2022 6672 6f6d 426c 6f63 6b22 3a20 6173   "fromBlock": as
+00011a40: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
+00011a50: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
+00011a60: 6265 7222 5d2c 0a20 2020 2020 2020 2020  ber"],.         
+00011a70: 2020 2022 746f 426c 6f63 6b22 3a20 426c     "toBlock": Bl
+00011a80: 6f63 6b4e 756d 6265 7228 6173 796e 635f  ockNumber(async_
+00011a90: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
+00011aa0: 6974 685f 6c6f 675b 226e 756d 6265 7222  ith_log["number"
+00011ab0: 5d20 2d20 3129 2c0a 2020 2020 2020 2020  ] - 1),.        
+00011ac0: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+00011ad0: 7974 6573 742e 7261 6973 6573 2857 6562  ytest.raises(Web
+00011ae0: 3352 5043 4572 726f 7229 3a0a 2020 2020  3RPCError):.    
+00011af0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00011b00: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00011b10: 6574 682e 6765 745f 6c6f 6773 2866 696c  eth.get_logs(fil
+00011b20: 7465 725f 7061 7261 6d73 290a 0a20 2020  ter_params)..   
+00011b30: 2020 2020 2023 2054 6573 7420 7769 7468       # Test with
+00011b40: 2060 6164 6472 6573 7360 0a0a 2020 2020   `address`..    
+00011b50: 2020 2020 2320 6669 6c74 6572 2077 6974      # filter wit
+00011b60: 6820 6f74 6865 7220 6164 6472 6573 730a  h other address.
+00011b70: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
+00011b80: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00011b90: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
+00011ba0: 223a 2042 6c6f 636b 4e75 6d62 6572 2830  ": BlockNumber(0
+00011bb0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00011bc0: 6164 6472 6573 7322 3a20 554e 4b4e 4f57  address": UNKNOW
+00011bd0: 4e5f 4144 4452 4553 532c 0a20 2020 2020  N_ADDRESS,.     
+00011be0: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
+00011bf0: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
+00011c00: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
+00011c10: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
+00011c20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011c30: 6c65 6e28 7265 7375 6c74 2920 3d3d 2030  len(result) == 0
+00011c40: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+00011c50: 2077 6974 6820 6d75 6c74 6970 6c65 2060   with multiple `
+00011c60: 6164 6472 6573 7360 0a0a 2020 2020 2020  address`..      
+00011c70: 2020 2320 6669 6c74 6572 2077 6974 6820    # filter with 
+00011c80: 6f74 6865 7220 6164 6472 6573 730a 2020  other address.  
+00011c90: 2020 2020 2020 6669 6c74 6572 5f70 6172        filter_par
+00011ca0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00011cb0: 2020 2020 2266 726f 6d42 6c6f 636b 223a      "fromBlock":
+00011cc0: 2042 6c6f 636b 4e75 6d62 6572 2830 292c   BlockNumber(0),
+00011cd0: 0a20 2020 2020 2020 2020 2020 2022 6164  .            "ad
+00011ce0: 6472 6573 7322 3a20 5b55 4e4b 4e4f 574e  dress": [UNKNOWN
+00011cf0: 5f41 4444 5245 5353 2c20 554e 4b4e 4f57  _ADDRESS, UNKNOW
+00011d00: 4e5f 4144 4452 4553 535d 2c0a 2020 2020  N_ADDRESS],.    
+00011d10: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
+00011d20: 7375 6c74 203d 2061 7761 6974 2061 7379  sult = await asy
+00011d30: 6e63 5f77 332e 6574 682e 6765 745f 6c6f  nc_w3.eth.get_lo
+00011d40: 6773 2866 696c 7465 725f 7061 7261 6d73  gs(filter_params
+00011d50: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00011d60: 206c 656e 2872 6573 756c 7429 203d 3d20   len(result) == 
+00011d70: 300a 0a20 2020 2040 7079 7465 7374 2e6d  0..    @pytest.m
+00011d80: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+00011d90: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
+00011da0: 7379 6e63 5f65 7468 5f67 6574 5f6c 6f67  sync_eth_get_log
+00011db0: 735f 7769 7468 5f6c 6f67 7328 0a20 2020  s_with_logs(.   
+00011dc0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00011dd0: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+00011de0: 796e 6357 6562 3322 2c0a 2020 2020 2020  yncWeb3",.      
+00011df0: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
+00011e00: 7468 5f74 786e 5f77 6974 685f 6c6f 673a  th_txn_with_log:
+00011e10: 2042 6c6f 636b 4461 7461 2c0a 2020 2020   BlockData,.    
+00011e20: 2020 2020 6173 796e 635f 656d 6974 7465      async_emitte
+00011e30: 725f 636f 6e74 7261 6374 5f61 6464 7265  r_contract_addre
+00011e40: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
+00011e50: 6573 732c 0a20 2020 2020 2020 2074 786e  ess,.        txn
+00011e60: 5f68 6173 685f 7769 7468 5f6c 6f67 3a20  _hash_with_log: 
+00011e70: 4865 7853 7472 2c0a 2020 2020 2920 2d3e  HexStr,.    ) ->
+00011e80: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+00011e90: 2054 6573 7420 7769 7468 2062 6c6f 636b   Test with block
+00011ea0: 2072 616e 6765 0a0a 2020 2020 2020 2020   range..        
+00011eb0: 2320 7468 6520 7261 6e67 6520 696e 636c  # the range incl
+00011ec0: 7564 6573 2074 6865 2062 6c6f 636b 2077  udes the block w
+00011ed0: 6865 7265 2074 6865 206c 6f67 2072 6573  here the log res
+00011ee0: 6964 6573 2069 6e0a 2020 2020 2020 2020  ides in.        
+00011ef0: 6669 6c74 6572 5f70 6172 616d 733a 2046  filter_params: F
+00011f00: 696c 7465 7250 6172 616d 7320 3d20 7b0a  ilterParams = {.
+00011f10: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00011f20: 6d42 6c6f 636b 223a 2061 7379 6e63 5f62  mBlock": async_b
+00011f30: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00011f40: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+00011f50: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00011f60: 6f42 6c6f 636b 223a 2061 7379 6e63 5f62  oBlock": async_b
+00011f70: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+00011f80: 7468 5f6c 6f67 5b22 6e75 6d62 6572 225d  th_log["number"]
+00011f90: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00011fa0: 2020 2020 7265 7375 6c74 203d 2061 7761      result = awa
+00011fb0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00011fc0: 6765 745f 6c6f 6773 2866 696c 7465 725f  get_logs(filter_
+00011fd0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00011fe0: 6173 7365 7274 5f63 6f6e 7461 696e 735f  assert_contains_
+00011ff0: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
+00012000: 2072 6573 756c 742c 0a20 2020 2020 2020   result,.       
+00012010: 2020 2020 2061 7379 6e63 5f62 6c6f 636b       async_block
+00012020: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
+00012030: 6f67 2c0a 2020 2020 2020 2020 2020 2020  og,.            
+00012040: 6173 796e 635f 656d 6974 7465 725f 636f  async_emitter_co
+00012050: 6e74 7261 6374 5f61 6464 7265 7373 2c0a  ntract_address,.
+00012060: 2020 2020 2020 2020 2020 2020 7478 6e5f              txn_
+00012070: 6861 7368 5f77 6974 685f 6c6f 672c 0a20  hash_with_log,. 
+00012080: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00012090: 2020 2320 7370 6563 6966 7920 6f6e 6c79    # specify only
+000120a0: 2060 6672 6f6d 5f62 6c6f 636b 602e 2062   `from_block`. b
+000120b0: 7920 6465 6661 756c 7420 6074 6f5f 626c  y default `to_bl
+000120c0: 6f63 6b60 2073 686f 756c 6420 6265 2027  ock` should be '
+000120d0: 6c61 7465 7374 270a 2020 2020 2020 2020  latest'.        
+000120e0: 6669 6c74 6572 5f70 6172 616d 7320 3d20  filter_params = 
+000120f0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+00012100: 726f 6d42 6c6f 636b 223a 2042 6c6f 636b  romBlock": Block
+00012110: 4e75 6d62 6572 2830 292c 0a20 2020 2020  Number(0),.     
+00012120: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
+00012130: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
+00012140: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
+00012150: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
+00012160: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
+00012170: 636f 6e74 6169 6e73 5f6c 6f67 280a 2020  contains_log(.  
+00012180: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012190: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
+000121a0: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
+000121b0: 786e 5f77 6974 685f 6c6f 672c 0a20 2020  xn_with_log,.   
+000121c0: 2020 2020 2020 2020 2061 7379 6e63 5f65           async_e
+000121d0: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
+000121e0: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+000121f0: 2020 2020 2074 786e 5f68 6173 685f 7769       txn_hash_wi
+00012200: 7468 5f6c 6f67 2c0a 2020 2020 2020 2020  th_log,.        
+00012210: 290a 0a20 2020 2020 2020 2023 2054 6573  )..        # Tes
+00012220: 7420 7769 7468 2060 6164 6472 6573 7360  t with `address`
+00012230: 0a0a 2020 2020 2020 2020 2320 6669 6c74  ..        # filt
+00012240: 6572 2077 6974 6820 656d 6974 7465 725f  er with emitter_
+00012250: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+00012260: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
+00012270: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+00012280: 2020 2020 2020 2022 6672 6f6d 426c 6f63         "fromBloc
+00012290: 6b22 3a20 426c 6f63 6b4e 756d 6265 7228  k": BlockNumber(
+000122a0: 3029 2c0a 2020 2020 2020 2020 2020 2020  0),.            
+000122b0: 2261 6464 7265 7373 223a 2061 7379 6e63  "address": async
+000122c0: 5f65 6d69 7474 6572 5f63 6f6e 7472 6163  _emitter_contrac
+000122d0: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+000122e0: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
+000122f0: 756c 7420 3d20 6177 6169 7420 6173 796e  ult = await asyn
+00012300: 635f 7733 2e65 7468 2e67 6574 5f6c 6f67  c_w3.eth.get_log
+00012310: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
+00012320: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
+00012330: 636f 6e74 6169 6e73 5f6c 6f67 280a 2020  contains_log(.  
+00012340: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012350: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
+00012360: 796e 635f 626c 6f63 6b5f 7769 7468 5f74  ync_block_with_t
+00012370: 786e 5f77 6974 685f 6c6f 672c 0a20 2020  xn_with_log,.   
+00012380: 2020 2020 2020 2020 2061 7379 6e63 5f65           async_e
+00012390: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
+000123a0: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+000123b0: 2020 2020 2074 786e 5f68 6173 685f 7769       txn_hash_wi
+000123c0: 7468 5f6c 6f67 2c0a 2020 2020 2020 2020  th_log,.        
+000123d0: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
+000123e0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+000123f0: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
+00012400: 7379 6e63 5f65 7468 5f67 6574 5f6c 6f67  sync_eth_get_log
+00012410: 735f 7769 7468 5f6c 6f67 735f 746f 7069  s_with_logs_topi
+00012420: 635f 6172 6773 280a 2020 2020 2020 2020  c_args(.        
+00012430: 7365 6c66 2c0a 2020 2020 2020 2020 6173  self,.        as
+00012440: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
+00012450: 6233 222c 0a20 2020 2020 2020 2061 7379  b3",.        asy
+00012460: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+00012470: 6e5f 7769 7468 5f6c 6f67 3a20 426c 6f63  n_with_log: Bloc
+00012480: 6b44 6174 612c 0a20 2020 2020 2020 2061  kData,.        a
+00012490: 7379 6e63 5f65 6d69 7474 6572 5f63 6f6e  sync_emitter_con
+000124a0: 7472 6163 745f 6164 6472 6573 733a 2043  tract_address: C
+000124b0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+000124c0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+000124d0: 5f77 6974 685f 6c6f 673a 2048 6578 5374  _with_log: HexSt
+000124e0: 722c 0a20 2020 2029 202d 3e20 4e6f 6e65  r,.    ) -> None
+000124f0: 3a0a 2020 2020 2020 2020 2320 5465 7374  :.        # Test
+00012500: 2077 6974 6820 4e6f 6e65 2065 7665 6e74   with None event
+00012510: 2073 6967 0a0a 2020 2020 2020 2020 6669   sig..        fi
+00012520: 6c74 6572 5f70 6172 616d 733a 2046 696c  lter_params: Fil
+00012530: 7465 7250 6172 616d 7320 3d20 7b0a 2020  terParams = {.  
+00012540: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
+00012550: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
+00012560: 6572 2830 292c 0a20 2020 2020 2020 2020  er(0),.         
+00012570: 2020 2022 746f 7069 6373 223a 205b 0a20     "topics": [. 
+00012580: 2020 2020 2020 2020 2020 2020 2020 204e                 N
+00012590: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+000125a0: 2020 2020 2048 6578 5374 7228 0a20 2020       HexStr(.   
+000125b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125c0: 2022 3078 3030 3030 3030 3030 3030 3030   "0x000000000000
 000125d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000125e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000125f0: 3030 3030 3064 3433 3122 0a20 2020 2020  00000d431".     
-00012600: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00012610: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00012620: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-00012630: 7265 7375 6c74 203d 2061 7761 6974 2061  result = await a
-00012640: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00012650: 6c6f 6773 2866 696c 7465 725f 7061 7261  logs(filter_para
-00012660: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
-00012670: 7274 5f63 6f6e 7461 696e 735f 6c6f 6728  rt_contains_log(
-00012680: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00012690: 756c 742c 0a20 2020 2020 2020 2020 2020  ult,.           
-000126a0: 2061 7379 6e63 5f62 6c6f 636b 5f77 6974   async_block_wit
-000126b0: 685f 7478 6e5f 7769 7468 5f6c 6f67 2c0a  h_txn_with_log,.
-000126c0: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
-000126d0: 635f 656d 6974 7465 725f 636f 6e74 7261  c_emitter_contra
-000126e0: 6374 5f61 6464 7265 7373 2c0a 2020 2020  ct_address,.    
-000126f0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-00012700: 5f77 6974 685f 6c6f 672c 0a20 2020 2020  _with_log,.     
-00012710: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00012720: 5465 7374 2077 6974 6820 4e6f 6e65 2069  Test with None i
-00012730: 6e64 6578 6564 2061 7267 0a20 2020 2020  ndexed arg.     
-00012740: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
-00012750: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00012760: 2022 6672 6f6d 426c 6f63 6b22 3a20 426c   "fromBlock": Bl
-00012770: 6f63 6b4e 756d 6265 7228 3029 2c0a 2020  ockNumber(0),.  
-00012780: 2020 2020 2020 2020 2020 2274 6f70 6963            "topic
-00012790: 7322 3a20 5b0a 2020 2020 2020 2020 2020  s": [.          
-000127a0: 2020 2020 2020 4865 7853 7472 280a 2020        HexStr(.  
-000127b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127c0: 2020 2230 7830 3537 6263 3332 3832 3666    "0x057bc32826f
-000127d0: 6265 3136 3164 6131 6331 3130 6166 6364  be161da1c110afcd
-000127e0: 6361 6537 6331 3039 6138 6236 3931 3439  cae7c109a8b69149
-000127f0: 6637 3237 6663 3337 6136 3033 6336 3065  f727fc37a603c60e
-00012800: 6639 3463 6122 0a20 2020 2020 2020 2020  f94ca".         
-00012810: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00012820: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00012830: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-00012840: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00012850: 2072 6573 756c 7420 3d20 6177 6169 7420   result = await 
-00012860: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00012870: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
-00012880: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
-00012890: 6572 745f 636f 6e74 6169 6e73 5f6c 6f67  ert_contains_log
-000128a0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-000128b0: 7375 6c74 2c0a 2020 2020 2020 2020 2020  sult,.          
-000128c0: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
-000128d0: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
-000128e0: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
-000128f0: 6e63 5f65 6d69 7474 6572 5f63 6f6e 7472  nc_emitter_contr
-00012900: 6163 745f 6164 6472 6573 732c 0a20 2020  act_address,.   
-00012910: 2020 2020 2020 2020 2074 786e 5f68 6173           txn_has
-00012920: 685f 7769 7468 5f6c 6f67 2c0a 2020 2020  h_with_log,.    
-00012930: 2020 2020 290a 0a20 2020 2040 7079 7465      )..    @pyte
-00012940: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00012950: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00012960: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
-00012970: 5f6c 6f67 735f 7769 7468 5f6c 6f67 735f  _logs_with_logs_
-00012980: 6e6f 6e65 5f74 6f70 6963 5f61 7267 7328  none_topic_args(
-00012990: 0a20 2020 2020 2020 2073 656c 662c 2061  .        self, a
-000129a0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-000129b0: 6562 3322 0a20 2020 2029 202d 3e20 4e6f  eb3".    ) -> No
-000129c0: 6e65 3a0a 2020 2020 2020 2020 2320 5465  ne:.        # Te
-000129d0: 7374 2077 6974 6820 4e6f 6e65 206f 7665  st with None ove
-000129e0: 7266 6c6f 7769 6e67 0a20 2020 2020 2020  rflowing.       
-000129f0: 2066 696c 7465 725f 7061 7261 6d73 3a20   filter_params: 
-00012a00: 4669 6c74 6572 5061 7261 6d73 203d 207b  FilterParams = {
-00012a10: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00012a20: 6f6d 426c 6f63 6b22 3a20 426c 6f63 6b4e  omBlock": BlockN
-00012a30: 756d 6265 7228 3029 2c0a 2020 2020 2020  umber(0),.      
-00012a40: 2020 2020 2020 2274 6f70 6963 7322 3a20        "topics": 
-00012a50: 5b4e 6f6e 652c 204e 6f6e 652c 204e 6f6e  [None, None, Non
-00012a60: 655d 2c0a 2020 2020 2020 2020 7d0a 0a20  e],.        }.. 
-00012a70: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00012a80: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-00012a90: 7468 2e67 6574 5f6c 6f67 7328 6669 6c74  th.get_logs(filt
-00012aa0: 6572 5f70 6172 616d 7329 0a20 2020 2020  er_params).     
-00012ab0: 2020 2061 7373 6572 7420 6c65 6e28 7265     assert len(re
-00012ac0: 7375 6c74 2920 3d3d 2030 0a0a 2020 2020  sult) == 0..    
-00012ad0: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00012ae0: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00012af0: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-00012b00: 685f 7379 6e63 696e 6728 7365 6c66 2c20  h_syncing(self, 
-00012b10: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00012b20: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-00012b30: 2020 2020 2020 2020 7379 6e63 696e 6720          syncing 
-00012b40: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00012b50: 2e65 7468 2e73 796e 6369 6e67 0a0a 2020  .eth.syncing..  
-00012b60: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00012b70: 626f 6f6c 6561 6e28 7379 6e63 696e 6729  boolean(syncing)
-00012b80: 206f 7220 6973 5f64 6963 7428 7379 6e63   or is_dict(sync
-00012b90: 696e 6729 0a0a 2020 2020 2020 2020 6966  ing)..        if
-00012ba0: 2069 735f 626f 6f6c 6561 6e28 7379 6e63   is_boolean(sync
-00012bb0: 696e 6729 3a0a 2020 2020 2020 2020 2020  ing):.          
-00012bc0: 2020 6173 7365 7274 2073 796e 6369 6e67    assert syncing
-00012bd0: 2069 7320 4661 6c73 650a 2020 2020 2020   is False.      
-00012be0: 2020 656c 6966 2069 735f 6469 6374 2873    elif is_dict(s
-00012bf0: 796e 6369 6e67 293a 0a20 2020 2020 2020  yncing):.       
-00012c00: 2020 2020 2073 796e 635f 6469 6374 203d       sync_dict =
-00012c10: 2063 6173 7428 5379 6e63 5374 6174 7573   cast(SyncStatus
-00012c20: 2c20 7379 6e63 696e 6729 0a20 2020 2020  , syncing).     
-00012c30: 2020 2020 2020 2061 7373 6572 7420 2273         assert "s
-00012c40: 7461 7274 696e 6742 6c6f 636b 2220 696e  tartingBlock" in
-00012c50: 2073 796e 635f 6469 6374 0a20 2020 2020   sync_dict.     
-00012c60: 2020 2020 2020 2061 7373 6572 7420 2263         assert "c
-00012c70: 7572 7265 6e74 426c 6f63 6b22 2069 6e20  urrentBlock" in 
-00012c80: 7379 6e63 5f64 6963 740a 2020 2020 2020  sync_dict.      
-00012c90: 2020 2020 2020 6173 7365 7274 2022 6869        assert "hi
-00012ca0: 6768 6573 7442 6c6f 636b 2220 696e 2073  ghestBlock" in s
-00012cb0: 796e 635f 6469 6374 0a0a 2020 2020 2020  ync_dict..      
-00012cc0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00012cd0: 696e 7465 6765 7228 7379 6e63 5f64 6963  integer(sync_dic
-00012ce0: 745b 2273 7461 7274 696e 6742 6c6f 636b  t["startingBlock
-00012cf0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00012d00: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00012d10: 7228 7379 6e63 5f64 6963 745b 2263 7572  r(sync_dict["cur
-00012d20: 7265 6e74 426c 6f63 6b22 5d29 0a20 2020  rentBlock"]).   
-00012d30: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00012d40: 6973 5f69 6e74 6567 6572 2873 796e 635f  is_integer(sync_
-00012d50: 6469 6374 5b22 6869 6768 6573 7442 6c6f  dict["highestBlo
-00012d60: 636b 225d 290a 0a20 2020 2040 7079 7465  ck"])..    @pyte
-00012d70: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00012d80: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00012d90: 7374 5f61 7379 6e63 5f65 7468 5f67 6574  st_async_eth_get
-00012da0: 5f73 746f 7261 6765 5f61 7428 0a20 2020  _storage_at(.   
-00012db0: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00012dc0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00012dd0: 2c20 6173 796e 635f 7374 6f72 6167 655f  , async_storage_
-00012de0: 636f 6e74 7261 6374 3a20 2241 7379 6e63  contract: "Async
-00012df0: 436f 6e74 7261 6374 220a 2020 2020 2920  Contract".    ) 
-00012e00: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00012e10: 2061 7379 6e63 5f73 746f 7261 6765 5f63   async_storage_c
-00012e20: 6f6e 7472 6163 745f 6164 6472 6573 7320  ontract_address 
-00012e30: 3d20 6173 796e 635f 7374 6f72 6167 655f  = async_storage_
-00012e40: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-00012e50: 0a0a 2020 2020 2020 2020 736c 6f74 5f30  ..        slot_0
-00012e60: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00012e70: 332e 6574 682e 6765 745f 7374 6f72 6167  3.eth.get_storag
-00012e80: 655f 6174 2861 7379 6e63 5f73 746f 7261  e_at(async_stora
-00012e90: 6765 5f63 6f6e 7472 6163 745f 6164 6472  ge_contract_addr
-00012ea0: 6573 732c 2030 290a 2020 2020 2020 2020  ess, 0).        
-00012eb0: 6173 7365 7274 2073 6c6f 745f 3020 3d3d  assert slot_0 ==
-00012ec0: 2048 6578 4279 7465 7328 6622 3078 7b27   HexBytes(f"0x{'
-00012ed0: 3030 2720 2a20 3332 7d22 290a 0a20 2020  00' * 32}")..   
-00012ee0: 2020 2020 2073 6c6f 745f 3120 3d20 6177       slot_1 = aw
-00012ef0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00012f00: 2e67 6574 5f73 746f 7261 6765 5f61 7428  .get_storage_at(
-00012f10: 6173 796e 635f 7374 6f72 6167 655f 636f  async_storage_co
-00012f20: 6e74 7261 6374 5f61 6464 7265 7373 2c20  ntract_address, 
-00012f30: 3129 0a20 2020 2020 2020 2061 7373 6572  1).        asser
-00012f40: 7420 736c 6f74 5f31 203d 3d20 4865 7842  t slot_1 == HexB
-00012f50: 7974 6573 2866 2230 787b 2730 3027 202a  ytes(f"0x{'00' *
-00012f60: 2033 317d 3031 2229 0a0a 2020 2020 2020   31}01")..      
-00012f70: 2020 736c 6f74 5f32 203d 2061 7761 6974    slot_2 = await
-00012f80: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00012f90: 745f 7374 6f72 6167 655f 6174 2861 7379  t_storage_at(asy
-00012fa0: 6e63 5f73 746f 7261 6765 5f63 6f6e 7472  nc_storage_contr
-00012fb0: 6163 745f 6164 6472 6573 732c 2032 290a  act_address, 2).
-00012fc0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-00012fd0: 6c6f 745f 3220 3d3d 2048 6578 4279 7465  lot_2 == HexByte
-00012fe0: 7328 6622 3078 7b27 3030 2720 2a20 3331  s(f"0x{'00' * 31
-00012ff0: 7d30 3222 290a 0a20 2020 2020 2020 2073  }02")..        s
-00013000: 6c6f 745f 3320 3d20 6177 6169 7420 6173  lot_3 = await as
-00013010: 796e 635f 7733 2e65 7468 2e67 6574 5f73  ync_w3.eth.get_s
-00013020: 746f 7261 6765 5f61 7428 6173 796e 635f  torage_at(async_
-00013030: 7374 6f72 6167 655f 636f 6e74 7261 6374  storage_contract
-00013040: 5f61 6464 7265 7373 2c20 3329 0a20 2020  _address, 3).   
-00013050: 2020 2020 2061 7373 6572 7420 736c 6f74       assert slot
-00013060: 5f33 203d 3d20 4865 7842 7974 6573 280a  _3 == HexBytes(.
-00013070: 2020 2020 2020 2020 2020 2020 2230 7837              "0x7
-00013080: 3436 3837 3236 3536 3530 3030 3030 3030  4687265650000000
-00013090: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+000125f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00012600: 6434 3331 220a 2020 2020 2020 2020 2020  d431".          
+00012610: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00012620: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00012630: 7d0a 0a20 2020 2020 2020 2072 6573 756c  }..        resul
+00012640: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
+00012650: 7733 2e65 7468 2e67 6574 5f6c 6f67 7328  w3.eth.get_logs(
+00012660: 6669 6c74 6572 5f70 6172 616d 7329 0a20  filter_params). 
+00012670: 2020 2020 2020 2061 7373 6572 745f 636f         assert_co
+00012680: 6e74 6169 6e73 5f6c 6f67 280a 2020 2020  ntains_log(.    
+00012690: 2020 2020 2020 2020 7265 7375 6c74 2c0a          result,.
+000126a0: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
+000126b0: 635f 626c 6f63 6b5f 7769 7468 5f74 786e  c_block_with_txn
+000126c0: 5f77 6974 685f 6c6f 672c 0a20 2020 2020  _with_log,.     
+000126d0: 2020 2020 2020 2061 7379 6e63 5f65 6d69         async_emi
+000126e0: 7474 6572 5f63 6f6e 7472 6163 745f 6164  tter_contract_ad
+000126f0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+00012700: 2020 2074 786e 5f68 6173 685f 7769 7468     txn_hash_with
+00012710: 5f6c 6f67 2c0a 2020 2020 2020 2020 290a  _log,.        ).
+00012720: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+00012730: 7769 7468 204e 6f6e 6520 696e 6465 7865  with None indexe
+00012740: 6420 6172 670a 2020 2020 2020 2020 6669  d arg.        fi
+00012750: 6c74 6572 5f70 6172 616d 7320 3d20 7b0a  lter_params = {.
+00012760: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00012770: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
+00012780: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
+00012790: 2020 2020 2022 746f 7069 6373 223a 205b       "topics": [
+000127a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000127b0: 2048 6578 5374 7228 0a20 2020 2020 2020   HexStr(.       
+000127c0: 2020 2020 2020 2020 2020 2020 2022 3078               "0x
+000127d0: 3035 3762 6333 3238 3236 6662 6531 3631  057bc32826fbe161
+000127e0: 6461 3163 3131 3061 6663 6463 6165 3763  da1c110afcdcae7c
+000127f0: 3130 3961 3862 3639 3134 3966 3732 3766  109a8b69149f727f
+00012800: 6333 3761 3630 3363 3630 6566 3934 6361  c37a603c60ef94ca
+00012810: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00012820: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00012830: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
+00012840: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00012850: 2020 7d0a 2020 2020 2020 2020 7265 7375    }.        resu
+00012860: 6c74 203d 2061 7761 6974 2061 7379 6e63  lt = await async
+00012870: 5f77 332e 6574 682e 6765 745f 6c6f 6773  _w3.eth.get_logs
+00012880: 2866 696c 7465 725f 7061 7261 6d73 290a  (filter_params).
+00012890: 2020 2020 2020 2020 6173 7365 7274 5f63          assert_c
+000128a0: 6f6e 7461 696e 735f 6c6f 6728 0a20 2020  ontains_log(.   
+000128b0: 2020 2020 2020 2020 2072 6573 756c 742c           result,
+000128c0: 0a20 2020 2020 2020 2020 2020 2061 7379  .            asy
+000128d0: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
+000128e0: 6e5f 7769 7468 5f6c 6f67 2c0a 2020 2020  n_with_log,.    
+000128f0: 2020 2020 2020 2020 6173 796e 635f 656d          async_em
+00012900: 6974 7465 725f 636f 6e74 7261 6374 5f61  itter_contract_a
+00012910: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00012920: 2020 2020 7478 6e5f 6861 7368 5f77 6974      txn_hash_wit
+00012930: 685f 6c6f 672c 0a20 2020 2020 2020 2029  h_log,.        )
+00012940: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00012950: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00012960: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
+00012970: 796e 635f 6574 685f 6765 745f 6c6f 6773  ync_eth_get_logs
+00012980: 5f77 6974 685f 6c6f 6773 5f6e 6f6e 655f  _with_logs_none_
+00012990: 746f 7069 635f 6172 6773 280a 2020 2020  topic_args(.    
+000129a0: 2020 2020 7365 6c66 2c20 6173 796e 635f      self, async_
+000129b0: 7733 3a20 2241 7379 6e63 5765 6233 220a  w3: "AsyncWeb3".
+000129c0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+000129d0: 2020 2020 2020 2023 2054 6573 7420 7769         # Test wi
+000129e0: 7468 204e 6f6e 6520 6f76 6572 666c 6f77  th None overflow
+000129f0: 696e 670a 2020 2020 2020 2020 6669 6c74  ing.        filt
+00012a00: 6572 5f70 6172 616d 733a 2046 696c 7465  er_params: Filte
+00012a10: 7250 6172 616d 7320 3d20 7b0a 2020 2020  rParams = {.    
+00012a20: 2020 2020 2020 2020 2266 726f 6d42 6c6f          "fromBlo
+00012a30: 636b 223a 2042 6c6f 636b 4e75 6d62 6572  ck": BlockNumber
+00012a40: 2830 292c 0a20 2020 2020 2020 2020 2020  (0),.           
+00012a50: 2022 746f 7069 6373 223a 205b 4e6f 6e65   "topics": [None
+00012a60: 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c 0a20  , None, None],. 
+00012a70: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+00012a80: 2020 7265 7375 6c74 203d 2061 7761 6974    result = await
+00012a90: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
+00012aa0: 745f 6c6f 6773 2866 696c 7465 725f 7061  t_logs(filter_pa
+00012ab0: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
+00012ac0: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
+00012ad0: 203d 3d20 300a 0a20 2020 2040 7079 7465   == 0..    @pyte
+00012ae0: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+00012af0: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00012b00: 7374 5f61 7379 6e63 5f65 7468 5f73 796e  st_async_eth_syn
+00012b10: 6369 6e67 2873 656c 662c 2061 7379 6e63  cing(self, async
+00012b20: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00012b30: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00012b40: 2020 2073 796e 6369 6e67 203d 2061 7761     syncing = awa
+00012b50: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00012b60: 7379 6e63 696e 670a 0a20 2020 2020 2020  syncing..       
+00012b70: 2061 7373 6572 7420 6973 5f62 6f6f 6c65   assert is_boole
+00012b80: 616e 2873 796e 6369 6e67 2920 6f72 2069  an(syncing) or i
+00012b90: 735f 6469 6374 2873 796e 6369 6e67 290a  s_dict(syncing).
+00012ba0: 0a20 2020 2020 2020 2069 6620 6973 5f62  .        if is_b
+00012bb0: 6f6f 6c65 616e 2873 796e 6369 6e67 293a  oolean(syncing):
+00012bc0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00012bd0: 6572 7420 7379 6e63 696e 6720 6973 2046  ert syncing is F
+00012be0: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
+00012bf0: 6620 6973 5f64 6963 7428 7379 6e63 696e  f is_dict(syncin
+00012c00: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
+00012c10: 7379 6e63 5f64 6963 7420 3d20 6361 7374  sync_dict = cast
+00012c20: 2853 796e 6353 7461 7475 732c 2073 796e  (SyncStatus, syn
+00012c30: 6369 6e67 290a 2020 2020 2020 2020 2020  cing).          
+00012c40: 2020 6173 7365 7274 2022 7374 6172 7469    assert "starti
+00012c50: 6e67 426c 6f63 6b22 2069 6e20 7379 6e63  ngBlock" in sync
+00012c60: 5f64 6963 740a 2020 2020 2020 2020 2020  _dict.          
+00012c70: 2020 6173 7365 7274 2022 6375 7272 656e    assert "curren
+00012c80: 7442 6c6f 636b 2220 696e 2073 796e 635f  tBlock" in sync_
+00012c90: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00012ca0: 2061 7373 6572 7420 2268 6967 6865 7374   assert "highest
+00012cb0: 426c 6f63 6b22 2069 6e20 7379 6e63 5f64  Block" in sync_d
+00012cc0: 6963 740a 0a20 2020 2020 2020 2020 2020  ict..           
+00012cd0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00012ce0: 6572 2873 796e 635f 6469 6374 5b22 7374  er(sync_dict["st
+00012cf0: 6172 7469 6e67 426c 6f63 6b22 5d29 0a20  artingBlock"]). 
+00012d00: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00012d10: 7420 6973 5f69 6e74 6567 6572 2873 796e  t is_integer(syn
+00012d20: 635f 6469 6374 5b22 6375 7272 656e 7442  c_dict["currentB
+00012d30: 6c6f 636b 225d 290a 2020 2020 2020 2020  lock"]).        
+00012d40: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00012d50: 7465 6765 7228 7379 6e63 5f64 6963 745b  teger(sync_dict[
+00012d60: 2268 6967 6865 7374 426c 6f63 6b22 5d29  "highestBlock"])
+00012d70: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00012d80: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00012d90: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
+00012da0: 796e 635f 6574 685f 6765 745f 7374 6f72  ync_eth_get_stor
+00012db0: 6167 655f 6174 280a 2020 2020 2020 2020  age_at(.        
+00012dc0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00012dd0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00012de0: 6e63 5f73 746f 7261 6765 5f63 6f6e 7472  nc_storage_contr
+00012df0: 6163 743a 2022 4173 796e 6343 6f6e 7472  act: "AsyncContr
+00012e00: 6163 7422 0a20 2020 2029 202d 3e20 4e6f  act".    ) -> No
+00012e10: 6e65 3a0a 2020 2020 2020 2020 6173 796e  ne:.        asyn
+00012e20: 635f 7374 6f72 6167 655f 636f 6e74 7261  c_storage_contra
+00012e30: 6374 5f61 6464 7265 7373 203d 2061 7379  ct_address = asy
+00012e40: 6e63 5f73 746f 7261 6765 5f63 6f6e 7472  nc_storage_contr
+00012e50: 6163 742e 6164 6472 6573 730a 0a20 2020  act.address..   
+00012e60: 2020 2020 2073 6c6f 745f 3020 3d20 6177       slot_0 = aw
+00012e70: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00012e80: 2e67 6574 5f73 746f 7261 6765 5f61 7428  .get_storage_at(
+00012e90: 6173 796e 635f 7374 6f72 6167 655f 636f  async_storage_co
+00012ea0: 6e74 7261 6374 5f61 6464 7265 7373 2c20  ntract_address, 
+00012eb0: 3029 0a20 2020 2020 2020 2061 7373 6572  0).        asser
+00012ec0: 7420 736c 6f74 5f30 203d 3d20 4865 7842  t slot_0 == HexB
+00012ed0: 7974 6573 2866 2230 787b 2730 3027 202a  ytes(f"0x{'00' *
+00012ee0: 2033 327d 2229 0a0a 2020 2020 2020 2020   32}")..        
+00012ef0: 736c 6f74 5f31 203d 2061 7761 6974 2061  slot_1 = await a
+00012f00: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00012f10: 7374 6f72 6167 655f 6174 2861 7379 6e63  storage_at(async
+00012f20: 5f73 746f 7261 6765 5f63 6f6e 7472 6163  _storage_contrac
+00012f30: 745f 6164 6472 6573 732c 2031 290a 2020  t_address, 1).  
+00012f40: 2020 2020 2020 6173 7365 7274 2073 6c6f        assert slo
+00012f50: 745f 3120 3d3d 2048 6578 4279 7465 7328  t_1 == HexBytes(
+00012f60: 6622 3078 7b27 3030 2720 2a20 3331 7d30  f"0x{'00' * 31}0
+00012f70: 3122 290a 0a20 2020 2020 2020 2073 6c6f  1")..        slo
+00012f80: 745f 3220 3d20 6177 6169 7420 6173 796e  t_2 = await asyn
+00012f90: 635f 7733 2e65 7468 2e67 6574 5f73 746f  c_w3.eth.get_sto
+00012fa0: 7261 6765 5f61 7428 6173 796e 635f 7374  rage_at(async_st
+00012fb0: 6f72 6167 655f 636f 6e74 7261 6374 5f61  orage_contract_a
+00012fc0: 6464 7265 7373 2c20 3229 0a20 2020 2020  ddress, 2).     
+00012fd0: 2020 2061 7373 6572 7420 736c 6f74 5f32     assert slot_2
+00012fe0: 203d 3d20 4865 7842 7974 6573 2866 2230   == HexBytes(f"0
+00012ff0: 787b 2730 3027 202a 2033 317d 3032 2229  x{'00' * 31}02")
+00013000: 0a0a 2020 2020 2020 2020 736c 6f74 5f33  ..        slot_3
+00013010: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00013020: 332e 6574 682e 6765 745f 7374 6f72 6167  3.eth.get_storag
+00013030: 655f 6174 2861 7379 6e63 5f73 746f 7261  e_at(async_stora
+00013040: 6765 5f63 6f6e 7472 6163 745f 6164 6472  ge_contract_addr
+00013050: 6573 732c 2033 290a 2020 2020 2020 2020  ess, 3).        
+00013060: 6173 7365 7274 2073 6c6f 745f 3320 3d3d  assert slot_3 ==
+00013070: 2048 6578 4279 7465 7328 0a20 2020 2020   HexBytes(.     
+00013080: 2020 2020 2020 2022 3078 3734 3638 3732         "0x746872
+00013090: 3635 3635 3030 3030 3030 3030 3030 3030  6565000000000000
 000130a0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000130b0: 3030 3030 3030 3030 3030 3030 3030 6122  00000000000000a"
-000130c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000130d0: 2020 2061 7373 6572 7420 6279 7465 7328     assert bytes(
-000130e0: 736c 6f74 5f33 5b3a 355d 2920 3d3d 2062  slot_3[:5]) == b
-000130f0: 2274 6872 6565 220a 0a20 2020 2020 2020  "three"..       
-00013100: 2073 6c6f 745f 3420 3d20 6177 6169 7420   slot_4 = await 
-00013110: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-00013120: 5f73 746f 7261 6765 5f61 7428 6173 796e  _storage_at(asyn
-00013130: 635f 7374 6f72 6167 655f 636f 6e74 7261  c_storage_contra
-00013140: 6374 5f61 6464 7265 7373 2c20 3429 0a20  ct_address, 4). 
-00013150: 2020 2020 2020 2061 7373 6572 7420 736c         assert sl
-00013160: 6f74 5f34 203d 3d20 4865 7842 7974 6573  ot_4 == HexBytes
-00013170: 280a 2020 2020 2020 2020 2020 2020 2230  (.            "0
-00013180: 7836 3636 6637 3537 3230 3030 3030 3030  x666f75720000000
-00013190: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+000130b0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+000130c0: 3030 3030 3030 3030 3061 220a 2020 2020  000000000a".    
+000130d0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+000130e0: 7365 7274 2062 7974 6573 2873 6c6f 745f  sert bytes(slot_
+000130f0: 335b 3a35 5d29 203d 3d20 6222 7468 7265  3[:5]) == b"thre
+00013100: 6522 0a0a 2020 2020 2020 2020 736c 6f74  e"..        slot
+00013110: 5f34 203d 2061 7761 6974 2061 7379 6e63  _4 = await async
+00013120: 5f77 332e 6574 682e 6765 745f 7374 6f72  _w3.eth.get_stor
+00013130: 6167 655f 6174 2861 7379 6e63 5f73 746f  age_at(async_sto
+00013140: 7261 6765 5f63 6f6e 7472 6163 745f 6164  rage_contract_ad
+00013150: 6472 6573 732c 2034 290a 2020 2020 2020  dress, 4).      
+00013160: 2020 6173 7365 7274 2073 6c6f 745f 3420    assert slot_4 
+00013170: 3d3d 2048 6578 4279 7465 7328 0a20 2020  == HexBytes(.   
+00013180: 2020 2020 2020 2020 2022 3078 3636 3666           "0x666f
+00013190: 3735 3732 3030 3030 3030 3030 3030 3030  7572000000000000
 000131a0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000131b0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000131c0: 3822 0a20 2020 2020 2020 2029 0a20 2020  8".        ).   
-000131d0: 2020 2020 2061 7373 6572 7420 6279 7465       assert byte
-000131e0: 7328 736c 6f74 5f34 5b3a 345d 2920 3d3d  s(slot_4[:4]) ==
-000131f0: 2062 2266 6f75 7222 0a0a 2020 2020 4070   b"four"..    @p
-00013200: 7974 6573 742e 6d61 726b 2e61 7379 6e63  ytest.mark.async
-00013210: 696f 0a20 2020 2040 7079 7465 7374 2e6d  io.    @pytest.m
-00013220: 6172 6b2e 7866 6169 6c0a 2020 2020 6173  ark.xfail.    as
-00013230: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
-00013240: 6e63 5f65 7468 5f67 6574 5f73 746f 7261  nc_eth_get_stora
-00013250: 6765 5f61 745f 656e 735f 6e61 6d65 280a  ge_at_ens_name(.
-00013260: 2020 2020 2020 2020 7365 6c66 2c20 6173          self, as
-00013270: 796e 635f 7733 3a20 2241 7379 6e63 5765  ync_w3: "AsyncWe
-00013280: 6233 222c 2061 7379 6e63 5f73 746f 7261  b3", async_stora
-00013290: 6765 5f63 6f6e 7472 6163 743a 2022 4173  ge_contract: "As
-000132a0: 796e 6343 6f6e 7472 6163 7422 0a20 2020  yncContract".   
-000132b0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000132c0: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
-000132d0: 7265 7373 6573 2861 7379 6e63 5f77 332c  resses(async_w3,
-000132e0: 207b 2273 746f 7261 6765 2e65 7468 223a   {"storage.eth":
-000132f0: 2061 7379 6e63 5f73 746f 7261 6765 5f63   async_storage_c
-00013300: 6f6e 7472 6163 742e 6164 6472 6573 737d  ontract.address}
-00013310: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00013320: 746f 7261 6765 203d 2061 7761 6974 2061  torage = await a
-00013330: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-00013340: 7374 6f72 6167 655f 6174 2845 4e53 2822  storage_at(ENS("
-00013350: 7374 6f72 6167 652e 6574 6822 292c 2031  storage.eth"), 1
-00013360: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
-00013370: 7365 7274 2073 746f 7261 6765 203d 3d20  sert storage == 
-00013380: 4865 7842 7974 6573 2866 2230 787b 2730  HexBytes(f"0x{'0
-00013390: 3027 202a 2033 317d 3031 2229 0a0a 2020  0' * 31}01")..  
-000133a0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-000133b0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-000133c0: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-000133d0: 6574 685f 6765 745f 7374 6f72 6167 655f  eth_get_storage_
-000133e0: 6174 5f69 6e76 616c 6964 5f61 6464 7265  at_invalid_addre
-000133f0: 7373 280a 2020 2020 2020 2020 7365 6c66  ss(.        self
-00013400: 2c20 6173 796e 635f 7733 3a20 2241 7379  , async_w3: "Asy
-00013410: 6e63 5765 6233 220a 2020 2020 2920 2d3e  ncWeb3".    ) ->
-00013420: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
-00013430: 6f69 6e62 6173 6520 3d20 6177 6169 7420  oinbase = await 
-00013440: 6173 796e 635f 7733 2e65 7468 2e63 6f69  async_w3.eth.coi
-00013450: 6e62 6173 650a 2020 2020 2020 2020 7769  nbase.        wi
-00013460: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
-00013470: 2849 6e76 616c 6964 4164 6472 6573 7329  (InvalidAddress)
-00013480: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
-00013490: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000134a0: 2e67 6574 5f73 746f 7261 6765 5f61 7428  .get_storage_at(
-000134b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000134c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-000134d0: 2848 6578 4164 6472 6573 7328 4865 7853  (HexAddress(HexS
-000134e0: 7472 2863 6f69 6e62 6173 652e 6c6f 7765  tr(coinbase.lowe
-000134f0: 7228 2929 2929 2c20 300a 2020 2020 2020  r()))), 0.      
-00013500: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00013510: 2074 6573 745f 6173 796e 635f 7072 6f76   test_async_prov
-00013520: 6964 6572 5f64 6566 6175 6c74 5f61 6363  ider_default_acc
-00013530: 6f75 6e74 280a 2020 2020 2020 2020 7365  ount(.        se
-00013540: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
-00013550: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-00013560: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
-00013570: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00013580: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00013590: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-000135a0: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
-000135b0: 6e65 3a0a 2020 2020 2020 2020 2320 6368  ne:.        # ch
-000135c0: 6563 6b20 6465 6661 756c 7473 2074 6f20  eck defaults to 
-000135d0: 656d 7074 790a 2020 2020 2020 2020 6465  empty.        de
-000135e0: 6661 756c 745f 6163 636f 756e 7420 3d20  fault_account = 
-000135f0: 6173 796e 635f 7733 2e65 7468 2e64 6566  async_w3.eth.def
-00013600: 6175 6c74 5f61 6363 6f75 6e74 0a20 2020  ault_account.   
-00013610: 2020 2020 2061 7373 6572 7420 6465 6661       assert defa
-00013620: 756c 745f 6163 636f 756e 7420 6973 2065  ult_account is e
-00013630: 6d70 7479 0a0a 2020 2020 2020 2020 2320  mpty..        # 
-00013640: 6368 6563 6b20 7365 7474 6572 0a20 2020  check setter.   
-00013650: 2020 2020 2061 7379 6e63 5f77 332e 6574       async_w3.et
-00013660: 682e 6465 6661 756c 745f 6163 636f 756e  h.default_accoun
-00013670: 7420 3d20 6173 796e 635f 6b65 7966 696c  t = async_keyfil
-00013680: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00013690: 735f 6475 616c 5f74 7970 650a 2020 2020  s_dual_type.    
-000136a0: 2020 2020 6465 6661 756c 745f 6163 636f      default_acco
-000136b0: 756e 7420 3d20 6173 796e 635f 7733 2e65  unt = async_w3.e
-000136c0: 7468 2e64 6566 6175 6c74 5f61 6363 6f75  th.default_accou
-000136d0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
-000136e0: 7420 6465 6661 756c 745f 6163 636f 756e  t default_accoun
-000136f0: 7420 3d3d 2061 7379 6e63 5f6b 6579 6669  t == async_keyfi
-00013700: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00013710: 7373 5f64 7561 6c5f 7479 7065 0a0a 2020  ss_dual_type..  
-00013720: 2020 2020 2020 2320 7265 7365 7420 746f        # reset to
-00013730: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-00013740: 2061 7379 6e63 5f77 332e 6574 682e 6465   async_w3.eth.de
-00013750: 6661 756c 745f 6163 636f 756e 7420 3d20  fault_account = 
-00013760: 656d 7074 790a 0a20 2020 2064 6566 2074  empty..    def t
-00013770: 6573 745f 6173 796e 635f 7072 6f76 6964  est_async_provid
-00013780: 6572 5f64 6566 6175 6c74 5f62 6c6f 636b  er_default_block
-00013790: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000137a0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
-000137b0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
-000137c0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-000137d0: 2020 2020 2020 2320 6368 6563 6b20 6465        # check de
-000137e0: 6661 756c 7473 2074 6f20 276c 6174 6573  faults to 'lates
-000137f0: 7427 0a20 2020 2020 2020 2064 6566 6175  t'.        defau
-00013800: 6c74 5f62 6c6f 636b 203d 2061 7379 6e63  lt_block = async
-00013810: 5f77 332e 6574 682e 6465 6661 756c 745f  _w3.eth.default_
-00013820: 626c 6f63 6b0a 2020 2020 2020 2020 6173  block.        as
-00013830: 7365 7274 2064 6566 6175 6c74 5f62 6c6f  sert default_blo
-00013840: 636b 203d 3d20 226c 6174 6573 7422 0a0a  ck == "latest"..
-00013850: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-00013860: 7365 7474 6572 0a20 2020 2020 2020 2061  setter.        a
-00013870: 7379 6e63 5f77 332e 6574 682e 6465 6661  sync_w3.eth.defa
-00013880: 756c 745f 626c 6f63 6b20 3d20 426c 6f63  ult_block = Bloc
-00013890: 6b4e 756d 6265 7228 3132 3334 3529 0a20  kNumber(12345). 
-000138a0: 2020 2020 2020 2064 6566 6175 6c74 5f62         default_b
-000138b0: 6c6f 636b 203d 2061 7379 6e63 5f77 332e  lock = async_w3.
-000138c0: 6574 682e 6465 6661 756c 745f 626c 6f63  eth.default_bloc
-000138d0: 6b0a 2020 2020 2020 2020 6173 7365 7274  k.        assert
-000138e0: 2064 6566 6175 6c74 5f62 6c6f 636b 203d   default_block =
-000138f0: 3d20 426c 6f63 6b4e 756d 6265 7228 3132  = BlockNumber(12
-00013900: 3334 3529 0a0a 2020 2020 2020 2020 2320  345)..        # 
-00013910: 7265 7365 7420 746f 2064 6566 6175 6c74  reset to default
-00013920: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00013930: 332e 6574 682e 6465 6661 756c 745f 626c  3.eth.default_bl
-00013940: 6f63 6b20 3d20 226c 6174 6573 7422 0a0a  ock = "latest"..
-00013950: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00013960: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
-00013970: 6e63 2064 6566 2074 6573 745f 6574 685f  nc def test_eth_
-00013980: 6765 7442 6c6f 636b 5472 616e 7361 6374  getBlockTransact
-00013990: 696f 6e43 6f75 6e74 4279 4861 7368 5f61  ionCountByHash_a
-000139a0: 7379 6e63 5f65 6d70 7479 5f62 6c6f 636b  sync_empty_block
-000139b0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000139c0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-000139d0: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
-000139e0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-000139f0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-00013a00: 653a 0a20 2020 2020 2020 2074 7261 6e73  e:.        trans
-00013a10: 6163 7469 6f6e 5f63 6f75 6e74 203d 2061  action_count = a
-00013a20: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00013a30: 682e 6765 745f 626c 6f63 6b5f 7472 616e  h.get_block_tran
-00013a40: 7361 6374 696f 6e5f 636f 756e 7428 0a20  saction_count(. 
-00013a50: 2020 2020 2020 2020 2020 2061 7379 6e63             async
-00013a60: 5f65 6d70 7479 5f62 6c6f 636b 5b22 6861  _empty_block["ha
-00013a70: 7368 225d 0a20 2020 2020 2020 2029 0a0a  sh"].        )..
-00013a80: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00013a90: 735f 696e 7465 6765 7228 7472 616e 7361  s_integer(transa
-00013aa0: 6374 696f 6e5f 636f 756e 7429 0a20 2020  ction_count).   
-00013ab0: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
-00013ac0: 7361 6374 696f 6e5f 636f 756e 7420 3d3d  saction_count ==
-00013ad0: 2030 0a0a 2020 2020 4070 7974 6573 742e   0..    @pytest.
-00013ae0: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00013af0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00013b00: 6574 685f 6765 7442 6c6f 636b 5472 616e  eth_getBlockTran
-00013b10: 7361 6374 696f 6e43 6f75 6e74 4279 4e75  sactionCountByNu
-00013b20: 6d62 6572 5f61 7379 6e63 5f65 6d70 7479  mber_async_empty
-00013b30: 5f62 6c6f 636b 280a 2020 2020 2020 2020  _block(.        
-00013b40: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00013b50: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-00013b60: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
-00013b70: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
-00013b80: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00013b90: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-00013ba0: 6e74 203d 2061 7761 6974 2061 7379 6e63  nt = await async
-00013bb0: 5f77 332e 6574 682e 6765 745f 626c 6f63  _w3.eth.get_bloc
-00013bc0: 6b5f 7472 616e 7361 6374 696f 6e5f 636f  k_transaction_co
-00013bd0: 756e 7428 0a20 2020 2020 2020 2020 2020  unt(.           
-00013be0: 2061 7379 6e63 5f65 6d70 7479 5f62 6c6f   async_empty_blo
-00013bf0: 636b 5b22 6e75 6d62 6572 225d 0a20 2020  ck["number"].   
-00013c00: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00013c10: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00013c20: 7228 7472 616e 7361 6374 696f 6e5f 636f  r(transaction_co
-00013c30: 756e 7429 0a20 2020 2020 2020 2061 7373  unt).        ass
-00013c40: 6572 7420 7472 616e 7361 6374 696f 6e5f  ert transaction_
-00013c50: 636f 756e 7420 3d3d 2030 0a0a 2020 2020  count == 0..    
-00013c60: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00013c70: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00013c80: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
-00013c90: 6c6f 636b 5472 616e 7361 6374 696f 6e43  lockTransactionC
-00013ca0: 6f75 6e74 4279 4861 7368 5f62 6c6f 636b  ountByHash_block
-00013cb0: 5f77 6974 685f 7478 6e28 0a20 2020 2020  _with_txn(.     
-00013cc0: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
-00013cd0: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
-00013ce0: 6173 796e 635f 626c 6f63 6b5f 7769 7468  async_block_with
-00013cf0: 5f74 786e 3a20 426c 6f63 6b44 6174 610a  _txn: BlockData.
-00013d00: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00013d10: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
-00013d20: 6f6e 5f63 6f75 6e74 203d 2061 7761 6974  on_count = await
-00013d30: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00013d40: 745f 626c 6f63 6b5f 7472 616e 7361 6374  t_block_transact
-00013d50: 696f 6e5f 636f 756e 7428 0a20 2020 2020  ion_count(.     
-00013d60: 2020 2020 2020 2061 7379 6e63 5f62 6c6f         async_blo
-00013d70: 636b 5f77 6974 685f 7478 6e5b 2268 6173  ck_with_txn["has
-00013d80: 6822 5d0a 2020 2020 2020 2020 290a 0a20  h"].        ).. 
-00013d90: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00013da0: 5f69 6e74 6567 6572 2874 7261 6e73 6163  _integer(transac
-00013db0: 7469 6f6e 5f63 6f75 6e74 290a 2020 2020  tion_count).    
-00013dc0: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00013dd0: 6163 7469 6f6e 5f63 6f75 6e74 203e 3d20  action_count >= 
-00013de0: 310a 0a20 2020 2040 7079 7465 7374 2e6d  1..    @pytest.m
-00013df0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00013e00: 6173 796e 6320 6465 6620 7465 7374 5f65  async def test_e
-00013e10: 7468 5f67 6574 556e 636c 6543 6f75 6e74  th_getUncleCount
-00013e20: 4279 426c 6f63 6b48 6173 6828 0a20 2020  ByBlockHash(.   
-00013e30: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00013e40: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00013e50: 2c20 6173 796e 635f 656d 7074 795f 626c  , async_empty_bl
-00013e60: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
-00013e70: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00013e80: 2020 2020 2020 756e 636c 655f 636f 756e        uncle_coun
-00013e90: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-00013ea0: 7733 2e65 7468 2e67 6574 5f75 6e63 6c65  w3.eth.get_uncle
-00013eb0: 5f63 6f75 6e74 2861 7379 6e63 5f65 6d70  _count(async_emp
-00013ec0: 7479 5f62 6c6f 636b 5b22 6861 7368 225d  ty_block["hash"]
-00013ed0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
-00013ee0: 7420 6973 5f69 6e74 6567 6572 2875 6e63  t is_integer(unc
-00013ef0: 6c65 5f63 6f75 6e74 290a 2020 2020 2020  le_count).      
-00013f00: 2020 6173 7365 7274 2075 6e63 6c65 5f63    assert uncle_c
-00013f10: 6f75 6e74 203d 3d20 300a 0a20 2020 2040  ount == 0..    @
-00013f20: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
-00013f30: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
-00013f40: 6620 7465 7374 5f65 7468 5f67 6574 556e  f test_eth_getUn
-00013f50: 636c 6543 6f75 6e74 4279 426c 6f63 6b4e  cleCountByBlockN
-00013f60: 756d 6265 7228 0a20 2020 2020 2020 2073  umber(.        s
-00013f70: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00013f80: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
-00013f90: 635f 656d 7074 795f 626c 6f63 6b3a 2042  c_empty_block: B
-00013fa0: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-00013fb0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00013fc0: 756e 636c 655f 636f 756e 7420 3d20 6177  uncle_count = aw
-00013fd0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00013fe0: 2e67 6574 5f75 6e63 6c65 5f63 6f75 6e74  .get_uncle_count
-00013ff0: 2861 7379 6e63 5f65 6d70 7479 5f62 6c6f  (async_empty_blo
-00014000: 636b 5b22 6e75 6d62 6572 225d 290a 0a20  ck["number"]).. 
-00014010: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00014020: 5f69 6e74 6567 6572 2875 6e63 6c65 5f63  _integer(uncle_c
-00014030: 6f75 6e74 290a 2020 2020 2020 2020 6173  ount).        as
-00014040: 7365 7274 2075 6e63 6c65 5f63 6f75 6e74  sert uncle_count
-00014050: 203d 3d20 300a 0a20 2020 2040 7079 7465   == 0..    @pyte
-00014060: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
-00014070: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
-00014080: 7374 5f65 7468 5f67 6574 426c 6f63 6b54  st_eth_getBlockT
-00014090: 7261 6e73 6163 7469 6f6e 436f 756e 7442  ransactionCountB
-000140a0: 794e 756d 6265 725f 626c 6f63 6b5f 7769  yNumber_block_wi
-000140b0: 7468 5f74 786e 280a 2020 2020 2020 2020  th_txn(.        
-000140c0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-000140d0: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
-000140e0: 6e63 5f62 6c6f 636b 5f77 6974 685f 7478  nc_block_with_tx
-000140f0: 6e3a 2042 6c6f 636b 4461 7461 0a20 2020  n: BlockData.   
-00014100: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00014110: 2020 2020 7472 616e 7361 6374 696f 6e5f      transaction_
-00014120: 636f 756e 7420 3d20 6177 6169 7420 6173  count = await as
-00014130: 796e 635f 7733 2e65 7468 2e67 6574 5f62  ync_w3.eth.get_b
-00014140: 6c6f 636b 5f74 7261 6e73 6163 7469 6f6e  lock_transaction
-00014150: 5f63 6f75 6e74 280a 2020 2020 2020 2020  _count(.        
-00014160: 2020 2020 6173 796e 635f 626c 6f63 6b5f      async_block_
-00014170: 7769 7468 5f74 786e 5b22 6e75 6d62 6572  with_txn["number
-00014180: 225d 0a20 2020 2020 2020 2029 0a0a 2020  "].        )..  
-00014190: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-000141a0: 696e 7465 6765 7228 7472 616e 7361 6374  integer(transact
-000141b0: 696f 6e5f 636f 756e 7429 0a20 2020 2020  ion_count).     
-000141c0: 2020 2061 7373 6572 7420 7472 616e 7361     assert transa
-000141d0: 6374 696f 6e5f 636f 756e 7420 3e3d 2031  ction_count >= 1
-000141e0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-000141f0: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00014200: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-00014210: 796e 635f 6574 685f 7369 676e 280a 2020  ync_eth_sign(.  
-00014220: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00014230: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
-00014240: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
-00014250: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
-00014260: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00014270: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-00014280: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-00014290: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000142a0: 2020 2020 7369 676e 6174 7572 6520 3d20      signature = 
-000142b0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-000142c0: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-000142d0: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
-000142e0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-000142f0: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00014300: 2020 2020 2020 2020 2020 7465 7874 3d22            text="
-00014310: 4d65 7373 6167 6520 74c3 b620 7369 676e  Message t.. sign
-00014320: 2e20 4c6f 6e67 6572 2074 6861 6e20 6861  . Longer than ha
-00014330: 7368 2122 2c0a 2020 2020 2020 2020 290a  sh!",.        ).
-00014340: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00014350: 735f 6279 7465 7328 7369 676e 6174 7572  s_bytes(signatur
-00014360: 6529 0a20 2020 2020 2020 2061 7373 6572  e).        asser
-00014370: 7420 6c65 6e28 7369 676e 6174 7572 6529  t len(signature)
-00014380: 203d 3d20 3332 202b 2033 3220 2b20 310a   == 32 + 32 + 1.
-00014390: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
-000143a0: 6f74 6865 7220 666f 726d 6174 730a 2020  other formats.  
-000143b0: 2020 2020 2020 6865 7873 6967 6e20 3d20        hexsign = 
-000143c0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
-000143d0: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-000143e0: 2020 2020 2061 7379 6e63 5f6b 6579 6669       async_keyfi
-000143f0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00014400: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00014410: 2020 2020 2020 2020 2020 6865 7873 7472            hexstr
-00014420: 3d48 6578 5374 7228 0a20 2020 2020 2020  =HexStr(.       
-00014430: 2020 2020 2020 2020 2022 3078 3464 3635           "0x4d65
-00014440: 3733 3733 3631 3637 3635 3230 3734 6333  73736167652074c3
-00014450: 6236 3230 3733 3639 3637 3665 3265 3230  b6207369676e2e20
-00014460: 3463 3666 3665 3637 3635 3732 3230 3734  4c6f6e6765722074
-00014470: 3638 3631 3665 3230 3638 3631 3733 3638  68616e2068617368
-00014480: 3231 2220 2023 206e 6f71 613a 2045 3530  21"  # noqa: E50
-00014490: 310a 2020 2020 2020 2020 2020 2020 292c  1.            ),
-000144a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000144b0: 2020 2061 7373 6572 7420 6865 7873 6967     assert hexsig
-000144c0: 6e20 3d3d 2073 6967 6e61 7475 7265 0a0a  n == signature..
-000144d0: 2020 2020 2020 2020 696e 7473 6967 6e20          intsign 
-000144e0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-000144f0: 2e65 7468 2e73 6967 6e28 0a20 2020 2020  .eth.sign(.     
-00014500: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
-00014510: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00014520: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
-00014530: 2020 2020 2020 2020 2020 2020 3078 3444              0x4D
-00014540: 3635 3733 3733 3631 3637 3635 3230 3734  6573736167652074
-00014550: 4333 4236 3230 3733 3639 3637 3645 3245  C3B6207369676E2E
-00014560: 3230 3443 3646 3645 3637 3635 3732 3230  204C6F6E67657220
-00014570: 3734 3638 3631 3645 3230 3638 3631 3733  7468616E20686173
-00014580: 3638 3231 2c0a 2020 2020 2020 2020 290a  6821,.        ).
-00014590: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000145a0: 6e74 7369 676e 203d 3d20 7369 676e 6174  ntsign == signat
-000145b0: 7572 650a 0a20 2020 2020 2020 2062 7974  ure..        byt
-000145c0: 6573 7369 676e 203d 2061 7761 6974 2061  essign = await a
-000145d0: 7379 6e63 5f77 332e 6574 682e 7369 676e  sync_w3.eth.sign
-000145e0: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
-000145f0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-00014600: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-00014610: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00014620: 2020 2062 224d 6573 7361 6765 2074 5c78     b"Message t\x
-00014630: 6333 5c78 6236 2073 6967 6e2e 204c 6f6e  c3\xb6 sign. Lon
-00014640: 6765 7220 7468 616e 2068 6173 6821 222c  ger than hash!",
-00014650: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00014660: 2020 2061 7373 6572 7420 6279 7465 7373     assert bytess
-00014670: 6967 6e20 3d3d 2073 6967 6e61 7475 7265  ign == signature
-00014680: 0a0a 2020 2020 2020 2020 6e65 775f 7369  ..        new_si
-00014690: 676e 6174 7572 6520 3d20 6177 6169 7420  gnature = await 
-000146a0: 6173 796e 635f 7733 2e65 7468 2e73 6967  async_w3.eth.sig
-000146b0: 6e28 0a20 2020 2020 2020 2020 2020 2061  n(.            a
-000146c0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-000146d0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-000146e0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-000146f0: 2020 2020 7465 7874 3d22 6469 6666 6572      text="differ
-00014700: 656e 7420 6d65 7373 6167 6520 6973 2064  ent message is d
-00014710: 6966 6665 7265 6e74 222c 0a20 2020 2020  ifferent",.     
-00014720: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-00014730: 6572 7420 6e65 775f 7369 676e 6174 7572  ert new_signatur
-00014740: 6520 213d 2073 6967 6e61 7475 7265 0a0a  e != signature..
-00014750: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00014760: 2e61 7379 6e63 696f 0a20 2020 2040 7079  .asyncio.    @py
-00014770: 7465 7374 2e6d 6172 6b2e 7866 6169 6c28  test.mark.xfail(
-00014780: 0a20 2020 2020 2020 2072 6561 736f 6e3d  .        reason=
-00014790: 2241 7379 6e63 206d 6964 646c 6577 6172  "Async middlewar
-000147a0: 6520 746f 2063 6f6e 7665 7274 2045 4e53  e to convert ENS
-000147b0: 206e 616d 6573 2074 6f20 6164 6472 6573   names to addres
-000147c0: 7365 7320 6973 206d 6973 7369 6e67 220a  ses is missing".
-000147d0: 2020 2020 290a 2020 2020 6173 796e 6320      ).    async 
-000147e0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
-000147f0: 7468 5f73 6967 6e5f 656e 735f 6e61 6d65  th_sign_ens_name
-00014800: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00014810: 0a20 2020 2020 2020 2061 7379 6e63 5f77  .        async_w
-00014820: 333a 2022 4173 796e 6357 6562 3322 2c0a  3: "AsyncWeb3",.
-00014830: 2020 2020 2020 2020 6173 796e 635f 6b65          async_ke
-00014840: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00014850: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
-00014860: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-00014870: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-00014880: 0a20 2020 2020 2020 2077 6974 6820 656e  .        with en
-00014890: 735f 6164 6472 6573 7365 7328 0a20 2020  s_addresses(.   
-000148a0: 2020 2020 2020 2020 2061 7379 6e63 5f77           async_w
-000148b0: 332c 207b 2275 6e6c 6f63 6b65 642d 6163  3, {"unlocked-ac
-000148c0: 6374 2e65 7468 223a 2061 7379 6e63 5f6b  ct.eth": async_k
-000148d0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-000148e0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-000148f0: 7d0a 2020 2020 2020 2020 293a 0a20 2020  }.        ):.   
-00014900: 2020 2020 2020 2020 2073 6967 6e61 7475           signatu
-00014910: 7265 203d 2061 7761 6974 2061 7379 6e63  re = await async
-00014920: 5f77 332e 6574 682e 7369 676e 280a 2020  _w3.eth.sign(.  
-00014930: 2020 2020 2020 2020 2020 2020 2020 454e                EN
-00014940: 5328 2275 6e6c 6f63 6b65 642d 6163 6374  S("unlocked-acct
-00014950: 2e65 7468 2229 2c20 7465 7874 3d22 4d65  .eth"), text="Me
-00014960: 7373 6167 6520 74c3 b620 7369 676e 2e20  ssage t.. sign. 
-00014970: 4c6f 6e67 6572 2074 6861 6e20 6861 7368  Longer than hash
-00014980: 2122 0a20 2020 2020 2020 2020 2020 2029  !".            )
-00014990: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-000149a0: 6572 7420 6973 5f62 7974 6573 2873 6967  ert is_bytes(sig
-000149b0: 6e61 7475 7265 290a 2020 2020 2020 2020  nature).        
-000149c0: 2020 2020 6173 7365 7274 206c 656e 2873      assert len(s
-000149d0: 6967 6e61 7475 7265 2920 3d3d 2033 3220  ignature) == 32 
-000149e0: 2b20 3332 202b 2031 0a0a 2020 2020 4066  + 32 + 1..    @f
-000149f0: 6c61 6b79 5f67 6574 685f 6465 765f 6d69  laky_geth_dev_mi
-00014a00: 6e69 6e67 0a20 2020 2040 7079 7465 7374  ning.    @pytest
-00014a10: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
-00014a20: 2020 6173 796e 6320 6465 6620 7465 7374    async def test
-00014a30: 5f61 7379 6e63 5f65 7468 5f72 6570 6c61  _async_eth_repla
-00014a40: 6365 5f74 7261 6e73 6163 7469 6f6e 5f6c  ce_transaction_l
-00014a50: 6567 6163 7928 0a20 2020 2020 2020 2073  egacy(.        s
-00014a60: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-00014a70: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-00014a80: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-00014a90: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00014aa0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00014ab0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00014ac0: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-00014ad0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00014ae0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00014af0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00014b00: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00014b10: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00014b20: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00014b30: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00014b40: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
-00014b50: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00014b60: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00014b70: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00014b80: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00014b90: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-00014ba0: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-00014bb0: 2022 6761 7350 7269 6365 223a 2061 7379   "gasPrice": asy
-00014bc0: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-00014bd0: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-00014be0: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
-00014bf0: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
-00014c00: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
-00014c10: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00014c20: 7261 6d73 290a 0a20 2020 2020 2020 2074  rams)..        t
-00014c30: 786e 5f70 6172 616d 735b 2267 6173 5072  xn_params["gasPr
-00014c40: 6963 6522 5d20 3d20 6173 796e 635f 7733  ice"] = async_w3
-00014c50: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
-00014c60: 2229 0a20 2020 2020 2020 2072 6570 6c61  ").        repla
-00014c70: 6365 5f74 786e 5f68 6173 6820 3d20 6177  ce_txn_hash = aw
-00014c80: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00014c90: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
-00014ca0: 7469 6f6e 2874 786e 5f68 6173 682c 2074  tion(txn_hash, t
-00014cb0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
-00014cc0: 2020 2072 6570 6c61 6365 5f74 786e 203d     replace_txn =
-00014cd0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00014ce0: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-00014cf0: 696f 6e28 7265 706c 6163 655f 7478 6e5f  ion(replace_txn_
-00014d00: 6861 7368 290a 0a20 2020 2020 2020 2061  hash)..        a
-00014d10: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
-00014d20: 6472 6573 7328 0a20 2020 2020 2020 2020  dress(.         
-00014d30: 2020 2072 6570 6c61 6365 5f74 786e 5b22     replace_txn["
-00014d40: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
-00014d50: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
-00014d60: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
-00014d70: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00014d80: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00014d90: 6d65 5f61 6464 7265 7373 280a 2020 2020  me_address(.    
-00014da0: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
-00014db0: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-00014dc0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00014dd0: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-00014de0: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-00014df0: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
-00014e00: 6163 655f 7478 6e5b 2276 616c 7565 225d  ace_txn["value"]
-00014e10: 203d 3d20 310a 2020 2020 2020 2020 6173   == 1.        as
-00014e20: 7365 7274 2072 6570 6c61 6365 5f74 786e  sert replace_txn
-00014e30: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
-00014e40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00014e50: 7265 706c 6163 655f 7478 6e5b 2267 6173  replace_txn["gas
-00014e60: 5072 6963 6522 5d20 3d3d 2074 786e 5f70  Price"] == txn_p
-00014e70: 6172 616d 735b 2267 6173 5072 6963 6522  arams["gasPrice"
-00014e80: 5d0a 0a20 2020 2040 666c 616b 795f 6765  ]..    @flaky_ge
-00014e90: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
-00014ea0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
-00014eb0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
-00014ec0: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
-00014ed0: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
-00014ee0: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-00014ef0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00014f00: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-00014f10: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
-00014f20: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-00014f30: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-00014f40: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-00014f50: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-00014f60: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00014f70: 776f 5f67 7765 695f 696e 5f77 6569 203d  wo_gwei_in_wei =
-00014f80: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
-00014f90: 2832 2c20 2267 7765 6922 290a 2020 2020  (2, "gwei").    
-00014fa0: 2020 2020 7468 7265 655f 6777 6569 5f69      three_gwei_i
-00014fb0: 6e5f 7765 6920 3d20 6173 796e 635f 7733  n_wei = async_w3
-00014fc0: 2e74 6f5f 7765 6928 332c 2022 6777 6569  .to_wei(3, "gwei
-00014fd0: 2229 0a0a 2020 2020 2020 2020 7478 6e5f  ")..        txn_
-00014fe0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-00014ff0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00015000: 2022 6672 6f6d 223a 2061 7379 6e63 5f6b   "from": async_k
-00015010: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00015020: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00015030: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00015040: 6f22 3a20 6173 796e 635f 6b65 7966 696c  o": async_keyfil
-00015050: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00015060: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-00015070: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-00015080: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-00015090: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-000150a0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-000150b0: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-000150c0: 7477 6f5f 6777 6569 5f69 6e5f 7765 692c  two_gwei_in_wei,
-000150d0: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-000150e0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-000150f0: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
-00015100: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
-00015110: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00015120: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-00015130: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-00015140: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
-00015150: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
-00015160: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00015170: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
-00015180: 5d20 3d20 7468 7265 655f 6777 6569 5f69  ] = three_gwei_i
-00015190: 6e5f 7765 690a 2020 2020 2020 2020 7478  n_wei.        tx
-000151a0: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
-000151b0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
-000151c0: 203d 2074 776f 5f67 7765 695f 696e 5f77   = two_gwei_in_w
-000151d0: 6569 0a0a 2020 2020 2020 2020 7265 706c  ei..        repl
-000151e0: 6163 655f 7478 6e5f 6861 7368 203d 2061  ace_txn_hash = a
-000151f0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00015200: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-00015210: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-00015220: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-00015230: 2020 2020 7265 706c 6163 655f 7478 6e20      replace_txn 
-00015240: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00015250: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-00015260: 7469 6f6e 2872 6570 6c61 6365 5f74 786e  tion(replace_txn
-00015270: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
-00015280: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-00015290: 6464 7265 7373 280a 2020 2020 2020 2020  ddress(.        
-000152a0: 2020 2020 7265 706c 6163 655f 7478 6e5b      replace_txn[
-000152b0: 2266 726f 6d22 5d2c 2063 6173 7428 4368  "from"], cast(Ch
-000152c0: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-000152d0: 786e 5f70 6172 616d 735b 2266 726f 6d22  xn_params["from"
-000152e0: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-000152f0: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-00015300: 616d 655f 6164 6472 6573 7328 0a20 2020  ame_address(.   
-00015310: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
-00015320: 5f74 786e 5b22 746f 225d 2c20 6361 7374  _txn["to"], cast
-00015330: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
-00015340: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
-00015350: 225d 290a 2020 2020 2020 2020 290a 2020  "]).        ).  
-00015360: 2020 2020 2020 6173 7365 7274 2072 6570        assert rep
-00015370: 6c61 6365 5f74 786e 5b22 7661 6c75 6522  lace_txn["value"
-00015380: 5d20 3d3d 2031 0a20 2020 2020 2020 2061  ] == 1.        a
-00015390: 7373 6572 7420 7265 706c 6163 655f 7478  ssert replace_tx
-000153a0: 6e5b 2267 6173 225d 203d 3d20 3231 3030  n["gas"] == 2100
-000153b0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-000153c0: 2072 6570 6c61 6365 5f74 786e 5b22 6d61   replace_txn["ma
-000153d0: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
-000153e0: 7468 7265 655f 6777 6569 5f69 6e5f 7765  three_gwei_in_we
-000153f0: 690a 2020 2020 2020 2020 6173 7365 7274  i.        assert
-00015400: 2072 6570 6c61 6365 5f74 786e 5b22 6d61   replace_txn["ma
-00015410: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00015420: 6173 225d 203d 3d20 7477 6f5f 6777 6569  as"] == two_gwei
-00015430: 5f69 6e5f 7765 690a 0a20 2020 2040 666c  _in_wei..    @fl
-00015440: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
-00015450: 696e 670a 2020 2020 4070 7974 6573 742e  ing.    @pytest.
-00015460: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
-00015470: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
-00015480: 6173 796e 635f 6574 685f 7265 706c 6163  async_eth_replac
-00015490: 655f 7472 616e 7361 6374 696f 6e5f 756e  e_transaction_un
-000154a0: 6465 7270 7269 6365 6428 0a20 2020 2020  derpriced(.     
-000154b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000154c0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-000154d0: 6357 6562 3322 2c0a 2020 2020 2020 2020  cWeb3",.        
-000154e0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-000154f0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00015500: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
-00015510: 6d41 6464 7265 7373 2c0a 2020 2020 2920  mAddress,.    ) 
-00015520: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00015530: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
-00015540: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00015550: 2020 2020 2020 2266 726f 6d22 3a20 6173        "from": as
-00015560: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-00015570: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-00015580: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00015590: 2020 2022 746f 223a 2061 7379 6e63 5f6b     "to": async_k
-000155a0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-000155b0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-000155c0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-000155d0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-000155e0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-000155f0: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00015600: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
-00015610: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
-00015620: 5f77 6569 2833 2c20 2267 7765 6922 292c  _wei(3, "gwei"),
-00015630: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-00015640: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00015650: 6173 223a 2061 7379 6e63 5f77 332e 746f  as": async_w3.to
-00015660: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
-00015670: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00015680: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
-00015690: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000156a0: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
-000156b0: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
-000156c0: 2020 2020 2020 206f 6e65 5f67 7765 695f         one_gwei_
-000156d0: 696e 5f77 6569 203d 2061 7379 6e63 5f77  in_wei = async_w
-000156e0: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
-000156f0: 6922 290a 2020 2020 2020 2020 7478 6e5f  i").        txn_
-00015700: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-00015710: 7247 6173 225d 203d 206f 6e65 5f67 7765  rGas"] = one_gwe
-00015720: 695f 696e 5f77 6569 0a20 2020 2020 2020  i_in_wei.       
-00015730: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-00015740: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-00015750: 7322 5d20 3d20 6f6e 655f 6777 6569 5f69  s"] = one_gwei_i
-00015760: 6e5f 7765 690a 0a20 2020 2020 2020 2077  n_wei..        w
-00015770: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00015780: 7328 5765 6233 5250 4345 7272 6f72 2c20  s(Web3RPCError, 
-00015790: 6d61 7463 683d 2272 6570 6c61 6365 6d65  match="replaceme
-000157a0: 6e74 2074 7261 6e73 6163 7469 6f6e 2075  nt transaction u
-000157b0: 6e64 6572 7072 6963 6564 2229 3a0a 2020  nderpriced"):.  
-000157c0: 2020 2020 2020 2020 2020 6177 6169 7420            await 
-000157d0: 6173 796e 635f 7733 2e65 7468 2e72 6570  async_w3.eth.rep
-000157e0: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
-000157f0: 2874 786e 5f68 6173 682c 2074 786e 5f70  (txn_hash, txn_p
-00015800: 6172 616d 7329 0a0a 2020 2020 4066 6c61  arams)..    @fla
-00015810: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
-00015820: 6e67 0a20 2020 2040 7079 7465 7374 2e6d  ng.    @pytest.m
-00015830: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-00015840: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
-00015850: 7379 6e63 5f65 7468 5f72 6570 6c61 6365  sync_eth_replace
-00015860: 5f74 7261 6e73 6163 7469 6f6e 5f6e 6f6e  _transaction_non
-00015870: 5f65 7869 7374 696e 675f 7472 616e 7361  _existing_transa
-00015880: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
-00015890: 656c 662c 0a20 2020 2020 2020 2061 7379  elf,.        asy
-000158a0: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
-000158b0: 3322 2c0a 2020 2020 2020 2020 6173 796e  3",.        asyn
-000158c0: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-000158d0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-000158e0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-000158f0: 7265 7373 2c0a 2020 2020 2920 2d3e 204e  ress,.    ) -> N
-00015900: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00015910: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00015920: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00015930: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
-00015940: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00015950: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00015960: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00015970: 746f 223a 2061 7379 6e63 5f6b 6579 6669  to": async_keyfi
-00015980: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00015990: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-000159a0: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-000159b0: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-000159c0: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-000159d0: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-000159e0: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
-000159f0: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
-00015a00: 2833 2c20 2267 7765 6922 292c 0a20 2020  (3, "gwei"),.   
-00015a10: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-00015a20: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-00015a30: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
-00015a40: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
-00015a50: 2020 2020 207d 0a20 2020 2020 2020 2077       }.        w
-00015a60: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00015a70: 7328 5472 616e 7361 6374 696f 6e4e 6f74  s(TransactionNot
-00015a80: 466f 756e 6429 3a0a 2020 2020 2020 2020  Found):.        
-00015a90: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
-00015aa0: 7733 2e65 7468 2e72 6570 6c61 6365 5f74  w3.eth.replace_t
-00015ab0: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
-00015ac0: 2020 2020 2020 2020 2020 2020 4865 7853              HexS
-00015ad0: 7472 280a 2020 2020 2020 2020 2020 2020  tr(.            
-00015ae0: 2020 2020 2020 2020 2230 7839 3865 3863          "0x98e8c
-00015af0: 6330 3962 3331 3135 3833 6335 3037 3966  c09b311583c5079f
-00015b00: 6136 3030 6636 6332 6133 6265 6138 3631  a600f6c2a3bea861
-00015b10: 3161 6631 3638 6335 3265 3462 3630 6235  1af168c52e4b60b5
-00015b20: 6232 3433 6134 3431 3939 3722 0a20 2020  b243a441997".   
-00015b30: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
-00015b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b50: 7478 6e5f 7061 7261 6d73 2c0a 2020 2020  txn_params,.    
-00015b60: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00015b70: 666c 616b 795f 6765 7468 5f64 6576 5f6d  flaky_geth_dev_m
-00015b80: 696e 696e 670a 2020 2020 4070 7974 6573  ining.    @pytes
-00015b90: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00015ba0: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00015bb0: 745f 6173 796e 635f 6574 685f 7265 706c  t_async_eth_repl
-00015bc0: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
-00015bd0: 616c 7265 6164 795f 6d69 6e65 6428 0a20  already_mined(. 
-00015be0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00015bf0: 2020 2020 2061 7379 6e63 5f77 333a 2022       async_w3: "
-00015c00: 4173 796e 6357 6562 3322 2c0a 2020 2020  AsyncWeb3",.    
-00015c10: 2020 2020 6173 796e 635f 6b65 7966 696c      async_keyfil
-00015c20: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00015c30: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
-00015c40: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
-00015c50: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00015c60: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00015c70: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00015c80: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00015c90: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
-00015ca0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00015cb0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-00015cc0: 2020 2020 2020 2022 746f 223a 2061 7379         "to": asy
-00015cd0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
-00015ce0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00015cf0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00015d00: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00015d10: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00015d20: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00015d30: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
-00015d40: 5065 7247 6173 223a 2061 7379 6e63 5f77  PerGas": async_w
-00015d50: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-00015d60: 6922 292c 0a20 2020 2020 2020 2020 2020  i"),.           
-00015d70: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
-00015d80: 5065 7247 6173 223a 2061 7379 6e63 5f77  PerGas": async_w
-00015d90: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
-00015da0: 6922 292c 0a20 2020 2020 2020 207d 0a20  i"),.        }. 
-00015db0: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-00015dc0: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
-00015dd0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-00015de0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-00015df0: 290a 2020 2020 2020 2020 6177 6169 7420  ).        await 
-00015e00: 6173 796e 635f 7733 2e65 7468 2e77 6169  async_w3.eth.wai
-00015e10: 745f 666f 725f 7472 616e 7361 6374 696f  t_for_transactio
-00015e20: 6e5f 7265 6365 6970 7428 7478 6e5f 6861  n_receipt(txn_ha
-00015e30: 7368 2c20 7469 6d65 6f75 743d 3130 290a  sh, timeout=10).
-00015e40: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00015e50: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
-00015e60: 7322 5d20 3d20 6173 796e 635f 7733 2e74  s"] = async_w3.t
-00015e70: 6f5f 7765 6928 332c 2022 6777 6569 2229  o_wei(3, "gwei")
-00015e80: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00015e90: 616d 735b 226d 6178 5072 696f 7269 7479  ams["maxPriority
-00015ea0: 4665 6550 6572 4761 7322 5d20 3d20 6173  FeePerGas"] = as
-00015eb0: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
-00015ec0: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
-00015ed0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00015ee0: 7365 7328 5765 6233 5661 6c75 6545 7272  ses(Web3ValueErr
-00015ef0: 6f72 2c20 6d61 7463 683d 2253 7570 706c  or, match="Suppl
-00015f00: 6965 6420 7472 616e 7361 6374 696f 6e20  ied transaction 
-00015f10: 7769 7468 2068 6173 6822 293a 0a20 2020  with hash"):.   
-00015f20: 2020 2020 2020 2020 2061 7761 6974 2061           await a
-00015f30: 7379 6e63 5f77 332e 6574 682e 7265 706c  sync_w3.eth.repl
-00015f40: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
-00015f50: 7478 6e5f 6861 7368 2c20 7478 6e5f 7061  txn_hash, txn_pa
-00015f60: 7261 6d73 290a 0a20 2020 2040 666c 616b  rams)..    @flak
-00015f70: 795f 6765 7468 5f64 6576 5f6d 696e 696e  y_geth_dev_minin
-00015f80: 670a 2020 2020 4070 7974 6573 742e 6d61  g.    @pytest.ma
-00015f90: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00015fa0: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-00015fb0: 796e 635f 6574 685f 7265 706c 6163 655f  ync_eth_replace_
-00015fc0: 7472 616e 7361 6374 696f 6e5f 696e 636f  transaction_inco
-00015fd0: 7272 6563 745f 6e6f 6e63 6528 0a20 2020  rrect_nonce(.   
-00015fe0: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
-00015ff0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
-00016000: 2c20 6173 796e 635f 6b65 7966 696c 655f  , async_keyfile_
-00016010: 6163 636f 756e 745f 6164 6472 6573 733a  account_address:
-00016020: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-00016030: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00016040: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00016050: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-00016060: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00016070: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
-00016080: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00016090: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
-000160a0: 2274 6f22 3a20 6173 796e 635f 6b65 7966  "to": async_keyf
-000160b0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-000160c0: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-000160d0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
-000160e0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-000160f0: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
-00016100: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-00016110: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
-00016120: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
-00016130: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00016140: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-00016150: 6572 4761 7322 3a20 6173 796e 635f 7733  erGas": async_w3
-00016160: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
-00016170: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
-00016180: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
-00016190: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-000161a0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-000161b0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-000161c0: 0a20 2020 2020 2020 2074 786e 203d 2061  .        txn = a
-000161d0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-000161e0: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-000161f0: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
-00016200: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
-00016210: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
-00016220: 3d20 6173 796e 635f 7733 2e74 6f5f 7765  = async_w3.to_we
-00016230: 6928 332c 2022 6777 6569 2229 0a20 2020  i(3, "gwei").   
-00016240: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
-00016250: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-00016260: 6572 4761 7322 5d20 3d20 6173 796e 635f  erGas"] = async_
-00016270: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-00016280: 6569 2229 0a20 2020 2020 2020 2074 786e  ei").        txn
-00016290: 5f70 6172 616d 735b 226e 6f6e 6365 225d  _params["nonce"]
-000162a0: 203d 204e 6f6e 6365 2874 786e 5b22 6e6f   = Nonce(txn["no
-000162b0: 6e63 6522 5d20 2b20 3129 0a20 2020 2020  nce"] + 1).     
-000162c0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-000162d0: 6169 7365 7328 5765 6233 5661 6c75 6545  aises(Web3ValueE
-000162e0: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
-000162f0: 2020 2061 7761 6974 2061 7379 6e63 5f77     await async_w
-00016300: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
-00016310: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-00016320: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
-00016330: 0a20 2020 2040 666c 616b 795f 6765 7468  .    @flaky_geth
-00016340: 5f64 6576 5f6d 696e 696e 670a 2020 2020  _dev_mining.    
-00016350: 4070 7974 6573 742e 6d61 726b 2e61 7379  @pytest.mark.asy
-00016360: 6e63 696f 0a20 2020 2061 7379 6e63 2064  ncio.    async d
-00016370: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
-00016380: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
-00016390: 6374 696f 6e5f 6761 735f 7072 6963 655f  ction_gas_price_
-000163a0: 746f 6f5f 6c6f 7728 0a20 2020 2020 2020  too_low(.       
-000163b0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-000163c0: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
-000163d0: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
-000163e0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
-000163f0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-00016400: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-00016410: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-00016420: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-00016430: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-00016440: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00016450: 2020 2020 2266 726f 6d22 3a20 6173 796e      "from": asyn
-00016460: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00016470: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00016480: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00016490: 2022 746f 223a 2061 7379 6e63 5f6b 6579   "to": async_key
-000164a0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000164b0: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
-000164c0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-000164d0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-000164e0: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
-000164f0: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
-00016500: 2020 2022 6761 7350 7269 6365 223a 2061     "gasPrice": a
-00016510: 7379 6e63 5f77 332e 746f 5f77 6569 2832  sync_w3.to_wei(2
-00016520: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
-00016530: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
-00016540: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
-00016550: 796e 635f 7733 2e65 7468 2e73 656e 645f  ync_w3.eth.send_
-00016560: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00016570: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
-00016580: 2074 786e 5f70 6172 616d 735b 2267 6173   txn_params["gas
-00016590: 5072 6963 6522 5d20 3d20 6173 796e 635f  Price"] = async_
-000165a0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-000165b0: 6569 2229 0a20 2020 2020 2020 2077 6974  ei").        wit
-000165c0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-000165d0: 5765 6233 5661 6c75 6545 7272 6f72 293a  Web3ValueError):
-000165e0: 0a20 2020 2020 2020 2020 2020 2061 7761  .            awa
-000165f0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00016600: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
-00016610: 696f 6e28 7478 6e5f 6861 7368 2c20 7478  ion(txn_hash, tx
-00016620: 6e5f 7061 7261 6d73 290a 0a20 2020 2040  n_params)..    @
-00016630: 666c 616b 795f 6765 7468 5f64 6576 5f6d  flaky_geth_dev_m
-00016640: 696e 696e 670a 2020 2020 4070 7974 6573  ining.    @pytes
-00016650: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
-00016660: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
-00016670: 745f 6173 796e 635f 6574 685f 7265 706c  t_async_eth_repl
-00016680: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
-00016690: 6761 735f 7072 6963 655f 6465 6661 756c  gas_price_defaul
-000166a0: 7469 6e67 5f6d 696e 696d 756d 280a 2020  ting_minimum(.  
-000166b0: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
-000166c0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000166d0: 222c 2061 7379 6e63 5f6b 6579 6669 6c65  ", async_keyfile
-000166e0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-000166f0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00016700: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00016710: 0a20 2020 2020 2020 2067 6173 5f70 7269  .        gas_pri
-00016720: 6365 203d 2061 7379 6e63 5f77 332e 746f  ce = async_w3.to
-00016730: 5f77 6569 2831 2c20 2267 7765 6922 290a  _wei(1, "gwei").
-00016740: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00016750: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
-00016760: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-00016770: 726f 6d22 3a20 6173 796e 635f 6b65 7966  rom": async_keyf
-00016780: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00016790: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-000167a0: 2022 746f 223a 2061 7379 6e63 5f6b 6579   "to": async_key
-000167b0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000167c0: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-000167d0: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-000167e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-000167f0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00016800: 2020 2020 2020 2020 2022 6761 7350 7269           "gasPri
-00016810: 6365 223a 2067 6173 5f70 7269 6365 2c0a  ce": gas_price,.
-00016820: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00016830: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
-00016840: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
-00016850: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-00016860: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-00016870: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00016880: 2e70 6f70 2822 6761 7350 7269 6365 2229  .pop("gasPrice")
-00016890: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
-000168a0: 5f74 786e 5f68 6173 6820 3d20 6177 6169  _txn_hash = awai
-000168b0: 7420 6173 796e 635f 7733 2e65 7468 2e72  t async_w3.eth.r
-000168c0: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
-000168d0: 6f6e 2874 786e 5f68 6173 682c 2074 786e  on(txn_hash, txn
-000168e0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-000168f0: 2072 6570 6c61 6365 5f74 786e 203d 2061   replace_txn = a
-00016900: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
-00016910: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00016920: 6e28 7265 706c 6163 655f 7478 6e5f 6861  n(replace_txn_ha
-00016930: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-00016940: 6572 7420 7265 706c 6163 655f 7478 6e5b  ert replace_txn[
-00016950: 2267 6173 5072 6963 6522 5d20 3d3d 206d  "gasPrice"] == m
-00016960: 6174 682e 6365 696c 280a 2020 2020 2020  ath.ceil(.      
-00016970: 2020 2020 2020 6761 735f 7072 6963 6520        gas_price 
-00016980: 2a20 312e 3132 350a 2020 2020 2020 2020  * 1.125.        
-00016990: 2920 2023 206d 696e 696d 756d 2067 6173  )  # minimum gas
-000169a0: 2070 7269 6365 0a0a 2020 2020 4066 6c61   price..    @fla
-000169b0: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
-000169c0: 6e67 0a20 2020 2040 7079 7465 7374 2e6d  ng.    @pytest.m
-000169d0: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
-000169e0: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
-000169f0: 7379 6e63 5f65 7468 5f72 6570 6c61 6365  sync_eth_replace
-00016a00: 5f74 7261 6e73 6163 7469 6f6e 5f67 6173  _transaction_gas
-00016a10: 5f70 7269 6365 5f64 6566 6175 6c74 696e  _price_defaultin
-00016a20: 675f 7374 7261 7465 6779 5f68 6967 6865  g_strategy_highe
-00016a30: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00016a40: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00016a50: 6357 6562 3322 2c20 6173 796e 635f 6b65  cWeb3", async_ke
-00016a60: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00016a70: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-00016a80: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-00016a90: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-00016aa0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
-00016ab0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-00016ac0: 2020 2022 6672 6f6d 223a 2061 7379 6e63     "from": async
-00016ad0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
-00016ae0: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
-00016af0: 2020 2020 2020 2274 6f22 3a20 6173 796e        "to": asyn
-00016b00: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00016b10: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-00016b20: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-00016b30: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-00016b40: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-00016b50: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
-00016b60: 6173 5072 6963 6522 3a20 6173 796e 635f  asPrice": async_
-00016b70: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-00016b80: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
-00016b90: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-00016ba0: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00016bb0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
-00016bc0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-00016bd0: 7329 0a0a 2020 2020 2020 2020 7477 6f5f  s)..        two_
-00016be0: 6777 6569 5f69 6e5f 7765 6920 3d20 6173  gwei_in_wei = as
-00016bf0: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
-00016c00: 2022 6777 6569 2229 0a0a 2020 2020 2020   "gwei")..      
-00016c10: 2020 6465 6620 6869 6768 6572 5f67 6173    def higher_gas
-00016c20: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-00016c30: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
-00016c40: 5765 6233 222c 2074 786e 3a20 5478 5061  Web3", txn: TxPa
-00016c50: 7261 6d73 2920 2d3e 2057 6569 3a0a 2020  rams) -> Wei:.  
-00016c60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016c70: 2074 776f 5f67 7765 695f 696e 5f77 6569   two_gwei_in_wei
-00016c80: 0a0a 2020 2020 2020 2020 6173 796e 635f  ..        async_
-00016c90: 7733 2e65 7468 2e73 6574 5f67 6173 5f70  w3.eth.set_gas_p
-00016ca0: 7269 6365 5f73 7472 6174 6567 7928 6869  rice_strategy(hi
-00016cb0: 6768 6572 5f67 6173 5f70 7269 6365 5f73  gher_gas_price_s
-00016cc0: 7472 6174 6567 7929 0a0a 2020 2020 2020  trategy)..      
-00016cd0: 2020 7478 6e5f 7061 7261 6d73 2e70 6f70    txn_params.pop
-00016ce0: 2822 6761 7350 7269 6365 2229 0a20 2020  ("gasPrice").   
-00016cf0: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
-00016d00: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
-00016d10: 796e 635f 7733 2e65 7468 2e72 6570 6c61  ync_w3.eth.repla
-00016d20: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
-00016d30: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
-00016d40: 616d 7329 0a20 2020 2020 2020 2072 6570  ams).        rep
-00016d50: 6c61 6365 5f74 786e 203d 2061 7761 6974  lace_txn = await
-00016d60: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-00016d70: 745f 7472 616e 7361 6374 696f 6e28 7265  t_transaction(re
-00016d80: 706c 6163 655f 7478 6e5f 6861 7368 290a  place_txn_hash).
-00016d90: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
-00016da0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
-00016db0: 6c61 6365 5f74 786e 5b22 6761 7350 7269  lace_txn["gasPri
-00016dc0: 6365 225d 203d 3d20 7477 6f5f 6777 6569  ce"] == two_gwei
-00016dd0: 5f69 6e5f 7765 690a 2020 2020 2020 2020  _in_wei.        
-00016de0: 2920 2023 2053 7472 6174 6567 7920 7072  )  # Strategy pr
-00016df0: 6f76 6964 6573 2068 6967 6865 7220 6761  ovides higher ga
-00016e00: 7320 7072 6963 650a 2020 2020 2020 2020  s price.        
-00016e10: 6173 796e 635f 7733 2e65 7468 2e73 6574  async_w3.eth.set
-00016e20: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-00016e30: 6567 7928 4e6f 6e65 2920 2023 2072 6573  egy(None)  # res
-00016e40: 6574 2073 7472 6174 6567 790a 0a20 2020  et strategy..   
-00016e50: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-00016e60: 5f6d 696e 696e 670a 2020 2020 4070 7974  _mining.    @pyt
-00016e70: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
-00016e80: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
-00016e90: 6573 745f 6173 796e 635f 6574 685f 7265  est_async_eth_re
-00016ea0: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00016eb0: 6e5f 6761 735f 7072 6963 655f 6465 6661  n_gas_price_defa
-00016ec0: 756c 7469 6e67 5f73 7472 6174 6567 795f  ulting_strategy_
-00016ed0: 6c6f 7765 7228 0a20 2020 2020 2020 2073  lower(.        s
-00016ee0: 656c 662c 2061 7379 6e63 5f77 333a 2022  elf, async_w3: "
-00016ef0: 4173 796e 6357 6562 3322 2c20 6173 796e  AsyncWeb3", asyn
-00016f00: 635f 6b65 7966 696c 655f 6163 636f 756e  c_keyfile_accoun
-00016f10: 745f 6164 6472 6573 733a 2043 6865 636b  t_address: Check
-00016f20: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-00016f30: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00016f40: 2020 6761 735f 7072 6963 6520 3d20 6173    gas_price = as
-00016f50: 796e 635f 7733 2e74 6f5f 7765 6928 322c  ync_w3.to_wei(2,
-00016f60: 2022 6777 6569 2229 0a0a 2020 2020 2020   "gwei")..      
-00016f70: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-00016f80: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-00016f90: 2020 2020 2020 2022 6672 6f6d 223a 2061         "from": a
-00016fa0: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
-00016fb0: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
-00016fc0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
-00016fd0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
-00016fe0: 636f 756e 745f 6164 6472 6573 732c 0a20  count_address,. 
-00016ff0: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-00017000: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-00017010: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-00017020: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-00017030: 2020 2267 6173 5072 6963 6522 3a20 6761    "gasPrice": ga
-00017040: 735f 7072 6963 652c 0a20 2020 2020 2020  s_price,.       
-00017050: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
-00017060: 6173 6820 3d20 6177 6169 7420 6173 796e  ash = await asyn
-00017070: 635f 7733 2e65 7468 2e73 656e 645f 7472  c_w3.eth.send_tr
-00017080: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-00017090: 7261 6d73 290a 0a20 2020 2020 2020 2064  rams)..        d
-000170a0: 6566 206c 6f77 6572 5f67 6173 5f70 7269  ef lower_gas_pri
-000170b0: 6365 5f73 7472 6174 6567 7928 6173 796e  ce_strategy(asyn
-000170c0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
-000170d0: 222c 2074 786e 3a20 5478 5061 7261 6d73  ", txn: TxParams
-000170e0: 2920 2d3e 2057 6569 3a0a 2020 2020 2020  ) -> Wei:.      
-000170f0: 2020 2020 2020 7265 7475 726e 2061 7379        return asy
-00017100: 6e63 5f77 332e 746f 5f77 6569 2831 2c20  nc_w3.to_wei(1, 
-00017110: 2267 7765 6922 290a 0a20 2020 2020 2020  "gwei")..       
-00017120: 2061 7379 6e63 5f77 332e 6574 682e 7365   async_w3.eth.se
-00017130: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
-00017140: 7465 6779 286c 6f77 6572 5f67 6173 5f70  tegy(lower_gas_p
-00017150: 7269 6365 5f73 7472 6174 6567 7929 0a0a  rice_strategy)..
-00017160: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00017170: 6d73 2e70 6f70 2822 6761 7350 7269 6365  ms.pop("gasPrice
-00017180: 2229 0a20 2020 2020 2020 2072 6570 6c61  ").        repla
-00017190: 6365 5f74 786e 5f68 6173 6820 3d20 6177  ce_txn_hash = aw
-000171a0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
-000171b0: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
-000171c0: 7469 6f6e 2874 786e 5f68 6173 682c 2074  tion(txn_hash, t
-000171d0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
-000171e0: 2020 2072 6570 6c61 6365 5f74 786e 203d     replace_txn =
-000171f0: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
-00017200: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
-00017210: 696f 6e28 7265 706c 6163 655f 7478 6e5f  ion(replace_txn_
-00017220: 6861 7368 290a 2020 2020 2020 2020 2320  hash).        # 
-00017230: 5374 7261 7465 6779 2070 726f 7669 6465  Strategy provide
-00017240: 7320 6c6f 7765 7220 6761 7320 7072 6963  s lower gas pric
-00017250: 6520 2d20 6d69 6e69 6d75 6d20 7072 6566  e - minimum pref
-00017260: 6572 7265 640a 2020 2020 2020 2020 6173  erred.        as
-00017270: 7365 7274 2072 6570 6c61 6365 5f74 786e  sert replace_txn
-00017280: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
-00017290: 6d61 7468 2e63 6569 6c28 6761 735f 7072  math.ceil(gas_pr
-000172a0: 6963 6520 2a20 312e 3132 3529 0a20 2020  ice * 1.125).   
-000172b0: 2020 2020 2061 7379 6e63 5f77 332e 6574       async_w3.et
-000172c0: 682e 7365 745f 6761 735f 7072 6963 655f  h.set_gas_price_
-000172d0: 7374 7261 7465 6779 284e 6f6e 6529 2020  strategy(None)  
-000172e0: 2320 7265 7365 7420 7374 7261 7465 6779  # reset strategy
-000172f0: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-00017300: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
-00017310: 7379 6e63 2064 6566 2074 6573 745f 6173  sync def test_as
-00017320: 796e 635f 6574 685f 6e65 775f 6669 6c74  ync_eth_new_filt
-00017330: 6572 2873 656c 662c 2061 7379 6e63 5f77  er(self, async_w
-00017340: 333a 2022 4173 796e 6357 6562 3322 2920  3: "AsyncWeb3") 
-00017350: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00017360: 2066 696c 7465 7220 3d20 6177 6169 7420   filter = await 
-00017370: 6173 796e 635f 7733 2e65 7468 2e66 696c  async_w3.eth.fil
-00017380: 7465 7228 7b7d 290a 0a20 2020 2020 2020  ter({})..       
-00017390: 2063 6861 6e67 6573 203d 2061 7761 6974   changes = await
-000173a0: 2061 7379 6e63 5f77 332e 6574 682e 6765   async_w3.eth.ge
-000173b0: 745f 6669 6c74 6572 5f63 6861 6e67 6573  t_filter_changes
-000173c0: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-000173d0: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
-000173e0: 7420 6973 5f6c 6973 745f 6c69 6b65 2863  t is_list_like(c
-000173f0: 6861 6e67 6573 290a 2020 2020 2020 2020  hanges).        
-00017400: 6173 7365 7274 206e 6f74 2063 6861 6e67  assert not chang
-00017410: 6573 0a0a 2020 2020 2020 2020 6c6f 6773  es..        logs
-00017420: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00017430: 332e 6574 682e 6765 745f 6669 6c74 6572  3.eth.get_filter
-00017440: 5f6c 6f67 7328 6669 6c74 6572 2e66 696c  _logs(filter.fil
-00017450: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
-00017460: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
-00017470: 696b 6528 6c6f 6773 290a 2020 2020 2020  ike(logs).      
-00017480: 2020 6173 7365 7274 206e 6f74 206c 6f67    assert not log
-00017490: 730a 0a20 2020 2020 2020 2072 6573 756c  s..        resul
-000174a0: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-000174b0: 7733 2e65 7468 2e75 6e69 6e73 7461 6c6c  w3.eth.uninstall
-000174c0: 5f66 696c 7465 7228 6669 6c74 6572 2e66  _filter(filter.f
-000174d0: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
-000174e0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
-000174f0: 6973 2054 7275 650a 0a20 2020 2040 7079  is True..    @py
-00017500: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00017510: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-00017520: 7465 7374 5f61 7379 6e63 5f65 7468 5f6e  test_async_eth_n
-00017530: 6577 5f62 6c6f 636b 5f66 696c 7465 7228  ew_block_filter(
-00017540: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-00017550: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-00017560: 4e6f 6e65 3a0a 2020 2020 2020 2020 6669  None:.        fi
-00017570: 6c74 6572 203d 2061 7761 6974 2061 7379  lter = await asy
-00017580: 6e63 5f77 332e 6574 682e 6669 6c74 6572  nc_w3.eth.filter
-00017590: 2822 6c61 7465 7374 2229 0a20 2020 2020  ("latest").     
-000175a0: 2020 2061 7373 6572 7420 6973 5f73 7472     assert is_str
-000175b0: 696e 6728 6669 6c74 6572 2e66 696c 7465  ing(filter.filte
-000175c0: 725f 6964 290a 0a20 2020 2020 2020 2063  r_id)..        c
-000175d0: 6861 6e67 6573 203d 2061 7761 6974 2061  hanges = await a
-000175e0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
-000175f0: 6669 6c74 6572 5f63 6861 6e67 6573 2866  filter_changes(f
-00017600: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
-00017610: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00017620: 6973 5f6c 6973 745f 6c69 6b65 2863 6861  is_list_like(cha
-00017630: 6e67 6573 290a 0a20 2020 2020 2020 2072  nges)..        r
-00017640: 6573 756c 7420 3d20 6177 6169 7420 6173  esult = await as
-00017650: 796e 635f 7733 2e65 7468 2e75 6e69 6e73  ync_w3.eth.unins
-00017660: 7461 6c6c 5f66 696c 7465 7228 6669 6c74  tall_filter(filt
-00017670: 6572 2e66 696c 7465 725f 6964 290a 2020  er.filter_id).  
-00017680: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
-00017690: 756c 7420 6973 2054 7275 650a 0a20 2020  ult is True..   
-000176a0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
-000176b0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
-000176c0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
-000176d0: 7468 5f6e 6577 5f70 656e 6469 6e67 5f74  th_new_pending_t
-000176e0: 7261 6e73 6163 7469 6f6e 5f66 696c 7465  ransaction_filte
-000176f0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00017700: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
-00017710: 6357 6562 3322 0a20 2020 2029 202d 3e20  cWeb3".    ) -> 
-00017720: 4e6f 6e65 3a0a 2020 2020 2020 2020 6669  None:.        fi
-00017730: 6c74 6572 203d 2061 7761 6974 2061 7379  lter = await asy
-00017740: 6e63 5f77 332e 6574 682e 6669 6c74 6572  nc_w3.eth.filter
-00017750: 2822 7065 6e64 696e 6722 290a 2020 2020  ("pending").    
-00017760: 2020 2020 6173 7365 7274 2069 735f 7374      assert is_st
-00017770: 7269 6e67 2866 696c 7465 722e 6669 6c74  ring(filter.filt
-00017780: 6572 5f69 6429 0a0a 2020 2020 2020 2020  er_id)..        
-00017790: 6368 616e 6765 7320 3d20 6177 6169 7420  changes = await 
-000177a0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
-000177b0: 5f66 696c 7465 725f 6368 616e 6765 7328  _filter_changes(
-000177c0: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
-000177d0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000177e0: 2069 735f 6c69 7374 5f6c 696b 6528 6368   is_list_like(ch
-000177f0: 616e 6765 7329 0a20 2020 2020 2020 2061  anges).        a
-00017800: 7373 6572 7420 6e6f 7420 6368 616e 6765  ssert not change
-00017810: 730a 0a20 2020 2020 2020 2072 6573 756c  s..        resul
-00017820: 7420 3d20 6177 6169 7420 6173 796e 635f  t = await async_
-00017830: 7733 2e65 7468 2e75 6e69 6e73 7461 6c6c  w3.eth.uninstall
-00017840: 5f66 696c 7465 7228 6669 6c74 6572 2e66  _filter(filter.f
-00017850: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
-00017860: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
-00017870: 6973 2054 7275 650a 0a20 2020 2040 7079  is True..    @py
-00017880: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
-00017890: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
-000178a0: 7465 7374 5f61 7379 6e63 5f65 7468 5f75  test_async_eth_u
-000178b0: 6e69 6e73 7461 6c6c 5f66 696c 7465 7228  ninstall_filter(
-000178c0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
-000178d0: 2241 7379 6e63 5765 6233 2229 202d 3e20  "AsyncWeb3") -> 
-000178e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6669  None:.        fi
-000178f0: 6c74 6572 203d 2061 7761 6974 2061 7379  lter = await asy
-00017900: 6e63 5f77 332e 6574 682e 6669 6c74 6572  nc_w3.eth.filter
-00017910: 287b 7d29 0a20 2020 2020 2020 2061 7373  ({}).        ass
-00017920: 6572 7420 6973 5f73 7472 696e 6728 6669  ert is_string(fi
-00017930: 6c74 6572 2e66 696c 7465 725f 6964 290a  lter.filter_id).
-00017940: 0a20 2020 2020 2020 2073 7563 6365 7373  .        success
-00017950: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
-00017960: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
-00017970: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
-00017980: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
-00017990: 2061 7373 6572 7420 7375 6363 6573 7320   assert success 
-000179a0: 6973 2054 7275 650a 0a20 2020 2020 2020  is True..       
-000179b0: 2066 6169 6c75 7265 203d 2061 7761 6974   failure = await
-000179c0: 2061 7379 6e63 5f77 332e 6574 682e 756e   async_w3.eth.un
-000179d0: 696e 7374 616c 6c5f 6669 6c74 6572 2866  install_filter(f
-000179e0: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
-000179f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00017a00: 6661 696c 7572 6520 6973 2046 616c 7365  failure is False
-00017a10: 0a0a 0a63 6c61 7373 2045 7468 4d6f 6475  ...class EthModu
-00017a20: 6c65 5465 7374 3a0a 2020 2020 6465 6620  leTest:.    def 
-00017a30: 7465 7374 5f65 7468 5f73 796e 6369 6e67  test_eth_syncing
-00017a40: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
-00017a50: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-00017a60: 2020 2020 7379 6e63 696e 6720 3d20 7733      syncing = w3
-00017a70: 2e65 7468 2e73 796e 6369 6e67 0a0a 2020  .eth.syncing..  
-00017a80: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00017a90: 626f 6f6c 6561 6e28 7379 6e63 696e 6729  boolean(syncing)
-00017aa0: 206f 7220 6973 5f64 6963 7428 7379 6e63   or is_dict(sync
-00017ab0: 696e 6729 0a0a 2020 2020 2020 2020 6966  ing)..        if
-00017ac0: 2069 735f 626f 6f6c 6561 6e28 7379 6e63   is_boolean(sync
-00017ad0: 696e 6729 3a0a 2020 2020 2020 2020 2020  ing):.          
-00017ae0: 2020 6173 7365 7274 2073 796e 6369 6e67    assert syncing
-00017af0: 2069 7320 4661 6c73 650a 2020 2020 2020   is False.      
-00017b00: 2020 656c 6966 2069 735f 6469 6374 2873    elif is_dict(s
-00017b10: 796e 6369 6e67 293a 0a20 2020 2020 2020  yncing):.       
-00017b20: 2020 2020 2073 796e 635f 6469 6374 203d       sync_dict =
-00017b30: 2063 6173 7428 5379 6e63 5374 6174 7573   cast(SyncStatus
-00017b40: 2c20 7379 6e63 696e 6729 0a20 2020 2020  , syncing).     
-00017b50: 2020 2020 2020 2061 7373 6572 7420 2273         assert "s
-00017b60: 7461 7274 696e 6742 6c6f 636b 2220 696e  tartingBlock" in
-00017b70: 2073 796e 635f 6469 6374 0a20 2020 2020   sync_dict.     
-00017b80: 2020 2020 2020 2061 7373 6572 7420 2263         assert "c
-00017b90: 7572 7265 6e74 426c 6f63 6b22 2069 6e20  urrentBlock" in 
-00017ba0: 7379 6e63 5f64 6963 740a 2020 2020 2020  sync_dict.      
-00017bb0: 2020 2020 2020 6173 7365 7274 2022 6869        assert "hi
-00017bc0: 6768 6573 7442 6c6f 636b 2220 696e 2073  ghestBlock" in s
-00017bd0: 796e 635f 6469 6374 0a0a 2020 2020 2020  ync_dict..      
-00017be0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
-00017bf0: 696e 7465 6765 7228 7379 6e63 5f64 6963  integer(sync_dic
-00017c00: 745b 2273 7461 7274 696e 6742 6c6f 636b  t["startingBlock
-00017c10: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00017c20: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00017c30: 7228 7379 6e63 5f64 6963 745b 2263 7572  r(sync_dict["cur
-00017c40: 7265 6e74 426c 6f63 6b22 5d29 0a20 2020  rentBlock"]).   
-00017c50: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00017c60: 6973 5f69 6e74 6567 6572 2873 796e 635f  is_integer(sync_
-00017c70: 6469 6374 5b22 6869 6768 6573 7442 6c6f  dict["highestBlo
-00017c80: 636b 225d 290a 0a20 2020 2064 6566 2074  ck"])..    def t
-00017c90: 6573 745f 6574 685f 636f 696e 6261 7365  est_eth_coinbase
-00017ca0: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
-00017cb0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
-00017cc0: 2020 2020 636f 696e 6261 7365 203d 2077      coinbase = w
-00017cd0: 332e 6574 682e 636f 696e 6261 7365 0a20  3.eth.coinbase. 
-00017ce0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00017cf0: 5f63 6865 636b 7375 6d5f 6164 6472 6573  _checksum_addres
-00017d00: 7328 636f 696e 6261 7365 290a 0a20 2020  s(coinbase)..   
-00017d10: 2064 6566 2074 6573 745f 6574 685f 6d69   def test_eth_mi
-00017d20: 6e69 6e67 2873 656c 662c 2077 333a 2022  ning(self, w3: "
-00017d30: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-00017d40: 2020 2020 2020 2020 6d69 6e69 6e67 203d          mining =
-00017d50: 2077 332e 6574 682e 6d69 6e69 6e67 0a20   w3.eth.mining. 
-00017d60: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00017d70: 5f62 6f6f 6c65 616e 286d 696e 696e 6729  _boolean(mining)
-00017d80: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-00017d90: 7468 5f68 6173 6872 6174 6528 7365 6c66  th_hashrate(self
-00017da0: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
-00017db0: 204e 6f6e 653a 0a20 2020 2020 2020 2068   None:.        h
-00017dc0: 6173 6872 6174 6520 3d20 7733 2e65 7468  ashrate = w3.eth
-00017dd0: 2e68 6173 6872 6174 650a 2020 2020 2020  .hashrate.      
-00017de0: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-00017df0: 6765 7228 6861 7368 7261 7465 290a 2020  ger(hashrate).  
-00017e00: 2020 2020 2020 6173 7365 7274 2068 6173        assert has
-00017e10: 6872 6174 6520 3e3d 2030 0a0a 2020 2020  hrate >= 0..    
-00017e20: 6465 6620 7465 7374 5f65 7468 5f63 6861  def test_eth_cha
-00017e30: 696e 5f69 6428 7365 6c66 2c20 7733 3a20  in_id(self, w3: 
-00017e40: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-00017e50: 0a20 2020 2020 2020 2063 6861 696e 5f69  .        chain_i
-00017e60: 6420 3d20 7733 2e65 7468 2e63 6861 696e  d = w3.eth.chain
-00017e70: 5f69 640a 2020 2020 2020 2020 2320 6368  _id.        # ch
-00017e80: 6169 6e20 6964 2076 616c 7565 2066 726f  ain id value fro
-00017e90: 6d20 6765 7468 2066 6978 7475 7265 2067  m geth fixture g
-00017ea0: 656e 6573 6973 2066 696c 650a 2020 2020  enesis file.    
-00017eb0: 2020 2020 6173 7365 7274 2063 6861 696e      assert chain
-00017ec0: 5f69 6420 3d3d 2031 3331 3237 3733 3232  _id == 131277322
-00017ed0: 3934 3035 3337 0a0a 2020 2020 6465 6620  940537..    def 
-00017ee0: 7465 7374 5f65 7468 5f66 6565 5f68 6973  test_eth_fee_his
-00017ef0: 746f 7279 2873 656c 662c 2077 333a 2022  tory(self, w3: "
-00017f00: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-00017f10: 2020 2020 2020 2020 6665 655f 6869 7374          fee_hist
-00017f20: 6f72 7920 3d20 7733 2e65 7468 2e66 6565  ory = w3.eth.fee
-00017f30: 5f68 6973 746f 7279 2831 2c20 226c 6174  _history(1, "lat
-00017f40: 6573 7422 2c20 5b35 305d 290a 2020 2020  est", [50]).    
-00017f50: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
-00017f60: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
-00017f70: 6f72 795b 2262 6173 6546 6565 5065 7247  ory["baseFeePerG
-00017f80: 6173 225d 290a 2020 2020 2020 2020 6173  as"]).        as
-00017f90: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
-00017fa0: 6528 6665 655f 6869 7374 6f72 795b 2267  e(fee_history["g
-00017fb0: 6173 5573 6564 5261 7469 6f22 5d29 0a20  asUsedRatio"]). 
-00017fc0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00017fd0: 5f69 6e74 6567 6572 2866 6565 5f68 6973  _integer(fee_his
-00017fe0: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
-00017ff0: 6b22 5d29 0a20 2020 2020 2020 2061 7373  k"]).        ass
-00018000: 6572 7420 6665 655f 6869 7374 6f72 795b  ert fee_history[
-00018010: 226f 6c64 6573 7442 6c6f 636b 225d 203e  "oldestBlock"] >
-00018020: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-00018030: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-00018040: 6665 655f 6869 7374 6f72 795b 2272 6577  fee_history["rew
-00018050: 6172 6422 5d29 0a20 2020 2020 2020 2069  ard"]).        i
-00018060: 6620 6c65 6e28 6665 655f 6869 7374 6f72  f len(fee_histor
-00018070: 795b 2272 6577 6172 6422 5d29 203e 2030  y["reward"]) > 0
-00018080: 3a0a 2020 2020 2020 2020 2020 2020 6173  :.            as
-00018090: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
-000180a0: 6528 6665 655f 6869 7374 6f72 795b 2272  e(fee_history["r
-000180b0: 6577 6172 6422 5d5b 305d 290a 0a20 2020  eward"][0])..   
-000180c0: 2064 6566 2074 6573 745f 6574 685f 6665   def test_eth_fe
-000180d0: 655f 6869 7374 6f72 795f 7769 7468 5f69  e_history_with_i
-000180e0: 6e74 6567 6572 280a 2020 2020 2020 2020  nteger(.        
-000180f0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00018100: 2c20 656d 7074 795f 626c 6f63 6b3a 2042  , empty_block: B
-00018110: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-00018120: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00018130: 6665 655f 6869 7374 6f72 7920 3d20 7733  fee_history = w3
-00018140: 2e65 7468 2e66 6565 5f68 6973 746f 7279  .eth.fee_history
-00018150: 2831 2c20 656d 7074 795f 626c 6f63 6b5b  (1, empty_block[
-00018160: 226e 756d 6265 7222 5d2c 205b 3530 5d29  "number"], [50])
-00018170: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00018180: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
-00018190: 5f68 6973 746f 7279 5b22 6261 7365 4665  _history["baseFe
-000181a0: 6550 6572 4761 7322 5d29 0a20 2020 2020  ePerGas"]).     
-000181b0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
-000181c0: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
-000181d0: 7279 5b22 6761 7355 7365 6452 6174 696f  ry["gasUsedRatio
-000181e0: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
-000181f0: 7274 2069 735f 696e 7465 6765 7228 6665  rt is_integer(fe
-00018200: 655f 6869 7374 6f72 795b 226f 6c64 6573  e_history["oldes
-00018210: 7442 6c6f 636b 225d 290a 2020 2020 2020  tBlock"]).      
-00018220: 2020 6173 7365 7274 2066 6565 5f68 6973    assert fee_his
-00018230: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
-00018240: 6b22 5d20 3e3d 2030 0a20 2020 2020 2020  k"] >= 0.       
-00018250: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-00018260: 6c69 6b65 2866 6565 5f68 6973 746f 7279  like(fee_history
-00018270: 5b22 7265 7761 7264 225d 290a 2020 2020  ["reward"]).    
-00018280: 2020 2020 6966 206c 656e 2866 6565 5f68      if len(fee_h
-00018290: 6973 746f 7279 5b22 7265 7761 7264 225d  istory["reward"]
-000182a0: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
-000182b0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
-000182c0: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
-000182d0: 7279 5b22 7265 7761 7264 225d 5b30 5d29  ry["reward"][0])
-000182e0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-000182f0: 7468 5f66 6565 5f68 6973 746f 7279 5f6e  th_fee_history_n
-00018300: 6f5f 7265 7761 7264 5f70 6572 6365 6e74  o_reward_percent
-00018310: 696c 6573 2873 656c 662c 2077 333a 2022  iles(self, w3: "
-00018320: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
-00018330: 2020 2020 2020 2020 6665 655f 6869 7374          fee_hist
-00018340: 6f72 7920 3d20 7733 2e65 7468 2e66 6565  ory = w3.eth.fee
-00018350: 5f68 6973 746f 7279 2831 2c20 226c 6174  _history(1, "lat
-00018360: 6573 7422 290a 2020 2020 2020 2020 6173  est").        as
-00018370: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
-00018380: 6528 6665 655f 6869 7374 6f72 795b 2262  e(fee_history["b
-00018390: 6173 6546 6565 5065 7247 6173 225d 290a  aseFeePerGas"]).
-000183a0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000183b0: 735f 6c69 7374 5f6c 696b 6528 6665 655f  s_list_like(fee_
-000183c0: 6869 7374 6f72 795b 2267 6173 5573 6564  history["gasUsed
-000183d0: 5261 7469 6f22 5d29 0a20 2020 2020 2020  Ratio"]).       
-000183e0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-000183f0: 6572 2866 6565 5f68 6973 746f 7279 5b22  er(fee_history["
-00018400: 6f6c 6465 7374 426c 6f63 6b22 5d29 0a20  oldestBlock"]). 
-00018410: 2020 2020 2020 2061 7373 6572 7420 6665         assert fe
-00018420: 655f 6869 7374 6f72 795b 226f 6c64 6573  e_history["oldes
-00018430: 7442 6c6f 636b 225d 203e 3d20 300a 0a20  tBlock"] >= 0.. 
-00018440: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00018450: 6761 735f 7072 6963 6528 7365 6c66 2c20  gas_price(self, 
-00018460: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
-00018470: 6f6e 653a 0a20 2020 2020 2020 2067 6173  one:.        gas
-00018480: 5f70 7269 6365 203d 2077 332e 6574 682e  _price = w3.eth.
-00018490: 6761 735f 7072 6963 650a 2020 2020 2020  gas_price.      
-000184a0: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-000184b0: 6765 7228 6761 735f 7072 6963 6529 0a20  ger(gas_price). 
-000184c0: 2020 2020 2020 2061 7373 6572 7420 6761         assert ga
-000184d0: 735f 7072 6963 6520 3e20 300a 0a20 2020  s_price > 0..   
-000184e0: 2064 6566 2074 6573 745f 6574 685f 6d61   def test_eth_ma
-000184f0: 785f 7072 696f 7269 7479 5f66 6565 2873  x_priority_fee(s
-00018500: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
-00018510: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00018520: 2020 6d61 785f 7072 696f 7269 7479 5f66    max_priority_f
-00018530: 6565 203d 2077 332e 6574 682e 6d61 785f  ee = w3.eth.max_
-00018540: 7072 696f 7269 7479 5f66 6565 0a20 2020  priority_fee.   
-00018550: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
-00018560: 6e74 6567 6572 286d 6178 5f70 7269 6f72  nteger(max_prior
-00018570: 6974 795f 6665 6529 0a0a 2020 2020 6465  ity_fee)..    de
-00018580: 6620 7465 7374 5f65 7468 5f6d 6178 5f70  f test_eth_max_p
-00018590: 7269 6f72 6974 795f 6665 655f 7769 7468  riority_fee_with
-000185a0: 5f66 6565 5f68 6973 746f 7279 5f63 616c  _fee_history_cal
-000185b0: 6375 6c61 7469 6f6e 280a 2020 2020 2020  culation(.      
-000185c0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-000185d0: 3322 2c20 7265 7175 6573 745f 6d6f 636b  3", request_mock
-000185e0: 6572 3a20 5479 7065 5b52 6571 7565 7374  er: Type[Request
-000185f0: 4d6f 636b 6572 5d0a 2020 2020 2920 2d3e  Mocker].    ) ->
-00018600: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
-00018610: 6974 6820 7265 7175 6573 745f 6d6f 636b  ith request_mock
-00018620: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
-00018630: 7733 2c0a 2020 2020 2020 2020 2020 2020  w3,.            
-00018640: 6d6f 636b 5f65 7272 6f72 733d 7b52 5043  mock_errors={RPC
-00018650: 456e 6470 6f69 6e74 2822 6574 685f 6d61  Endpoint("eth_ma
-00018660: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00018670: 6173 2229 3a20 7b7d 7d2c 0a20 2020 2020  as"): {}},.     
-00018680: 2020 2020 2020 206d 6f63 6b5f 7265 7375         mock_resu
-00018690: 6c74 733d 7b52 5043 456e 6470 6f69 6e74  lts={RPCEndpoint
-000186a0: 2822 6574 685f 6665 6548 6973 746f 7279  ("eth_feeHistory
-000186b0: 2229 3a20 7b22 7265 7761 7264 223a 205b  "): {"reward": [
-000186c0: 5b30 5d5d 7d7d 2c0a 2020 2020 2020 2020  [0]]}},.        
-000186d0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-000186e0: 6974 6820 7079 7465 7374 2e77 6172 6e73  ith pytest.warns
-000186f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00018700: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
-00018710: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00018720: 6174 6368 3d28 0a20 2020 2020 2020 2020  atch=(.         
-00018730: 2020 2020 2020 2020 2020 2022 5468 6572             "Ther
-00018740: 6520 7761 7320 616e 2069 7373 7565 2077  e was an issue w
-00018750: 6974 6820 7468 6520 6d65 7468 6f64 2065  ith the method e
-00018760: 7468 5f6d 6178 5072 696f 7269 7479 4665  th_maxPriorityFe
-00018770: 6550 6572 4761 732e 2022 0a20 2020 2020  ePerGas. ".     
-00018780: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00018790: 4361 6c63 756c 6174 696e 6720 7573 696e  Calculating usin
-000187a0: 6720 6574 685f 6665 6548 6973 746f 7279  g eth_feeHistory
-000187b0: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
-000187c0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-000187d0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000187e0: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
-000187f0: 795f 6665 6520 3d20 7733 2e65 7468 2e6d  y_fee = w3.eth.m
-00018800: 6178 5f70 7269 6f72 6974 795f 6665 650a  ax_priority_fee.
-00018810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018820: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00018830: 7228 6d61 785f 7072 696f 7269 7479 5f66  r(max_priority_f
-00018840: 6565 290a 2020 2020 2020 2020 2020 2020  ee).            
-00018850: 2020 2020 6173 7365 7274 206d 6178 5f70      assert max_p
-00018860: 7269 6f72 6974 795f 6665 6520 3d3d 2050  riority_fee == P
-00018870: 5249 4f52 4954 595f 4645 455f 4d49 4e0a  RIORITY_FEE_MIN.
-00018880: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00018890: 685f 6163 636f 756e 7473 2873 656c 662c  h_accounts(self,
-000188a0: 2077 333a 2022 5765 6233 2229 202d 3e20   w3: "Web3") -> 
-000188b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6163  None:.        ac
-000188c0: 636f 756e 7473 203d 2077 332e 6574 682e  counts = w3.eth.
-000188d0: 6163 636f 756e 7473 0a20 2020 2020 2020  accounts.       
-000188e0: 2061 7373 6572 7420 6973 5f6c 6973 745f   assert is_list_
-000188f0: 6c69 6b65 2861 6363 6f75 6e74 7329 0a20  like(accounts). 
-00018900: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-00018910: 6e28 6163 636f 756e 7473 2920 213d 2030  n(accounts) != 0
-00018920: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00018930: 616c 6c28 6973 5f63 6865 636b 7375 6d5f  all(is_checksum_
-00018940: 6164 6472 6573 7328 6163 636f 756e 7429  address(account)
-00018950: 2066 6f72 2061 6363 6f75 6e74 2069 6e20   for account in 
-00018960: 6163 636f 756e 7473 290a 2020 2020 2020  accounts).      
-00018970: 2020 6173 7365 7274 2077 332e 6574 682e    assert w3.eth.
-00018980: 636f 696e 6261 7365 2069 6e20 6163 636f  coinbase in acco
-00018990: 756e 7473 0a0a 2020 2020 6465 6620 7465  unts..    def te
-000189a0: 7374 5f65 7468 5f62 6c6f 636b 5f6e 756d  st_eth_block_num
-000189b0: 6265 7228 7365 6c66 2c20 7733 3a20 2257  ber(self, w3: "W
-000189c0: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-000189d0: 2020 2020 2020 2062 6c6f 636b 5f6e 756d         block_num
-000189e0: 6265 7220 3d20 7733 2e65 7468 2e62 6c6f  ber = w3.eth.blo
-000189f0: 636b 5f6e 756d 6265 720a 2020 2020 2020  ck_number.      
-00018a00: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-00018a10: 6765 7228 626c 6f63 6b5f 6e75 6d62 6572  ger(block_number
-00018a20: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00018a30: 2062 6c6f 636b 5f6e 756d 6265 7220 3e3d   block_number >=
-00018a40: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
-00018a50: 5f65 7468 5f67 6574 5f62 6c6f 636b 5f6e  _eth_get_block_n
-00018a60: 756d 6265 7228 7365 6c66 2c20 7733 3a20  umber(self, w3: 
-00018a70: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-00018a80: 0a20 2020 2020 2020 2062 6c6f 636b 5f6e  .        block_n
-00018a90: 756d 6265 7220 3d20 7733 2e65 7468 2e67  umber = w3.eth.g
-00018aa0: 6574 5f62 6c6f 636b 5f6e 756d 6265 7228  et_block_number(
-00018ab0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00018ac0: 2069 735f 696e 7465 6765 7228 626c 6f63   is_integer(bloc
-00018ad0: 6b5f 6e75 6d62 6572 290a 2020 2020 2020  k_number).      
-00018ae0: 2020 6173 7365 7274 2062 6c6f 636b 5f6e    assert block_n
-00018af0: 756d 6265 7220 3e3d 2030 0a0a 2020 2020  umber >= 0..    
-00018b00: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00018b10: 5f62 616c 616e 6365 2873 656c 662c 2077  _balance(self, w
-00018b20: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
-00018b30: 6e65 3a0a 2020 2020 2020 2020 636f 696e  ne:.        coin
-00018b40: 6261 7365 203d 2077 332e 6574 682e 636f  base = w3.eth.co
-00018b50: 696e 6261 7365 0a0a 2020 2020 2020 2020  inbase..        
-00018b60: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00018b70: 6573 2849 6e76 616c 6964 4164 6472 6573  es(InvalidAddres
-00018b80: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00018b90: 7733 2e65 7468 2e67 6574 5f62 616c 616e  w3.eth.get_balan
-00018ba0: 6365 2843 6865 636b 7375 6d41 6464 7265  ce(ChecksumAddre
-00018bb0: 7373 2848 6578 4164 6472 6573 7328 4865  ss(HexAddress(He
-00018bc0: 7853 7472 2863 6f69 6e62 6173 652e 6c6f  xStr(coinbase.lo
-00018bd0: 7765 7228 2929 2929 290a 0a20 2020 2020  wer()))))..     
-00018be0: 2020 2062 616c 616e 6365 203d 2077 332e     balance = w3.
-00018bf0: 6574 682e 6765 745f 6261 6c61 6e63 6528  eth.get_balance(
-00018c00: 636f 696e 6261 7365 290a 0a20 2020 2020  coinbase)..     
-00018c10: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00018c20: 6567 6572 2862 616c 616e 6365 290a 2020  eger(balance).  
-00018c30: 2020 2020 2020 6173 7365 7274 2062 616c        assert bal
-00018c40: 616e 6365 203e 3d20 300a 0a20 2020 2064  ance >= 0..    d
-00018c50: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-00018c60: 6261 6c61 6e63 655f 7769 7468 5f62 6c6f  balance_with_blo
-00018c70: 636b 5f69 6465 6e74 6966 6965 7228 7365  ck_identifier(se
-00018c80: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
-00018c90: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00018ca0: 206d 696e 6572 5f61 6464 7265 7373 203d   miner_address =
-00018cb0: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
-00018cc0: 6b28 3129 5b22 6d69 6e65 7222 5d0a 2020  k(1)["miner"].  
-00018cd0: 2020 2020 2020 6261 6c61 6e63 655f 706f        balance_po
-00018ce0: 7374 5f67 656e 6573 6973 203d 2077 332e  st_genesis = w3.
-00018cf0: 6574 682e 6765 745f 6261 6c61 6e63 6528  eth.get_balance(
-00018d00: 6d69 6e65 725f 6164 6472 6573 732c 2031  miner_address, 1
-00018d10: 290a 2020 2020 2020 2020 6c61 7465 725f  ).        later_
-00018d20: 6261 6c61 6e63 6520 3d20 7733 2e65 7468  balance = w3.eth
-00018d30: 2e67 6574 5f62 616c 616e 6365 286d 696e  .get_balance(min
-00018d40: 6572 5f61 6464 7265 7373 2c20 226c 6174  er_address, "lat
-00018d50: 6573 7422 290a 0a20 2020 2020 2020 2061  est")..        a
-00018d60: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-00018d70: 2862 616c 616e 6365 5f70 6f73 745f 6765  (balance_post_ge
-00018d80: 6e65 7369 7329 0a20 2020 2020 2020 2061  nesis).        a
-00018d90: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-00018da0: 286c 6174 6572 5f62 616c 616e 6365 290a  (later_balance).
-00018db0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00018dc0: 6174 6572 5f62 616c 616e 6365 203e 2062  ater_balance > b
-00018dd0: 616c 616e 6365 5f70 6f73 745f 6765 6e65  alance_post_gene
-00018de0: 7369 730a 0a20 2020 2040 7079 7465 7374  sis..    @pytest
-00018df0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-00018e00: 6528 0a20 2020 2020 2020 2022 6164 6472  e(.        "addr
-00018e10: 6573 732c 2065 7870 6563 745f 7375 6363  ess, expect_succ
-00018e20: 6573 7322 2c0a 2020 2020 2020 2020 5b28  ess",.        [(
-00018e30: 2274 6573 742d 6164 6472 6573 732e 6574  "test-address.et
-00018e40: 6822 2c20 5472 7565 292c 2028 226e 6f74  h", True), ("not
-00018e50: 2d61 6e2d 6164 6472 6573 732e 6574 6822  -an-address.eth"
-00018e60: 2c20 4661 6c73 6529 5d2c 0a20 2020 2029  , False)],.    )
-00018e70: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00018e80: 685f 6765 745f 6261 6c61 6e63 655f 7769  h_get_balance_wi
-00018e90: 7468 5f65 6e73 5f6e 616d 6528 0a20 2020  th_ens_name(.   
-00018ea0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00018eb0: 5765 6233 222c 2061 6464 7265 7373 3a20  Web3", address: 
-00018ec0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00018ed0: 2065 7870 6563 745f 7375 6363 6573 733a   expect_success:
-00018ee0: 2062 6f6f 6c0a 2020 2020 2920 2d3e 204e   bool.    ) -> N
-00018ef0: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
-00018f00: 6820 656e 735f 6164 6472 6573 7365 7328  h ens_addresses(
-00018f10: 7733 2c20 7b22 7465 7374 2d61 6464 7265  w3, {"test-addre
-00018f20: 7373 2e65 7468 223a 2077 332e 6574 682e  ss.eth": w3.eth.
-00018f30: 6163 636f 756e 7473 5b30 5d7d 293a 0a20  accounts[0]}):. 
-00018f40: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-00018f50: 7065 6374 5f73 7563 6365 7373 3a0a 2020  pect_success:.  
-00018f60: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00018f70: 6c61 6e63 6520 3d20 7733 2e65 7468 2e67  lance = w3.eth.g
-00018f80: 6574 5f62 616c 616e 6365 2861 6464 7265  et_balance(addre
-00018f90: 7373 290a 2020 2020 2020 2020 2020 2020  ss).            
-00018fa0: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
-00018fb0: 7465 6765 7228 6261 6c61 6e63 6529 0a20  teger(balance). 
-00018fc0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00018fd0: 7373 6572 7420 6261 6c61 6e63 6520 3e3d  ssert balance >=
-00018fe0: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
-00018ff0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00019000: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00019010: 2e72 6169 7365 7328 4e61 6d65 4e6f 7446  .raises(NameNotF
-00019020: 6f75 6e64 293a 0a20 2020 2020 2020 2020  ound):.         
-00019030: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-00019040: 682e 6765 745f 6261 6c61 6e63 6528 6164  h.get_balance(ad
-00019050: 6472 6573 7329 0a0a 2020 2020 6465 6620  dress)..    def 
-00019060: 7465 7374 5f65 7468 5f67 6574 5f73 746f  test_eth_get_sto
-00019070: 7261 6765 5f61 7428 7365 6c66 2c20 7733  rage_at(self, w3
-00019080: 3a20 2257 6562 3322 2c20 7374 6f72 6167  : "Web3", storag
-00019090: 655f 636f 6e74 7261 6374 3a20 2243 6f6e  e_contract: "Con
-000190a0: 7472 6163 7422 2920 2d3e 204e 6f6e 653a  tract") -> None:
-000190b0: 0a20 2020 2020 2020 2073 746f 7261 6765  .        storage
-000190c0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-000190d0: 7320 3d20 7374 6f72 6167 655f 636f 6e74  s = storage_cont
-000190e0: 7261 6374 2e61 6464 7265 7373 0a0a 2020  ract.address..  
-000190f0: 2020 2020 2020 736c 6f74 5f30 203d 2077        slot_0 = w
-00019100: 332e 6574 682e 6765 745f 7374 6f72 6167  3.eth.get_storag
-00019110: 655f 6174 2873 746f 7261 6765 5f63 6f6e  e_at(storage_con
-00019120: 7472 6163 745f 6164 6472 6573 732c 2030  tract_address, 0
-00019130: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00019140: 2073 6c6f 745f 3020 3d3d 2048 6578 4279   slot_0 == HexBy
-00019150: 7465 7328 6622 3078 7b27 3030 2720 2a20  tes(f"0x{'00' * 
-00019160: 3332 7d22 290a 0a20 2020 2020 2020 2073  32}")..        s
-00019170: 6c6f 745f 3120 3d20 7733 2e65 7468 2e67  lot_1 = w3.eth.g
-00019180: 6574 5f73 746f 7261 6765 5f61 7428 7374  et_storage_at(st
-00019190: 6f72 6167 655f 636f 6e74 7261 6374 5f61  orage_contract_a
-000191a0: 6464 7265 7373 2c20 3129 0a20 2020 2020  ddress, 1).     
-000191b0: 2020 2061 7373 6572 7420 736c 6f74 5f31     assert slot_1
-000191c0: 203d 3d20 4865 7842 7974 6573 2866 2230   == HexBytes(f"0
-000191d0: 787b 2730 3027 202a 2033 317d 3031 2229  x{'00' * 31}01")
-000191e0: 0a0a 2020 2020 2020 2020 736c 6f74 5f32  ..        slot_2
-000191f0: 203d 2077 332e 6574 682e 6765 745f 7374   = w3.eth.get_st
-00019200: 6f72 6167 655f 6174 2873 746f 7261 6765  orage_at(storage
-00019210: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
-00019220: 732c 2032 290a 2020 2020 2020 2020 6173  s, 2).        as
-00019230: 7365 7274 2073 6c6f 745f 3220 3d3d 2048  sert slot_2 == H
-00019240: 6578 4279 7465 7328 6622 3078 7b27 3030  exBytes(f"0x{'00
-00019250: 2720 2a20 3331 7d30 3222 290a 0a20 2020  ' * 31}02")..   
-00019260: 2020 2020 2073 6c6f 745f 3320 3d20 7733       slot_3 = w3
-00019270: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
-00019280: 5f61 7428 7374 6f72 6167 655f 636f 6e74  _at(storage_cont
-00019290: 7261 6374 5f61 6464 7265 7373 2c20 3329  ract_address, 3)
-000192a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000192b0: 736c 6f74 5f33 203d 3d20 4865 7842 7974  slot_3 == HexByt
-000192c0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-000192d0: 2230 7837 3436 3837 3236 3536 3530 3030  "0x7468726565000
-000192e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+000131c0: 3030 3030 3030 3030 3030 3038 220a 2020  000000000008".  
+000131d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000131e0: 6173 7365 7274 2062 7974 6573 2873 6c6f  assert bytes(slo
+000131f0: 745f 345b 3a34 5d29 203d 3d20 6222 666f  t_4[:4]) == b"fo
+00013200: 7572 220a 0a20 2020 2040 7079 7465 7374  ur"..    @pytest
+00013210: 2e6d 6172 6b2e 6173 796e 6369 6f0a 2020  .mark.asyncio.  
+00013220: 2020 4070 7974 6573 742e 6d61 726b 2e78    @pytest.mark.x
+00013230: 6661 696c 0a20 2020 2061 7379 6e63 2064  fail.    async d
+00013240: 6566 2074 6573 745f 6173 796e 635f 6574  ef test_async_et
+00013250: 685f 6765 745f 7374 6f72 6167 655f 6174  h_get_storage_at
+00013260: 5f65 6e73 5f6e 616d 6528 0a20 2020 2020  _ens_name(.     
+00013270: 2020 2073 656c 662c 2061 7379 6e63 5f77     self, async_w
+00013280: 333a 2022 4173 796e 6357 6562 3322 2c20  3: "AsyncWeb3", 
+00013290: 6173 796e 635f 7374 6f72 6167 655f 636f  async_storage_co
+000132a0: 6e74 7261 6374 3a20 2241 7379 6e63 436f  ntract: "AsyncCo
+000132b0: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
+000132c0: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+000132d0: 6974 6820 656e 735f 6164 6472 6573 7365  ith ens_addresse
+000132e0: 7328 6173 796e 635f 7733 2c20 7b22 7374  s(async_w3, {"st
+000132f0: 6f72 6167 652e 6574 6822 3a20 6173 796e  orage.eth": asyn
+00013300: 635f 7374 6f72 6167 655f 636f 6e74 7261  c_storage_contra
+00013310: 6374 2e61 6464 7265 7373 7d29 3a0a 2020  ct.address}):.  
+00013320: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
+00013330: 6520 3d20 6177 6169 7420 6173 796e 635f  e = await async_
+00013340: 7733 2e65 7468 2e67 6574 5f73 746f 7261  w3.eth.get_stora
+00013350: 6765 5f61 7428 454e 5328 2273 746f 7261  ge_at(ENS("stora
+00013360: 6765 2e65 7468 2229 2c20 3129 0a20 2020  ge.eth"), 1).   
+00013370: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00013380: 7374 6f72 6167 6520 3d3d 2048 6578 4279  storage == HexBy
+00013390: 7465 7328 6622 3078 7b27 3030 2720 2a20  tes(f"0x{'00' * 
+000133a0: 3331 7d30 3122 290a 0a20 2020 2040 7079  31}01")..    @py
+000133b0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+000133c0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+000133d0: 7465 7374 5f61 7379 6e63 5f65 7468 5f67  test_async_eth_g
+000133e0: 6574 5f73 746f 7261 6765 5f61 745f 696e  et_storage_at_in
+000133f0: 7661 6c69 645f 6164 6472 6573 7328 0a20  valid_address(. 
+00013400: 2020 2020 2020 2073 656c 662c 2061 7379         self, asy
+00013410: 6e63 5f77 333a 2022 4173 796e 6357 6562  nc_w3: "AsyncWeb
+00013420: 3322 0a20 2020 2029 202d 3e20 4e6f 6e65  3".    ) -> None
+00013430: 3a0a 2020 2020 2020 2020 636f 696e 6261  :.        coinba
+00013440: 7365 203d 2061 7761 6974 2061 7379 6e63  se = await async
+00013450: 5f77 332e 6574 682e 636f 696e 6261 7365  _w3.eth.coinbase
+00013460: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00013470: 7465 7374 2e72 6169 7365 7328 496e 7661  test.raises(Inva
+00013480: 6c69 6441 6464 7265 7373 293a 0a20 2020  lidAddress):.   
+00013490: 2020 2020 2020 2020 2061 7761 6974 2061           await a
+000134a0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+000134b0: 7374 6f72 6167 655f 6174 280a 2020 2020  storage_at(.    
+000134c0: 2020 2020 2020 2020 2020 2020 4368 6563              Chec
+000134d0: 6b73 756d 4164 6472 6573 7328 4865 7841  ksumAddress(HexA
+000134e0: 6464 7265 7373 2848 6578 5374 7228 636f  ddress(HexStr(co
+000134f0: 696e 6261 7365 2e6c 6f77 6572 2829 2929  inbase.lower()))
+00013500: 292c 2030 0a20 2020 2020 2020 2020 2020  ), 0.           
+00013510: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+00013520: 5f61 7379 6e63 5f70 726f 7669 6465 725f  _async_provider_
+00013530: 6465 6661 756c 745f 6163 636f 756e 7428  default_account(
+00013540: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00013550: 2020 2020 2020 2061 7379 6e63 5f77 333a         async_w3:
+00013560: 2022 4173 796e 6357 6562 3322 2c0a 2020   "AsyncWeb3",.  
+00013570: 2020 2020 2020 6173 796e 635f 6b65 7966        async_keyf
+00013580: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00013590: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
+000135a0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+000135b0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+000135c0: 2020 2020 2020 2023 2063 6865 636b 2064         # check d
+000135d0: 6566 6175 6c74 7320 746f 2065 6d70 7479  efaults to empty
+000135e0: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
+000135f0: 5f61 6363 6f75 6e74 203d 2061 7379 6e63  _account = async
+00013600: 5f77 332e 6574 682e 6465 6661 756c 745f  _w3.eth.default_
+00013610: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
+00013620: 6173 7365 7274 2064 6566 6175 6c74 5f61  assert default_a
+00013630: 6363 6f75 6e74 2069 7320 656d 7074 790a  ccount is empty.
+00013640: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
+00013650: 2073 6574 7465 720a 2020 2020 2020 2020   setter.        
+00013660: 6173 796e 635f 7733 2e65 7468 2e64 6566  async_w3.eth.def
+00013670: 6175 6c74 5f61 6363 6f75 6e74 203d 2061  ault_account = a
+00013680: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00013690: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+000136a0: 6c5f 7479 7065 0a20 2020 2020 2020 2064  l_type.        d
+000136b0: 6566 6175 6c74 5f61 6363 6f75 6e74 203d  efault_account =
+000136c0: 2061 7379 6e63 5f77 332e 6574 682e 6465   async_w3.eth.de
+000136d0: 6661 756c 745f 6163 636f 756e 740a 2020  fault_account.  
+000136e0: 2020 2020 2020 6173 7365 7274 2064 6566        assert def
+000136f0: 6175 6c74 5f61 6363 6f75 6e74 203d 3d20  ault_account == 
+00013700: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00013710: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00013720: 616c 5f74 7970 650a 0a20 2020 2020 2020  al_type..       
+00013730: 2023 2072 6573 6574 2074 6f20 6465 6661   # reset to defa
+00013740: 756c 740a 2020 2020 2020 2020 6173 796e  ult.        asyn
+00013750: 635f 7733 2e65 7468 2e64 6566 6175 6c74  c_w3.eth.default
+00013760: 5f61 6363 6f75 6e74 203d 2065 6d70 7479  _account = empty
+00013770: 0a0a 2020 2020 6465 6620 7465 7374 5f61  ..    def test_a
+00013780: 7379 6e63 5f70 726f 7669 6465 725f 6465  sync_provider_de
+00013790: 6661 756c 745f 626c 6f63 6b28 0a20 2020  fault_block(.   
+000137a0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000137b0: 2020 2061 7379 6e63 5f77 333a 2022 4173     async_w3: "As
+000137c0: 796e 6357 6562 3322 2c0a 2020 2020 2920  yncWeb3",.    ) 
+000137d0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000137e0: 2023 2063 6865 636b 2064 6566 6175 6c74   # check default
+000137f0: 7320 746f 2027 6c61 7465 7374 270a 2020  s to 'latest'.  
+00013800: 2020 2020 2020 6465 6661 756c 745f 626c        default_bl
+00013810: 6f63 6b20 3d20 6173 796e 635f 7733 2e65  ock = async_w3.e
+00013820: 7468 2e64 6566 6175 6c74 5f62 6c6f 636b  th.default_block
+00013830: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00013840: 6465 6661 756c 745f 626c 6f63 6b20 3d3d  default_block ==
+00013850: 2022 6c61 7465 7374 220a 0a20 2020 2020   "latest"..     
+00013860: 2020 2023 2063 6865 636b 2073 6574 7465     # check sette
+00013870: 720a 2020 2020 2020 2020 6173 796e 635f  r.        async_
+00013880: 7733 2e65 7468 2e64 6566 6175 6c74 5f62  w3.eth.default_b
+00013890: 6c6f 636b 203d 2042 6c6f 636b 4e75 6d62  lock = BlockNumb
+000138a0: 6572 2831 3233 3435 290a 2020 2020 2020  er(12345).      
+000138b0: 2020 6465 6661 756c 745f 626c 6f63 6b20    default_block 
+000138c0: 3d20 6173 796e 635f 7733 2e65 7468 2e64  = async_w3.eth.d
+000138d0: 6566 6175 6c74 5f62 6c6f 636b 0a20 2020  efault_block.   
+000138e0: 2020 2020 2061 7373 6572 7420 6465 6661       assert defa
+000138f0: 756c 745f 626c 6f63 6b20 3d3d 2042 6c6f  ult_block == Blo
+00013900: 636b 4e75 6d62 6572 2831 3233 3435 290a  ckNumber(12345).
+00013910: 0a20 2020 2020 2020 2023 2072 6573 6574  .        # reset
+00013920: 2074 6f20 6465 6661 756c 740a 2020 2020   to default.    
+00013930: 2020 2020 6173 796e 635f 7733 2e65 7468      async_w3.eth
+00013940: 2e64 6566 6175 6c74 5f62 6c6f 636b 203d  .default_block =
+00013950: 2022 6c61 7465 7374 220a 0a20 2020 2040   "latest"..    @
+00013960: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00013970: 6369 6f0a 2020 2020 6173 796e 6320 6465  cio.    async de
+00013980: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
+00013990: 6f63 6b54 7261 6e73 6163 7469 6f6e 436f  ockTransactionCo
+000139a0: 756e 7442 7948 6173 685f 6173 796e 635f  untByHash_async_
+000139b0: 656d 7074 795f 626c 6f63 6b28 0a20 2020  empty_block(.   
+000139c0: 2020 2020 2073 656c 662c 2061 7379 6e63       self, async
+000139d0: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+000139e0: 2c20 6173 796e 635f 656d 7074 795f 626c  , async_empty_bl
+000139f0: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
+00013a00: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00013a10: 2020 2020 2020 7472 616e 7361 6374 696f        transactio
+00013a20: 6e5f 636f 756e 7420 3d20 6177 6169 7420  n_count = await 
+00013a30: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00013a40: 5f62 6c6f 636b 5f74 7261 6e73 6163 7469  _block_transacti
+00013a50: 6f6e 5f63 6f75 6e74 280a 2020 2020 2020  on_count(.      
+00013a60: 2020 2020 2020 6173 796e 635f 656d 7074        async_empt
+00013a70: 795f 626c 6f63 6b5b 2268 6173 6822 5d0a  y_block["hash"].
+00013a80: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00013a90: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
+00013aa0: 6567 6572 2874 7261 6e73 6163 7469 6f6e  eger(transaction
+00013ab0: 5f63 6f75 6e74 290a 2020 2020 2020 2020  _count).        
+00013ac0: 6173 7365 7274 2074 7261 6e73 6163 7469  assert transacti
+00013ad0: 6f6e 5f63 6f75 6e74 203d 3d20 300a 0a20  on_count == 0.. 
+00013ae0: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00013af0: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+00013b00: 6320 6465 6620 7465 7374 5f65 7468 5f67  c def test_eth_g
+00013b10: 6574 426c 6f63 6b54 7261 6e73 6163 7469  etBlockTransacti
+00013b20: 6f6e 436f 756e 7442 794e 756d 6265 725f  onCountByNumber_
+00013b30: 6173 796e 635f 656d 7074 795f 626c 6f63  async_empty_bloc
+00013b40: 6b28 0a20 2020 2020 2020 2073 656c 662c  k(.        self,
+00013b50: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00013b60: 6357 6562 3322 2c20 6173 796e 635f 656d  cWeb3", async_em
+00013b70: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
+00013b80: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
+00013b90: 6e65 3a0a 2020 2020 2020 2020 7472 616e  ne:.        tran
+00013ba0: 7361 6374 696f 6e5f 636f 756e 7420 3d20  saction_count = 
+00013bb0: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00013bc0: 7468 2e67 6574 5f62 6c6f 636b 5f74 7261  th.get_block_tra
+00013bd0: 6e73 6163 7469 6f6e 5f63 6f75 6e74 280a  nsaction_count(.
+00013be0: 2020 2020 2020 2020 2020 2020 6173 796e              asyn
+00013bf0: 635f 656d 7074 795f 626c 6f63 6b5b 226e  c_empty_block["n
+00013c00: 756d 6265 7222 5d0a 2020 2020 2020 2020  umber"].        
+00013c10: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00013c20: 7420 6973 5f69 6e74 6567 6572 2874 7261  t is_integer(tra
+00013c30: 6e73 6163 7469 6f6e 5f63 6f75 6e74 290a  nsaction_count).
+00013c40: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+00013c50: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+00013c60: 203d 3d20 300a 0a20 2020 2040 7079 7465   == 0..    @pyte
+00013c70: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+00013c80: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00013c90: 7374 5f65 7468 5f67 6574 426c 6f63 6b54  st_eth_getBlockT
+00013ca0: 7261 6e73 6163 7469 6f6e 436f 756e 7442  ransactionCountB
+00013cb0: 7948 6173 685f 626c 6f63 6b5f 7769 7468  yHash_block_with
+00013cc0: 5f74 786e 280a 2020 2020 2020 2020 7365  _txn(.        se
+00013cd0: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00013ce0: 7379 6e63 5765 6233 222c 2061 7379 6e63  syncWeb3", async
+00013cf0: 5f62 6c6f 636b 5f77 6974 685f 7478 6e3a  _block_with_txn:
+00013d00: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
+00013d10: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00013d20: 2020 7472 616e 7361 6374 696f 6e5f 636f    transaction_co
+00013d30: 756e 7420 3d20 6177 6169 7420 6173 796e  unt = await asyn
+00013d40: 635f 7733 2e65 7468 2e67 6574 5f62 6c6f  c_w3.eth.get_blo
+00013d50: 636b 5f74 7261 6e73 6163 7469 6f6e 5f63  ck_transaction_c
+00013d60: 6f75 6e74 280a 2020 2020 2020 2020 2020  ount(.          
+00013d70: 2020 6173 796e 635f 626c 6f63 6b5f 7769    async_block_wi
+00013d80: 7468 5f74 786e 5b22 6861 7368 225d 0a20  th_txn["hash"]. 
+00013d90: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00013da0: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00013db0: 6765 7228 7472 616e 7361 6374 696f 6e5f  ger(transaction_
+00013dc0: 636f 756e 7429 0a20 2020 2020 2020 2061  count).        a
+00013dd0: 7373 6572 7420 7472 616e 7361 6374 696f  ssert transactio
+00013de0: 6e5f 636f 756e 7420 3e3d 2031 0a0a 2020  n_count >= 1..  
+00013df0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00013e00: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00013e10: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00013e20: 7455 6e63 6c65 436f 756e 7442 7942 6c6f  tUncleCountByBlo
+00013e30: 636b 4861 7368 280a 2020 2020 2020 2020  ckHash(.        
+00013e40: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00013e50: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00013e60: 6e63 5f65 6d70 7479 5f62 6c6f 636b 3a20  nc_empty_block: 
+00013e70: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00013e80: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00013e90: 2075 6e63 6c65 5f63 6f75 6e74 203d 2061   uncle_count = a
+00013ea0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00013eb0: 682e 6765 745f 756e 636c 655f 636f 756e  h.get_uncle_coun
+00013ec0: 7428 6173 796e 635f 656d 7074 795f 626c  t(async_empty_bl
+00013ed0: 6f63 6b5b 2268 6173 6822 5d29 0a0a 2020  ock["hash"])..  
+00013ee0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00013ef0: 696e 7465 6765 7228 756e 636c 655f 636f  integer(uncle_co
+00013f00: 756e 7429 0a20 2020 2020 2020 2061 7373  unt).        ass
+00013f10: 6572 7420 756e 636c 655f 636f 756e 7420  ert uncle_count 
+00013f20: 3d3d 2030 0a0a 2020 2020 4070 7974 6573  == 0..    @pytes
+00013f30: 742e 6d61 726b 2e61 7379 6e63 696f 0a20  t.mark.asyncio. 
+00013f40: 2020 2061 7379 6e63 2064 6566 2074 6573     async def tes
+00013f50: 745f 6574 685f 6765 7455 6e63 6c65 436f  t_eth_getUncleCo
+00013f60: 756e 7442 7942 6c6f 636b 4e75 6d62 6572  untByBlockNumber
+00013f70: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00013f80: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00013f90: 5765 6233 222c 2061 7379 6e63 5f65 6d70  Web3", async_emp
+00013fa0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
+00013fb0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
+00013fc0: 653a 0a20 2020 2020 2020 2075 6e63 6c65  e:.        uncle
+00013fd0: 5f63 6f75 6e74 203d 2061 7761 6974 2061  _count = await a
+00013fe0: 7379 6e63 5f77 332e 6574 682e 6765 745f  sync_w3.eth.get_
+00013ff0: 756e 636c 655f 636f 756e 7428 6173 796e  uncle_count(asyn
+00014000: 635f 656d 7074 795f 626c 6f63 6b5b 226e  c_empty_block["n
+00014010: 756d 6265 7222 5d29 0a0a 2020 2020 2020  umber"])..      
+00014020: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00014030: 6765 7228 756e 636c 655f 636f 756e 7429  ger(uncle_count)
+00014040: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014050: 756e 636c 655f 636f 756e 7420 3d3d 2030  uncle_count == 0
+00014060: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
+00014070: 726b 2e61 7379 6e63 696f 0a20 2020 2061  rk.asyncio.    a
+00014080: 7379 6e63 2064 6566 2074 6573 745f 6574  sync def test_et
+00014090: 685f 6765 7442 6c6f 636b 5472 616e 7361  h_getBlockTransa
+000140a0: 6374 696f 6e43 6f75 6e74 4279 4e75 6d62  ctionCountByNumb
+000140b0: 6572 5f62 6c6f 636b 5f77 6974 685f 7478  er_block_with_tx
+000140c0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+000140d0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+000140e0: 6357 6562 3322 2c20 6173 796e 635f 626c  cWeb3", async_bl
+000140f0: 6f63 6b5f 7769 7468 5f74 786e 3a20 426c  ock_with_txn: Bl
+00014100: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00014110: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00014120: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+00014130: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00014140: 332e 6574 682e 6765 745f 626c 6f63 6b5f  3.eth.get_block_
+00014150: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+00014160: 7428 0a20 2020 2020 2020 2020 2020 2061  t(.            a
+00014170: 7379 6e63 5f62 6c6f 636b 5f77 6974 685f  sync_block_with_
+00014180: 7478 6e5b 226e 756d 6265 7222 5d0a 2020  txn["number"].  
+00014190: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000141a0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+000141b0: 6572 2874 7261 6e73 6163 7469 6f6e 5f63  er(transaction_c
+000141c0: 6f75 6e74 290a 2020 2020 2020 2020 6173  ount).        as
+000141d0: 7365 7274 2074 7261 6e73 6163 7469 6f6e  sert transaction
+000141e0: 5f63 6f75 6e74 203e 3d20 310a 0a20 2020  _count >= 1..   
+000141f0: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00014200: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00014210: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+00014220: 7468 5f73 6967 6e28 0a20 2020 2020 2020  th_sign(.       
+00014230: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00014240: 7379 6e63 5f77 333a 2022 4173 796e 6357  sync_w3: "AsyncW
+00014250: 6562 3322 2c0a 2020 2020 2020 2020 6173  eb3",.        as
+00014260: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+00014270: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+00014280: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+00014290: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
+000142a0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+000142b0: 6967 6e61 7475 7265 203d 2061 7761 6974  ignature = await
+000142c0: 2061 7379 6e63 5f77 332e 6574 682e 7369   async_w3.eth.si
+000142d0: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+000142e0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+000142f0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00014300: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00014310: 2020 2020 2074 6578 743d 224d 6573 7361       text="Messa
+00014320: 6765 2074 c3b6 2073 6967 6e2e 204c 6f6e  ge t.. sign. Lon
+00014330: 6765 7220 7468 616e 2068 6173 6821 222c  ger than hash!",
+00014340: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00014350: 2020 2061 7373 6572 7420 6973 5f62 7974     assert is_byt
+00014360: 6573 2873 6967 6e61 7475 7265 290a 2020  es(signature).  
+00014370: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00014380: 2873 6967 6e61 7475 7265 2920 3d3d 2033  (signature) == 3
+00014390: 3220 2b20 3332 202b 2031 0a0a 2020 2020  2 + 32 + 1..    
+000143a0: 2020 2020 2320 7465 7374 206f 7468 6572      # test other
+000143b0: 2066 6f72 6d61 7473 0a20 2020 2020 2020   formats.       
+000143c0: 2068 6578 7369 676e 203d 2061 7761 6974   hexsign = await
+000143d0: 2061 7379 6e63 5f77 332e 6574 682e 7369   async_w3.eth.si
+000143e0: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+000143f0: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00014400: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00014410: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00014420: 2020 2020 2068 6578 7374 723d 4865 7853       hexstr=HexS
+00014430: 7472 280a 2020 2020 2020 2020 2020 2020  tr(.            
+00014440: 2020 2020 2230 7834 6436 3537 3337 3336      "0x4d6573736
+00014450: 3136 3736 3532 3037 3463 3362 3632 3037  167652074c3b6207
+00014460: 3336 3936 3736 6532 6532 3034 6336 6636  369676e2e204c6f6
+00014470: 6536 3736 3537 3232 3037 3436 3836 3136  e676572207468616
+00014480: 6532 3036 3836 3137 3336 3832 3122 2020  e206861736821"  
+00014490: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
+000144a0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+000144b0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+000144c0: 7365 7274 2068 6578 7369 676e 203d 3d20  sert hexsign == 
+000144d0: 7369 676e 6174 7572 650a 0a20 2020 2020  signature..     
+000144e0: 2020 2069 6e74 7369 676e 203d 2061 7761     intsign = awa
+000144f0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00014500: 7369 676e 280a 2020 2020 2020 2020 2020  sign(.          
+00014510: 2020 6173 796e 635f 6b65 7966 696c 655f    async_keyfile_
+00014520: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00014530: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00014540: 2020 2020 2020 2030 7834 4436 3537 3337         0x4D65737
+00014550: 3336 3136 3736 3532 3037 3443 3342 3632  36167652074C3B62
+00014560: 3037 3336 3936 3736 4532 4532 3034 4336  07369676E2E204C6
+00014570: 4636 4536 3736 3537 3232 3037 3436 3836  F6E6765722074686
+00014580: 3136 4532 3036 3836 3137 3336 3832 312c  16E206861736821,
+00014590: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000145a0: 2020 2061 7373 6572 7420 696e 7473 6967     assert intsig
+000145b0: 6e20 3d3d 2073 6967 6e61 7475 7265 0a0a  n == signature..
+000145c0: 2020 2020 2020 2020 6279 7465 7373 6967          bytessig
+000145d0: 6e20 3d20 6177 6169 7420 6173 796e 635f  n = await async_
+000145e0: 7733 2e65 7468 2e73 6967 6e28 0a20 2020  w3.eth.sign(.   
+000145f0: 2020 2020 2020 2020 2061 7379 6e63 5f6b           async_k
+00014600: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00014610: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00014620: 2c0a 2020 2020 2020 2020 2020 2020 6222  ,.            b"
+00014630: 4d65 7373 6167 6520 745c 7863 335c 7862  Message t\xc3\xb
+00014640: 3620 7369 676e 2e20 4c6f 6e67 6572 2074  6 sign. Longer t
+00014650: 6861 6e20 6861 7368 2122 2c0a 2020 2020  han hash!",.    
+00014660: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00014670: 7365 7274 2062 7974 6573 7369 676e 203d  sert bytessign =
+00014680: 3d20 7369 676e 6174 7572 650a 0a20 2020  = signature..   
+00014690: 2020 2020 206e 6577 5f73 6967 6e61 7475       new_signatu
+000146a0: 7265 203d 2061 7761 6974 2061 7379 6e63  re = await async
+000146b0: 5f77 332e 6574 682e 7369 676e 280a 2020  _w3.eth.sign(.  
+000146c0: 2020 2020 2020 2020 2020 6173 796e 635f            async_
+000146d0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+000146e0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+000146f0: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
+00014700: 6578 743d 2264 6966 6665 7265 6e74 206d  ext="different m
+00014710: 6573 7361 6765 2069 7320 6469 6666 6572  essage is differ
+00014720: 656e 7422 2c0a 2020 2020 2020 2020 290a  ent",.        ).
+00014730: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+00014740: 6577 5f73 6967 6e61 7475 7265 2021 3d20  ew_signature != 
+00014750: 7369 676e 6174 7572 650a 0a20 2020 2040  signature..    @
+00014760: 7079 7465 7374 2e6d 6172 6b2e 6173 796e  pytest.mark.asyn
+00014770: 6369 6f0a 2020 2020 4070 7974 6573 742e  cio.    @pytest.
+00014780: 6d61 726b 2e78 6661 696c 280a 2020 2020  mark.xfail(.    
+00014790: 2020 2020 7265 6173 6f6e 3d22 4173 796e      reason="Asyn
+000147a0: 6320 6d69 6464 6c65 7761 7265 2074 6f20  c middleware to 
+000147b0: 636f 6e76 6572 7420 454e 5320 6e61 6d65  convert ENS name
+000147c0: 7320 746f 2061 6464 7265 7373 6573 2069  s to addresses i
+000147d0: 7320 6d69 7373 696e 6722 0a20 2020 2029  s missing".    )
+000147e0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000147f0: 6573 745f 6173 796e 635f 6574 685f 7369  est_async_eth_si
+00014800: 676e 5f65 6e73 5f6e 616d 6573 280a 2020  gn_ens_names(.  
+00014810: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00014820: 2020 2020 6173 796e 635f 7733 3a20 2241      async_w3: "A
+00014830: 7379 6e63 5765 6233 222c 0a20 2020 2020  syncWeb3",.     
+00014840: 2020 2061 7379 6e63 5f6b 6579 6669 6c65     async_keyfile
+00014850: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00014860: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00014870: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+00014880: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00014890: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
+000148a0: 7265 7373 6573 280a 2020 2020 2020 2020  resses(.        
+000148b0: 2020 2020 6173 796e 635f 7733 2c20 7b22      async_w3, {"
+000148c0: 756e 6c6f 636b 6564 2d61 6363 742e 6574  unlocked-acct.et
+000148d0: 6822 3a20 6173 796e 635f 6b65 7966 696c  h": async_keyfil
+000148e0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+000148f0: 735f 6475 616c 5f74 7970 657d 0a20 2020  s_dual_type}.   
+00014900: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00014910: 2020 2020 7369 676e 6174 7572 6520 3d20      signature = 
+00014920: 6177 6169 7420 6173 796e 635f 7733 2e65  await async_w3.e
+00014930: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
+00014940: 2020 2020 2020 2020 2045 4e53 2822 756e           ENS("un
+00014950: 6c6f 636b 6564 2d61 6363 742e 6574 6822  locked-acct.eth"
+00014960: 292c 2074 6578 743d 224d 6573 7361 6765  ), text="Message
+00014970: 2074 c3b6 2073 6967 6e2e 204c 6f6e 6765   t.. sign. Longe
+00014980: 7220 7468 616e 2068 6173 6821 220a 2020  r than hash!".  
+00014990: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000149a0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000149b0: 735f 6279 7465 7328 7369 676e 6174 7572  s_bytes(signatur
+000149c0: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
+000149d0: 7373 6572 7420 6c65 6e28 7369 676e 6174  ssert len(signat
+000149e0: 7572 6529 203d 3d20 3332 202b 2033 3220  ure) == 32 + 32 
+000149f0: 2b20 310a 0a20 2020 2040 666c 616b 795f  + 1..    @flaky_
+00014a00: 6765 7468 5f64 6576 5f6d 696e 696e 670a  geth_dev_mining.
+00014a10: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00014a20: 2e61 7379 6e63 696f 0a20 2020 2061 7379  .asyncio.    asy
+00014a30: 6e63 2064 6566 2074 6573 745f 6173 796e  nc def test_asyn
+00014a40: 635f 6574 685f 7265 706c 6163 655f 7472  c_eth_replace_tr
+00014a50: 616e 7361 6374 696f 6e5f 6c65 6761 6379  ansaction_legacy
+00014a60: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00014a70: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+00014a80: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+00014a90: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+00014aa0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00014ab0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+00014ac0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00014ad0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00014ae0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00014af0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00014b00: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00014b10: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
+00014b20: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00014b30: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00014b40: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00014b50: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00014b60: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00014b70: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00014b80: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00014b90: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00014ba0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00014bb0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00014bc0: 5072 6963 6522 3a20 6173 796e 635f 7733  Price": async_w3
+00014bd0: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
+00014be0: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
+00014bf0: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
+00014c00: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00014c10: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+00014c20: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+00014c30: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
+00014c40: 7261 6d73 5b22 6761 7350 7269 6365 225d  rams["gasPrice"]
+00014c50: 203d 2061 7379 6e63 5f77 332e 746f 5f77   = async_w3.to_w
+00014c60: 6569 2832 2c20 2267 7765 6922 290a 2020  ei(2, "gwei").  
+00014c70: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
+00014c80: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+00014c90: 7379 6e63 5f77 332e 6574 682e 7265 706c  sync_w3.eth.repl
+00014ca0: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
+00014cb0: 7478 6e5f 6861 7368 2c20 7478 6e5f 7061  txn_hash, txn_pa
+00014cc0: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+00014cd0: 706c 6163 655f 7478 6e20 3d20 6177 6169  place_txn = awai
+00014ce0: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+00014cf0: 6574 5f74 7261 6e73 6163 7469 6f6e 2872  et_transaction(r
+00014d00: 6570 6c61 6365 5f74 786e 5f68 6173 6829  eplace_txn_hash)
+00014d10: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00014d20: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+00014d30: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+00014d40: 706c 6163 655f 7478 6e5b 2266 726f 6d22  place_txn["from"
+00014d50: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
+00014d60: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
+00014d70: 616d 735b 2266 726f 6d22 5d29 0a20 2020  ams["from"]).   
+00014d80: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00014d90: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
+00014da0: 6472 6573 7328 0a20 2020 2020 2020 2020  dress(.         
+00014db0: 2020 2072 6570 6c61 6365 5f74 786e 5b22     replace_txn["
+00014dc0: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
+00014dd0: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
+00014de0: 7061 7261 6d73 5b22 746f 225d 290a 2020  params["to"]).  
+00014df0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00014e00: 6173 7365 7274 2072 6570 6c61 6365 5f74  assert replace_t
+00014e10: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
+00014e20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014e30: 7265 706c 6163 655f 7478 6e5b 2267 6173  replace_txn["gas
+00014e40: 225d 203d 3d20 3231 3030 300a 2020 2020  "] == 21000.    
+00014e50: 2020 2020 6173 7365 7274 2072 6570 6c61      assert repla
+00014e60: 6365 5f74 786e 5b22 6761 7350 7269 6365  ce_txn["gasPrice
+00014e70: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+00014e80: 5b22 6761 7350 7269 6365 225d 0a0a 2020  ["gasPrice"]..  
+00014e90: 2020 4066 6c61 6b79 5f67 6574 685f 6465    @flaky_geth_de
+00014ea0: 765f 6d69 6e69 6e67 0a20 2020 2040 7079  v_mining.    @py
+00014eb0: 7465 7374 2e6d 6172 6b2e 6173 796e 6369  test.mark.asynci
+00014ec0: 6f0a 2020 2020 6173 796e 6320 6465 6620  o.    async def 
+00014ed0: 7465 7374 5f61 7379 6e63 5f65 7468 5f72  test_async_eth_r
+00014ee0: 6570 6c61 6365 5f74 7261 6e73 6163 7469  eplace_transacti
+00014ef0: 6f6e 280a 2020 2020 2020 2020 7365 6c66  on(.        self
+00014f00: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+00014f10: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+00014f20: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+00014f30: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00014f40: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00014f50: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00014f60: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+00014f70: 3a0a 2020 2020 2020 2020 7477 6f5f 6777  :.        two_gw
+00014f80: 6569 5f69 6e5f 7765 6920 3d20 6173 796e  ei_in_wei = asyn
+00014f90: 635f 7733 2e74 6f5f 7765 6928 322c 2022  c_w3.to_wei(2, "
+00014fa0: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
+00014fb0: 6872 6565 5f67 7765 695f 696e 5f77 6569  hree_gwei_in_wei
+00014fc0: 203d 2061 7379 6e63 5f77 332e 746f 5f77   = async_w3.to_w
+00014fd0: 6569 2833 2c20 2267 7765 6922 290a 0a20  ei(3, "gwei").. 
+00014fe0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00014ff0: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
+00015000: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00015010: 6d22 3a20 6173 796e 635f 6b65 7966 696c  m": async_keyfil
+00015020: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00015030: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+00015040: 2020 2020 2020 2020 2022 746f 223a 2061           "to": a
+00015050: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00015060: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00015070: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00015080: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+00015090: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+000150a0: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
+000150b0: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
+000150c0: 6565 5065 7247 6173 223a 2074 776f 5f67  eePerGas": two_g
+000150d0: 7765 695f 696e 5f77 6569 2c0a 2020 2020  wei_in_wei,.    
+000150e0: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
+000150f0: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
+00015100: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
+00015110: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
+00015120: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00015130: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+00015140: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+00015150: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00015160: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
+00015170: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
+00015180: 7846 6565 5065 7247 6173 225d 203d 2074  xFeePerGas"] = t
+00015190: 6872 6565 5f67 7765 695f 696e 5f77 6569  hree_gwei_in_wei
+000151a0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+000151b0: 616d 735b 226d 6178 5072 696f 7269 7479  ams["maxPriority
+000151c0: 4665 6550 6572 4761 7322 5d20 3d20 7477  FeePerGas"] = tw
+000151d0: 6f5f 6777 6569 5f69 6e5f 7765 690a 0a20  o_gwei_in_wei.. 
+000151e0: 2020 2020 2020 2072 6570 6c61 6365 5f74         replace_t
+000151f0: 786e 5f68 6173 6820 3d20 6177 6169 7420  xn_hash = await 
+00015200: 6173 796e 635f 7733 2e65 7468 2e72 6570  async_w3.eth.rep
+00015210: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
+00015220: 2874 786e 5f68 6173 682c 2074 786e 5f70  (txn_hash, txn_p
+00015230: 6172 616d 7329 0a20 2020 2020 2020 2072  arams).        r
+00015240: 6570 6c61 6365 5f74 786e 203d 2061 7761  eplace_txn = awa
+00015250: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00015260: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
+00015270: 7265 706c 6163 655f 7478 6e5f 6861 7368  replace_txn_hash
+00015280: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00015290: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+000152a0: 7328 0a20 2020 2020 2020 2020 2020 2072  s(.            r
+000152b0: 6570 6c61 6365 5f74 786e 5b22 6672 6f6d  eplace_txn["from
+000152c0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+000152d0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+000152e0: 7261 6d73 5b22 6672 6f6d 225d 290a 2020  rams["from"]).  
+000152f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015300: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
+00015310: 6464 7265 7373 280a 2020 2020 2020 2020  ddress(.        
+00015320: 2020 2020 7265 706c 6163 655f 7478 6e5b      replace_txn[
+00015330: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
+00015340: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+00015350: 5f70 6172 616d 735b 2274 6f22 5d29 0a20  _params["to"]). 
+00015360: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00015370: 2061 7373 6572 7420 7265 706c 6163 655f   assert replace_
+00015380: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
+00015390: 310a 2020 2020 2020 2020 6173 7365 7274  1.        assert
+000153a0: 2072 6570 6c61 6365 5f74 786e 5b22 6761   replace_txn["ga
+000153b0: 7322 5d20 3d3d 2032 3130 3030 0a20 2020  s"] == 21000.   
+000153c0: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
+000153d0: 6163 655f 7478 6e5b 226d 6178 4665 6550  ace_txn["maxFeeP
+000153e0: 6572 4761 7322 5d20 3d3d 2074 6872 6565  erGas"] == three
+000153f0: 5f67 7765 695f 696e 5f77 6569 0a20 2020  _gwei_in_wei.   
+00015400: 2020 2020 2061 7373 6572 7420 7265 706c       assert repl
+00015410: 6163 655f 7478 6e5b 226d 6178 5072 696f  ace_txn["maxPrio
+00015420: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
+00015430: 3d3d 2074 776f 5f67 7765 695f 696e 5f77  == two_gwei_in_w
+00015440: 6569 0a0a 2020 2020 4066 6c61 6b79 5f67  ei..    @flaky_g
+00015450: 6574 685f 6465 765f 6d69 6e69 6e67 0a20  eth_dev_mining. 
+00015460: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
+00015470: 6173 796e 6369 6f0a 2020 2020 6173 796e  asyncio.    asyn
+00015480: 6320 6465 6620 7465 7374 5f61 7379 6e63  c def test_async
+00015490: 5f65 7468 5f72 6570 6c61 6365 5f74 7261  _eth_replace_tra
+000154a0: 6e73 6163 7469 6f6e 5f75 6e64 6572 7072  nsaction_underpr
+000154b0: 6963 6564 280a 2020 2020 2020 2020 7365  iced(.        se
+000154c0: 6c66 2c0a 2020 2020 2020 2020 6173 796e  lf,.        asyn
+000154d0: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+000154e0: 222c 0a20 2020 2020 2020 2061 7379 6e63  ",.        async
+000154f0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
+00015500: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+00015510: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
+00015520: 6573 732c 0a20 2020 2029 202d 3e20 4e6f  ess,.    ) -> No
+00015530: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+00015540: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+00015550: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00015560: 2022 6672 6f6d 223a 2061 7379 6e63 5f6b   "from": async_k
+00015570: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00015580: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00015590: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+000155a0: 6f22 3a20 6173 796e 635f 6b65 7966 696c  o": async_keyfil
+000155b0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+000155c0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+000155d0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+000155e0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+000155f0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+00015600: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+00015610: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+00015620: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
+00015630: 332c 2022 6777 6569 2229 2c0a 2020 2020  3, "gwei"),.    
+00015640: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
+00015650: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
+00015660: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
+00015670: 322c 2022 6777 6569 2229 2c0a 2020 2020  2, "gwei"),.    
+00015680: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00015690: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+000156a0: 7379 6e63 5f77 332e 6574 682e 7365 6e64  sync_w3.eth.send
+000156b0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+000156c0: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
+000156d0: 2020 6f6e 655f 6777 6569 5f69 6e5f 7765    one_gwei_in_we
+000156e0: 6920 3d20 6173 796e 635f 7733 2e74 6f5f  i = async_w3.to_
+000156f0: 7765 6928 312c 2022 6777 6569 2229 0a20  wei(1, "gwei"). 
+00015700: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00015710: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
+00015720: 5d20 3d20 6f6e 655f 6777 6569 5f69 6e5f  ] = one_gwei_in_
+00015730: 7765 690a 2020 2020 2020 2020 7478 6e5f  wei.        txn_
+00015740: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
+00015750: 6974 7946 6565 5065 7247 6173 225d 203d  ityFeePerGas"] =
+00015760: 206f 6e65 5f67 7765 695f 696e 5f77 6569   one_gwei_in_wei
+00015770: 0a0a 2020 2020 2020 2020 7769 7468 2070  ..        with p
+00015780: 7974 6573 742e 7261 6973 6573 2857 6562  ytest.raises(Web
+00015790: 3352 5043 4572 726f 722c 206d 6174 6368  3RPCError, match
+000157a0: 3d22 7265 706c 6163 656d 656e 7420 7472  ="replacement tr
+000157b0: 616e 7361 6374 696f 6e20 756e 6465 7270  ansaction underp
+000157c0: 7269 6365 6422 293a 0a20 2020 2020 2020  riced"):.       
+000157d0: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+000157e0: 5f77 332e 6574 682e 7265 706c 6163 655f  _w3.eth.replace_
+000157f0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+00015800: 6861 7368 2c20 7478 6e5f 7061 7261 6d73  hash, txn_params
+00015810: 290a 0a20 2020 2040 666c 616b 795f 6765  )..    @flaky_ge
+00015820: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
+00015830: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+00015840: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+00015850: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
+00015860: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
+00015870: 7361 6374 696f 6e5f 6e6f 6e5f 6578 6973  saction_non_exis
+00015880: 7469 6e67 5f74 7261 6e73 6163 7469 6f6e  ting_transaction
+00015890: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000158a0: 2020 2020 2020 2020 6173 796e 635f 7733          async_w3
+000158b0: 3a20 2241 7379 6e63 5765 6233 222c 0a20  : "AsyncWeb3",. 
+000158c0: 2020 2020 2020 2061 7379 6e63 5f6b 6579         async_key
+000158d0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+000158e0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+000158f0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00015900: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00015910: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+00015920: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+00015930: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00015940: 6f6d 223a 2061 7379 6e63 5f6b 6579 6669  om": async_keyfi
+00015950: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00015960: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+00015970: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00015980: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00015990: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+000159a0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+000159b0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+000159c0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+000159d0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+000159e0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+000159f0: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
+00015a00: 635f 7733 2e74 6f5f 7765 6928 332c 2022  c_w3.to_wei(3, "
+00015a10: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00015a20: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+00015a30: 4665 6550 6572 4761 7322 3a20 6173 796e  FeePerGas": asyn
+00015a40: 635f 7733 2e74 6f5f 7765 6928 312c 2022  c_w3.to_wei(1, "
+00015a50: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00015a60: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
+00015a70: 7974 6573 742e 7261 6973 6573 2854 7261  ytest.raises(Tra
+00015a80: 6e73 6163 7469 6f6e 4e6f 7446 6f75 6e64  nsactionNotFound
+00015a90: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+00015aa0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00015ab0: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
+00015ac0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00015ad0: 2020 2020 2020 2048 6578 5374 7228 0a20         HexStr(. 
+00015ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015af0: 2020 2022 3078 3938 6538 6363 3039 6233     "0x98e8cc09b3
+00015b00: 3131 3538 3363 3530 3739 6661 3630 3066  11583c5079fa600f
+00015b10: 3663 3261 3362 6561 3836 3131 6166 3136  6c2a3bea8611af16
+00015b20: 3863 3532 6534 6236 3062 3562 3234 3361  8c52e4b60b5b243a
+00015b30: 3434 3139 3937 220a 2020 2020 2020 2020  441997".        
+00015b40: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00015b50: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
+00015b60: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+00015b70: 2020 2029 0a0a 2020 2020 4066 6c61 6b79     )..    @flaky
+00015b80: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
+00015b90: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00015ba0: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00015bb0: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00015bc0: 6e63 5f65 7468 5f72 6570 6c61 6365 5f74  nc_eth_replace_t
+00015bd0: 7261 6e73 6163 7469 6f6e 5f61 6c72 6561  ransaction_alrea
+00015be0: 6479 5f6d 696e 6564 280a 2020 2020 2020  dy_mined(.      
+00015bf0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00015c00: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00015c10: 5765 6233 222c 0a20 2020 2020 2020 2061  Web3",.        a
+00015c20: 7379 6e63 5f6b 6579 6669 6c65 5f61 6363  sync_keyfile_acc
+00015c30: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00015c40: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00015c50: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
+00015c60: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00015c70: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+00015c80: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00015c90: 2020 2020 2022 6672 6f6d 223a 2061 7379       "from": asy
+00015ca0: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00015cb0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+00015cc0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00015cd0: 2020 2274 6f22 3a20 6173 796e 635f 6b65    "to": async_ke
+00015ce0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+00015cf0: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+00015d00: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00015d10: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+00015d20: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00015d30: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00015d40: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00015d50: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+00015d60: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
+00015d70: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00015d80: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00015d90: 7322 3a20 6173 796e 635f 7733 2e74 6f5f  s": async_w3.to_
+00015da0: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
+00015db0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00015dc0: 2020 7478 6e5f 6861 7368 203d 2061 7761    txn_hash = awa
+00015dd0: 6974 2061 7379 6e63 5f77 332e 6574 682e  it async_w3.eth.
+00015de0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+00015df0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+00015e00: 2020 2020 2061 7761 6974 2061 7379 6e63       await async
+00015e10: 5f77 332e 6574 682e 7761 6974 5f66 6f72  _w3.eth.wait_for
+00015e20: 5f74 7261 6e73 6163 7469 6f6e 5f72 6563  _transaction_rec
+00015e30: 6569 7074 2874 786e 5f68 6173 682c 2074  eipt(txn_hash, t
+00015e40: 696d 656f 7574 3d31 3029 0a0a 2020 2020  imeout=10)..    
+00015e50: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
+00015e60: 6d61 7846 6565 5065 7247 6173 225d 203d  maxFeePerGas"] =
+00015e70: 2061 7379 6e63 5f77 332e 746f 5f77 6569   async_w3.to_wei
+00015e80: 2833 2c20 2267 7765 6922 290a 2020 2020  (3, "gwei").    
+00015e90: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
+00015ea0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+00015eb0: 7247 6173 225d 203d 2061 7379 6e63 5f77  rGas"] = async_w
+00015ec0: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
+00015ed0: 6922 290a 2020 2020 2020 2020 7769 7468  i").        with
+00015ee0: 2070 7974 6573 742e 7261 6973 6573 2857   pytest.raises(W
+00015ef0: 6562 3356 616c 7565 4572 726f 722c 206d  eb3ValueError, m
+00015f00: 6174 6368 3d22 5375 7070 6c69 6564 2074  atch="Supplied t
+00015f10: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
+00015f20: 6861 7368 2229 3a0a 2020 2020 2020 2020  hash"):.        
+00015f30: 2020 2020 6177 6169 7420 6173 796e 635f      await async_
+00015f40: 7733 2e65 7468 2e72 6570 6c61 6365 5f74  w3.eth.replace_t
+00015f50: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
+00015f60: 6173 682c 2074 786e 5f70 6172 616d 7329  ash, txn_params)
+00015f70: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
+00015f80: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
+00015f90: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00015fa0: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00015fb0: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+00015fc0: 7468 5f72 6570 6c61 6365 5f74 7261 6e73  th_replace_trans
+00015fd0: 6163 7469 6f6e 5f69 6e63 6f72 7265 6374  action_incorrect
+00015fe0: 5f6e 6f6e 6365 280a 2020 2020 2020 2020  _nonce(.        
+00015ff0: 7365 6c66 2c20 6173 796e 635f 7733 3a20  self, async_w3: 
+00016000: 2241 7379 6e63 5765 6233 222c 2061 7379  "AsyncWeb3", asy
+00016010: 6e63 5f6b 6579 6669 6c65 5f61 6363 6f75  nc_keyfile_accou
+00016020: 6e74 5f61 6464 7265 7373 3a20 4368 6563  nt_address: Chec
+00016030: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+00016040: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00016050: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
+00016060: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
+00016070: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
+00016080: 6173 796e 635f 6b65 7966 696c 655f 6163  async_keyfile_ac
+00016090: 636f 756e 745f 6164 6472 6573 732c 0a20  count_address,. 
+000160a0: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
+000160b0: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+000160c0: 6363 6f75 6e74 5f61 6464 7265 7373 2c0a  ccount_address,.
+000160d0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+000160e0: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
+000160f0: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
+00016100: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
+00016110: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+00016120: 223a 2061 7379 6e63 5f77 332e 746f 5f77  ": async_w3.to_w
+00016130: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
+00016140: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+00016150: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00016160: 223a 2061 7379 6e63 5f77 332e 746f 5f77  ": async_w3.to_w
+00016170: 6569 2831 2c20 2267 7765 6922 292c 0a20  ei(1, "gwei"),. 
+00016180: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00016190: 2074 786e 5f68 6173 6820 3d20 6177 6169   txn_hash = awai
+000161a0: 7420 6173 796e 635f 7733 2e65 7468 2e73  t async_w3.eth.s
+000161b0: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
+000161c0: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
+000161d0: 2020 2020 7478 6e20 3d20 6177 6169 7420      txn = await 
+000161e0: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+000161f0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00016200: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
+00016210: 7478 6e5f 7061 7261 6d73 5b22 6d61 7846  txn_params["maxF
+00016220: 6565 5065 7247 6173 225d 203d 2061 7379  eePerGas"] = asy
+00016230: 6e63 5f77 332e 746f 5f77 6569 2833 2c20  nc_w3.to_wei(3, 
+00016240: 2267 7765 6922 290a 2020 2020 2020 2020  "gwei").        
+00016250: 7478 6e5f 7061 7261 6d73 5b22 6d61 7850  txn_params["maxP
+00016260: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+00016270: 225d 203d 2061 7379 6e63 5f77 332e 746f  "] = async_w3.to
+00016280: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
+00016290: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+000162a0: 6d73 5b22 6e6f 6e63 6522 5d20 3d20 4e6f  ms["nonce"] = No
+000162b0: 6e63 6528 7478 6e5b 226e 6f6e 6365 225d  nce(txn["nonce"]
+000162c0: 202b 2031 290a 2020 2020 2020 2020 7769   + 1).        wi
+000162d0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+000162e0: 2857 6562 3356 616c 7565 4572 726f 7229  (Web3ValueError)
+000162f0: 3a0a 2020 2020 2020 2020 2020 2020 6177  :.            aw
+00016300: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00016310: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
+00016320: 7469 6f6e 2874 786e 5f68 6173 682c 2074  tion(txn_hash, t
+00016330: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
+00016340: 4066 6c61 6b79 5f67 6574 685f 6465 765f  @flaky_geth_dev_
+00016350: 6d69 6e69 6e67 0a20 2020 2040 7079 7465  mining.    @pyte
+00016360: 7374 2e6d 6172 6b2e 6173 796e 6369 6f0a  st.mark.asyncio.
+00016370: 2020 2020 6173 796e 6320 6465 6620 7465      async def te
+00016380: 7374 5f61 7379 6e63 5f65 7468 5f72 6570  st_async_eth_rep
+00016390: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
+000163a0: 5f67 6173 5f70 7269 6365 5f74 6f6f 5f6c  _gas_price_too_l
+000163b0: 6f77 280a 2020 2020 2020 2020 7365 6c66  ow(.        self
+000163c0: 2c0a 2020 2020 2020 2020 6173 796e 635f  ,.        async_
+000163d0: 7733 3a20 2241 7379 6e63 5765 6233 222c  w3: "AsyncWeb3",
+000163e0: 0a20 2020 2020 2020 2061 7379 6e63 5f6b  .        async_k
+000163f0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00016400: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+00016410: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00016420: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+00016430: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+00016440: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+00016450: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00016460: 6672 6f6d 223a 2061 7379 6e63 5f6b 6579  from": async_key
+00016470: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00016480: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+00016490: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+000164a0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
+000164b0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+000164c0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+000164d0: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+000164e0: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+000164f0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+00016500: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00016510: 6173 5072 6963 6522 3a20 6173 796e 635f  asPrice": async_
+00016520: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+00016530: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
+00016540: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00016550: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00016560: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00016570: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00016580: 7329 0a0a 2020 2020 2020 2020 7478 6e5f  s)..        txn_
+00016590: 7061 7261 6d73 5b22 6761 7350 7269 6365  params["gasPrice
+000165a0: 225d 203d 2061 7379 6e63 5f77 332e 746f  "] = async_w3.to
+000165b0: 5f77 6569 2831 2c20 2267 7765 6922 290a  _wei(1, "gwei").
+000165c0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+000165d0: 6573 742e 7261 6973 6573 2857 6562 3356  est.raises(Web3V
+000165e0: 616c 7565 4572 726f 7229 3a0a 2020 2020  alueError):.    
+000165f0: 2020 2020 2020 2020 6177 6169 7420 6173          await as
+00016600: 796e 635f 7733 2e65 7468 2e72 6570 6c61  ync_w3.eth.repla
+00016610: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
+00016620: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
+00016630: 616d 7329 0a0a 2020 2020 4066 6c61 6b79  ams)..    @flaky
+00016640: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
+00016650: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+00016660: 6b2e 6173 796e 6369 6f0a 2020 2020 6173  k.asyncio.    as
+00016670: 796e 6320 6465 6620 7465 7374 5f61 7379  ync def test_asy
+00016680: 6e63 5f65 7468 5f72 6570 6c61 6365 5f74  nc_eth_replace_t
+00016690: 7261 6e73 6163 7469 6f6e 5f67 6173 5f70  ransaction_gas_p
+000166a0: 7269 6365 5f64 6566 6175 6c74 696e 675f  rice_defaulting_
+000166b0: 6d69 6e69 6d75 6d28 0a20 2020 2020 2020  minimum(.       
+000166c0: 2073 656c 662c 2061 7379 6e63 5f77 333a   self, async_w3:
+000166d0: 2022 4173 796e 6357 6562 3322 2c20 6173   "AsyncWeb3", as
+000166e0: 796e 635f 6b65 7966 696c 655f 6163 636f  ync_keyfile_acco
+000166f0: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
+00016700: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00016710: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00016720: 2020 2020 6761 735f 7072 6963 6520 3d20      gas_price = 
+00016730: 6173 796e 635f 7733 2e74 6f5f 7765 6928  async_w3.to_wei(
+00016740: 312c 2022 6777 6569 2229 0a0a 2020 2020  1, "gwei")..    
+00016750: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+00016760: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+00016770: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+00016780: 2061 7379 6e63 5f6b 6579 6669 6c65 5f61   async_keyfile_a
+00016790: 6363 6f75 6e74 5f61 6464 7265 7373 2c0a  ccount_address,.
+000167a0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+000167b0: 3a20 6173 796e 635f 6b65 7966 696c 655f  : async_keyfile_
+000167c0: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
+000167d0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+000167e0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+000167f0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
+00016800: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
+00016810: 2020 2020 2267 6173 5072 6963 6522 3a20      "gasPrice": 
+00016820: 6761 735f 7072 6963 652c 0a20 2020 2020  gas_price,.     
+00016830: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
+00016840: 5f68 6173 6820 3d20 6177 6169 7420 6173  _hash = await as
+00016850: 796e 635f 7733 2e65 7468 2e73 656e 645f  ync_w3.eth.send_
+00016860: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+00016870: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
+00016880: 2074 786e 5f70 6172 616d 732e 706f 7028   txn_params.pop(
+00016890: 2267 6173 5072 6963 6522 290a 2020 2020  "gasPrice").    
+000168a0: 2020 2020 7265 706c 6163 655f 7478 6e5f      replace_txn_
+000168b0: 6861 7368 203d 2061 7761 6974 2061 7379  hash = await asy
+000168c0: 6e63 5f77 332e 6574 682e 7265 706c 6163  nc_w3.eth.replac
+000168d0: 655f 7472 616e 7361 6374 696f 6e28 7478  e_transaction(tx
+000168e0: 6e5f 6861 7368 2c20 7478 6e5f 7061 7261  n_hash, txn_para
+000168f0: 6d73 290a 2020 2020 2020 2020 7265 706c  ms).        repl
+00016900: 6163 655f 7478 6e20 3d20 6177 6169 7420  ace_txn = await 
+00016910: 6173 796e 635f 7733 2e65 7468 2e67 6574  async_w3.eth.get
+00016920: 5f74 7261 6e73 6163 7469 6f6e 2872 6570  _transaction(rep
+00016930: 6c61 6365 5f74 786e 5f68 6173 6829 0a0a  lace_txn_hash)..
+00016940: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00016950: 6570 6c61 6365 5f74 786e 5b22 6761 7350  eplace_txn["gasP
+00016960: 7269 6365 225d 203d 3d20 6d61 7468 2e63  rice"] == math.c
+00016970: 6569 6c28 0a20 2020 2020 2020 2020 2020  eil(.           
+00016980: 2067 6173 5f70 7269 6365 202a 2031 2e31   gas_price * 1.1
+00016990: 3235 0a20 2020 2020 2020 2029 2020 2320  25.        )  # 
+000169a0: 6d69 6e69 6d75 6d20 6761 7320 7072 6963  minimum gas pric
+000169b0: 650a 0a20 2020 2040 666c 616b 795f 6765  e..    @flaky_ge
+000169c0: 7468 5f64 6576 5f6d 696e 696e 670a 2020  th_dev_mining.  
+000169d0: 2020 4070 7974 6573 742e 6d61 726b 2e61    @pytest.mark.a
+000169e0: 7379 6e63 696f 0a20 2020 2061 7379 6e63  syncio.    async
+000169f0: 2064 6566 2074 6573 745f 6173 796e 635f   def test_async_
+00016a00: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
+00016a10: 7361 6374 696f 6e5f 6761 735f 7072 6963  saction_gas_pric
+00016a20: 655f 6465 6661 756c 7469 6e67 5f73 7472  e_defaulting_str
+00016a30: 6174 6567 795f 6869 6768 6572 280a 2020  ategy_higher(.  
+00016a40: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00016a50: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00016a60: 222c 2061 7379 6e63 5f6b 6579 6669 6c65  ", async_keyfile
+00016a70: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00016a80: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+00016a90: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+00016aa0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00016ab0: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+00016ac0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
+00016ad0: 726f 6d22 3a20 6173 796e 635f 6b65 7966  rom": async_keyf
+00016ae0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00016af0: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
+00016b00: 2022 746f 223a 2061 7379 6e63 5f6b 6579   "to": async_key
+00016b10: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00016b20: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
+00016b30: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00016b40: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00016b50: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+00016b60: 2020 2020 2020 2020 2022 6761 7350 7269           "gasPri
+00016b70: 6365 223a 2061 7379 6e63 5f77 332e 746f  ce": async_w3.to
+00016b80: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+00016b90: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00016ba0: 2020 2074 786e 5f68 6173 6820 3d20 6177     txn_hash = aw
+00016bb0: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00016bc0: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+00016bd0: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
+00016be0: 2020 2020 2020 2074 776f 5f67 7765 695f         two_gwei_
+00016bf0: 696e 5f77 6569 203d 2061 7379 6e63 5f77  in_wei = async_w
+00016c00: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
+00016c10: 6922 290a 0a20 2020 2020 2020 2064 6566  i")..        def
+00016c20: 2068 6967 6865 725f 6761 735f 7072 6963   higher_gas_pric
+00016c30: 655f 7374 7261 7465 6779 2861 7379 6e63  e_strategy(async
+00016c40: 5f77 333a 2022 4173 796e 6357 6562 3322  _w3: "AsyncWeb3"
+00016c50: 2c20 7478 6e3a 2054 7850 6172 616d 7329  , txn: TxParams)
+00016c60: 202d 3e20 5765 693a 0a20 2020 2020 2020   -> Wei:.       
+00016c70: 2020 2020 2072 6574 7572 6e20 7477 6f5f       return two_
+00016c80: 6777 6569 5f69 6e5f 7765 690a 0a20 2020  gwei_in_wei..   
+00016c90: 2020 2020 2061 7379 6e63 5f77 332e 6574       async_w3.et
+00016ca0: 682e 7365 745f 6761 735f 7072 6963 655f  h.set_gas_price_
+00016cb0: 7374 7261 7465 6779 2868 6967 6865 725f  strategy(higher_
+00016cc0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
+00016cd0: 6779 290a 0a20 2020 2020 2020 2074 786e  gy)..        txn
+00016ce0: 5f70 6172 616d 732e 706f 7028 2267 6173  _params.pop("gas
+00016cf0: 5072 6963 6522 290a 2020 2020 2020 2020  Price").        
+00016d00: 7265 706c 6163 655f 7478 6e5f 6861 7368  replace_txn_hash
+00016d10: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00016d20: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
+00016d30: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
+00016d40: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
+00016d50: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
+00016d60: 7478 6e20 3d20 6177 6169 7420 6173 796e  txn = await asyn
+00016d70: 635f 7733 2e65 7468 2e67 6574 5f74 7261  c_w3.eth.get_tra
+00016d80: 6e73 6163 7469 6f6e 2872 6570 6c61 6365  nsaction(replace
+00016d90: 5f74 786e 5f68 6173 6829 0a20 2020 2020  _txn_hash).     
+00016da0: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+00016db0: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
+00016dc0: 7478 6e5b 2267 6173 5072 6963 6522 5d20  txn["gasPrice"] 
+00016dd0: 3d3d 2074 776f 5f67 7765 695f 696e 5f77  == two_gwei_in_w
+00016de0: 6569 0a20 2020 2020 2020 2029 2020 2320  ei.        )  # 
+00016df0: 5374 7261 7465 6779 2070 726f 7669 6465  Strategy provide
+00016e00: 7320 6869 6768 6572 2067 6173 2070 7269  s higher gas pri
+00016e10: 6365 0a20 2020 2020 2020 2061 7379 6e63  ce.        async
+00016e20: 5f77 332e 6574 682e 7365 745f 6761 735f  _w3.eth.set_gas_
+00016e30: 7072 6963 655f 7374 7261 7465 6779 284e  price_strategy(N
+00016e40: 6f6e 6529 2020 2320 7265 7365 7420 7374  one)  # reset st
+00016e50: 7261 7465 6779 0a0a 2020 2020 4066 6c61  rategy..    @fla
+00016e60: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
+00016e70: 6e67 0a20 2020 2040 7079 7465 7374 2e6d  ng.    @pytest.m
+00016e80: 6172 6b2e 6173 796e 6369 6f0a 2020 2020  ark.asyncio.    
+00016e90: 6173 796e 6320 6465 6620 7465 7374 5f61  async def test_a
+00016ea0: 7379 6e63 5f65 7468 5f72 6570 6c61 6365  sync_eth_replace
+00016eb0: 5f74 7261 6e73 6163 7469 6f6e 5f67 6173  _transaction_gas
+00016ec0: 5f70 7269 6365 5f64 6566 6175 6c74 696e  _price_defaultin
+00016ed0: 675f 7374 7261 7465 6779 5f6c 6f77 6572  g_strategy_lower
+00016ee0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00016ef0: 6173 796e 635f 7733 3a20 2241 7379 6e63  async_w3: "Async
+00016f00: 5765 6233 222c 2061 7379 6e63 5f6b 6579  Web3", async_key
+00016f10: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00016f20: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
+00016f30: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+00016f40: 6f6e 653a 0a20 2020 2020 2020 2067 6173  one:.        gas
+00016f50: 5f70 7269 6365 203d 2061 7379 6e63 5f77  _price = async_w
+00016f60: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
+00016f70: 6922 290a 0a20 2020 2020 2020 2074 786e  i")..        txn
+00016f80: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+00016f90: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00016fa0: 2020 2266 726f 6d22 3a20 6173 796e 635f    "from": async_
+00016fb0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00016fc0: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+00016fd0: 2020 2020 2022 746f 223a 2061 7379 6e63       "to": async
+00016fe0: 5f6b 6579 6669 6c65 5f61 6363 6f75 6e74  _keyfile_account
+00016ff0: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
+00017000: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
+00017010: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
+00017020: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
+00017030: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
+00017040: 7350 7269 6365 223a 2067 6173 5f70 7269  sPrice": gas_pri
+00017050: 6365 2c0a 2020 2020 2020 2020 7d0a 2020  ce,.        }.  
+00017060: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
+00017070: 2061 7761 6974 2061 7379 6e63 5f77 332e   await async_w3.
+00017080: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+00017090: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+000170a0: 0a0a 2020 2020 2020 2020 6465 6620 6c6f  ..        def lo
+000170b0: 7765 725f 6761 735f 7072 6963 655f 7374  wer_gas_price_st
+000170c0: 7261 7465 6779 2861 7379 6e63 5f77 333a  rategy(async_w3:
+000170d0: 2022 4173 796e 6357 6562 3322 2c20 7478   "AsyncWeb3", tx
+000170e0: 6e3a 2054 7850 6172 616d 7329 202d 3e20  n: TxParams) -> 
+000170f0: 5765 693a 0a20 2020 2020 2020 2020 2020  Wei:.           
+00017100: 2072 6574 7572 6e20 6173 796e 635f 7733   return async_w3
+00017110: 2e74 6f5f 7765 6928 312c 2022 6777 6569  .to_wei(1, "gwei
+00017120: 2229 0a0a 2020 2020 2020 2020 6173 796e  ")..        asyn
+00017130: 635f 7733 2e65 7468 2e73 6574 5f67 6173  c_w3.eth.set_gas
+00017140: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
+00017150: 6c6f 7765 725f 6761 735f 7072 6963 655f  lower_gas_price_
+00017160: 7374 7261 7465 6779 290a 0a20 2020 2020  strategy)..     
+00017170: 2020 2074 786e 5f70 6172 616d 732e 706f     txn_params.po
+00017180: 7028 2267 6173 5072 6963 6522 290a 2020  p("gasPrice").  
+00017190: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
+000171a0: 6e5f 6861 7368 203d 2061 7761 6974 2061  n_hash = await a
+000171b0: 7379 6e63 5f77 332e 6574 682e 7265 706c  sync_w3.eth.repl
+000171c0: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
+000171d0: 7478 6e5f 6861 7368 2c20 7478 6e5f 7061  txn_hash, txn_pa
+000171e0: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+000171f0: 706c 6163 655f 7478 6e20 3d20 6177 6169  place_txn = awai
+00017200: 7420 6173 796e 635f 7733 2e65 7468 2e67  t async_w3.eth.g
+00017210: 6574 5f74 7261 6e73 6163 7469 6f6e 2872  et_transaction(r
+00017220: 6570 6c61 6365 5f74 786e 5f68 6173 6829  eplace_txn_hash)
+00017230: 0a20 2020 2020 2020 2023 2053 7472 6174  .        # Strat
+00017240: 6567 7920 7072 6f76 6964 6573 206c 6f77  egy provides low
+00017250: 6572 2067 6173 2070 7269 6365 202d 206d  er gas price - m
+00017260: 696e 696d 756d 2070 7265 6665 7272 6564  inimum preferred
+00017270: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00017280: 7265 706c 6163 655f 7478 6e5b 2267 6173  replace_txn["gas
+00017290: 5072 6963 6522 5d20 3d3d 206d 6174 682e  Price"] == math.
+000172a0: 6365 696c 2867 6173 5f70 7269 6365 202a  ceil(gas_price *
+000172b0: 2031 2e31 3235 290a 2020 2020 2020 2020   1.125).        
+000172c0: 6173 796e 635f 7733 2e65 7468 2e73 6574  async_w3.eth.set
+000172d0: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+000172e0: 6567 7928 4e6f 6e65 2920 2023 2072 6573  egy(None)  # res
+000172f0: 6574 2073 7472 6174 6567 790a 0a20 2020  et strategy..   
+00017300: 2040 7079 7465 7374 2e6d 6172 6b2e 6173   @pytest.mark.as
+00017310: 796e 6369 6f0a 2020 2020 6173 796e 6320  yncio.    async 
+00017320: 6465 6620 7465 7374 5f61 7379 6e63 5f65  def test_async_e
+00017330: 7468 5f6e 6577 5f66 696c 7465 7228 7365  th_new_filter(se
+00017340: 6c66 2c20 6173 796e 635f 7733 3a20 2241  lf, async_w3: "A
+00017350: 7379 6e63 5765 6233 2229 202d 3e20 4e6f  syncWeb3") -> No
+00017360: 6e65 3a0a 2020 2020 2020 2020 6669 6c74  ne:.        filt
+00017370: 6572 203d 2061 7761 6974 2061 7379 6e63  er = await async
+00017380: 5f77 332e 6574 682e 6669 6c74 6572 287b  _w3.eth.filter({
+00017390: 7d29 0a0a 2020 2020 2020 2020 6368 616e  })..        chan
+000173a0: 6765 7320 3d20 6177 6169 7420 6173 796e  ges = await asyn
+000173b0: 635f 7733 2e65 7468 2e67 6574 5f66 696c  c_w3.eth.get_fil
+000173c0: 7465 725f 6368 616e 6765 7328 6669 6c74  ter_changes(filt
+000173d0: 6572 2e66 696c 7465 725f 6964 290a 2020  er.filter_id).  
+000173e0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+000173f0: 6c69 7374 5f6c 696b 6528 6368 616e 6765  list_like(change
+00017400: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+00017410: 7420 6e6f 7420 6368 616e 6765 730a 0a20  t not changes.. 
+00017420: 2020 2020 2020 206c 6f67 7320 3d20 6177         logs = aw
+00017430: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00017440: 2e67 6574 5f66 696c 7465 725f 6c6f 6773  .get_filter_logs
+00017450: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
+00017460: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
+00017470: 7420 6973 5f6c 6973 745f 6c69 6b65 286c  t is_list_like(l
+00017480: 6f67 7329 0a20 2020 2020 2020 2061 7373  ogs).        ass
+00017490: 6572 7420 6e6f 7420 6c6f 6773 0a0a 2020  ert not logs..  
+000174a0: 2020 2020 2020 7265 7375 6c74 203d 2061        result = a
+000174b0: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+000174c0: 682e 756e 696e 7374 616c 6c5f 6669 6c74  h.uninstall_filt
+000174d0: 6572 2866 696c 7465 722e 6669 6c74 6572  er(filter.filter
+000174e0: 5f69 6429 0a20 2020 2020 2020 2061 7373  _id).        ass
+000174f0: 6572 7420 7265 7375 6c74 2069 7320 5472  ert result is Tr
+00017500: 7565 0a0a 2020 2020 4070 7974 6573 742e  ue..    @pytest.
+00017510: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+00017520: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+00017530: 6173 796e 635f 6574 685f 6e65 775f 626c  async_eth_new_bl
+00017540: 6f63 6b5f 6669 6c74 6572 2873 656c 662c  ock_filter(self,
+00017550: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+00017560: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+00017570: 0a20 2020 2020 2020 2066 696c 7465 7220  .        filter 
+00017580: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00017590: 2e65 7468 2e66 696c 7465 7228 226c 6174  .eth.filter("lat
+000175a0: 6573 7422 290a 2020 2020 2020 2020 6173  est").        as
+000175b0: 7365 7274 2069 735f 7374 7269 6e67 2866  sert is_string(f
+000175c0: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
+000175d0: 0a0a 2020 2020 2020 2020 6368 616e 6765  ..        change
+000175e0: 7320 3d20 6177 6169 7420 6173 796e 635f  s = await async_
+000175f0: 7733 2e65 7468 2e67 6574 5f66 696c 7465  w3.eth.get_filte
+00017600: 725f 6368 616e 6765 7328 6669 6c74 6572  r_changes(filter
+00017610: 2e66 696c 7465 725f 6964 290a 2020 2020  .filter_id).    
+00017620: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
+00017630: 7374 5f6c 696b 6528 6368 616e 6765 7329  st_like(changes)
+00017640: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+00017650: 203d 2061 7761 6974 2061 7379 6e63 5f77   = await async_w
+00017660: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
+00017670: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
+00017680: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+00017690: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+000176a0: 7320 5472 7565 0a0a 2020 2020 4070 7974  s True..    @pyt
+000176b0: 6573 742e 6d61 726b 2e61 7379 6e63 696f  est.mark.asyncio
+000176c0: 0a20 2020 2061 7379 6e63 2064 6566 2074  .    async def t
+000176d0: 6573 745f 6173 796e 635f 6574 685f 6e65  est_async_eth_ne
+000176e0: 775f 7065 6e64 696e 675f 7472 616e 7361  w_pending_transa
+000176f0: 6374 696f 6e5f 6669 6c74 6572 280a 2020  ction_filter(.  
+00017700: 2020 2020 2020 7365 6c66 2c20 6173 796e        self, asyn
+00017710: 635f 7733 3a20 2241 7379 6e63 5765 6233  c_w3: "AsyncWeb3
+00017720: 220a 2020 2020 2920 2d3e 204e 6f6e 653a  ".    ) -> None:
+00017730: 0a20 2020 2020 2020 2066 696c 7465 7220  .        filter 
+00017740: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00017750: 2e65 7468 2e66 696c 7465 7228 2270 656e  .eth.filter("pen
+00017760: 6469 6e67 2229 0a20 2020 2020 2020 2061  ding").        a
+00017770: 7373 6572 7420 6973 5f73 7472 696e 6728  ssert is_string(
+00017780: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
+00017790: 290a 0a20 2020 2020 2020 2063 6861 6e67  )..        chang
+000177a0: 6573 203d 2061 7761 6974 2061 7379 6e63  es = await async
+000177b0: 5f77 332e 6574 682e 6765 745f 6669 6c74  _w3.eth.get_filt
+000177c0: 6572 5f63 6861 6e67 6573 2866 696c 7465  er_changes(filte
+000177d0: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
+000177e0: 2020 2020 2061 7373 6572 7420 6973 5f6c       assert is_l
+000177f0: 6973 745f 6c69 6b65 2863 6861 6e67 6573  ist_like(changes
+00017800: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00017810: 206e 6f74 2063 6861 6e67 6573 0a0a 2020   not changes..  
+00017820: 2020 2020 2020 7265 7375 6c74 203d 2061        result = a
+00017830: 7761 6974 2061 7379 6e63 5f77 332e 6574  wait async_w3.et
+00017840: 682e 756e 696e 7374 616c 6c5f 6669 6c74  h.uninstall_filt
+00017850: 6572 2866 696c 7465 722e 6669 6c74 6572  er(filter.filter
+00017860: 5f69 6429 0a20 2020 2020 2020 2061 7373  _id).        ass
+00017870: 6572 7420 7265 7375 6c74 2069 7320 5472  ert result is Tr
+00017880: 7565 0a0a 2020 2020 4070 7974 6573 742e  ue..    @pytest.
+00017890: 6d61 726b 2e61 7379 6e63 696f 0a20 2020  mark.asyncio.   
+000178a0: 2061 7379 6e63 2064 6566 2074 6573 745f   async def test_
+000178b0: 6173 796e 635f 6574 685f 756e 696e 7374  async_eth_uninst
+000178c0: 616c 6c5f 6669 6c74 6572 2873 656c 662c  all_filter(self,
+000178d0: 2061 7379 6e63 5f77 333a 2022 4173 796e   async_w3: "Asyn
+000178e0: 6357 6562 3322 2920 2d3e 204e 6f6e 653a  cWeb3") -> None:
+000178f0: 0a20 2020 2020 2020 2066 696c 7465 7220  .        filter 
+00017900: 3d20 6177 6169 7420 6173 796e 635f 7733  = await async_w3
+00017910: 2e65 7468 2e66 696c 7465 7228 7b7d 290a  .eth.filter({}).
+00017920: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00017930: 735f 7374 7269 6e67 2866 696c 7465 722e  s_string(filter.
+00017940: 6669 6c74 6572 5f69 6429 0a0a 2020 2020  filter_id)..    
+00017950: 2020 2020 7375 6363 6573 7320 3d20 6177      success = aw
+00017960: 6169 7420 6173 796e 635f 7733 2e65 7468  ait async_w3.eth
+00017970: 2e75 6e69 6e73 7461 6c6c 5f66 696c 7465  .uninstall_filte
+00017980: 7228 6669 6c74 6572 2e66 696c 7465 725f  r(filter.filter_
+00017990: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
+000179a0: 7274 2073 7563 6365 7373 2069 7320 5472  rt success is Tr
+000179b0: 7565 0a0a 2020 2020 2020 2020 6661 696c  ue..        fail
+000179c0: 7572 6520 3d20 6177 6169 7420 6173 796e  ure = await asyn
+000179d0: 635f 7733 2e65 7468 2e75 6e69 6e73 7461  c_w3.eth.uninsta
+000179e0: 6c6c 5f66 696c 7465 7228 6669 6c74 6572  ll_filter(filter
+000179f0: 2e66 696c 7465 725f 6964 290a 2020 2020  .filter_id).    
+00017a00: 2020 2020 6173 7365 7274 2066 6169 6c75      assert failu
+00017a10: 7265 2069 7320 4661 6c73 650a 0a0a 636c  re is False...cl
+00017a20: 6173 7320 4574 684d 6f64 756c 6554 6573  ass EthModuleTes
+00017a30: 743a 0a20 2020 2064 6566 2074 6573 745f  t:.    def test_
+00017a40: 6574 685f 7379 6e63 696e 6728 7365 6c66  eth_syncing(self
+00017a50: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
+00017a60: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+00017a70: 796e 6369 6e67 203d 2077 332e 6574 682e  yncing = w3.eth.
+00017a80: 7379 6e63 696e 670a 0a20 2020 2020 2020  syncing..       
+00017a90: 2061 7373 6572 7420 6973 5f62 6f6f 6c65   assert is_boole
+00017aa0: 616e 2873 796e 6369 6e67 2920 6f72 2069  an(syncing) or i
+00017ab0: 735f 6469 6374 2873 796e 6369 6e67 290a  s_dict(syncing).
+00017ac0: 0a20 2020 2020 2020 2069 6620 6973 5f62  .        if is_b
+00017ad0: 6f6f 6c65 616e 2873 796e 6369 6e67 293a  oolean(syncing):
+00017ae0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00017af0: 6572 7420 7379 6e63 696e 6720 6973 2046  ert syncing is F
+00017b00: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
+00017b10: 6620 6973 5f64 6963 7428 7379 6e63 696e  f is_dict(syncin
+00017b20: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
+00017b30: 7379 6e63 5f64 6963 7420 3d20 6361 7374  sync_dict = cast
+00017b40: 2853 796e 6353 7461 7475 732c 2073 796e  (SyncStatus, syn
+00017b50: 6369 6e67 290a 2020 2020 2020 2020 2020  cing).          
+00017b60: 2020 6173 7365 7274 2022 7374 6172 7469    assert "starti
+00017b70: 6e67 426c 6f63 6b22 2069 6e20 7379 6e63  ngBlock" in sync
+00017b80: 5f64 6963 740a 2020 2020 2020 2020 2020  _dict.          
+00017b90: 2020 6173 7365 7274 2022 6375 7272 656e    assert "curren
+00017ba0: 7442 6c6f 636b 2220 696e 2073 796e 635f  tBlock" in sync_
+00017bb0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00017bc0: 2061 7373 6572 7420 2268 6967 6865 7374   assert "highest
+00017bd0: 426c 6f63 6b22 2069 6e20 7379 6e63 5f64  Block" in sync_d
+00017be0: 6963 740a 0a20 2020 2020 2020 2020 2020  ict..           
+00017bf0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+00017c00: 6572 2873 796e 635f 6469 6374 5b22 7374  er(sync_dict["st
+00017c10: 6172 7469 6e67 426c 6f63 6b22 5d29 0a20  artingBlock"]). 
+00017c20: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00017c30: 7420 6973 5f69 6e74 6567 6572 2873 796e  t is_integer(syn
+00017c40: 635f 6469 6374 5b22 6375 7272 656e 7442  c_dict["currentB
+00017c50: 6c6f 636b 225d 290a 2020 2020 2020 2020  lock"]).        
+00017c60: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+00017c70: 7465 6765 7228 7379 6e63 5f64 6963 745b  teger(sync_dict[
+00017c80: 2268 6967 6865 7374 426c 6f63 6b22 5d29  "highestBlock"])
+00017c90: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00017ca0: 7468 5f63 6f69 6e62 6173 6528 7365 6c66  th_coinbase(self
+00017cb0: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
+00017cc0: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
+00017cd0: 6f69 6e62 6173 6520 3d20 7733 2e65 7468  oinbase = w3.eth
+00017ce0: 2e63 6f69 6e62 6173 650a 2020 2020 2020  .coinbase.      
+00017cf0: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
+00017d00: 6b73 756d 5f61 6464 7265 7373 2863 6f69  ksum_address(coi
+00017d10: 6e62 6173 6529 0a0a 2020 2020 6465 6620  nbase)..    def 
+00017d20: 7465 7374 5f65 7468 5f6d 696e 696e 6728  test_eth_mining(
+00017d30: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00017d40: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00017d50: 2020 206d 696e 696e 6720 3d20 7733 2e65     mining = w3.e
+00017d60: 7468 2e6d 696e 696e 670a 2020 2020 2020  th.mining.      
+00017d70: 2020 6173 7365 7274 2069 735f 626f 6f6c    assert is_bool
+00017d80: 6561 6e28 6d69 6e69 6e67 290a 0a20 2020  ean(mining)..   
+00017d90: 2064 6566 2074 6573 745f 6574 685f 6861   def test_eth_ha
+00017da0: 7368 7261 7465 2873 656c 662c 2077 333a  shrate(self, w3:
+00017db0: 2022 5765 6233 2229 202d 3e20 4e6f 6e65   "Web3") -> None
+00017dc0: 3a0a 2020 2020 2020 2020 6861 7368 7261  :.        hashra
+00017dd0: 7465 203d 2077 332e 6574 682e 6861 7368  te = w3.eth.hash
+00017de0: 7261 7465 0a20 2020 2020 2020 2061 7373  rate.        ass
+00017df0: 6572 7420 6973 5f69 6e74 6567 6572 2868  ert is_integer(h
+00017e00: 6173 6872 6174 6529 0a20 2020 2020 2020  ashrate).       
+00017e10: 2061 7373 6572 7420 6861 7368 7261 7465   assert hashrate
+00017e20: 203e 3d20 300a 0a20 2020 2064 6566 2074   >= 0..    def t
+00017e30: 6573 745f 6574 685f 6368 6169 6e5f 6964  est_eth_chain_id
+00017e40: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+00017e50: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+00017e60: 2020 2020 6368 6169 6e5f 6964 203d 2077      chain_id = w
+00017e70: 332e 6574 682e 6368 6169 6e5f 6964 0a20  3.eth.chain_id. 
+00017e80: 2020 2020 2020 2023 2063 6861 696e 2069         # chain i
+00017e90: 6420 7661 6c75 6520 6672 6f6d 2067 6574  d value from get
+00017ea0: 6820 6669 7874 7572 6520 6765 6e65 7369  h fixture genesi
+00017eb0: 7320 6669 6c65 0a20 2020 2020 2020 2061  s file.        a
+00017ec0: 7373 6572 7420 6368 6169 6e5f 6964 203d  ssert chain_id =
+00017ed0: 3d20 3133 3132 3737 3332 3239 3430 3533  = 13127732294053
+00017ee0: 370a 0a20 2020 2064 6566 2074 6573 745f  7..    def test_
+00017ef0: 6574 685f 6665 655f 6869 7374 6f72 7928  eth_fee_history(
+00017f00: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00017f10: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00017f20: 2020 2066 6565 5f68 6973 746f 7279 203d     fee_history =
+00017f30: 2077 332e 6574 682e 6665 655f 6869 7374   w3.eth.fee_hist
+00017f40: 6f72 7928 312c 2022 6c61 7465 7374 222c  ory(1, "latest",
+00017f50: 205b 3530 5d29 0a20 2020 2020 2020 2061   [50]).        a
+00017f60: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+00017f70: 6b65 2866 6565 5f68 6973 746f 7279 5b22  ke(fee_history["
+00017f80: 6261 7365 4665 6550 6572 4761 7322 5d29  baseFeePerGas"])
+00017f90: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00017fa0: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
+00017fb0: 5f68 6973 746f 7279 5b22 6761 7355 7365  _history["gasUse
+00017fc0: 6452 6174 696f 225d 290a 2020 2020 2020  dRatio"]).      
+00017fd0: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00017fe0: 6765 7228 6665 655f 6869 7374 6f72 795b  ger(fee_history[
+00017ff0: 226f 6c64 6573 7442 6c6f 636b 225d 290a  "oldestBlock"]).
+00018000: 2020 2020 2020 2020 6173 7365 7274 2066          assert f
+00018010: 6565 5f68 6973 746f 7279 5b22 6f6c 6465  ee_history["olde
+00018020: 7374 426c 6f63 6b22 5d20 3e3d 2030 0a20  stBlock"] >= 0. 
+00018030: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00018040: 5f6c 6973 745f 6c69 6b65 2866 6565 5f68  _list_like(fee_h
+00018050: 6973 746f 7279 5b22 7265 7761 7264 225d  istory["reward"]
+00018060: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
+00018070: 2866 6565 5f68 6973 746f 7279 5b22 7265  (fee_history["re
+00018080: 7761 7264 225d 2920 3e20 303a 0a20 2020  ward"]) > 0:.   
+00018090: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000180a0: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
+000180b0: 5f68 6973 746f 7279 5b22 7265 7761 7264  _history["reward
+000180c0: 225d 5b30 5d29 0a0a 2020 2020 6465 6620  "][0])..    def 
+000180d0: 7465 7374 5f65 7468 5f66 6565 5f68 6973  test_eth_fee_his
+000180e0: 746f 7279 5f77 6974 685f 696e 7465 6765  tory_with_intege
+000180f0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+00018100: 2077 333a 2022 5765 6233 222c 2065 6d70   w3: "Web3", emp
+00018110: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
+00018120: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
+00018130: 653a 0a20 2020 2020 2020 2066 6565 5f68  e:.        fee_h
+00018140: 6973 746f 7279 203d 2077 332e 6574 682e  istory = w3.eth.
+00018150: 6665 655f 6869 7374 6f72 7928 312c 2065  fee_history(1, e
+00018160: 6d70 7479 5f62 6c6f 636b 5b22 6e75 6d62  mpty_block["numb
+00018170: 6572 225d 2c20 5b35 305d 290a 2020 2020  er"], [50]).    
+00018180: 2020 2020 6173 7365 7274 2069 735f 6c69      assert is_li
+00018190: 7374 5f6c 696b 6528 6665 655f 6869 7374  st_like(fee_hist
+000181a0: 6f72 795b 2262 6173 6546 6565 5065 7247  ory["baseFeePerG
+000181b0: 6173 225d 290a 2020 2020 2020 2020 6173  as"]).        as
+000181c0: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
+000181d0: 6528 6665 655f 6869 7374 6f72 795b 2267  e(fee_history["g
+000181e0: 6173 5573 6564 5261 7469 6f22 5d29 0a20  asUsedRatio"]). 
+000181f0: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00018200: 5f69 6e74 6567 6572 2866 6565 5f68 6973  _integer(fee_his
+00018210: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
+00018220: 6b22 5d29 0a20 2020 2020 2020 2061 7373  k"]).        ass
+00018230: 6572 7420 6665 655f 6869 7374 6f72 795b  ert fee_history[
+00018240: 226f 6c64 6573 7442 6c6f 636b 225d 203e  "oldestBlock"] >
+00018250: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
+00018260: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
+00018270: 6665 655f 6869 7374 6f72 795b 2272 6577  fee_history["rew
+00018280: 6172 6422 5d29 0a20 2020 2020 2020 2069  ard"]).        i
+00018290: 6620 6c65 6e28 6665 655f 6869 7374 6f72  f len(fee_histor
+000182a0: 795b 2272 6577 6172 6422 5d29 203e 2030  y["reward"]) > 0
+000182b0: 3a0a 2020 2020 2020 2020 2020 2020 6173  :.            as
+000182c0: 7365 7274 2069 735f 6c69 7374 5f6c 696b  sert is_list_lik
+000182d0: 6528 6665 655f 6869 7374 6f72 795b 2272  e(fee_history["r
+000182e0: 6577 6172 6422 5d5b 305d 290a 0a20 2020  eward"][0])..   
+000182f0: 2064 6566 2074 6573 745f 6574 685f 6665   def test_eth_fe
+00018300: 655f 6869 7374 6f72 795f 6e6f 5f72 6577  e_history_no_rew
+00018310: 6172 645f 7065 7263 656e 7469 6c65 7328  ard_percentiles(
+00018320: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00018330: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00018340: 2020 2066 6565 5f68 6973 746f 7279 203d     fee_history =
+00018350: 2077 332e 6574 682e 6665 655f 6869 7374   w3.eth.fee_hist
+00018360: 6f72 7928 312c 2022 6c61 7465 7374 2229  ory(1, "latest")
+00018370: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00018380: 6973 5f6c 6973 745f 6c69 6b65 2866 6565  is_list_like(fee
+00018390: 5f68 6973 746f 7279 5b22 6261 7365 4665  _history["baseFe
+000183a0: 6550 6572 4761 7322 5d29 0a20 2020 2020  ePerGas"]).     
+000183b0: 2020 2061 7373 6572 7420 6973 5f6c 6973     assert is_lis
+000183c0: 745f 6c69 6b65 2866 6565 5f68 6973 746f  t_like(fee_histo
+000183d0: 7279 5b22 6761 7355 7365 6452 6174 696f  ry["gasUsedRatio
+000183e0: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
+000183f0: 7274 2069 735f 696e 7465 6765 7228 6665  rt is_integer(fe
+00018400: 655f 6869 7374 6f72 795b 226f 6c64 6573  e_history["oldes
+00018410: 7442 6c6f 636b 225d 290a 2020 2020 2020  tBlock"]).      
+00018420: 2020 6173 7365 7274 2066 6565 5f68 6973    assert fee_his
+00018430: 746f 7279 5b22 6f6c 6465 7374 426c 6f63  tory["oldestBloc
+00018440: 6b22 5d20 3e3d 2030 0a0a 2020 2020 6465  k"] >= 0..    de
+00018450: 6620 7465 7374 5f65 7468 5f67 6173 5f70  f test_eth_gas_p
+00018460: 7269 6365 2873 656c 662c 2077 333a 2022  rice(self, w3: "
+00018470: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+00018480: 2020 2020 2020 2020 6761 735f 7072 6963          gas_pric
+00018490: 6520 3d20 7733 2e65 7468 2e67 6173 5f70  e = w3.eth.gas_p
+000184a0: 7269 6365 0a20 2020 2020 2020 2061 7373  rice.        ass
+000184b0: 6572 7420 6973 5f69 6e74 6567 6572 2867  ert is_integer(g
+000184c0: 6173 5f70 7269 6365 290a 2020 2020 2020  as_price).      
+000184d0: 2020 6173 7365 7274 2067 6173 5f70 7269    assert gas_pri
+000184e0: 6365 203e 2030 0a0a 2020 2020 6465 6620  ce > 0..    def 
+000184f0: 7465 7374 5f65 7468 5f6d 6178 5f70 7269  test_eth_max_pri
+00018500: 6f72 6974 795f 6665 6528 7365 6c66 2c20  ority_fee(self, 
+00018510: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
+00018520: 6f6e 653a 0a20 2020 2020 2020 206d 6178  one:.        max
+00018530: 5f70 7269 6f72 6974 795f 6665 6520 3d20  _priority_fee = 
+00018540: 7733 2e65 7468 2e6d 6178 5f70 7269 6f72  w3.eth.max_prior
+00018550: 6974 795f 6665 650a 2020 2020 2020 2020  ity_fee.        
+00018560: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
+00018570: 7228 6d61 785f 7072 696f 7269 7479 5f66  r(max_priority_f
+00018580: 6565 290a 0a20 2020 2064 6566 2074 6573  ee)..    def tes
+00018590: 745f 6574 685f 6d61 785f 7072 696f 7269  t_eth_max_priori
+000185a0: 7479 5f66 6565 5f77 6974 685f 6665 655f  ty_fee_with_fee_
+000185b0: 6869 7374 6f72 795f 6361 6c63 756c 6174  history_calculat
+000185c0: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
+000185d0: 662c 2077 333a 2022 5765 6233 222c 2072  f, w3: "Web3", r
+000185e0: 6571 7565 7374 5f6d 6f63 6b65 723a 2054  equest_mocker: T
+000185f0: 7970 655b 5265 7175 6573 744d 6f63 6b65  ype[RequestMocke
+00018600: 725d 0a20 2020 2029 202d 3e20 4e6f 6e65  r].    ) -> None
+00018610: 3a0a 2020 2020 2020 2020 7769 7468 2072  :.        with r
+00018620: 6571 7565 7374 5f6d 6f63 6b65 7228 0a20  equest_mocker(. 
+00018630: 2020 2020 2020 2020 2020 2077 332c 0a20             w3,. 
+00018640: 2020 2020 2020 2020 2020 206d 6f63 6b5f             mock_
+00018650: 6572 726f 7273 3d7b 5250 4345 6e64 706f  errors={RPCEndpo
+00018660: 696e 7428 2265 7468 5f6d 6178 5072 696f  int("eth_maxPrio
+00018670: 7269 7479 4665 6550 6572 4761 7322 293a  rityFeePerGas"):
+00018680: 207b 7d7d 2c0a 2020 2020 2020 2020 2020   {}},.          
+00018690: 2020 6d6f 636b 5f72 6573 756c 7473 3d7b    mock_results={
+000186a0: 5250 4345 6e64 706f 696e 7428 2265 7468  RPCEndpoint("eth
+000186b0: 5f66 6565 4869 7374 6f72 7922 293a 207b  _feeHistory"): {
+000186c0: 2272 6577 6172 6422 3a20 5b5b 305d 5d7d  "reward": [[0]]}
+000186d0: 7d2c 0a20 2020 2020 2020 2029 3a0a 2020  },.        ):.  
+000186e0: 2020 2020 2020 2020 2020 7769 7468 2070            with p
+000186f0: 7974 6573 742e 7761 726e 7328 0a20 2020  ytest.warns(.   
+00018700: 2020 2020 2020 2020 2020 2020 2055 7365               Use
+00018710: 7257 6172 6e69 6e67 2c0a 2020 2020 2020  rWarning,.      
+00018720: 2020 2020 2020 2020 2020 6d61 7463 683d            match=
+00018730: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00018740: 2020 2020 2020 2254 6865 7265 2077 6173        "There was
+00018750: 2061 6e20 6973 7375 6520 7769 7468 2074   an issue with t
+00018760: 6865 206d 6574 686f 6420 6574 685f 6d61  he method eth_ma
+00018770: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00018780: 6173 2e20 220a 2020 2020 2020 2020 2020  as. ".          
+00018790: 2020 2020 2020 2020 2020 2243 616c 6375            "Calcu
+000187a0: 6c61 7469 6e67 2075 7369 6e67 2065 7468  lating using eth
+000187b0: 5f66 6565 4869 7374 6f72 792e 220a 2020  _feeHistory.".  
+000187c0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+000187d0: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
+000187e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187f0: 6d61 785f 7072 696f 7269 7479 5f66 6565  max_priority_fee
+00018800: 203d 2077 332e 6574 682e 6d61 785f 7072   = w3.eth.max_pr
+00018810: 696f 7269 7479 5f66 6565 0a20 2020 2020  iority_fee.     
+00018820: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00018830: 7420 6973 5f69 6e74 6567 6572 286d 6178  t is_integer(max
+00018840: 5f70 7269 6f72 6974 795f 6665 6529 0a20  _priority_fee). 
+00018850: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018860: 7373 6572 7420 6d61 785f 7072 696f 7269  ssert max_priori
+00018870: 7479 5f66 6565 203d 3d20 5052 494f 5249  ty_fee == PRIORI
+00018880: 5459 5f46 4545 5f4d 494e 0a0a 2020 2020  TY_FEE_MIN..    
+00018890: 6465 6620 7465 7374 5f65 7468 5f61 6363  def test_eth_acc
+000188a0: 6f75 6e74 7328 7365 6c66 2c20 7733 3a20  ounts(self, w3: 
+000188b0: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
+000188c0: 0a20 2020 2020 2020 2061 6363 6f75 6e74  .        account
+000188d0: 7320 3d20 7733 2e65 7468 2e61 6363 6f75  s = w3.eth.accou
+000188e0: 6e74 730a 2020 2020 2020 2020 6173 7365  nts.        asse
+000188f0: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
+00018900: 6163 636f 756e 7473 290a 2020 2020 2020  accounts).      
+00018910: 2020 6173 7365 7274 206c 656e 2861 6363    assert len(acc
+00018920: 6f75 6e74 7329 2021 3d20 300a 2020 2020  ounts) != 0.    
+00018930: 2020 2020 6173 7365 7274 2061 6c6c 2869      assert all(i
+00018940: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
+00018950: 7373 2861 6363 6f75 6e74 2920 666f 7220  ss(account) for 
+00018960: 6163 636f 756e 7420 696e 2061 6363 6f75  account in accou
+00018970: 6e74 7329 0a20 2020 2020 2020 2061 7373  nts).        ass
+00018980: 6572 7420 7733 2e65 7468 2e63 6f69 6e62  ert w3.eth.coinb
+00018990: 6173 6520 696e 2061 6363 6f75 6e74 730a  ase in accounts.
+000189a0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+000189b0: 685f 626c 6f63 6b5f 6e75 6d62 6572 2873  h_block_number(s
+000189c0: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
+000189d0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000189e0: 2020 626c 6f63 6b5f 6e75 6d62 6572 203d    block_number =
+000189f0: 2077 332e 6574 682e 626c 6f63 6b5f 6e75   w3.eth.block_nu
+00018a00: 6d62 6572 0a20 2020 2020 2020 2061 7373  mber.        ass
+00018a10: 6572 7420 6973 5f69 6e74 6567 6572 2862  ert is_integer(b
+00018a20: 6c6f 636b 5f6e 756d 6265 7229 0a20 2020  lock_number).   
+00018a30: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
+00018a40: 6b5f 6e75 6d62 6572 203e 3d20 300a 0a20  k_number >= 0.. 
+00018a50: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00018a60: 6765 745f 626c 6f63 6b5f 6e75 6d62 6572  get_block_number
+00018a70: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+00018a80: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+00018a90: 2020 2020 626c 6f63 6b5f 6e75 6d62 6572      block_number
+00018aa0: 203d 2077 332e 6574 682e 6765 745f 626c   = w3.eth.get_bl
+00018ab0: 6f63 6b5f 6e75 6d62 6572 2829 0a20 2020  ock_number().   
+00018ac0: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+00018ad0: 6e74 6567 6572 2862 6c6f 636b 5f6e 756d  nteger(block_num
+00018ae0: 6265 7229 0a20 2020 2020 2020 2061 7373  ber).        ass
+00018af0: 6572 7420 626c 6f63 6b5f 6e75 6d62 6572  ert block_number
+00018b00: 203e 3d20 300a 0a20 2020 2064 6566 2074   >= 0..    def t
+00018b10: 6573 745f 6574 685f 6765 745f 6261 6c61  est_eth_get_bala
+00018b20: 6e63 6528 7365 6c66 2c20 7733 3a20 2257  nce(self, w3: "W
+00018b30: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
+00018b40: 2020 2020 2020 2063 6f69 6e62 6173 6520         coinbase 
+00018b50: 3d20 7733 2e65 7468 2e63 6f69 6e62 6173  = w3.eth.coinbas
+00018b60: 650a 0a20 2020 2020 2020 2077 6974 6820  e..        with 
+00018b70: 7079 7465 7374 2e72 6169 7365 7328 496e  pytest.raises(In
+00018b80: 7661 6c69 6441 6464 7265 7373 293a 0a20  validAddress):. 
+00018b90: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+00018ba0: 682e 6765 745f 6261 6c61 6e63 6528 4368  h.get_balance(Ch
+00018bb0: 6563 6b73 756d 4164 6472 6573 7328 4865  ecksumAddress(He
+00018bc0: 7841 6464 7265 7373 2848 6578 5374 7228  xAddress(HexStr(
+00018bd0: 636f 696e 6261 7365 2e6c 6f77 6572 2829  coinbase.lower()
+00018be0: 2929 2929 0a0a 2020 2020 2020 2020 6261  ))))..        ba
+00018bf0: 6c61 6e63 6520 3d20 7733 2e65 7468 2e67  lance = w3.eth.g
+00018c00: 6574 5f62 616c 616e 6365 2863 6f69 6e62  et_balance(coinb
+00018c10: 6173 6529 0a0a 2020 2020 2020 2020 6173  ase)..        as
+00018c20: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+00018c30: 6261 6c61 6e63 6529 0a20 2020 2020 2020  balance).       
+00018c40: 2061 7373 6572 7420 6261 6c61 6e63 6520   assert balance 
+00018c50: 3e3d 2030 0a0a 2020 2020 6465 6620 7465  >= 0..    def te
+00018c60: 7374 5f65 7468 5f67 6574 5f62 616c 616e  st_eth_get_balan
+00018c70: 6365 5f77 6974 685f 626c 6f63 6b5f 6964  ce_with_block_id
+00018c80: 656e 7469 6669 6572 2873 656c 662c 2077  entifier(self, w
+00018c90: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
+00018ca0: 6e65 3a0a 2020 2020 2020 2020 6d69 6e65  ne:.        mine
+00018cb0: 725f 6164 6472 6573 7320 3d20 7733 2e65  r_address = w3.e
+00018cc0: 7468 2e67 6574 5f62 6c6f 636b 2831 295b  th.get_block(1)[
+00018cd0: 226d 696e 6572 225d 0a20 2020 2020 2020  "miner"].       
+00018ce0: 2062 616c 616e 6365 5f70 6f73 745f 6765   balance_post_ge
+00018cf0: 6e65 7369 7320 3d20 7733 2e65 7468 2e67  nesis = w3.eth.g
+00018d00: 6574 5f62 616c 616e 6365 286d 696e 6572  et_balance(miner
+00018d10: 5f61 6464 7265 7373 2c20 3129 0a20 2020  _address, 1).   
+00018d20: 2020 2020 206c 6174 6572 5f62 616c 616e       later_balan
+00018d30: 6365 203d 2077 332e 6574 682e 6765 745f  ce = w3.eth.get_
+00018d40: 6261 6c61 6e63 6528 6d69 6e65 725f 6164  balance(miner_ad
+00018d50: 6472 6573 732c 2022 6c61 7465 7374 2229  dress, "latest")
+00018d60: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00018d70: 2069 735f 696e 7465 6765 7228 6261 6c61   is_integer(bala
+00018d80: 6e63 655f 706f 7374 5f67 656e 6573 6973  nce_post_genesis
+00018d90: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00018da0: 2069 735f 696e 7465 6765 7228 6c61 7465   is_integer(late
+00018db0: 725f 6261 6c61 6e63 6529 0a20 2020 2020  r_balance).     
+00018dc0: 2020 2061 7373 6572 7420 6c61 7465 725f     assert later_
+00018dd0: 6261 6c61 6e63 6520 3e20 6261 6c61 6e63  balance > balanc
+00018de0: 655f 706f 7374 5f67 656e 6573 6973 0a0a  e_post_genesis..
+00018df0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00018e00: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00018e10: 2020 2020 2020 2261 6464 7265 7373 2c20        "address, 
+00018e20: 6578 7065 6374 5f73 7563 6365 7373 222c  expect_success",
+00018e30: 0a20 2020 2020 2020 205b 2822 7465 7374  .        [("test
+00018e40: 2d61 6464 7265 7373 2e65 7468 222c 2054  -address.eth", T
+00018e50: 7275 6529 2c20 2822 6e6f 742d 616e 2d61  rue), ("not-an-a
+00018e60: 6464 7265 7373 2e65 7468 222c 2046 616c  ddress.eth", Fal
+00018e70: 7365 295d 2c0a 2020 2020 290a 2020 2020  se)],.    ).    
+00018e80: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+00018e90: 5f62 616c 616e 6365 5f77 6974 685f 656e  _balance_with_en
+00018ea0: 735f 6e61 6d65 280a 2020 2020 2020 2020  s_name(.        
+00018eb0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+00018ec0: 2c20 6164 6472 6573 733a 2043 6865 636b  , address: Check
+00018ed0: 7375 6d41 6464 7265 7373 2c20 6578 7065  sumAddress, expe
+00018ee0: 6374 5f73 7563 6365 7373 3a20 626f 6f6c  ct_success: bool
+00018ef0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00018f00: 2020 2020 2020 2020 7769 7468 2065 6e73          with ens
+00018f10: 5f61 6464 7265 7373 6573 2877 332c 207b  _addresses(w3, {
+00018f20: 2274 6573 742d 6164 6472 6573 732e 6574  "test-address.et
+00018f30: 6822 3a20 7733 2e65 7468 2e61 6363 6f75  h": w3.eth.accou
+00018f40: 6e74 735b 305d 7d29 3a0a 2020 2020 2020  nts[0]}):.      
+00018f50: 2020 2020 2020 6966 2065 7870 6563 745f        if expect_
+00018f60: 7375 6363 6573 733a 0a20 2020 2020 2020  success:.       
+00018f70: 2020 2020 2020 2020 2062 616c 616e 6365           balance
+00018f80: 203d 2077 332e 6574 682e 6765 745f 6261   = w3.eth.get_ba
+00018f90: 6c61 6e63 6528 6164 6472 6573 7329 0a20  lance(address). 
+00018fa0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018fb0: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
+00018fc0: 2862 616c 616e 6365 290a 2020 2020 2020  (balance).      
+00018fd0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00018fe0: 2062 616c 616e 6365 203e 3d20 300a 2020   balance >= 0.  
+00018ff0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00019000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019010: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00019020: 6573 284e 616d 654e 6f74 466f 756e 6429  es(NameNotFound)
+00019030: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019040: 2020 2020 2020 7733 2e65 7468 2e67 6574        w3.eth.get
+00019050: 5f62 616c 616e 6365 2861 6464 7265 7373  _balance(address
+00019060: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00019070: 6574 685f 6765 745f 7374 6f72 6167 655f  eth_get_storage_
+00019080: 6174 2873 656c 662c 2077 333a 2022 5765  at(self, w3: "We
+00019090: 6233 222c 2073 746f 7261 6765 5f63 6f6e  b3", storage_con
+000190a0: 7472 6163 743a 2022 436f 6e74 7261 6374  tract: "Contract
+000190b0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+000190c0: 2020 2020 7374 6f72 6167 655f 636f 6e74      storage_cont
+000190d0: 7261 6374 5f61 6464 7265 7373 203d 2073  ract_address = s
+000190e0: 746f 7261 6765 5f63 6f6e 7472 6163 742e  torage_contract.
+000190f0: 6164 6472 6573 730a 0a20 2020 2020 2020  address..       
+00019100: 2073 6c6f 745f 3020 3d20 7733 2e65 7468   slot_0 = w3.eth
+00019110: 2e67 6574 5f73 746f 7261 6765 5f61 7428  .get_storage_at(
+00019120: 7374 6f72 6167 655f 636f 6e74 7261 6374  storage_contract
+00019130: 5f61 6464 7265 7373 2c20 3029 0a20 2020  _address, 0).   
+00019140: 2020 2020 2061 7373 6572 7420 736c 6f74       assert slot
+00019150: 5f30 203d 3d20 4865 7842 7974 6573 2866  _0 == HexBytes(f
+00019160: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
+00019170: 0a0a 2020 2020 2020 2020 736c 6f74 5f31  ..        slot_1
+00019180: 203d 2077 332e 6574 682e 6765 745f 7374   = w3.eth.get_st
+00019190: 6f72 6167 655f 6174 2873 746f 7261 6765  orage_at(storage
+000191a0: 5f63 6f6e 7472 6163 745f 6164 6472 6573  _contract_addres
+000191b0: 732c 2031 290a 2020 2020 2020 2020 6173  s, 1).        as
+000191c0: 7365 7274 2073 6c6f 745f 3120 3d3d 2048  sert slot_1 == H
+000191d0: 6578 4279 7465 7328 6622 3078 7b27 3030  exBytes(f"0x{'00
+000191e0: 2720 2a20 3331 7d30 3122 290a 0a20 2020  ' * 31}01")..   
+000191f0: 2020 2020 2073 6c6f 745f 3220 3d20 7733       slot_2 = w3
+00019200: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
+00019210: 5f61 7428 7374 6f72 6167 655f 636f 6e74  _at(storage_cont
+00019220: 7261 6374 5f61 6464 7265 7373 2c20 3229  ract_address, 2)
+00019230: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00019240: 736c 6f74 5f32 203d 3d20 4865 7842 7974  slot_2 == HexByt
+00019250: 6573 2866 2230 787b 2730 3027 202a 2033  es(f"0x{'00' * 3
+00019260: 317d 3032 2229 0a0a 2020 2020 2020 2020  1}02")..        
+00019270: 736c 6f74 5f33 203d 2077 332e 6574 682e  slot_3 = w3.eth.
+00019280: 6765 745f 7374 6f72 6167 655f 6174 2873  get_storage_at(s
+00019290: 746f 7261 6765 5f63 6f6e 7472 6163 745f  torage_contract_
+000192a0: 6164 6472 6573 732c 2033 290a 2020 2020  address, 3).    
+000192b0: 2020 2020 6173 7365 7274 2073 6c6f 745f      assert slot_
+000192c0: 3320 3d3d 2048 6578 4279 7465 7328 0a20  3 == HexBytes(. 
+000192d0: 2020 2020 2020 2020 2020 2022 3078 3734             "0x74
+000192e0: 3638 3732 3635 3635 3030 3030 3030 3030  6872656500000000
 000192f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 00019300: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00019310: 3030 6122 0a20 2020 2020 2020 2029 0a20  00a".        ). 
-00019320: 2020 2020 2020 2061 7373 6572 7420 6279         assert by
-00019330: 7465 7328 736c 6f74 5f33 5b3a 355d 2920  tes(slot_3[:5]) 
-00019340: 3d3d 2062 2274 6872 6565 220a 0a20 2020  == b"three"..   
-00019350: 2020 2020 2073 6c6f 745f 3420 3d20 7733       slot_4 = w3
-00019360: 2e65 7468 2e67 6574 5f73 746f 7261 6765  .eth.get_storage
-00019370: 5f61 7428 7374 6f72 6167 655f 636f 6e74  _at(storage_cont
-00019380: 7261 6374 5f61 6464 7265 7373 2c20 3429  ract_address, 4)
-00019390: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000193a0: 736c 6f74 5f34 203d 3d20 4865 7842 7974  slot_4 == HexByt
-000193b0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-000193c0: 2230 7836 3636 6637 3537 3230 3030 3030  "0x666f757200000
-000193d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00019310: 3030 3030 3030 3030 3030 3030 3061 220a  0000000000000a".
+00019320: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00019330: 2020 6173 7365 7274 2062 7974 6573 2873    assert bytes(s
+00019340: 6c6f 745f 335b 3a35 5d29 203d 3d20 6222  lot_3[:5]) == b"
+00019350: 7468 7265 6522 0a0a 2020 2020 2020 2020  three"..        
+00019360: 736c 6f74 5f34 203d 2077 332e 6574 682e  slot_4 = w3.eth.
+00019370: 6765 745f 7374 6f72 6167 655f 6174 2873  get_storage_at(s
+00019380: 746f 7261 6765 5f63 6f6e 7472 6163 745f  torage_contract_
+00019390: 6164 6472 6573 732c 2034 290a 2020 2020  address, 4).    
+000193a0: 2020 2020 6173 7365 7274 2073 6c6f 745f      assert slot_
+000193b0: 3420 3d3d 2048 6578 4279 7465 7328 0a20  4 == HexBytes(. 
+000193c0: 2020 2020 2020 2020 2020 2022 3078 3636             "0x66
+000193d0: 3666 3735 3732 3030 3030 3030 3030 3030  6f75720000000000
 000193e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000193f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00019400: 3030 3822 0a20 2020 2020 2020 2029 0a20  008".        ). 
-00019410: 2020 2020 2020 2061 7373 6572 7420 6279         assert by
-00019420: 7465 7328 736c 6f74 5f34 5b3a 345d 2920  tes(slot_4[:4]) 
-00019430: 3d3d 2062 2266 6f75 7222 0a0a 2020 2020  == b"four"..    
-00019440: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-00019450: 5f73 746f 7261 6765 5f61 745f 656e 735f  _storage_at_ens_
-00019460: 6e61 6d65 280a 2020 2020 2020 2020 7365  name(.        se
-00019470: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00019480: 7374 6f72 6167 655f 636f 6e74 7261 6374  storage_contract
-00019490: 3a20 2243 6f6e 7472 6163 7422 0a20 2020  : "Contract".   
-000194a0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000194b0: 2020 2020 7769 7468 2065 6e73 5f61 6464      with ens_add
-000194c0: 7265 7373 6573 2877 332c 207b 2273 746f  resses(w3, {"sto
-000194d0: 7261 6765 2e65 7468 223a 2073 746f 7261  rage.eth": stora
-000194e0: 6765 5f63 6f6e 7472 6163 742e 6164 6472  ge_contract.addr
-000194f0: 6573 737d 293a 0a20 2020 2020 2020 2020  ess}):.         
-00019500: 2020 2073 746f 7261 6765 203d 2077 332e     storage = w3.
-00019510: 6574 682e 6765 745f 7374 6f72 6167 655f  eth.get_storage_
-00019520: 6174 2845 4e53 2822 7374 6f72 6167 652e  at(ENS("storage.
-00019530: 6574 6822 292c 2031 290a 2020 2020 2020  eth"), 1).      
-00019540: 2020 2020 2020 6173 7365 7274 2073 746f        assert sto
-00019550: 7261 6765 203d 3d20 4865 7842 7974 6573  rage == HexBytes
-00019560: 2866 2230 787b 2730 3027 202a 2033 317d  (f"0x{'00' * 31}
-00019570: 3031 2229 0a0a 2020 2020 6465 6620 7465  01")..    def te
-00019580: 7374 5f65 7468 5f67 6574 5f73 746f 7261  st_eth_get_stora
-00019590: 6765 5f61 745f 696e 7661 6c69 645f 6164  ge_at_invalid_ad
-000195a0: 6472 6573 7328 7365 6c66 2c20 7733 3a20  dress(self, w3: 
-000195b0: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-000195c0: 0a20 2020 2020 2020 2063 6f69 6e62 6173  .        coinbas
-000195d0: 6520 3d20 7733 2e65 7468 2e63 6f69 6e62  e = w3.eth.coinb
-000195e0: 6173 650a 2020 2020 2020 2020 7769 7468  ase.        with
-000195f0: 2070 7974 6573 742e 7261 6973 6573 2849   pytest.raises(I
-00019600: 6e76 616c 6964 4164 6472 6573 7329 3a0a  nvalidAddress):.
-00019610: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
-00019620: 7468 2e67 6574 5f73 746f 7261 6765 5f61  th.get_storage_a
-00019630: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00019640: 2020 2043 6865 636b 7375 6d41 6464 7265     ChecksumAddre
-00019650: 7373 2848 6578 4164 6472 6573 7328 4865  ss(HexAddress(He
-00019660: 7853 7472 2863 6f69 6e62 6173 652e 6c6f  xStr(coinbase.lo
-00019670: 7765 7228 2929 2929 2c20 300a 2020 2020  wer()))), 0.    
-00019680: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00019690: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-000196a0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
-000196b0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-000196c0: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
-000196d0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000196e0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
-000196f0: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-00019700: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00019710: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
-00019720: 6f6e 5f63 6f75 6e74 203d 2077 332e 6574  on_count = w3.et
-00019730: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00019740: 6e5f 636f 756e 7428 0a20 2020 2020 2020  n_count(.       
-00019750: 2020 2020 206b 6579 6669 6c65 5f61 6363       keyfile_acc
-00019760: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-00019770: 6c5f 7479 7065 0a20 2020 2020 2020 2029  l_type.        )
-00019780: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00019790: 6973 5f69 6e74 6567 6572 2874 7261 6e73  is_integer(trans
-000197a0: 6163 7469 6f6e 5f63 6f75 6e74 290a 2020  action_count).  
-000197b0: 2020 2020 2020 6173 7365 7274 2074 7261        assert tra
-000197c0: 6e73 6163 7469 6f6e 5f63 6f75 6e74 203e  nsaction_count >
-000197d0: 3d20 300a 0a20 2020 2064 6566 2074 6573  = 0..    def tes
-000197e0: 745f 6574 685f 6765 745f 7472 616e 7361  t_eth_get_transa
-000197f0: 6374 696f 6e5f 636f 756e 745f 656e 735f  ction_count_ens_
-00019800: 6e61 6d65 280a 2020 2020 2020 2020 7365  name(.        se
-00019810: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00019820: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00019830: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-00019840: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-00019850: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-00019860: 3a0a 2020 2020 2020 2020 7769 7468 2065  :.        with e
-00019870: 6e73 5f61 6464 7265 7373 6573 280a 2020  ns_addresses(.  
-00019880: 2020 2020 2020 2020 2020 7733 2c20 7b22            w3, {"
-00019890: 756e 6c6f 636b 6564 2d61 6363 742d 6475  unlocked-acct-du
-000198a0: 616c 2d74 7970 652e 6574 6822 3a20 6b65  al-type.eth": ke
-000198b0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-000198c0: 6472 6573 735f 6475 616c 5f74 7970 657d  dress_dual_type}
-000198d0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-000198e0: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-000198f0: 696f 6e5f 636f 756e 7420 3d20 7733 2e65  ion_count = w3.e
-00019900: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
-00019910: 6f6e 5f63 6f75 6e74 280a 2020 2020 2020  on_count(.      
-00019920: 2020 2020 2020 2020 2020 454e 5328 2275            ENS("u
-00019930: 6e6c 6f63 6b65 642d 6163 6374 2d64 7561  nlocked-acct-dua
-00019940: 6c2d 7479 7065 2e65 7468 2229 0a20 2020  l-type.eth").   
-00019950: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00019960: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00019970: 5f69 6e74 6567 6572 2874 7261 6e73 6163  _integer(transac
-00019980: 7469 6f6e 5f63 6f75 6e74 290a 2020 2020  tion_count).    
-00019990: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-000199a0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-000199b0: 203e 3d20 300a 0a20 2020 2064 6566 2074   >= 0..    def t
-000199c0: 6573 745f 6574 685f 6765 745f 7472 616e  est_eth_get_tran
-000199d0: 7361 6374 696f 6e5f 636f 756e 745f 696e  saction_count_in
-000199e0: 7661 6c69 645f 6164 6472 6573 7328 7365  valid_address(se
-000199f0: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
-00019a00: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00019a10: 2063 6f69 6e62 6173 6520 3d20 7733 2e65   coinbase = w3.e
-00019a20: 7468 2e63 6f69 6e62 6173 650a 2020 2020  th.coinbase.    
-00019a30: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-00019a40: 7261 6973 6573 2849 6e76 616c 6964 4164  raises(InvalidAd
-00019a50: 6472 6573 7329 3a0a 2020 2020 2020 2020  dress):.        
-00019a60: 2020 2020 7733 2e65 7468 2e67 6574 5f74      w3.eth.get_t
-00019a70: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00019a80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019a90: 2020 4368 6563 6b73 756d 4164 6472 6573    ChecksumAddres
-00019aa0: 7328 4865 7841 6464 7265 7373 2848 6578  s(HexAddress(Hex
-00019ab0: 5374 7228 636f 696e 6261 7365 2e6c 6f77  Str(coinbase.low
-00019ac0: 6572 2829 2929 290a 2020 2020 2020 2020  er()))).        
-00019ad0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-00019ae0: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00019af0: 5472 616e 7361 6374 696f 6e43 6f75 6e74  TransactionCount
-00019b00: 4279 4861 7368 5f65 6d70 7479 5f62 6c6f  ByHash_empty_blo
-00019b10: 636b 280a 2020 2020 2020 2020 7365 6c66  ck(.        self
-00019b20: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-00019b30: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00019b40: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00019b50: 6e65 3a0a 2020 2020 2020 2020 7472 616e  ne:.        tran
-00019b60: 7361 6374 696f 6e5f 636f 756e 7420 3d20  saction_count = 
-00019b70: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-00019b80: 5f74 7261 6e73 6163 7469 6f6e 5f63 6f75  _transaction_cou
-00019b90: 6e74 2865 6d70 7479 5f62 6c6f 636b 5b22  nt(empty_block["
-00019ba0: 6861 7368 225d 290a 0a20 2020 2020 2020  hash"])..       
-00019bb0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-00019bc0: 6572 2874 7261 6e73 6163 7469 6f6e 5f63  er(transaction_c
-00019bd0: 6f75 6e74 290a 2020 2020 2020 2020 6173  ount).        as
-00019be0: 7365 7274 2074 7261 6e73 6163 7469 6f6e  sert transaction
-00019bf0: 5f63 6f75 6e74 203d 3d20 300a 0a20 2020  _count == 0..   
-00019c00: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-00019c10: 7442 6c6f 636b 5472 616e 7361 6374 696f  tBlockTransactio
-00019c20: 6e43 6f75 6e74 4279 4e75 6d62 6572 5f65  nCountByNumber_e
-00019c30: 6d70 7479 5f62 6c6f 636b 280a 2020 2020  mpty_block(.    
-00019c40: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00019c50: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-00019c60: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00019c70: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00019c80: 2020 2020 7472 616e 7361 6374 696f 6e5f      transaction_
-00019c90: 636f 756e 7420 3d20 7733 2e65 7468 2e67  count = w3.eth.g
-00019ca0: 6574 5f62 6c6f 636b 5f74 7261 6e73 6163  et_block_transac
-00019cb0: 7469 6f6e 5f63 6f75 6e74 2865 6d70 7479  tion_count(empty
-00019cc0: 5f62 6c6f 636b 5b22 6e75 6d62 6572 225d  _block["number"]
-00019cd0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
-00019ce0: 7420 6973 5f69 6e74 6567 6572 2874 7261  t is_integer(tra
-00019cf0: 6e73 6163 7469 6f6e 5f63 6f75 6e74 290a  nsaction_count).
-00019d00: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00019d10: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00019d20: 203d 3d20 300a 0a20 2020 2064 6566 2074   == 0..    def t
-00019d30: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00019d40: 5472 616e 7361 6374 696f 6e43 6f75 6e74  TransactionCount
-00019d50: 4279 4861 7368 5f62 6c6f 636b 5f77 6974  ByHash_block_wit
-00019d60: 685f 7478 6e28 0a20 2020 2020 2020 2073  h_txn(.        s
-00019d70: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00019d80: 2062 6c6f 636b 5f77 6974 685f 7478 6e3a   block_with_txn:
-00019d90: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
-00019da0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00019db0: 2020 7472 616e 7361 6374 696f 6e5f 636f    transaction_co
-00019dc0: 756e 7420 3d20 7733 2e65 7468 2e67 6574  unt = w3.eth.get
-00019dd0: 5f62 6c6f 636b 5f74 7261 6e73 6163 7469  _block_transacti
-00019de0: 6f6e 5f63 6f75 6e74 2862 6c6f 636b 5f77  on_count(block_w
-00019df0: 6974 685f 7478 6e5b 2268 6173 6822 5d29  ith_txn["hash"])
-00019e00: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00019e10: 2069 735f 696e 7465 6765 7228 7472 616e   is_integer(tran
-00019e20: 7361 6374 696f 6e5f 636f 756e 7429 0a20  saction_count). 
-00019e30: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
-00019e40: 616e 7361 6374 696f 6e5f 636f 756e 7420  ansaction_count 
-00019e50: 3e3d 2031 0a0a 2020 2020 6465 6620 7465  >= 1..    def te
-00019e60: 7374 5f65 7468 5f67 6574 426c 6f63 6b54  st_eth_getBlockT
-00019e70: 7261 6e73 6163 7469 6f6e 436f 756e 7442  ransactionCountB
-00019e80: 794e 756d 6265 725f 626c 6f63 6b5f 7769  yNumber_block_wi
-00019e90: 7468 5f74 786e 280a 2020 2020 2020 2020  th_txn(.        
-00019ea0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00019eb0: 2c20 626c 6f63 6b5f 7769 7468 5f74 786e  , block_with_txn
-00019ec0: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
-00019ed0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00019ee0: 2020 2074 7261 6e73 6163 7469 6f6e 5f63     transaction_c
-00019ef0: 6f75 6e74 203d 2077 332e 6574 682e 6765  ount = w3.eth.ge
-00019f00: 745f 626c 6f63 6b5f 7472 616e 7361 6374  t_block_transact
-00019f10: 696f 6e5f 636f 756e 7428 626c 6f63 6b5f  ion_count(block_
-00019f20: 7769 7468 5f74 786e 5b22 6e75 6d62 6572  with_txn["number
-00019f30: 225d 290a 0a20 2020 2020 2020 2061 7373  "])..        ass
-00019f40: 6572 7420 6973 5f69 6e74 6567 6572 2874  ert is_integer(t
-00019f50: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00019f60: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00019f70: 2074 7261 6e73 6163 7469 6f6e 5f63 6f75   transaction_cou
-00019f80: 6e74 203e 3d20 310a 0a20 2020 2064 6566  nt >= 1..    def
-00019f90: 2074 6573 745f 6574 685f 6765 7455 6e63   test_eth_getUnc
-00019fa0: 6c65 436f 756e 7442 7942 6c6f 636b 4861  leCountByBlockHa
-00019fb0: 7368 280a 2020 2020 2020 2020 7365 6c66  sh(.        self
-00019fc0: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-00019fd0: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00019fe0: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00019ff0: 6e65 3a0a 2020 2020 2020 2020 756e 636c  ne:.        uncl
-0001a000: 655f 636f 756e 7420 3d20 7733 2e65 7468  e_count = w3.eth
-0001a010: 2e67 6574 5f75 6e63 6c65 5f63 6f75 6e74  .get_uncle_count
-0001a020: 2865 6d70 7479 5f62 6c6f 636b 5b22 6861  (empty_block["ha
-0001a030: 7368 225d 290a 0a20 2020 2020 2020 2061  sh"])..        a
-0001a040: 7373 6572 7420 6973 5f69 6e74 6567 6572  ssert is_integer
-0001a050: 2875 6e63 6c65 5f63 6f75 6e74 290a 2020  (uncle_count).  
-0001a060: 2020 2020 2020 6173 7365 7274 2075 6e63        assert unc
-0001a070: 6c65 5f63 6f75 6e74 203d 3d20 300a 0a20  le_count == 0.. 
-0001a080: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0001a090: 6765 7455 6e63 6c65 436f 756e 7442 7942  getUncleCountByB
-0001a0a0: 6c6f 636b 4e75 6d62 6572 280a 2020 2020  lockNumber(.    
-0001a0b0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-0001a0c0: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-0001a0d0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-0001a0e0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0001a0f0: 2020 2020 756e 636c 655f 636f 756e 7420      uncle_count 
-0001a100: 3d20 7733 2e65 7468 2e67 6574 5f75 6e63  = w3.eth.get_unc
-0001a110: 6c65 5f63 6f75 6e74 2865 6d70 7479 5f62  le_count(empty_b
-0001a120: 6c6f 636b 5b22 6e75 6d62 6572 225d 290a  lock["number"]).
-0001a130: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001a140: 6973 5f69 6e74 6567 6572 2875 6e63 6c65  is_integer(uncle
-0001a150: 5f63 6f75 6e74 290a 2020 2020 2020 2020  _count).        
-0001a160: 6173 7365 7274 2075 6e63 6c65 5f63 6f75  assert uncle_cou
-0001a170: 6e74 203d 3d20 300a 0a20 2020 2064 6566  nt == 0..    def
-0001a180: 2074 6573 745f 6574 685f 6765 745f 636f   test_eth_get_co
-0001a190: 6465 280a 2020 2020 2020 2020 7365 6c66  de(.        self
-0001a1a0: 2c20 7733 3a20 2257 6562 3322 2c20 6d61  , w3: "Web3", ma
-0001a1b0: 7468 5f63 6f6e 7472 6163 745f 6164 6472  th_contract_addr
-0001a1c0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
-0001a1d0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001a1e0: 6e65 3a0a 2020 2020 2020 2020 636f 6465  ne:.        code
-0001a1f0: 203d 2077 332e 6574 682e 6765 745f 636f   = w3.eth.get_co
-0001a200: 6465 286d 6174 685f 636f 6e74 7261 6374  de(math_contract
-0001a210: 5f61 6464 7265 7373 290a 2020 2020 2020  _address).      
-0001a220: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
-0001a230: 6e63 6528 636f 6465 2c20 4865 7842 7974  nce(code, HexByt
-0001a240: 6573 290a 2020 2020 2020 2020 6173 7365  es).        asse
-0001a250: 7274 206c 656e 2863 6f64 6529 203e 2030  rt len(code) > 0
-0001a260: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001a270: 7468 5f67 6574 5f63 6f64 655f 656e 735f  th_get_code_ens_
-0001a280: 6164 6472 6573 7328 0a20 2020 2020 2020  address(.       
-0001a290: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-0001a2a0: 222c 206d 6174 685f 636f 6e74 7261 6374  ", math_contract
-0001a2b0: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-0001a2c0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-0001a2d0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0001a2e0: 2077 6974 6820 656e 735f 6164 6472 6573   with ens_addres
-0001a2f0: 7365 7328 7733 2c20 7b22 6d61 7468 636f  ses(w3, {"mathco
-0001a300: 6e74 7261 6374 2e65 7468 223a 206d 6174  ntract.eth": mat
-0001a310: 685f 636f 6e74 7261 6374 5f61 6464 7265  h_contract_addre
-0001a320: 7373 7d29 3a0a 2020 2020 2020 2020 2020  ss}):.          
-0001a330: 2020 636f 6465 203d 2077 332e 6574 682e    code = w3.eth.
-0001a340: 6765 745f 636f 6465 2845 4e53 2822 6d61  get_code(ENS("ma
-0001a350: 7468 636f 6e74 7261 6374 2e65 7468 2229  thcontract.eth")
-0001a360: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
-0001a370: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-0001a380: 636f 6465 2c20 4865 7842 7974 6573 290a  code, HexBytes).
-0001a390: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0001a3a0: 7274 206c 656e 2863 6f64 6529 203e 2030  rt len(code) > 0
-0001a3b0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001a3c0: 7468 5f67 6574 5f63 6f64 655f 696e 7661  th_get_code_inva
-0001a3d0: 6c69 645f 6164 6472 6573 7328 0a20 2020  lid_address(.   
-0001a3e0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-0001a3f0: 5765 6233 222c 206d 6174 685f 636f 6e74  Web3", math_cont
-0001a400: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-0001a410: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001a420: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0001a430: 6573 742e 7261 6973 6573 2849 6e76 616c  est.raises(Inval
-0001a440: 6964 4164 6472 6573 7329 3a0a 2020 2020  idAddress):.    
-0001a450: 2020 2020 2020 2020 7733 2e65 7468 2e67          w3.eth.g
-0001a460: 6574 5f63 6f64 6528 0a20 2020 2020 2020  et_code(.       
-0001a470: 2020 2020 2020 2020 2043 6865 636b 7375           Checksu
-0001a480: 6d41 6464 7265 7373 2848 6578 4164 6472  mAddress(HexAddr
-0001a490: 6573 7328 4865 7853 7472 286d 6174 685f  ess(HexStr(math_
-0001a4a0: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-0001a4b0: 2e6c 6f77 6572 2829 2929 290a 2020 2020  .lower()))).    
-0001a4c0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001a4d0: 6566 2074 6573 745f 6574 685f 6765 745f  ef test_eth_get_
-0001a4e0: 636f 6465 5f77 6974 685f 626c 6f63 6b5f  code_with_block_
-0001a4f0: 6964 656e 7469 6669 6572 280a 2020 2020  identifier(.    
-0001a500: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-0001a510: 6562 3322 2c20 656d 6974 7465 725f 636f  eb3", emitter_co
-0001a520: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
-0001a530: 7422 0a20 2020 2029 202d 3e20 4e6f 6e65  t".    ) -> None
-0001a540: 3a0a 2020 2020 2020 2020 636f 6465 203d  :.        code =
-0001a550: 2077 332e 6574 682e 6765 745f 636f 6465   w3.eth.get_code
-0001a560: 280a 2020 2020 2020 2020 2020 2020 656d  (.            em
-0001a570: 6974 7465 725f 636f 6e74 7261 6374 2e61  itter_contract.a
-0001a580: 6464 7265 7373 2c20 626c 6f63 6b5f 6964  ddress, block_id
-0001a590: 656e 7469 6669 6572 3d77 332e 6574 682e  entifier=w3.eth.
-0001a5a0: 626c 6f63 6b5f 6e75 6d62 6572 0a20 2020  block_number.   
-0001a5b0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-0001a5c0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0001a5d0: 2863 6f64 652c 2048 6578 4279 7465 7329  (code, HexBytes)
-0001a5e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001a5f0: 6c65 6e28 636f 6465 2920 3e20 300a 0a20  len(code) > 0.. 
-0001a600: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0001a610: 6372 6561 7465 5f61 6363 6573 735f 6c69  create_access_li
-0001a620: 7374 280a 2020 2020 2020 2020 7365 6c66  st(.        self
-0001a630: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
-0001a640: 6562 3322 2c0a 2020 2020 2020 2020 6b65  eb3",.        ke
-0001a650: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0001a660: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
-0001a670: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-0001a680: 2c0a 2020 2020 2020 2020 6d61 7468 5f63  ,.        math_c
-0001a690: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-0001a6a0: 6374 222c 0a20 2020 2029 202d 3e20 4e6f  ct",.    ) -> No
-0001a6b0: 6e65 3a0a 2020 2020 2020 2020 2320 6275  ne:.        # bu
-0001a6c0: 696c 6420 7478 6e0a 2020 2020 2020 2020  ild txn.        
-0001a6d0: 7478 6e20 3d20 6d61 7468 5f63 6f6e 7472  txn = math_contr
-0001a6e0: 6163 742e 6675 6e63 7469 6f6e 732e 696e  act.functions.in
-0001a6f0: 6372 656d 656e 7443 6f75 6e74 6572 2831  crementCounter(1
-0001a700: 292e 6275 696c 645f 7472 616e 7361 6374  ).build_transact
-0001a710: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0001a720: 207b 2266 726f 6d22 3a20 6b65 7966 696c   {"from": keyfil
-0001a730: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001a740: 735f 6475 616c 5f74 7970 657d 0a20 2020  s_dual_type}.   
-0001a750: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001a760: 2320 6372 6561 7465 2061 6363 6573 7320  # create access 
-0001a770: 6c69 7374 0a20 2020 2020 2020 2072 6573  list.        res
-0001a780: 706f 6e73 6520 3d20 7733 2e65 7468 2e63  ponse = w3.eth.c
-0001a790: 7265 6174 655f 6163 6365 7373 5f6c 6973  reate_access_lis
-0001a7a0: 7428 7478 6e29 0a0a 2020 2020 2020 2020  t(txn)..        
-0001a7b0: 6173 7365 7274 2069 735f 6469 6374 2872  assert is_dict(r
-0001a7c0: 6573 706f 6e73 6529 0a20 2020 2020 2020  esponse).       
-0001a7d0: 2061 6363 6573 735f 6c69 7374 203d 2072   access_list = r
-0001a7e0: 6573 706f 6e73 655b 2261 6363 6573 734c  esponse["accessL
-0001a7f0: 6973 7422 5d0a 2020 2020 2020 2020 6173  ist"].        as
-0001a800: 7365 7274 206c 656e 2861 6363 6573 735f  sert len(access_
-0001a810: 6c69 7374 2920 3e20 300a 2020 2020 2020  list) > 0.      
-0001a820: 2020 6173 7365 7274 2061 6363 6573 735f    assert access_
-0001a830: 6c69 7374 5b30 5d5b 2261 6464 7265 7373  list[0]["address
-0001a840: 225d 2069 7320 6e6f 7420 4e6f 6e65 0a20  "] is not None. 
-0001a850: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0001a860: 5f63 6865 636b 7375 6d5f 6164 6472 6573  _checksum_addres
-0001a870: 7328 6163 6365 7373 5f6c 6973 745b 305d  s(access_list[0]
-0001a880: 5b22 6164 6472 6573 7322 5d29 0a20 2020  ["address"]).   
-0001a890: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0001a8a0: 6163 6365 7373 5f6c 6973 745b 305d 5b22  access_list[0]["
-0001a8b0: 7374 6f72 6167 654b 6579 7322 5d5b 305d  storageKeys"][0]
-0001a8c0: 2920 3d3d 2033 320a 2020 2020 2020 2020  ) == 32.        
-0001a8d0: 6173 7365 7274 2069 6e74 2872 6573 706f  assert int(respo
-0001a8e0: 6e73 655b 2267 6173 5573 6564 225d 2920  nse["gasUsed"]) 
-0001a8f0: 3e3d 2030 0a0a 2020 2020 2020 2020 2320  >= 0..        # 
-0001a900: 6173 7365 7274 2074 6865 2072 6573 756c  assert the resul
-0001a910: 7420 6361 6e20 6265 2075 7365 6420 6469  t can be used di
-0001a920: 7265 6374 6c79 2069 6e20 6120 7472 616e  rectly in a tran
-0001a930: 7361 6374 696f 6e20 6469 6374 0a20 2020  saction dict.   
-0001a940: 2020 2020 2074 786e 5b22 6163 6365 7373       txn["access
-0001a950: 4c69 7374 225d 203d 2072 6573 706f 6e73  List"] = respons
-0001a960: 655b 2261 6363 6573 734c 6973 7422 5d0a  e["accessList"].
-0001a970: 2020 2020 2020 2020 7478 6e5b 2267 6173          txn["gas
-0001a980: 225d 203d 2072 6573 706f 6e73 655b 2267  "] = response["g
-0001a990: 6173 5573 6564 225d 0a0a 2020 2020 2020  asUsed"]..      
-0001a9a0: 2020 2320 7365 6e64 2074 786e 2077 6974    # send txn wit
-0001a9b0: 6820 6163 6365 7373 206c 6973 740a 2020  h access list.  
-0001a9c0: 2020 2020 2020 7733 2e65 7468 2e73 656e        w3.eth.sen
-0001a9d0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
-0001a9e0: 6e29 0a0a 2020 2020 6465 6620 7465 7374  n)..    def test
-0001a9f0: 5f65 7468 5f73 6967 6e28 0a20 2020 2020  _eth_sign(.     
-0001aa00: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-0001aa10: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
-0001aa20: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001aa30: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0001aa40: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0001aa50: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
-0001aa60: 6967 6e61 7475 7265 203d 2077 332e 6574  ignature = w3.et
-0001aa70: 682e 7369 676e 280a 2020 2020 2020 2020  h.sign(.        
-0001aa80: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
-0001aa90: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0001aaa0: 5f74 7970 652c 2074 6578 743d 224d 6573  _type, text="Mes
-0001aab0: 7361 6765 2074 c3b6 2073 6967 6e2e 204c  sage t.. sign. L
-0001aac0: 6f6e 6765 7220 7468 616e 2068 6173 6821  onger than hash!
-0001aad0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-0001aae0: 2020 2020 6173 7365 7274 2069 735f 6279      assert is_by
-0001aaf0: 7465 7328 7369 676e 6174 7572 6529 0a20  tes(signature). 
-0001ab00: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0001ab10: 6e28 7369 676e 6174 7572 6529 203d 3d20  n(signature) == 
-0001ab20: 3332 202b 2033 3220 2b20 310a 0a20 2020  32 + 32 + 1..   
-0001ab30: 2020 2020 2023 2074 6573 7420 6f74 6865       # test othe
-0001ab40: 7220 666f 726d 6174 730a 2020 2020 2020  r formats.      
-0001ab50: 2020 6865 7873 6967 6e20 3d20 7733 2e65    hexsign = w3.e
-0001ab60: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-0001ab70: 2020 2020 206b 6579 6669 6c65 5f61 6363       keyfile_acc
-0001ab80: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001ab90: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-0001aba0: 2020 2020 6865 7873 7472 3d48 6578 5374      hexstr=HexSt
-0001abb0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001abc0: 2020 2022 3078 3464 3635 3733 3733 3631     "0x4d65737361
-0001abd0: 3637 3635 3230 3734 6333 6236 3230 3733  67652074c3b62073
-0001abe0: 3639 3637 3665 3265 3230 3463 3666 3665  69676e2e204c6f6e
-0001abf0: 3637 3635 3732 3230 3734 3638 3631 3665  676572207468616e
-0001ac00: 3230 3638 3631 3733 3638 3231 2220 2023  206861736821"  #
-0001ac10: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-0001ac20: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-0001ac30: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-0001ac40: 6572 7420 6865 7873 6967 6e20 3d3d 2073  ert hexsign == s
-0001ac50: 6967 6e61 7475 7265 0a0a 2020 2020 2020  ignature..      
-0001ac60: 2020 696e 7473 6967 6e20 3d20 7733 2e65    intsign = w3.e
-0001ac70: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-0001ac80: 2020 2020 206b 6579 6669 6c65 5f61 6363       keyfile_acc
-0001ac90: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001aca0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-0001acb0: 2020 2020 3078 3444 3635 3733 3733 3631      0x4D65737361
-0001acc0: 3637 3635 3230 3734 4333 4236 3230 3733  67652074C3B62073
-0001acd0: 3639 3637 3645 3245 3230 3443 3646 3645  69676E2E204C6F6E
-0001ace0: 3637 3635 3732 3230 3734 3638 3631 3645  676572207468616E
-0001acf0: 3230 3638 3631 3733 3638 3231 2c0a 2020  206861736821,.  
-0001ad00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001ad10: 6173 7365 7274 2069 6e74 7369 676e 203d  assert intsign =
-0001ad20: 3d20 7369 676e 6174 7572 650a 0a20 2020  = signature..   
-0001ad30: 2020 2020 2062 7974 6573 7369 676e 203d       bytessign =
-0001ad40: 2077 332e 6574 682e 7369 676e 280a 2020   w3.eth.sign(.  
-0001ad50: 2020 2020 2020 2020 2020 6b65 7966 696c            keyfil
-0001ad60: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001ad70: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-0001ad80: 2020 2020 2020 2020 2062 224d 6573 7361           b"Messa
-0001ad90: 6765 2074 5c78 6333 5c78 6236 2073 6967  ge t\xc3\xb6 sig
-0001ada0: 6e2e 204c 6f6e 6765 7220 7468 616e 2068  n. Longer than h
-0001adb0: 6173 6821 222c 0a20 2020 2020 2020 2029  ash!",.        )
-0001adc0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001add0: 6279 7465 7373 6967 6e20 3d3d 2073 6967  bytessign == sig
-0001ade0: 6e61 7475 7265 0a0a 2020 2020 2020 2020  nature..        
-0001adf0: 6e65 775f 7369 676e 6174 7572 6520 3d20  new_signature = 
-0001ae00: 7733 2e65 7468 2e73 6967 6e28 0a20 2020  w3.eth.sign(.   
-0001ae10: 2020 2020 2020 2020 206b 6579 6669 6c65           keyfile
-0001ae20: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001ae30: 5f64 7561 6c5f 7479 7065 2c20 7465 7874  _dual_type, text
-0001ae40: 3d22 6469 6666 6572 656e 7420 6d65 7373  ="different mess
-0001ae50: 6167 6520 6973 2064 6966 6665 7265 6e74  age is different
-0001ae60: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-0001ae70: 2020 2020 6173 7365 7274 206e 6577 5f73      assert new_s
-0001ae80: 6967 6e61 7475 7265 2021 3d20 7369 676e  ignature != sign
-0001ae90: 6174 7572 650a 0a20 2020 2064 6566 2074  ature..    def t
-0001aea0: 6573 745f 6574 685f 7369 676e 5f65 6e73  est_eth_sign_ens
-0001aeb0: 5f6e 616d 6573 280a 2020 2020 2020 2020  _names(.        
-0001aec0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-0001aed0: 2c20 6b65 7966 696c 655f 6163 636f 756e  , keyfile_accoun
-0001aee0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0001aef0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0001af00: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001af10: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-0001af20: 2065 6e73 5f61 6464 7265 7373 6573 280a   ens_addresses(.
-0001af30: 2020 2020 2020 2020 2020 2020 7733 2c20              w3, 
-0001af40: 7b22 756e 6c6f 636b 6564 2d61 6363 742e  {"unlocked-acct.
-0001af50: 6574 6822 3a20 6b65 7966 696c 655f 6163  eth": keyfile_ac
-0001af60: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-0001af70: 616c 5f74 7970 657d 0a20 2020 2020 2020  al_type}.       
-0001af80: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0001af90: 7369 676e 6174 7572 6520 3d20 7733 2e65  signature = w3.e
-0001afa0: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
-0001afb0: 2020 2020 2020 2020 2022 756e 6c6f 636b           "unlock
-0001afc0: 6564 2d61 6363 742e 6574 6822 2c20 7465  ed-acct.eth", te
-0001afd0: 7874 3d22 4d65 7373 6167 6520 74c3 b620  xt="Message t.. 
-0001afe0: 7369 676e 2e20 4c6f 6e67 6572 2074 6861  sign. Longer tha
-0001aff0: 6e20 6861 7368 2122 0a20 2020 2020 2020  n hash!".       
-0001b000: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001b010: 2020 2061 7373 6572 7420 6973 5f62 7974     assert is_byt
-0001b020: 6573 2873 6967 6e61 7475 7265 290a 2020  es(signature).  
-0001b030: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-0001b040: 206c 656e 2873 6967 6e61 7475 7265 2920   len(signature) 
-0001b050: 3d3d 2033 3220 2b20 3332 202b 2031 0a0a  == 32 + 32 + 1..
-0001b060: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-0001b070: 5f73 6967 6e5f 7479 7065 645f 6461 7461  _sign_typed_data
-0001b080: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001b090: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-0001b0a0: 3322 2c0a 2020 2020 2020 2020 6b65 7966  3",.        keyf
-0001b0b0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001b0c0: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
-0001b0d0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-0001b0e0: 2020 2020 2020 2020 736b 6970 5f69 665f          skip_if_
-0001b0f0: 7465 7374 7270 633a 2043 616c 6c61 626c  testrpc: Callabl
-0001b100: 655b 5b22 5765 6233 225d 2c20 4e6f 6e65  e[["Web3"], None
-0001b110: 5d2c 0a20 2020 2029 202d 3e20 4e6f 6e65  ],.    ) -> None
-0001b120: 3a0a 2020 2020 2020 2020 7661 6c69 644a  :.        validJ
-0001b130: 534f 4e4d 6573 7361 6765 203d 2022 2222  SONMessage = """
-0001b140: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
-0001b150: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b160: 7479 7065 7322 3a20 7b0a 2020 2020 2020  types": {.      
-0001b170: 2020 2020 2020 2020 2020 2020 2020 2245                "E
-0001b180: 4950 3731 3244 6f6d 6169 6e22 3a20 5b0a  IP712Domain": [.
-0001b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1a0: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-0001b1b0: 2022 6e61 6d65 222c 2022 7479 7065 223a   "name", "type":
-0001b1c0: 2022 7374 7269 6e67 227d 2c0a 2020 2020   "string"},.    
-0001b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1e0: 2020 2020 7b22 6e61 6d65 223a 2022 7665      {"name": "ve
-0001b1f0: 7273 696f 6e22 2c20 2274 7970 6522 3a20  rsion", "type": 
-0001b200: 2273 7472 696e 6722 7d2c 0a20 2020 2020  "string"},.     
-0001b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b220: 2020 207b 226e 616d 6522 3a20 2263 6861     {"name": "cha
-0001b230: 696e 4964 222c 2022 7479 7065 223a 2022  inId", "type": "
-0001b240: 7569 6e74 3235 3622 7d2c 0a20 2020 2020  uint256"},.     
-0001b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b260: 2020 207b 226e 616d 6522 3a20 2276 6572     {"name": "ver
-0001b270: 6966 7969 6e67 436f 6e74 7261 6374 222c  ifyingContract",
-0001b280: 2022 7479 7065 223a 2022 6164 6472 6573   "type": "addres
-0001b290: 7322 7d0a 2020 2020 2020 2020 2020 2020  s"}.            
-0001b2a0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0001b2b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b2c0: 5065 7273 6f6e 223a 205b 0a20 2020 2020  Person": [.     
-0001b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2e0: 2020 207b 226e 616d 6522 3a20 226e 616d     {"name": "nam
-0001b2f0: 6522 2c20 2274 7970 6522 3a20 2273 7472  e", "type": "str
-0001b300: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
-0001b310: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001b320: 226e 616d 6522 3a20 2277 616c 6c65 7422  "name": "wallet"
-0001b330: 2c20 2274 7970 6522 3a20 2261 6464 7265  , "type": "addre
-0001b340: 7373 227d 0a20 2020 2020 2020 2020 2020  ss"}.           
-0001b350: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0001b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b370: 224d 6169 6c22 3a20 5b0a 2020 2020 2020  "Mail": [.      
-0001b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b390: 2020 7b22 6e61 6d65 223a 2022 6672 6f6d    {"name": "from
-0001b3a0: 222c 2022 7479 7065 223a 2022 5065 7273  ", "type": "Pers
-0001b3b0: 6f6e 227d 2c0a 2020 2020 2020 2020 2020  on"},.          
-0001b3c0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001b3d0: 6e61 6d65 223a 2022 746f 222c 2022 7479  name": "to", "ty
-0001b3e0: 7065 223a 2022 5065 7273 6f6e 227d 2c0a  pe": "Person"},.
-0001b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b400: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-0001b410: 2022 636f 6e74 656e 7473 222c 2022 7479   "contents", "ty
-0001b420: 7065 223a 2022 7374 7269 6e67 227d 0a20  pe": "string"}. 
-0001b430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b440: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0001b450: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-0001b460: 2020 2020 2020 2020 2270 7269 6d61 7279          "primary
-0001b470: 5479 7065 223a 2022 4d61 696c 222c 0a20  Type": "Mail",. 
-0001b480: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b490: 646f 6d61 696e 223a 207b 0a20 2020 2020  domain": {.     
-0001b4a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b4b0: 6e61 6d65 223a 2022 4574 6865 7220 4d61  name": "Ether Ma
-0001b4c0: 696c 222c 0a20 2020 2020 2020 2020 2020  il",.           
-0001b4d0: 2020 2020 2020 2020 2022 7665 7273 696f           "versio
-0001b4e0: 6e22 3a20 2231 222c 0a20 2020 2020 2020  n": "1",.       
-0001b4f0: 2020 2020 2020 2020 2020 2020 2022 6368               "ch
-0001b500: 6169 6e49 6422 3a20 2230 7830 3122 2c0a  ainId": "0x01",.
-0001b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b520: 2020 2020 2276 6572 6966 7969 6e67 436f      "verifyingCo
-0001b530: 6e74 7261 6374 223a 2022 3078 4363 4343  ntract": "0xCcCC
-0001b540: 6363 6363 4343 4343 6343 4343 4343 4363  ccccCCCCcCCCCCCc
-0001b550: 4363 4363 6343 6343 4343 6343 6363 6363  CcCccCcCCCcCcccc
-0001b560: 6363 6343 220a 2020 2020 2020 2020 2020  cccC".          
-0001b570: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-0001b580: 2020 2020 2020 2020 2022 6d65 7373 6167           "messag
-0001b590: 6522 3a20 7b0a 2020 2020 2020 2020 2020  e": {.          
-0001b5a0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001b5b0: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
-0001b5c0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-0001b5d0: 6522 3a20 2243 6f77 222c 0a20 2020 2020  e": "Cow",.     
-0001b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5f0: 2020 2022 7761 6c6c 6574 223a 2022 3078     "wallet": "0x
-0001b600: 4344 3261 3364 3946 3933 3845 3133 4344  CD2a3d9F938E13CD
-0001b610: 3934 3745 6330 3541 6243 3746 4537 3334  947Ec05AbC7FE734
-0001b620: 4466 3844 4438 3236 220a 2020 2020 2020  Df8DD826".      
-0001b630: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0001b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b650: 2020 2020 2022 746f 223a 207b 0a20 2020       "to": {.   
-0001b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b670: 2020 2020 2022 6e61 6d65 223a 2022 426f       "name": "Bo
-0001b680: 6222 2c0a 2020 2020 2020 2020 2020 2020  b",.            
-0001b690: 2020 2020 2020 2020 2020 2020 2277 616c              "wal
-0001b6a0: 6c65 7422 3a20 2230 7862 4262 4242 4242  let": "0xbBbBBBB
-0001b6b0: 6262 4242 4262 6262 4262 6242 6262 6262  bbBBBbbbBbbBbbbb
-0001b6c0: 4242 6242 6262 6262 4262 4262 6242 4262  BBbBbbbbBbBbbBBb
-0001b6d0: 4222 0a20 2020 2020 2020 2020 2020 2020  B".             
-0001b6e0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0001b6f0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0001b700: 6f6e 7465 6e74 7322 3a20 2248 656c 6c6f  ontents": "Hello
-0001b710: 2c20 426f 6221 220a 2020 2020 2020 2020  , Bob!".        
-0001b720: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0001b730: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001b740: 2222 220a 2020 2020 2020 2020 736b 6970  """.        skip
-0001b750: 5f69 665f 7465 7374 7270 6328 7733 290a  _if_testrpc(w3).
-0001b760: 2020 2020 2020 2020 7369 676e 6174 7572          signatur
-0001b770: 6520 3d20 4865 7842 7974 6573 280a 2020  e = HexBytes(.  
-0001b780: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
-0001b790: 2e73 6967 6e5f 7479 7065 645f 6461 7461  .sign_typed_data
-0001b7a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001b7b0: 2020 6b65 7966 696c 655f 6163 636f 756e    keyfile_accoun
-0001b7c0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0001b7d0: 7970 652c 206a 736f 6e2e 6c6f 6164 7328  ype, json.loads(
-0001b7e0: 7661 6c69 644a 534f 4e4d 6573 7361 6765  validJSONMessage
-0001b7f0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-0001b800: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b810: 2020 6173 7365 7274 206c 656e 2873 6967    assert len(sig
-0001b820: 6e61 7475 7265 2920 3d3d 2033 3220 2b20  nature) == 32 + 
-0001b830: 3332 202b 2031 0a0a 2020 2020 6465 6620  32 + 1..    def 
-0001b840: 7465 7374 5f69 6e76 616c 6964 5f65 7468  test_invalid_eth
-0001b850: 5f73 6967 6e5f 7479 7065 645f 6461 7461  _sign_typed_data
-0001b860: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001b870: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-0001b880: 3322 2c0a 2020 2020 2020 2020 6b65 7966  3",.        keyf
-0001b890: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001b8a0: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
-0001b8b0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-0001b8c0: 2020 2020 2020 2020 736b 6970 5f69 665f          skip_if_
-0001b8d0: 7465 7374 7270 633a 2043 616c 6c61 626c  testrpc: Callabl
-0001b8e0: 655b 5b22 5765 6233 225d 2c20 4e6f 6e65  e[["Web3"], None
-0001b8f0: 5d2c 0a20 2020 2029 202d 3e20 4e6f 6e65  ],.    ) -> None
-0001b900: 3a0a 2020 2020 2020 2020 736b 6970 5f69  :.        skip_i
-0001b910: 665f 7465 7374 7270 6328 7733 290a 2020  f_testrpc(w3).  
-0001b920: 2020 2020 2020 696e 7661 6c69 645f 7479        invalid_ty
-0001b930: 7065 645f 6d65 7373 6167 6520 3d20 2222  ped_message = ""
-0001b940: 220a 2020 2020 2020 2020 2020 2020 7b0a  ".            {.
-0001b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b960: 2274 7970 6573 223a 207b 0a20 2020 2020  "types": {.     
-0001b970: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b980: 4549 5037 3132 446f 6d61 696e 223a 205b  EIP712Domain": [
-0001b990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b9a0: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
-0001b9b0: 3a20 226e 616d 6522 2c20 2274 7970 6522  : "name", "type"
-0001b9c0: 3a20 2273 7472 696e 6722 7d2c 0a20 2020  : "string"},.   
-0001b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9e0: 2020 2020 207b 226e 616d 6522 3a20 2276       {"name": "v
-0001b9f0: 6572 7369 6f6e 222c 2022 7479 7065 223a  ersion", "type":
-0001ba00: 2022 7374 7269 6e67 227d 2c0a 2020 2020   "string"},.    
-0001ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba20: 2020 2020 7b22 6e61 6d65 223a 2022 6368      {"name": "ch
-0001ba30: 6169 6e49 6422 2c20 2274 7970 6522 3a20  ainId", "type": 
-0001ba40: 2275 696e 7432 3536 227d 2c0a 2020 2020  "uint256"},.    
-0001ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba60: 2020 2020 7b22 6e61 6d65 223a 2022 7665      {"name": "ve
-0001ba70: 7269 6679 696e 6743 6f6e 7472 6163 7422  rifyingContract"
-0001ba80: 2c20 2274 7970 6522 3a20 2261 6464 7265  , "type": "addre
-0001ba90: 7373 227d 0a20 2020 2020 2020 2020 2020  ss"}.           
-0001baa0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0001bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bac0: 2250 6572 736f 6e22 3a20 5b0a 2020 2020  "Person": [.    
-0001bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bae0: 2020 2020 7b22 6e61 6d65 223a 2022 6e61      {"name": "na
-0001baf0: 6d65 222c 2022 7479 7065 223a 2022 7374  me", "type": "st
-0001bb00: 7269 6e67 227d 2c0a 2020 2020 2020 2020  ring"},.        
-0001bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb20: 7b22 6e61 6d65 223a 2022 7761 6c6c 6574  {"name": "wallet
-0001bb30: 222c 2022 7479 7065 223a 2022 6164 6472  ", "type": "addr
-0001bb40: 6573 7322 7d0a 2020 2020 2020 2020 2020  ess"}.          
-0001bb50: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0001bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb70: 2022 4d61 696c 223a 205b 0a20 2020 2020   "Mail": [.     
-0001bb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb90: 2020 207b 226e 616d 6522 3a20 2266 726f     {"name": "fro
-0001bba0: 6d22 2c20 2274 7970 6522 3a20 2250 6572  m", "type": "Per
-0001bbb0: 736f 6e22 7d2c 0a20 2020 2020 2020 2020  son"},.         
-0001bbc0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001bbd0: 226e 616d 6522 3a20 2274 6f22 2c20 2274  "name": "to", "t
-0001bbe0: 7970 6522 3a20 2250 6572 736f 6e5b 325d  ype": "Person[2]
-0001bbf0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0001bc00: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-0001bc10: 6d65 223a 2022 636f 6e74 656e 7473 222c  me": "contents",
-0001bc20: 2022 7479 7065 223a 2022 7374 7269 6e67   "type": "string
-0001bc30: 227d 0a20 2020 2020 2020 2020 2020 2020  "}.             
-0001bc40: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0001bc50: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0001bc60: 2020 2020 2020 2020 2020 2020 2270 7269              "pri
-0001bc70: 6d61 7279 5479 7065 223a 2022 4d61 696c  maryType": "Mail
-0001bc80: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001bc90: 2020 2022 646f 6d61 696e 223a 207b 0a20     "domain": {. 
-0001bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcb0: 2020 2022 6e61 6d65 223a 2022 4574 6865     "name": "Ethe
-0001bcc0: 7220 4d61 696c 222c 0a20 2020 2020 2020  r Mail",.       
-0001bcd0: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-0001bce0: 7273 696f 6e22 3a20 2231 222c 0a20 2020  rsion": "1",.   
-0001bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd00: 2022 6368 6169 6e49 6422 3a20 2230 7830   "chainId": "0x0
-0001bd10: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0001bd20: 2020 2020 2020 2020 2276 6572 6966 7969          "verifyi
-0001bd30: 6e67 436f 6e74 7261 6374 223a 2022 3078  ngContract": "0x
-0001bd40: 4363 4343 6363 6363 4343 4343 6343 4343  CcCCccccCCCCcCCC
-0001bd50: 4343 4363 4363 4363 6343 6343 4343 6343  CCCcCcCccCcCCCcC
-0001bd60: 6363 6363 6363 6343 220a 2020 2020 2020  cccccccC".      
-0001bd70: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0001bd80: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
-0001bd90: 7373 6167 6522 3a20 7b0a 2020 2020 2020  ssage": {.      
-0001bda0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0001bdb0: 726f 6d22 3a20 7b0a 2020 2020 2020 2020  rom": {.        
-0001bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdd0: 226e 616d 6522 3a20 2243 6f77 222c 0a20  "name": "Cow",. 
-0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdf0: 2020 2020 2020 2022 7761 6c6c 6574 223a         "wallet":
-0001be00: 2022 3078 4344 3261 3364 3946 3933 3845   "0xCD2a3d9F938E
-0001be10: 3133 4344 3934 3745 6330 3541 6243 3746  13CD947Ec05AbC7F
-0001be20: 4537 3334 4466 3844 4438 3236 220a 2020  E734Df8DD826".  
-0001be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be40: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0001be50: 2020 2020 2020 2020 2022 746f 223a 205b           "to": [
-0001be60: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001be70: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-0001be80: 3a20 2242 6f62 222c 0a20 2020 2020 2020  : "Bob",.       
-0001be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bea0: 2022 7761 6c6c 6574 223a 2022 3078 6242   "wallet": "0xbB
-0001beb0: 6242 4242 4262 6242 4242 6262 6242 6262  bBBBBbbBBBbbbBbb
-0001bec0: 4262 6262 6242 4262 4262 6262 6242 6242  BbbbbBBbBbbbbBbB
-0001bed0: 6262 4242 6242 220a 2020 2020 2020 2020  bbBBbB".        
-0001bee0: 2020 2020 2020 2020 2020 2020 7d5d 2c0a              }],.
-0001bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf00: 2020 2020 2263 6f6e 7465 6e74 7322 3a20      "contents": 
-0001bf10: 2248 656c 6c6f 2c20 426f 6221 220a 2020  "Hello, Bob!".  
-0001bf20: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-0001bf30: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0001bf40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001bf50: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0001bf60: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
-0001bf70: 2020 5765 6233 5661 6c75 6545 7272 6f72    Web3ValueError
-0001bf80: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-0001bf90: 7463 683d 7222 2e2a 4578 7065 6374 6564  tch=r".*Expected
-0001bfa0: 2032 2069 7465 6d73 2066 6f72 2061 7272   2 items for arr
-0001bfb0: 6179 2074 7970 6520 5065 7273 6f6e 5c5b  ay type Person\[
-0001bfc0: 325c 5d2c 2067 6f74 2031 2069 7465 6d73  2\], got 1 items
-0001bfd0: 2e2a 222c 0a20 2020 2020 2020 2029 3a0a  .*",.        ):.
-0001bfe0: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
-0001bff0: 7468 2e73 6967 6e5f 7479 7065 645f 6461  th.sign_typed_da
-0001c000: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
-0001c010: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
-0001c020: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0001c030: 5f74 7970 652c 206a 736f 6e2e 6c6f 6164  _type, json.load
-0001c040: 7328 696e 7661 6c69 645f 7479 7065 645f  s(invalid_typed_
-0001c050: 6d65 7373 6167 6529 0a20 2020 2020 2020  message).       
-0001c060: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001c070: 7465 7374 5f65 7468 5f73 6967 6e5f 7472  test_eth_sign_tr
-0001c080: 616e 7361 6374 696f 6e5f 6c65 6761 6379  ansaction_legacy
-0001c090: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001c0a0: 7733 3a20 2257 6562 3322 2c20 6b65 7966  w3: "Web3", keyf
-0001c0b0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001c0c0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
-0001c0d0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001c0e0: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-0001c0f0: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-0001c100: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001c110: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
-0001c120: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001c130: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0001c140: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
-0001c150: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
-0001c160: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-0001c170: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-0001c180: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-0001c190: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-0001c1a0: 2267 6173 5072 6963 6522 3a20 7733 2e65  "gasPrice": w3.e
-0001c1b0: 7468 2e67 6173 5f70 7269 6365 2c0a 2020  th.gas_price,.  
-0001c1c0: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
-0001c1d0: 223a 204e 6f6e 6365 2830 292c 0a20 2020  ": Nonce(0),.   
-0001c1e0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-0001c1f0: 6573 756c 7420 3d20 7733 2e65 7468 2e73  esult = w3.eth.s
-0001c200: 6967 6e5f 7472 616e 7361 6374 696f 6e28  ign_transaction(
-0001c210: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-0001c220: 2020 2020 7369 676e 6174 6f72 795f 6163      signatory_ac
-0001c230: 636f 756e 7420 3d20 7733 2e65 7468 2e61  count = w3.eth.a
-0001c240: 6363 6f75 6e74 2e72 6563 6f76 6572 5f74  ccount.recover_t
-0001c250: 7261 6e73 6163 7469 6f6e 2872 6573 756c  ransaction(resul
-0001c260: 745b 2272 6177 225d 290a 2020 2020 2020  t["raw"]).      
-0001c270: 2020 6173 7365 7274 206b 6579 6669 6c65    assert keyfile
-0001c280: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001c290: 203d 3d20 7369 676e 6174 6f72 795f 6163   == signatory_ac
-0001c2a0: 636f 756e 740a 2020 2020 2020 2020 6173  count.        as
-0001c2b0: 7365 7274 2072 6573 756c 745b 2274 7822  sert result["tx"
-0001c2c0: 5d5b 2274 6f22 5d20 3d3d 2074 786e 5f70  ]["to"] == txn_p
-0001c2d0: 6172 616d 735b 2274 6f22 5d0a 2020 2020  arams["to"].    
-0001c2e0: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-0001c2f0: 745b 2274 7822 5d5b 2276 616c 7565 225d  t["tx"]["value"]
-0001c300: 203d 3d20 7478 6e5f 7061 7261 6d73 5b22   == txn_params["
-0001c310: 7661 6c75 6522 5d0a 2020 2020 2020 2020  value"].        
-0001c320: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-0001c330: 7822 5d5b 2267 6173 225d 203d 3d20 7478  x"]["gas"] == tx
-0001c340: 6e5f 7061 7261 6d73 5b22 6761 7322 5d0a  n_params["gas"].
-0001c350: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-0001c360: 6573 756c 745b 2274 7822 5d5b 2267 6173  esult["tx"]["gas
-0001c370: 5072 6963 6522 5d20 3d3d 2074 786e 5f70  Price"] == txn_p
-0001c380: 6172 616d 735b 2267 6173 5072 6963 6522  arams["gasPrice"
-0001c390: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-0001c3a0: 2072 6573 756c 745b 2274 7822 5d5b 226e   result["tx"]["n
-0001c3b0: 6f6e 6365 225d 203d 3d20 7478 6e5f 7061  once"] == txn_pa
-0001c3c0: 7261 6d73 5b22 6e6f 6e63 6522 5d0a 0a20  rams["nonce"].. 
-0001c3d0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0001c3e0: 7369 676e 5f74 7261 6e73 6163 7469 6f6e  sign_transaction
-0001c3f0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001c400: 7733 3a20 2257 6562 3322 2c20 6b65 7966  w3: "Web3", keyf
-0001c410: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001c420: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
-0001c430: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-0001c440: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-0001c450: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-0001c460: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001c470: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
-0001c480: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001c490: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0001c4a0: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
-0001c4b0: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
-0001c4c0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-0001c4d0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-0001c4e0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-0001c4f0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-0001c500: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-0001c510: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-0001c520: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
-0001c530: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-0001c540: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-0001c550: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-0001c560: 2020 2020 2020 2020 2020 2020 226e 6f6e              "non
-0001c570: 6365 223a 204e 6f6e 6365 2830 292c 0a20  ce": Nonce(0),. 
-0001c580: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0001c590: 2072 6573 756c 7420 3d20 7733 2e65 7468   result = w3.eth
-0001c5a0: 2e73 6967 6e5f 7472 616e 7361 6374 696f  .sign_transactio
-0001c5b0: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
-0001c5c0: 2020 2020 2020 7369 676e 6174 6f72 795f        signatory_
-0001c5d0: 6163 636f 756e 7420 3d20 7733 2e65 7468  account = w3.eth
-0001c5e0: 2e61 6363 6f75 6e74 2e72 6563 6f76 6572  .account.recover
-0001c5f0: 5f74 7261 6e73 6163 7469 6f6e 2872 6573  _transaction(res
-0001c600: 756c 745b 2272 6177 225d 290a 2020 2020  ult["raw"]).    
-0001c610: 2020 2020 6173 7365 7274 206b 6579 6669      assert keyfi
-0001c620: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0001c630: 7373 203d 3d20 7369 676e 6174 6f72 795f  ss == signatory_
-0001c640: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
-0001c650: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
-0001c660: 7822 5d5b 2274 6f22 5d20 3d3d 2074 786e  x"]["to"] == txn
-0001c670: 5f70 6172 616d 735b 2274 6f22 5d0a 2020  _params["to"].  
-0001c680: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
-0001c690: 756c 745b 2274 7822 5d5b 2276 616c 7565  ult["tx"]["value
-0001c6a0: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-0001c6b0: 5b22 7661 6c75 6522 5d0a 2020 2020 2020  ["value"].      
-0001c6c0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
-0001c6d0: 2274 7822 5d5b 2267 6173 225d 203d 3d20  "tx"]["gas"] == 
-0001c6e0: 7478 6e5f 7061 7261 6d73 5b22 6761 7322  txn_params["gas"
-0001c6f0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-0001c700: 2072 6573 756c 745b 2274 7822 5d5b 226d   result["tx"]["m
-0001c710: 6178 4665 6550 6572 4761 7322 5d20 3d3d  axFeePerGas"] ==
-0001c720: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-0001c730: 4665 6550 6572 4761 7322 5d0a 2020 2020  FeePerGas"].    
-0001c740: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
-0001c750: 2020 2020 2020 2020 2072 6573 756c 745b           result[
-0001c760: 2274 7822 5d5b 226d 6178 5072 696f 7269  "tx"]["maxPriori
-0001c770: 7479 4665 6550 6572 4761 7322 5d20 3d3d  tyFeePerGas"] ==
-0001c780: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-0001c790: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-0001c7a0: 7322 5d0a 2020 2020 2020 2020 290a 2020  s"].        ).  
-0001c7b0: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
-0001c7c0: 756c 745b 2274 7822 5d5b 226e 6f6e 6365  ult["tx"]["nonce
-0001c7d0: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-0001c7e0: 5b22 6e6f 6e63 6522 5d0a 0a20 2020 2064  ["nonce"]..    d
-0001c7f0: 6566 2074 6573 745f 6574 685f 7369 676e  ef test_eth_sign
-0001c800: 5f74 7261 6e73 6163 7469 6f6e 5f68 6578  _transaction_hex
-0001c810: 5f66 6565 7328 0a20 2020 2020 2020 2073  _fees(.        s
-0001c820: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-0001c830: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0001c840: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-0001c850: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
-0001c860: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0001c870: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
-0001c880: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-0001c890: 2020 2020 2020 2266 726f 6d22 3a20 6b65        "from": ke
-0001c8a0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0001c8b0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
-0001c8c0: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
-0001c8d0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001c8e0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-0001c8f0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-0001c900: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-0001c910: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-0001c920: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
-0001c930: 6173 223a 2068 6578 2877 332e 746f 5f77  as": hex(w3.to_w
-0001c940: 6569 2832 2c20 2267 7765 6922 2929 2c0a  ei(2, "gwei")),.
-0001c950: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-0001c960: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
-0001c970: 7322 3a20 6865 7828 7733 2e74 6f5f 7765  s": hex(w3.to_we
-0001c980: 6928 312c 2022 6777 6569 2229 292c 0a20  i(1, "gwei")),. 
-0001c990: 2020 2020 2020 2020 2020 2022 6e6f 6e63             "nonc
-0001c9a0: 6522 3a20 4e6f 6e63 6528 3029 2c0a 2020  e": Nonce(0),.  
-0001c9b0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001c9c0: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
-0001c9d0: 7369 676e 5f74 7261 6e73 6163 7469 6f6e  sign_transaction
-0001c9e0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-0001c9f0: 2020 2020 2073 6967 6e61 746f 7279 5f61       signatory_a
-0001ca00: 6363 6f75 6e74 203d 2077 332e 6574 682e  ccount = w3.eth.
-0001ca10: 6163 636f 756e 742e 7265 636f 7665 725f  account.recover_
-0001ca20: 7472 616e 7361 6374 696f 6e28 7265 7375  transaction(resu
-0001ca30: 6c74 5b22 7261 7722 5d29 0a20 2020 2020  lt["raw"]).     
-0001ca40: 2020 2061 7373 6572 7420 6b65 7966 696c     assert keyfil
-0001ca50: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001ca60: 7320 3d3d 2073 6967 6e61 746f 7279 5f61  s == signatory_a
-0001ca70: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
-0001ca80: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-0001ca90: 225d 5b22 746f 225d 203d 3d20 7478 6e5f  "]["to"] == txn_
-0001caa0: 7061 7261 6d73 5b22 746f 225d 0a20 2020  params["to"].   
-0001cab0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0001cac0: 6c74 5b22 7478 225d 5b22 7661 6c75 6522  lt["tx"]["value"
-0001cad0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-0001cae0: 2276 616c 7565 225d 0a20 2020 2020 2020  "value"].       
-0001caf0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001cb00: 7478 225d 5b22 6761 7322 5d20 3d3d 2074  tx"]["gas"] == t
-0001cb10: 786e 5f70 6172 616d 735b 2267 6173 225d  xn_params["gas"]
-0001cb20: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001cb30: 7265 7375 6c74 5b22 7478 225d 5b22 6d61  result["tx"]["ma
-0001cb40: 7846 6565 5065 7247 6173 225d 203d 3d20  xFeePerGas"] == 
-0001cb50: 696e 7428 7374 7228 7478 6e5f 7061 7261  int(str(txn_para
-0001cb60: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
-0001cb70: 225d 292c 2031 3629 0a20 2020 2020 2020  "]), 16).       
-0001cb80: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001cb90: 7478 225d 5b22 6d61 7850 7269 6f72 6974  tx"]["maxPriorit
-0001cba0: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
-0001cbb0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-0001cbc0: 2073 7472 2874 786e 5f70 6172 616d 735b   str(txn_params[
-0001cbd0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-0001cbe0: 6572 4761 7322 5d29 2c20 3136 0a20 2020  erGas"]), 16.   
-0001cbf0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-0001cc00: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
-0001cc10: 225d 5b22 6e6f 6e63 6522 5d20 3d3d 2074  "]["nonce"] == t
-0001cc20: 786e 5f70 6172 616d 735b 226e 6f6e 6365  xn_params["nonce
-0001cc30: 225d 0a0a 2020 2020 6465 6620 7465 7374  "]..    def test
-0001cc40: 5f65 7468 5f73 6967 6e5f 7472 616e 7361  _eth_sign_transa
-0001cc50: 6374 696f 6e5f 656e 735f 6e61 6d65 7328  ction_ens_names(
-0001cc60: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0001cc70: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
-0001cc80: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0001cc90: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
-0001cca0: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
-0001ccb0: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
-0001ccc0: 656e 735f 6164 6472 6573 7365 7328 7733  ens_addresses(w3
-0001ccd0: 2c20 7b22 756e 6c6f 636b 6564 2d61 6363  , {"unlocked-acc
-0001cce0: 6f75 6e74 2e65 7468 223a 206b 6579 6669  ount.eth": keyfi
-0001ccf0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0001cd00: 7373 7d29 3a0a 2020 2020 2020 2020 2020  ss}):.          
-0001cd10: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-0001cd20: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-0001cd30: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0001cd40: 223a 2022 756e 6c6f 636b 6564 2d61 6363  ": "unlocked-acc
-0001cd50: 6f75 6e74 2e65 7468 222c 0a20 2020 2020  ount.eth",.     
-0001cd60: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-0001cd70: 2022 756e 6c6f 636b 6564 2d61 6363 6f75   "unlocked-accou
-0001cd80: 6e74 2e65 7468 222c 0a20 2020 2020 2020  nt.eth",.       
-0001cd90: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-0001cda0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-0001cdb0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-0001cdc0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-0001cdd0: 2020 2020 2020 2020 226d 6178 4665 6550          "maxFeeP
-0001cde0: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
-0001cdf0: 6928 322c 2022 6777 6569 2229 2c0a 2020  i(2, "gwei"),.  
-0001ce00: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-0001ce10: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-0001ce20: 4761 7322 3a20 7733 2e74 6f5f 7765 6928  Gas": w3.to_wei(
-0001ce30: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
-0001ce40: 2020 2020 2020 2020 2020 2020 226e 6f6e              "non
-0001ce50: 6365 223a 204e 6f6e 6365 2830 292c 0a20  ce": Nonce(0),. 
-0001ce60: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0001ce70: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-0001ce80: 3d20 7733 2e65 7468 2e73 6967 6e5f 7472  = w3.eth.sign_tr
-0001ce90: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-0001cea0: 7261 6d73 290a 2020 2020 2020 2020 2020  rams).          
-0001ceb0: 2020 7369 676e 6174 6f72 795f 6163 636f    signatory_acco
-0001cec0: 756e 7420 3d20 7733 2e65 7468 2e61 6363  unt = w3.eth.acc
-0001ced0: 6f75 6e74 2e72 6563 6f76 6572 5f74 7261  ount.recover_tra
-0001cee0: 6e73 6163 7469 6f6e 2872 6573 756c 745b  nsaction(result[
-0001cef0: 2272 6177 225d 290a 2020 2020 2020 2020  "raw"]).        
-0001cf00: 2020 2020 6173 7365 7274 206b 6579 6669      assert keyfi
-0001cf10: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0001cf20: 7373 203d 3d20 7369 676e 6174 6f72 795f  ss == signatory_
-0001cf30: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
-0001cf40: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-0001cf50: 745b 2274 7822 5d5b 2274 6f22 5d20 3d3d  t["tx"]["to"] ==
-0001cf60: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0001cf70: 5f61 6464 7265 7373 0a20 2020 2020 2020  _address.       
-0001cf80: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0001cf90: 6c74 5b22 7478 225d 5b22 7661 6c75 6522  lt["tx"]["value"
-0001cfa0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-0001cfb0: 2276 616c 7565 225d 0a20 2020 2020 2020  "value"].       
-0001cfc0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0001cfd0: 6c74 5b22 7478 225d 5b22 6761 7322 5d20  lt["tx"]["gas"] 
-0001cfe0: 3d3d 2074 786e 5f70 6172 616d 735b 2267  == txn_params["g
-0001cff0: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
-0001d000: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
-0001d010: 7478 225d 5b22 6d61 7846 6565 5065 7247  tx"]["maxFeePerG
-0001d020: 6173 225d 203d 3d20 7478 6e5f 7061 7261  as"] == txn_para
-0001d030: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
-0001d040: 225d 0a20 2020 2020 2020 2020 2020 2061  "].            a
-0001d050: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-0001d060: 2020 2020 2020 2020 7265 7375 6c74 5b22          result["
-0001d070: 7478 225d 5b22 6d61 7850 7269 6f72 6974  tx"]["maxPriorit
-0001d080: 7946 6565 5065 7247 6173 225d 0a20 2020  yFeePerGas"].   
-0001d090: 2020 2020 2020 2020 2020 2020 203d 3d20               == 
-0001d0a0: 7478 6e5f 7061 7261 6d73 5b22 6d61 7850  txn_params["maxP
-0001d0b0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-0001d0c0: 225d 0a20 2020 2020 2020 2020 2020 2029  "].            )
-0001d0d0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0001d0e0: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
-0001d0f0: 5b22 6e6f 6e63 6522 5d20 3d3d 2074 786e  ["nonce"] == txn
-0001d100: 5f70 6172 616d 735b 226e 6f6e 6365 225d  _params["nonce"]
-0001d110: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0001d120: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
-0001d130: 696f 6e5f 6164 6472 5f63 6865 636b 7375  ion_addr_checksu
-0001d140: 6d5f 7265 7175 6972 6564 280a 2020 2020  m_required(.    
-0001d150: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-0001d160: 6562 3322 2c20 6b65 7966 696c 655f 6163  eb3", keyfile_ac
-0001d170: 636f 756e 745f 6164 6472 6573 733a 2043  count_address: C
-0001d180: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-0001d190: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001d1a0: 2020 2020 2020 6e6f 6e5f 6368 6563 6b73        non_checks
-0001d1b0: 756d 5f61 6464 7220 3d20 6b65 7966 696c  um_addr = keyfil
-0001d1c0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001d1d0: 732e 6c6f 7765 7228 290a 2020 2020 2020  s.lower().      
-0001d1e0: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-0001d1f0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-0001d200: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
-0001d210: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-0001d220: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-0001d230: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
-0001d240: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001d250: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-0001d260: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-0001d270: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-0001d280: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-0001d290: 2020 2020 2020 226d 6178 4665 6550 6572        "maxFeePer
-0001d2a0: 4761 7322 3a20 7733 2e74 6f5f 7765 6928  Gas": w3.to_wei(
-0001d2b0: 322c 2022 6777 6569 2229 2c0a 2020 2020  2, "gwei"),.    
-0001d2c0: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
-0001d2d0: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
-0001d2e0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-0001d2f0: 6569 2229 2c0a 2020 2020 2020 2020 7d0a  ei"),.        }.
-0001d300: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0001d310: 7465 7374 2e72 6169 7365 7328 496e 7661  test.raises(Inva
-0001d320: 6c69 6441 6464 7265 7373 293a 0a20 2020  lidAddress):.   
-0001d330: 2020 2020 2020 2020 2069 6e76 616c 6964           invalid
-0001d340: 5f70 6172 616d 7320 3d20 6361 7374 280a  _params = cast(.
-0001d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d360: 5478 5061 7261 6d73 2c20 6469 6374 2874  TxParams, dict(t
-0001d370: 786e 5f70 6172 616d 732c 202a 2a7b 2266  xn_params, **{"f
-0001d380: 726f 6d22 3a20 6e6f 6e5f 6368 6563 6b73  rom": non_checks
-0001d390: 756d 5f61 6464 727d 290a 2020 2020 2020  um_addr}).      
-0001d3a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001d3b0: 2020 2020 7733 2e65 7468 2e73 656e 645f      w3.eth.send_
-0001d3c0: 7472 616e 7361 6374 696f 6e28 696e 7661  transaction(inva
-0001d3d0: 6c69 645f 7061 7261 6d73 290a 0a20 2020  lid_params)..   
-0001d3e0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001d3f0: 2e72 6169 7365 7328 496e 7661 6c69 6441  .raises(InvalidA
-0001d400: 6464 7265 7373 293a 0a20 2020 2020 2020  ddress):.       
-0001d410: 2020 2020 2069 6e76 616c 6964 5f70 6172       invalid_par
-0001d420: 616d 7320 3d20 6361 7374 280a 2020 2020  ams = cast(.    
-0001d430: 2020 2020 2020 2020 2020 2020 5478 5061              TxPa
-0001d440: 7261 6d73 2c20 6469 6374 2874 786e 5f70  rams, dict(txn_p
-0001d450: 6172 616d 732c 202a 2a7b 2274 6f22 3a20  arams, **{"to": 
-0001d460: 6e6f 6e5f 6368 6563 6b73 756d 5f61 6464  non_checksum_add
-0001d470: 727d 290a 2020 2020 2020 2020 2020 2020  r}).            
-0001d480: 290a 2020 2020 2020 2020 2020 2020 7733  ).            w3
-0001d490: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-0001d4a0: 6374 696f 6e28 696e 7661 6c69 645f 7061  ction(invalid_pa
-0001d4b0: 7261 6d73 290a 0a20 2020 2064 6566 2074  rams)..    def t
-0001d4c0: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-0001d4d0: 6e73 6163 7469 6f6e 5f6c 6567 6163 7928  nsaction_legacy(
-0001d4e0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0001d4f0: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
-0001d500: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0001d510: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
-0001d520: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-0001d530: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-0001d540: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-0001d550: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-0001d560: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-0001d570: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
-0001d580: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0001d590: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001d5a0: 2022 746f 223a 206b 6579 6669 6c65 5f61   "to": keyfile_a
-0001d5b0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
-0001d5c0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-0001d5d0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-0001d5e0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-0001d5f0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-0001d600: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-0001d610: 7350 7269 6365 223a 2077 332e 746f 5f77  sPrice": w3.to_w
-0001d620: 6569 280a 2020 2020 2020 2020 2020 2020  ei(.            
-0001d630: 2020 2020 312c 2022 6777 6569 220a 2020      1, "gwei".  
-0001d640: 2020 2020 2020 2020 2020 292c 2020 2320            ),  # 
-0001d650: 706f 7374 2d6c 6f6e 646f 6e20 6e65 6564  post-london need
-0001d660: 7320 746f 2062 6520 6d6f 7265 2074 6861  s to be more tha
-0001d670: 6e20 7468 6520 6261 7365 2066 6565 0a20  n the base fee. 
-0001d680: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0001d690: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
-0001d6a0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-0001d6b0: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-0001d6c0: 2020 2020 2020 2020 7478 6e20 3d20 7733          txn = w3
-0001d6d0: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-0001d6e0: 7469 6f6e 2874 786e 5f68 6173 6829 0a0a  tion(txn_hash)..
-0001d6f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0001d700: 735f 7361 6d65 5f61 6464 7265 7373 2874  s_same_address(t
-0001d710: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
-0001d720: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
-0001d730: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
-0001d740: 6f6d 225d 2929 0a20 2020 2020 2020 2061  om"])).        a
-0001d750: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
-0001d760: 6472 6573 7328 7478 6e5b 2274 6f22 5d2c  dress(txn["to"],
-0001d770: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
-0001d780: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
-0001d790: 735b 2274 6f22 5d29 290a 2020 2020 2020  s["to"])).      
-0001d7a0: 2020 6173 7365 7274 2074 786e 5b22 7661    assert txn["va
-0001d7b0: 6c75 6522 5d20 3d3d 2031 0a20 2020 2020  lue"] == 1.     
-0001d7c0: 2020 2061 7373 6572 7420 7478 6e5b 2267     assert txn["g
-0001d7d0: 6173 225d 203d 3d20 3231 3030 300a 2020  as"] == 21000.  
-0001d7e0: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
-0001d7f0: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
-0001d800: 7478 6e5f 7061 7261 6d73 5b22 6761 7350  txn_params["gasP
-0001d810: 7269 6365 225d 0a0a 2020 2020 6465 6620  rice"]..    def 
-0001d820: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-0001d830: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-0001d840: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-0001d850: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
-0001d860: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001d870: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0001d880: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0001d890: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-0001d8a0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-0001d8b0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0001d8c0: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-0001d8d0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001d8e0: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-0001d8f0: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-0001d900: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0001d910: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-0001d920: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0001d930: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-0001d940: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-0001d950: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-0001d960: 2020 2020 2020 2022 6d61 7846 6565 5065         "maxFeePe
-0001d970: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
-0001d980: 2833 2c20 2267 7765 6922 292c 0a20 2020  (3, "gwei"),.   
-0001d990: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-0001d9a0: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-0001d9b0: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
-0001d9c0: 7765 6922 292c 0a20 2020 2020 2020 207d  wei"),.        }
-0001d9d0: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-0001d9e0: 6820 3d20 7733 2e65 7468 2e73 656e 645f  h = w3.eth.send_
-0001d9f0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-0001da00: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-0001da10: 7478 6e20 3d20 7733 2e65 7468 2e67 6574  txn = w3.eth.get
-0001da20: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-0001da30: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
-0001da40: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
-0001da50: 6464 7265 7373 2874 786e 5b22 6672 6f6d  ddress(txn["from
-0001da60: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
-0001da70: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
-0001da80: 7261 6d73 5b22 6672 6f6d 225d 2929 0a20  rams["from"])). 
-0001da90: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0001daa0: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
-0001dab0: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
-0001dac0: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-0001dad0: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
-0001dae0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0001daf0: 2074 786e 5b22 7661 6c75 6522 5d20 3d3d   txn["value"] ==
-0001db00: 2031 0a20 2020 2020 2020 2061 7373 6572   1.        asser
-0001db10: 7420 7478 6e5b 2267 6173 225d 203d 3d20  t txn["gas"] == 
-0001db20: 3231 3030 300a 2020 2020 2020 2020 6173  21000.        as
-0001db30: 7365 7274 2074 786e 5b22 6d61 7846 6565  sert txn["maxFee
-0001db40: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
-0001db50: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-0001db60: 7247 6173 225d 0a20 2020 2020 2020 2061  rGas"].        a
-0001db70: 7373 6572 7420 7478 6e5b 226d 6178 5072  ssert txn["maxPr
-0001db80: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-0001db90: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-0001dba0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-0001dbb0: 6572 4761 7322 5d0a 2020 2020 2020 2020  erGas"].        
-0001dbc0: 6173 7365 7274 2074 786e 5b22 6761 7350  assert txn["gasP
-0001dbd0: 7269 6365 225d 203d 3d20 7478 6e5f 7061  rice"] == txn_pa
-0001dbe0: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
-0001dbf0: 6173 225d 0a0a 2020 2020 6465 6620 7465  as"]..    def te
-0001dc00: 7374 5f65 7468 5f73 656e 645f 7472 616e  st_eth_send_tran
-0001dc10: 7361 6374 696f 6e5f 7769 7468 5f6e 6f6e  saction_with_non
-0001dc20: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
-0001dc30: 2c20 7733 3a20 2257 6562 3322 2c20 6b65  , w3: "Web3", ke
-0001dc40: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0001dc50: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-0001dc60: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-0001dc70: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d61  None:.        ma
-0001dc80: 785f 7072 696f 7269 7479 5f66 6565 5f70  x_priority_fee_p
-0001dc90: 6572 5f67 6173 203d 2077 332e 746f 5f77  er_gas = w3.to_w
-0001dca0: 6569 2831 2e32 3334 2c20 2267 7765 6922  ei(1.234, "gwei"
-0001dcb0: 290a 2020 2020 2020 2020 6d61 785f 6665  ).        max_fe
-0001dcc0: 655f 7065 725f 6761 7320 3d20 5765 6928  e_per_gas = Wei(
-0001dcd0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
-0001dce0: 6574 682e 6765 745f 626c 6f63 6b28 226c  eth.get_block("l
-0001dcf0: 6174 6573 7422 295b 2262 6173 6546 6565  atest")["baseFee
-0001dd00: 5065 7247 6173 225d 202b 206d 6178 5f70  PerGas"] + max_p
-0001dd10: 7269 6f72 6974 795f 6665 655f 7065 725f  riority_fee_per_
-0001dd20: 6761 730a 2020 2020 2020 2020 290a 2020  gas.        ).  
-0001dd30: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-0001dd40: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-0001dd50: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0001dd60: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
-0001dd70: 6e74 5f61 6464 7265 7373 2c0a 2020 2020  nt_address,.    
-0001dd80: 2020 2020 2020 2020 2274 6f22 3a20 6b65          "to": ke
-0001dd90: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0001dda0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
-0001ddb0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
-0001ddc0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0001ddd0: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
-0001dde0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
-0001ddf0: 6550 6572 4761 7322 3a20 6d61 785f 6665  ePerGas": max_fe
-0001de00: 655f 7065 725f 6761 732c 0a20 2020 2020  e_per_gas,.     
-0001de10: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
-0001de20: 6974 7946 6565 5065 7247 6173 223a 206d  ityFeePerGas": m
-0001de30: 6178 5f70 7269 6f72 6974 795f 6665 655f  ax_priority_fee_
-0001de40: 7065 725f 6761 732c 0a20 2020 2020 2020  per_gas,.       
-0001de50: 2020 2020 2022 6e6f 6e63 6522 3a20 4e6f       "nonce": No
-0001de60: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
-0001de70: 2020 2020 2077 332e 6574 682e 6765 745f       w3.eth.get_
-0001de80: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
-0001de90: 7428 6b65 7966 696c 655f 6163 636f 756e  t(keyfile_accoun
-0001dea0: 745f 6164 6472 6573 732c 2022 7065 6e64  t_address, "pend
-0001deb0: 696e 6722 290a 2020 2020 2020 2020 2020  ing").          
-0001dec0: 2020 292c 0a20 2020 2020 2020 207d 0a20    ),.        }. 
-0001ded0: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-0001dee0: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
-0001def0: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-0001df00: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
-0001df10: 6e20 3d20 7733 2e65 7468 2e67 6574 5f74  n = w3.eth.get_t
-0001df20: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
-0001df30: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
-0001df40: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-0001df50: 7265 7373 2874 786e 5b22 6672 6f6d 225d  ress(txn["from"]
-0001df60: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
-0001df70: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
-0001df80: 6d73 5b22 6672 6f6d 225d 2929 0a20 2020  ms["from"])).   
-0001df90: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0001dfa0: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
-0001dfb0: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
-0001dfc0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-0001dfd0: 5f70 6172 616d 735b 2274 6f22 5d29 290a  _params["to"])).
-0001dfe0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001dff0: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
-0001e000: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001e010: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-0001e020: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-0001e030: 7274 2074 786e 5b22 6d61 7846 6565 5065  rt txn["maxFeePe
-0001e040: 7247 6173 225d 203d 3d20 7478 6e5f 7061  rGas"] == txn_pa
-0001e050: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
-0001e060: 6173 225d 0a20 2020 2020 2020 2061 7373  as"].        ass
-0001e070: 6572 7420 7478 6e5b 226d 6178 5072 696f  ert txn["maxPrio
-0001e080: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
-0001e090: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
-0001e0a0: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
-0001e0b0: 4761 7322 5d0a 2020 2020 2020 2020 6173  Gas"].        as
-0001e0c0: 7365 7274 2074 786e 5b22 6e6f 6e63 6522  sert txn["nonce"
-0001e0d0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
-0001e0e0: 226e 6f6e 6365 225d 0a20 2020 2020 2020  "nonce"].       
-0001e0f0: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-0001e100: 6572 2874 786e 5b22 6761 7350 7269 6365  er(txn["gasPrice
-0001e110: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
-0001e120: 7274 2069 735f 696e 7465 6765 7228 7478  rt is_integer(tx
-0001e130: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
-0001e140: 5065 7247 6173 225d 290a 0a20 2020 2064  PerGas"])..    d
-0001e150: 6566 2074 6573 745f 6574 685f 7365 6e64  ef test_eth_send
-0001e160: 5f74 7261 6e73 6163 7469 6f6e 5f64 6566  _transaction_def
-0001e170: 6175 6c74 5f66 6565 7328 0a20 2020 2020  ault_fees(.     
-0001e180: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-0001e190: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
-0001e1a0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001e1b0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0001e1c0: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0001e1d0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-0001e1e0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-0001e1f0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0001e200: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-0001e210: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001e220: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-0001e230: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-0001e240: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0001e250: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-0001e260: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0001e270: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-0001e280: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-0001e290: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-0001e2a0: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
-0001e2b0: 5f68 6173 6820 3d20 7733 2e65 7468 2e73  _hash = w3.eth.s
-0001e2c0: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-0001e2d0: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-0001e2e0: 2020 2020 7478 6e20 3d20 7733 2e65 7468      txn = w3.eth
-0001e2f0: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
-0001e300: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
-0001e310: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-0001e320: 6d65 5f61 6464 7265 7373 2874 786e 5b22  me_address(txn["
-0001e330: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
-0001e340: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
-0001e350: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
-0001e360: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-0001e370: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
-0001e380: 7328 7478 6e5b 2274 6f22 5d2c 2063 6173  s(txn["to"], cas
-0001e390: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
-0001e3a0: 732c 2074 786e 5f70 6172 616d 735b 2274  s, txn_params["t
-0001e3b0: 6f22 5d29 290a 2020 2020 2020 2020 6173  o"])).        as
-0001e3c0: 7365 7274 2074 786e 5b22 7661 6c75 6522  sert txn["value"
-0001e3d0: 5d20 3d3d 2031 0a20 2020 2020 2020 2061  ] == 1.        a
-0001e3e0: 7373 6572 7420 7478 6e5b 2267 6173 225d  ssert txn["gas"]
-0001e3f0: 203d 3d20 3231 3030 300a 2020 2020 2020   == 21000.      
-0001e400: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
-0001e410: 6765 7228 7478 6e5b 226d 6178 5072 696f  ger(txn["maxPrio
-0001e420: 7269 7479 4665 6550 6572 4761 7322 5d29  rityFeePerGas"])
-0001e430: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001e440: 6973 5f69 6e74 6567 6572 2874 786e 5b22  is_integer(txn["
-0001e450: 6d61 7846 6565 5065 7247 6173 225d 290a  maxFeePerGas"]).
-0001e460: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001e470: 786e 5b22 6761 7350 7269 6365 225d 203d  xn["gasPrice"] =
-0001e480: 3d20 7478 6e5b 226d 6178 4665 6550 6572  = txn["maxFeePer
-0001e490: 4761 7322 5d0a 0a20 2020 2064 6566 2074  Gas"]..    def t
-0001e4a0: 6573 745f 6574 685f 7365 6e64 5f74 7261  est_eth_send_tra
-0001e4b0: 6e73 6163 7469 6f6e 5f68 6578 5f66 6565  nsaction_hex_fee
-0001e4c0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0001e4d0: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
-0001e4e0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-0001e4f0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
-0001e500: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-0001e510: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-0001e520: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-0001e530: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-0001e540: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-0001e550: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
-0001e560: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0001e570: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001e580: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
-0001e590: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001e5a0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-0001e5b0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-0001e5c0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-0001e5d0: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-0001e5e0: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
-0001e5f0: 6d61 7846 6565 5065 7247 6173 223a 2068  maxFeePerGas": h
-0001e600: 6578 2832 3530 202a 2031 302a 2a39 292c  ex(250 * 10**9),
-0001e610: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
-0001e620: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-0001e630: 6173 223a 2068 6578 2832 202a 2031 302a  as": hex(2 * 10*
-0001e640: 2a39 292c 0a20 2020 2020 2020 207d 0a20  *9),.        }. 
-0001e650: 2020 2020 2020 2074 786e 5f68 6173 6820         txn_hash 
-0001e660: 3d20 7733 2e65 7468 2e73 656e 645f 7472  = w3.eth.send_tr
-0001e670: 616e 7361 6374 696f 6e28 7478 6e5f 7061  ansaction(txn_pa
-0001e680: 7261 6d73 290a 2020 2020 2020 2020 7478  rams).        tx
-0001e690: 6e20 3d20 7733 2e65 7468 2e67 6574 5f74  n = w3.eth.get_t
-0001e6a0: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
-0001e6b0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
-0001e6c0: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-0001e6d0: 7265 7373 2874 786e 5b22 6672 6f6d 225d  ress(txn["from"]
-0001e6e0: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
-0001e6f0: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
-0001e700: 6d73 5b22 6672 6f6d 225d 2929 0a20 2020  ms["from"])).   
-0001e710: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0001e720: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
-0001e730: 2274 6f22 5d2c 2063 6173 7428 4368 6563  "to"], cast(Chec
-0001e740: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-0001e750: 5f70 6172 616d 735b 2274 6f22 5d29 290a  _params["to"])).
-0001e760: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0001e770: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
-0001e780: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001e790: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-0001e7a0: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-0001e7b0: 7274 2074 786e 5b22 6d61 7846 6565 5065  rt txn["maxFeePe
-0001e7c0: 7247 6173 225d 203d 3d20 3235 3020 2a20  rGas"] == 250 * 
-0001e7d0: 3130 2a2a 390a 2020 2020 2020 2020 6173  10**9.        as
-0001e7e0: 7365 7274 2074 786e 5b22 6d61 7850 7269  sert txn["maxPri
-0001e7f0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
-0001e800: 203d 3d20 3220 2a20 3130 2a2a 390a 0a20   == 2 * 10**9.. 
-0001e810: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0001e820: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-0001e830: 5f6e 6f5f 6761 7328 0a20 2020 2020 2020  _no_gas(.       
-0001e840: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-0001e850: 222c 206b 6579 6669 6c65 5f61 6363 6f75  ", keyfile_accou
-0001e860: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-0001e870: 7479 7065 3a20 4368 6563 6b73 756d 4164  type: ChecksumAd
-0001e880: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-0001e890: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-0001e8a0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-0001e8b0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0001e8c0: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
-0001e8d0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001e8e0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-0001e8f0: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
-0001e900: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-0001e910: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-0001e920: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-0001e930: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
-0001e940: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
-0001e950: 6565 5065 7247 6173 223a 2057 6569 2832  eePerGas": Wei(2
-0001e960: 3530 202a 2031 302a 2a39 292c 0a20 2020  50 * 10**9),.   
-0001e970: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-0001e980: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-0001e990: 2057 6569 2832 202a 2031 302a 2a39 292c   Wei(2 * 10**9),
-0001e9a0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001e9b0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
-0001e9c0: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-0001e9d0: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-0001e9e0: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
-0001e9f0: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-0001ea00: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
-0001ea10: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0001ea20: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
-0001ea30: 2874 786e 5b22 6672 6f6d 225d 2c20 6361  (txn["from"], ca
-0001ea40: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-0001ea50: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-0001ea60: 6672 6f6d 225d 2929 0a20 2020 2020 2020  from"])).       
-0001ea70: 2061 7373 6572 7420 6973 5f73 616d 655f   assert is_same_
-0001ea80: 6164 6472 6573 7328 7478 6e5b 2274 6f22  address(txn["to"
-0001ea90: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
-0001eaa0: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
-0001eab0: 616d 735b 2274 6f22 5d29 290a 2020 2020  ams["to"])).    
-0001eac0: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-0001ead0: 7661 6c75 6522 5d20 3d3d 2031 0a20 2020  value"] == 1.   
-0001eae0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
-0001eaf0: 2267 6173 225d 203d 3d20 3132 3130 3030  "gas"] == 121000
-0001eb00: 2020 2320 3231 3030 3020 2b20 6275 6666    # 21000 + buff
-0001eb10: 6572 0a0a 2020 2020 6465 6620 7465 7374  er..    def test
-0001eb20: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
-0001eb30: 6374 696f 6e5f 7769 7468 5f67 6173 5f70  ction_with_gas_p
-0001eb40: 7269 6365 280a 2020 2020 2020 2020 7365  rice(.        se
-0001eb50: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-0001eb60: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-0001eb70: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-0001eb80: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-0001eb90: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-0001eba0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
-0001ebb0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
-0001ebc0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0001ebd0: 6672 6f6d 223a 206b 6579 6669 6c65 5f61  from": keyfile_a
-0001ebe0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
-0001ebf0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-0001ec00: 2020 2020 2020 2274 6f22 3a20 6b65 7966        "to": keyf
-0001ec10: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001ec20: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-0001ec30: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
-0001ec40: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
-0001ec50: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
-0001ec60: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
-0001ec70: 2020 2267 6173 5072 6963 6522 3a20 5765    "gasPrice": We
-0001ec80: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
-0001ec90: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
-0001eca0: 3a20 5765 6928 3235 3020 2a20 3130 2a2a  : Wei(250 * 10**
-0001ecb0: 3929 2c0a 2020 2020 2020 2020 2020 2020  9),.            
-0001ecc0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
-0001ecd0: 6572 4761 7322 3a20 5765 6928 3220 2a20  erGas": Wei(2 * 
-0001ece0: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
-0001ecf0: 7d0a 2020 2020 2020 2020 7769 7468 2070  }.        with p
-0001ed00: 7974 6573 742e 7261 6973 6573 2854 7261  ytest.raises(Tra
-0001ed10: 6e73 6163 7469 6f6e 5479 7065 4d69 736d  nsactionTypeMism
-0001ed20: 6174 6368 293a 0a20 2020 2020 2020 2020  atch):.         
-0001ed30: 2020 2077 332e 6574 682e 7365 6e64 5f74     w3.eth.send_t
-0001ed40: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
-0001ed50: 6172 616d 7329 0a0a 2020 2020 6465 6620  arams)..    def 
-0001ed60: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-0001ed70: 616e 7361 6374 696f 6e5f 6e6f 5f70 7269  ansaction_no_pri
-0001ed80: 6f72 6974 795f 6665 6528 0a20 2020 2020  ority_fee(.     
-0001ed90: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-0001eda0: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
-0001edb0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001edc0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
-0001edd0: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
-0001ede0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-0001edf0: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
-0001ee00: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0001ee10: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-0001ee20: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001ee30: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-0001ee40: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-0001ee50: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0001ee60: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-0001ee70: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0001ee80: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-0001ee90: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-0001eea0: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-0001eeb0: 2020 2020 2020 2022 6d61 7846 6565 5065         "maxFeePe
-0001eec0: 7247 6173 223a 2057 6569 2832 3530 202a  rGas": Wei(250 *
-0001eed0: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
-0001eee0: 207d 0a20 2020 2020 2020 2077 6974 6820   }.        with 
-0001eef0: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
-0001ef00: 2020 2020 2020 2020 2020 2049 6e76 616c             Inval
-0001ef10: 6964 5472 616e 7361 6374 696f 6e2c 206d  idTransaction, m
-0001ef20: 6174 6368 3d22 6d61 7850 7269 6f72 6974  atch="maxPriorit
-0001ef30: 7946 6565 5065 7247 6173 206d 7573 7420  yFeePerGas must 
-0001ef40: 6265 2064 6566 696e 6564 220a 2020 2020  be defined".    
-0001ef50: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0001ef60: 2020 2077 332e 6574 682e 7365 6e64 5f74     w3.eth.send_t
-0001ef70: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
-0001ef80: 6172 616d 7329 0a0a 2020 2020 6465 6620  arams)..    def 
-0001ef90: 7465 7374 5f65 7468 5f73 656e 645f 7472  test_eth_send_tr
-0001efa0: 616e 7361 6374 696f 6e5f 6e6f 5f6d 6178  ansaction_no_max
-0001efb0: 5f66 6565 280a 2020 2020 2020 2020 7365  _fee(.        se
-0001efc0: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-0001efd0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-0001efe0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-0001eff0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
-0001f000: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
-0001f010: 3a0a 2020 2020 2020 2020 6d61 785f 7072  :.        max_pr
-0001f020: 696f 7269 7479 5f66 6565 5f70 6572 5f67  iority_fee_per_g
-0001f030: 6173 203d 2077 332e 746f 5f77 6569 2832  as = w3.to_wei(2
-0001f040: 2c20 2267 7765 6922 290a 2020 2020 2020  , "gwei").      
-0001f050: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-0001f060: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-0001f070: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
-0001f080: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-0001f090: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-0001f0a0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0001f0b0: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
-0001f0c0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0001f0d0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001f0e0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
-0001f0f0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0001f100: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
-0001f110: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-0001f120: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-0001f130: 3a20 6d61 785f 7072 696f 7269 7479 5f66  : max_priority_f
-0001f140: 6565 5f70 6572 5f67 6173 2c0a 2020 2020  ee_per_gas,.    
-0001f150: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
-0001f160: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
-0001f170: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-0001f180: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-0001f190: 2020 2020 2074 786e 203d 2077 332e 6574       txn = w3.et
-0001f1a0: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-0001f1b0: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
-0001f1c0: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-0001f1d0: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
-0001f1e0: 2266 726f 6d22 5d2c 2063 6173 7428 4368  "from"], cast(Ch
-0001f1f0: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
-0001f200: 786e 5f70 6172 616d 735b 2266 726f 6d22  xn_params["from"
-0001f210: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
-0001f220: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
-0001f230: 7373 2874 786e 5b22 746f 225d 2c20 6361  ss(txn["to"], ca
-0001f240: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-0001f250: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-0001f260: 746f 225d 2929 0a20 2020 2020 2020 2061  to"])).        a
-0001f270: 7373 6572 7420 7478 6e5b 2276 616c 7565  ssert txn["value
-0001f280: 225d 203d 3d20 310a 2020 2020 2020 2020  "] == 1.        
-0001f290: 6173 7365 7274 2074 786e 5b22 6761 7322  assert txn["gas"
-0001f2a0: 5d20 3d3d 2032 3130 3030 0a20 2020 2020  ] == 21000.     
-0001f2b0: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-0001f2c0: 6567 6572 2874 786e 5b22 6d61 7850 7269  eger(txn["maxPri
-0001f2d0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
-0001f2e0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0001f2f0: 2074 786e 5b22 6d61 7850 7269 6f72 6974   txn["maxPriorit
-0001f300: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
-0001f310: 6d61 785f 7072 696f 7269 7479 5f66 6565  max_priority_fee
-0001f320: 5f70 6572 5f67 6173 0a20 2020 2020 2020  _per_gas.       
-0001f330: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
-0001f340: 6572 2874 786e 5b22 6d61 7846 6565 5065  er(txn["maxFeePe
-0001f350: 7247 6173 225d 290a 0a20 2020 2064 6566  rGas"])..    def
-0001f360: 2074 6573 745f 6574 685f 7365 6e64 5f74   test_eth_send_t
-0001f370: 7261 6e73 6163 7469 6f6e 5f6d 6178 5f66  ransaction_max_f
-0001f380: 6565 5f6c 6573 735f 7468 616e 5f74 6970  ee_less_than_tip
-0001f390: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001f3a0: 7733 3a20 2257 6562 3322 2c20 6b65 7966  w3: "Web3", keyf
-0001f3b0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-0001f3c0: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
-0001f3d0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
-0001f3e0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001f3f0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-0001f400: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
-0001f410: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0001f420: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
-0001f430: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-0001f440: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-0001f450: 2020 2274 6f22 3a20 6b65 7966 696c 655f    "to": keyfile_
-0001f460: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-0001f470: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-0001f480: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-0001f490: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-0001f4a0: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
-0001f4b0: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
-0001f4c0: 6178 4665 6550 6572 4761 7322 3a20 5765  axFeePerGas": We
-0001f4d0: 6928 3120 2a20 3130 2a2a 3929 2c0a 2020  i(1 * 10**9),.  
-0001f4e0: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
-0001f4f0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
-0001f500: 3a20 5765 6928 3220 2a20 3130 2a2a 3929  : Wei(2 * 10**9)
-0001f510: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-0001f520: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-0001f530: 7261 6973 6573 280a 2020 2020 2020 2020  raises(.        
-0001f540: 2020 2020 496e 7661 6c69 6454 7261 6e73      InvalidTrans
-0001f550: 6163 7469 6f6e 2c20 6d61 7463 683d 226d  action, match="m
-0001f560: 6178 4665 6550 6572 4761 7320 6d75 7374  axFeePerGas must
-0001f570: 2062 6520 3e3d 206d 6178 5072 696f 7269   be >= maxPriori
-0001f580: 7479 4665 6550 6572 4761 7322 0a20 2020  tyFeePerGas".   
-0001f590: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0001f5a0: 2020 2020 7733 2e65 7468 2e73 656e 645f      w3.eth.send_
-0001f5b0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-0001f5c0: 7061 7261 6d73 290a 0a20 2020 2064 6566  params)..    def
-0001f5d0: 2074 6573 745f 7661 6c69 6461 7469 6f6e   test_validation
-0001f5e0: 5f6d 6964 646c 6577 6172 655f 6368 6169  _middleware_chai
-0001f5f0: 6e5f 6964 5f6d 6973 6d61 7463 6828 0a20  n_id_mismatch(. 
-0001f600: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-0001f610: 2022 5765 6233 222c 206b 6579 6669 6c65   "Web3", keyfile
-0001f620: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0001f630: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-0001f640: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-0001f650: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0001f660: 2020 2077 726f 6e67 5f63 6861 696e 5f69     wrong_chain_i
-0001f670: 6420 3d20 3132 3334 3536 3738 3930 0a20  d = 1234567890. 
-0001f680: 2020 2020 2020 2061 6374 7561 6c5f 6368         actual_ch
-0001f690: 6169 6e5f 6964 203d 2077 332e 6574 682e  ain_id = w3.eth.
-0001f6a0: 6368 6169 6e5f 6964 0a0a 2020 2020 2020  chain_id..      
-0001f6b0: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-0001f6c0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-0001f6d0: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
-0001f6e0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-0001f6f0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-0001f700: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0001f710: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
-0001f720: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0001f730: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0001f740: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
-0001f750: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0001f760: 2267 6173 223a 2057 6569 2832 3130 3030  "gas": Wei(21000
-0001f770: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001f780: 6d61 7846 6565 5065 7247 6173 223a 2077  maxFeePerGas": w
-0001f790: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
-0001f7a0: 6922 292c 0a20 2020 2020 2020 2020 2020  i"),.           
-0001f7b0: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
-0001f7c0: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
-0001f7d0: 6569 2831 2c20 2267 7765 6922 292c 0a20  ei(1, "gwei"),. 
-0001f7e0: 2020 2020 2020 2020 2020 2022 6368 6169             "chai
-0001f7f0: 6e49 6422 3a20 7772 6f6e 675f 6368 6169  nId": wrong_chai
-0001f800: 6e5f 6964 2c0a 2020 2020 2020 2020 7d0a  n_id,.        }.
-0001f810: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0001f820: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
-0001f830: 2020 2020 2020 2020 5765 6233 5661 6c69          Web3Vali
-0001f840: 6461 7469 6f6e 4572 726f 722c 0a20 2020  dationError,.   
-0001f850: 2020 2020 2020 2020 206d 6174 6368 3d66           match=f
-0001f860: 2254 6865 2074 7261 6e73 6163 7469 6f6e  "The transaction
-0001f870: 2064 6563 6c61 7265 6420 6368 6169 6e20   declared chain 
-0001f880: 4944 207b 7772 6f6e 675f 6368 6169 6e5f  ID {wrong_chain_
-0001f890: 6964 7d2c 2022 0a20 2020 2020 2020 2020  id}, ".         
-0001f8a0: 2020 2066 2262 7574 2074 6865 2063 6f6e     f"but the con
-0001f8b0: 6e65 6374 6564 206e 6f64 6520 6973 206f  nected node is o
-0001f8c0: 6e20 7b61 6374 7561 6c5f 6368 6169 6e5f  n {actual_chain_
-0001f8d0: 6964 7d22 2c0a 2020 2020 2020 2020 293a  id}",.        ):
-0001f8e0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
-0001f8f0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-0001f900: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-0001f910: 0a0a 2020 2020 4070 7974 6573 742e 6d61  ..    @pytest.ma
-0001f920: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0001f930: 2020 2020 2020 2020 226d 6178 5f66 6565          "max_fee
-0001f940: 222c 2028 3130 3030 3030 3030 3030 2c20  ", (1000000000, 
-0001f950: 4e6f 6e65 292c 2069 6473 3d5b 2277 6974  None), ids=["wit
-0001f960: 685f 6d61 785f 6665 6522 2c20 2277 6974  h_max_fee", "wit
-0001f970: 686f 7574 5f6d 6178 5f66 6565 225d 0a20  hout_max_fee"]. 
-0001f980: 2020 2029 0a20 2020 2064 6566 2074 6573     ).    def tes
-0001f990: 745f 6761 735f 7072 6963 655f 6672 6f6d  t_gas_price_from
-0001f9a0: 5f73 7472 6174 6567 795f 6279 7061 7373  _strategy_bypass
-0001f9b0: 6564 5f66 6f72 5f64 796e 616d 6963 5f66  ed_for_dynamic_f
-0001f9c0: 6565 5f74 786e 280a 2020 2020 2020 2020  ee_txn(.        
-0001f9d0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-0001f9e0: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-0001f9f0: 2020 6b65 7966 696c 655f 6163 636f 756e    keyfile_accoun
-0001fa00: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0001fa10: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0001fa20: 7265 7373 2c0a 2020 2020 2020 2020 6d61  ress,.        ma
-0001fa30: 785f 6665 653a 2057 6569 2c0a 2020 2020  x_fee: Wei,.    
-0001fa40: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0001fa50: 2020 206d 6178 5f70 7269 6f72 6974 795f     max_priority_
-0001fa60: 6665 6520 3d20 7733 2e74 6f5f 7765 6928  fee = w3.to_wei(
-0001fa70: 312c 2022 6777 6569 2229 0a20 2020 2020  1, "gwei").     
-0001fa80: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-0001fa90: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-0001faa0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-0001fab0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-0001fac0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
-0001fad0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-0001fae0: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
-0001faf0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001fb00: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-0001fb10: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-0001fb20: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-0001fb30: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-0001fb40: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
-0001fb50: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
-0001fb60: 223a 206d 6178 5f70 7269 6f72 6974 795f  ": max_priority_
-0001fb70: 6665 652c 0a20 2020 2020 2020 207d 0a20  fee,.        }. 
-0001fb80: 2020 2020 2020 2069 6620 6d61 785f 6665         if max_fe
-0001fb90: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0001fba0: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
-0001fbb0: 6172 616d 7320 3d20 6173 736f 6328 7478  arams = assoc(tx
-0001fbc0: 6e5f 7061 7261 6d73 2c20 226d 6178 4665  n_params, "maxFe
-0001fbd0: 6550 6572 4761 7322 2c20 6d61 785f 6665  ePerGas", max_fe
-0001fbe0: 6529 0a0a 2020 2020 2020 2020 6465 6620  e)..        def 
-0001fbf0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
-0001fc00: 6779 285f 7733 3a20 2257 6562 3322 2c20  gy(_w3: "Web3", 
-0001fc10: 5f74 786e 3a20 5478 5061 7261 6d73 2920  _txn: TxParams) 
-0001fc20: 2d3e 2057 6569 3a0a 2020 2020 2020 2020  -> Wei:.        
-0001fc30: 2020 2020 7265 7475 726e 2077 332e 746f      return w3.to
-0001fc40: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
-0001fc50: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-0001fc60: 7365 745f 6761 735f 7072 6963 655f 7374  set_gas_price_st
-0001fc70: 7261 7465 6779 2867 6173 5f70 7269 6365  rategy(gas_price
-0001fc80: 5f73 7472 6174 6567 7929 0a0a 2020 2020  _strategy)..    
-0001fc90: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
-0001fca0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
-0001fcb0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-0001fcc0: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
-0001fcd0: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
-0001fce0: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
-0001fcf0: 290a 0a20 2020 2020 2020 206c 6174 6573  )..        lates
-0001fd00: 745f 626c 6f63 6b20 3d20 7733 2e65 7468  t_block = w3.eth
-0001fd10: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
-0001fd20: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
-0001fd30: 6572 7420 280a 2020 2020 2020 2020 2020  ert (.          
-0001fd40: 2020 7478 6e5b 226d 6178 4665 6550 6572    txn["maxFeePer
-0001fd50: 4761 7322 5d20 3d3d 206d 6178 5f66 6565  Gas"] == max_fee
-0001fd60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001fd70: 6d61 785f 6665 6520 6973 206e 6f74 204e  max_fee is not N
-0001fd80: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001fd90: 656c 7365 2032 202a 206c 6174 6573 745f  else 2 * latest_
-0001fda0: 626c 6f63 6b5b 2262 6173 6546 6565 5065  block["baseFeePe
-0001fdb0: 7247 6173 225d 202b 206d 6178 5f70 7269  rGas"] + max_pri
-0001fdc0: 6f72 6974 795f 6665 650a 2020 2020 2020  ority_fee.      
-0001fdd0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
-0001fde0: 7274 2074 786e 5b22 6d61 7850 7269 6f72  rt txn["maxPrior
-0001fdf0: 6974 7946 6565 5065 7247 6173 225d 203d  ityFeePerGas"] =
-0001fe00: 3d20 6d61 785f 7072 696f 7269 7479 5f66  = max_priority_f
-0001fe10: 6565 0a20 2020 2020 2020 2061 7373 6572  ee.        asser
-0001fe20: 7420 7478 6e5b 2267 6173 5072 6963 6522  t txn["gasPrice"
-0001fe30: 5d20 3d3d 2074 786e 5b22 6d61 7846 6565  ] == txn["maxFee
-0001fe40: 5065 7247 6173 225d 0a0a 2020 2020 2020  PerGas"]..      
-0001fe50: 2020 7733 2e65 7468 2e73 6574 5f67 6173    w3.eth.set_gas
-0001fe60: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-0001fe70: 4e6f 6e65 2920 2023 2072 6573 6574 2073  None)  # reset s
-0001fe80: 7472 6174 6567 790a 0a20 2020 2064 6566  trategy..    def
-0001fe90: 2074 6573 745f 6761 735f 7072 6963 655f   test_gas_price_
-0001fea0: 6672 6f6d 5f73 7472 6174 6567 795f 6279  from_strategy_by
-0001feb0: 7061 7373 6564 5f66 6f72 5f64 796e 616d  passed_for_dynam
-0001fec0: 6963 5f66 6565 5f74 786e 5f6e 6f5f 7469  ic_fee_txn_no_ti
-0001fed0: 7028 0a20 2020 2020 2020 2073 656c 662c  p(.        self,
-0001fee0: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
-0001fef0: 6233 222c 0a20 2020 2020 2020 206b 6579  b3",.        key
-0001ff00: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-0001ff10: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
-0001ff20: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-0001ff30: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0001ff40: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-0001ff50: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-0001ff60: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-0001ff70: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
-0001ff80: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-0001ff90: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-0001ffa0: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
-0001ffb0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0001ffc0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-0001ffd0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-0001ffe0: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-0001fff0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-00020000: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00020010: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-00020020: 5765 6928 3130 3030 3030 3030 3030 292c  Wei(1000000000),
-00020030: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00020040: 2020 2020 6465 6620 6761 735f 7072 6963      def gas_pric
-00020050: 655f 7374 7261 7465 6779 285f 7733 3a20  e_strategy(_w3: 
-00020060: 2257 6562 3322 2c20 5f74 786e 3a20 5478  "Web3", _txn: Tx
-00020070: 5061 7261 6d73 2920 2d3e 2057 6569 3a0a  Params) -> Wei:.
-00020080: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00020090: 726e 2077 332e 746f 5f77 6569 2832 2c20  rn w3.to_wei(2, 
-000200a0: 2267 7765 6922 290a 0a20 2020 2020 2020  "gwei")..       
-000200b0: 2077 332e 6574 682e 7365 745f 6761 735f   w3.eth.set_gas_
-000200c0: 7072 6963 655f 7374 7261 7465 6779 2867  price_strategy(g
-000200d0: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
-000200e0: 7929 0a0a 2020 2020 2020 2020 7769 7468  y)..        with
-000200f0: 2070 7974 6573 742e 7261 6973 6573 280a   pytest.raises(.
-00020100: 2020 2020 2020 2020 2020 2020 496e 7661              Inva
-00020110: 6c69 6454 7261 6e73 6163 7469 6f6e 2c20  lidTransaction, 
-00020120: 6d61 7463 683d 226d 6178 5072 696f 7269  match="maxPriori
-00020130: 7479 4665 6550 6572 4761 7320 6d75 7374  tyFeePerGas must
-00020140: 2062 6520 6465 6669 6e65 6422 0a20 2020   be defined".   
-00020150: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00020160: 2020 2020 7733 2e65 7468 2e73 656e 645f      w3.eth.send_
-00020170: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00020180: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
-00020190: 2077 332e 6574 682e 7365 745f 6761 735f   w3.eth.set_gas_
-000201a0: 7072 6963 655f 7374 7261 7465 6779 284e  price_strategy(N
-000201b0: 6f6e 6529 2020 2320 7265 7365 7420 7374  one)  # reset st
-000201c0: 7261 7465 6779 0a0a 2020 2020 6465 6620  rategy..    def 
-000201d0: 7465 7374 5f67 6173 5f70 7269 6365 5f73  test_gas_price_s
-000201e0: 7472 6174 6567 795f 6865 785f 7661 6c75  trategy_hex_valu
-000201f0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00020200: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
-00020210: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00020220: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
-00020230: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
-00020240: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00020250: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00020260: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00020270: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00020280: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
-00020290: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-000202a0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-000202b0: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
-000202c0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-000202d0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-000202e0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-000202f0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-00020300: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-00020310: 302c 0a20 2020 2020 2020 207d 0a20 2020  0,.        }.   
-00020320: 2020 2020 2074 776f 5f67 7765 695f 696e       two_gwei_in
-00020330: 5f77 6569 203d 2077 332e 746f 5f77 6569  _wei = w3.to_wei
-00020340: 2832 2c20 2267 7765 6922 290a 0a20 2020  (2, "gwei")..   
-00020350: 2020 2020 2064 6566 2067 6173 5f70 7269       def gas_pri
-00020360: 6365 5f73 7472 6174 6567 7928 5f77 333a  ce_strategy(_w3:
-00020370: 2022 5765 6233 222c 205f 7478 6e3a 2054   "Web3", _txn: T
-00020380: 7850 6172 616d 7329 202d 3e20 7374 723a  xParams) -> str:
-00020390: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000203a0: 7572 6e20 6865 7828 7477 6f5f 6777 6569  urn hex(two_gwei
-000203b0: 5f69 6e5f 7765 6929 0a0a 2020 2020 2020  _in_wei)..      
-000203c0: 2020 7733 2e65 7468 2e73 6574 5f67 6173    w3.eth.set_gas
-000203d0: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-000203e0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
-000203f0: 6779 2920 2023 2074 7970 653a 2069 676e  gy)  # type: ign
-00020400: 6f72 650a 0a20 2020 2020 2020 2074 786e  ore..        txn
-00020410: 5f68 6173 6820 3d20 7733 2e65 7468 2e73  _hash = w3.eth.s
-00020420: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
-00020430: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
-00020440: 2020 2020 7478 6e20 3d20 7733 2e65 7468      txn = w3.eth
-00020450: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
-00020460: 2874 786e 5f68 6173 6829 0a0a 2020 2020  (txn_hash)..    
-00020470: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
-00020480: 6761 7350 7269 6365 225d 203d 3d20 7477  gasPrice"] == tw
-00020490: 6f5f 6777 6569 5f69 6e5f 7765 690a 2020  o_gwei_in_wei.  
-000204a0: 2020 2020 2020 7733 2e65 7468 2e73 6574        w3.eth.set
-000204b0: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-000204c0: 6567 7928 4e6f 6e65 2920 2023 2072 6573  egy(None)  # res
-000204d0: 6574 2073 7472 6174 6567 790a 0a20 2020  et strategy..   
-000204e0: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-000204f0: 5f6d 696e 696e 670a 2020 2020 6465 6620  _mining.    def 
-00020500: 7465 7374 5f65 7468 5f72 6570 6c61 6365  test_eth_replace
-00020510: 5f74 7261 6e73 6163 7469 6f6e 5f6c 6567  _transaction_leg
-00020520: 6163 7928 0a20 2020 2020 2020 2073 656c  acy(.        sel
-00020530: 662c 2077 333a 2022 5765 6233 222c 206b  f, w3: "Web3", k
-00020540: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00020550: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00020560: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00020570: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00020580: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00020590: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
-000205a0: 7b0a 2020 2020 2020 2020 2020 2020 2266  {.            "f
-000205b0: 726f 6d22 3a20 6b65 7966 696c 655f 6163  rom": keyfile_ac
-000205c0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-000205d0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-000205e0: 2020 2020 2022 746f 223a 206b 6579 6669       "to": keyfi
-000205f0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00020600: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-00020610: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00020620: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00020630: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-00020640: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-00020650: 2022 6761 7350 7269 6365 223a 2077 332e   "gasPrice": w3.
-00020660: 746f 5f77 6569 280a 2020 2020 2020 2020  to_wei(.        
-00020670: 2020 2020 2020 2020 312c 2022 6777 6569          1, "gwei
-00020680: 220a 2020 2020 2020 2020 2020 2020 292c  ".            ),
-00020690: 2020 2320 6d75 7374 2062 6520 6772 6561    # must be grea
-000206a0: 7465 7220 7468 616e 2062 6173 655f 6665  ter than base_fe
-000206b0: 6520 706f 7374 204c 6f6e 646f 6e0a 2020  e post London.  
-000206c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000206d0: 7478 6e5f 6861 7368 203d 2077 332e 6574  txn_hash = w3.et
-000206e0: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-000206f0: 6f6e 2874 786e 5f70 6172 616d 7329 0a0a  on(txn_params)..
-00020700: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00020710: 6d73 5b22 6761 7350 7269 6365 225d 203d  ms["gasPrice"] =
-00020720: 2077 332e 746f 5f77 6569 2832 2c20 2267   w3.to_wei(2, "g
-00020730: 7765 6922 290a 2020 2020 2020 2020 7265  wei").        re
-00020740: 706c 6163 655f 7478 6e5f 6861 7368 203d  place_txn_hash =
-00020750: 2077 332e 6574 682e 7265 706c 6163 655f   w3.eth.replace_
-00020760: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00020770: 6861 7368 2c20 7478 6e5f 7061 7261 6d73  hash, txn_params
-00020780: 290a 2020 2020 2020 2020 7265 706c 6163  ).        replac
-00020790: 655f 7478 6e20 3d20 7733 2e65 7468 2e67  e_txn = w3.eth.g
-000207a0: 6574 5f74 7261 6e73 6163 7469 6f6e 2872  et_transaction(r
-000207b0: 6570 6c61 6365 5f74 786e 5f68 6173 6829  eplace_txn_hash)
-000207c0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000207d0: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
-000207e0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-000207f0: 706c 6163 655f 7478 6e5b 2266 726f 6d22  place_txn["from"
-00020800: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
-00020810: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
-00020820: 616d 735b 2266 726f 6d22 5d29 0a20 2020  ams["from"]).   
-00020830: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00020840: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
-00020850: 6472 6573 7328 0a20 2020 2020 2020 2020  dress(.         
-00020860: 2020 2072 6570 6c61 6365 5f74 786e 5b22     replace_txn["
-00020870: 746f 225d 2c20 6361 7374 2843 6865 636b  to"], cast(Check
-00020880: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
-00020890: 7061 7261 6d73 5b22 746f 225d 290a 2020  params["to"]).  
-000208a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000208b0: 6173 7365 7274 2072 6570 6c61 6365 5f74  assert replace_t
-000208c0: 786e 5b22 7661 6c75 6522 5d20 3d3d 2031  xn["value"] == 1
-000208d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000208e0: 7265 706c 6163 655f 7478 6e5b 2267 6173  replace_txn["gas
-000208f0: 225d 203d 3d20 3231 3030 300a 2020 2020  "] == 21000.    
-00020900: 2020 2020 6173 7365 7274 2072 6570 6c61      assert repla
-00020910: 6365 5f74 786e 5b22 6761 7350 7269 6365  ce_txn["gasPrice
-00020920: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
-00020930: 5b22 6761 7350 7269 6365 225d 0a0a 2020  ["gasPrice"]..  
-00020940: 2020 4066 6c61 6b79 5f67 6574 685f 6465    @flaky_geth_de
-00020950: 765f 6d69 6e69 6e67 0a20 2020 2064 6566  v_mining.    def
-00020960: 2074 6573 745f 6574 685f 7265 706c 6163   test_eth_replac
-00020970: 655f 7472 616e 7361 6374 696f 6e28 0a20  e_transaction(. 
-00020980: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-00020990: 2022 5765 6233 222c 206b 6579 6669 6c65   "Web3", keyfile
-000209a0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-000209b0: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
-000209c0: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
-000209d0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000209e0: 2020 2074 776f 5f67 7765 695f 696e 5f77     two_gwei_in_w
-000209f0: 6569 203d 2077 332e 746f 5f77 6569 2832  ei = w3.to_wei(2
-00020a00: 2c20 2267 7765 6922 290a 2020 2020 2020  , "gwei").      
-00020a10: 2020 7468 7265 655f 6777 6569 5f69 6e5f    three_gwei_in_
-00020a20: 7765 6920 3d20 7733 2e74 6f5f 7765 6928  wei = w3.to_wei(
-00020a30: 332c 2022 6777 6569 2229 0a0a 2020 2020  3, "gwei")..    
-00020a40: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
-00020a50: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
-00020a60: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
-00020a70: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-00020a80: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00020a90: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00020aa0: 2274 6f22 3a20 6b65 7966 696c 655f 6163  "to": keyfile_ac
-00020ab0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00020ac0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00020ad0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
-00020ae0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
-00020af0: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
-00020b00: 2020 2020 2020 2020 2020 2020 226d 6178              "max
-00020b10: 4665 6550 6572 4761 7322 3a20 7477 6f5f  FeePerGas": two_
-00020b20: 6777 6569 5f69 6e5f 7765 692c 0a20 2020  gwei_in_wei,.   
-00020b30: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-00020b40: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-00020b50: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
-00020b60: 7765 6922 292c 0a20 2020 2020 2020 207d  wei"),.        }
-00020b70: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00020b80: 6820 3d20 7733 2e65 7468 2e73 656e 645f  h = w3.eth.send_
-00020b90: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
-00020ba0: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
-00020bb0: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
-00020bc0: 4665 6550 6572 4761 7322 5d20 3d20 7468  FeePerGas"] = th
-00020bd0: 7265 655f 6777 6569 5f69 6e5f 7765 690a  ree_gwei_in_wei.
-00020be0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00020bf0: 6d73 5b22 6d61 7850 7269 6f72 6974 7946  ms["maxPriorityF
-00020c00: 6565 5065 7247 6173 225d 203d 2074 776f  eePerGas"] = two
-00020c10: 5f67 7765 695f 696e 5f77 6569 0a0a 2020  _gwei_in_wei..  
-00020c20: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00020c30: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
-00020c40: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
-00020c50: 696f 6e28 7478 6e5f 6861 7368 2c20 7478  ion(txn_hash, tx
-00020c60: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-00020c70: 2020 7265 706c 6163 655f 7478 6e20 3d20    replace_txn = 
-00020c80: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-00020c90: 6163 7469 6f6e 2872 6570 6c61 6365 5f74  action(replace_t
-00020ca0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
-00020cb0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
-00020cc0: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
-00020cd0: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
-00020ce0: 6e5b 2266 726f 6d22 5d2c 2063 6173 7428  n["from"], cast(
-00020cf0: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00020d00: 2074 786e 5f70 6172 616d 735b 2266 726f   txn_params["fro
-00020d10: 6d22 5d29 0a20 2020 2020 2020 2029 0a20  m"]).        ). 
-00020d20: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00020d30: 5f73 616d 655f 6164 6472 6573 7328 0a20  _same_address(. 
-00020d40: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
-00020d50: 6365 5f74 786e 5b22 746f 225d 2c20 6361  ce_txn["to"], ca
-00020d60: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
-00020d70: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
-00020d80: 746f 225d 290a 2020 2020 2020 2020 290a  to"]).        ).
-00020d90: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
-00020da0: 6570 6c61 6365 5f74 786e 5b22 7661 6c75  eplace_txn["valu
-00020db0: 6522 5d20 3d3d 2031 0a20 2020 2020 2020  e"] == 1.       
-00020dc0: 2061 7373 6572 7420 7265 706c 6163 655f   assert replace_
-00020dd0: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-00020de0: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-00020df0: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
-00020e00: 6d61 7846 6565 5065 7247 6173 225d 203d  maxFeePerGas"] =
-00020e10: 3d20 7468 7265 655f 6777 6569 5f69 6e5f  = three_gwei_in_
-00020e20: 7765 690a 2020 2020 2020 2020 6173 7365  wei.        asse
-00020e30: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
-00020e40: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00020e50: 7247 6173 225d 203d 3d20 7477 6f5f 6777  rGas"] == two_gw
-00020e60: 6569 5f69 6e5f 7765 690a 0a20 2020 2040  ei_in_wei..    @
-00020e70: 666c 616b 795f 6765 7468 5f64 6576 5f6d  flaky_geth_dev_m
-00020e80: 696e 696e 670a 2020 2020 6465 6620 7465  ining.    def te
-00020e90: 7374 5f65 7468 5f72 6570 6c61 6365 5f74  st_eth_replace_t
-00020ea0: 7261 6e73 6163 7469 6f6e 5f75 6e64 6572  ransaction_under
-00020eb0: 7072 6963 6564 280a 2020 2020 2020 2020  priced(.        
-00020ec0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00020ed0: 2c20 6b65 7966 696c 655f 6163 636f 756e  , keyfile_accoun
-00020ee0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00020ef0: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00020f00: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00020f10: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
-00020f20: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
-00020f30: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00020f40: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
-00020f50: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00020f60: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
-00020f70: 2020 2020 2020 2020 2274 6f22 3a20 6b65          "to": ke
-00020f80: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00020f90: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
-00020fa0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00020fb0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00020fc0: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-00020fd0: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00020fe0: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
-00020ff0: 7322 3a20 7733 2e74 6f5f 7765 6928 332c  s": w3.to_wei(3,
-00021000: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
-00021010: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
-00021020: 7479 4665 6550 6572 4761 7322 3a20 7733  tyFeePerGas": w3
-00021030: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
-00021040: 2229 2c0a 2020 2020 2020 2020 7d0a 2020  "),.        }.  
-00021050: 2020 2020 2020 7478 6e5f 6861 7368 203d        txn_hash =
-00021060: 2077 332e 6574 682e 7365 6e64 5f74 7261   w3.eth.send_tra
-00021070: 6e73 6163 7469 6f6e 2874 786e 5f70 6172  nsaction(txn_par
-00021080: 616d 7329 0a0a 2020 2020 2020 2020 6f6e  ams)..        on
-00021090: 655f 6777 6569 5f69 6e5f 7765 6920 3d20  e_gwei_in_wei = 
-000210a0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
-000210b0: 6569 2229 0a20 2020 2020 2020 2074 786e  ei").        txn
-000210c0: 5f70 6172 616d 735b 226d 6178 4665 6550  _params["maxFeeP
-000210d0: 6572 4761 7322 5d20 3d20 6f6e 655f 6777  erGas"] = one_gw
-000210e0: 6569 5f69 6e5f 7765 690a 2020 2020 2020  ei_in_wei.      
-000210f0: 2020 7478 6e5f 7061 7261 6d73 5b22 6d61    txn_params["ma
-00021100: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00021110: 6173 225d 203d 206f 6e65 5f67 7765 695f  as"] = one_gwei_
-00021120: 696e 5f77 6569 0a0a 2020 2020 2020 2020  in_wei..        
-00021130: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00021140: 6573 2857 6562 3352 5043 4572 726f 722c  es(Web3RPCError,
-00021150: 206d 6174 6368 3d22 7265 706c 6163 656d   match="replacem
-00021160: 656e 7420 7472 616e 7361 6374 696f 6e20  ent transaction 
-00021170: 756e 6465 7270 7269 6365 6422 293a 0a20  underpriced"):. 
-00021180: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-00021190: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
-000211a0: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
-000211b0: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
-000211c0: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
-000211d0: 5f6d 696e 696e 670a 2020 2020 6465 6620  _mining.    def 
-000211e0: 7465 7374 5f65 7468 5f72 6570 6c61 6365  test_eth_replace
-000211f0: 5f74 7261 6e73 6163 7469 6f6e 5f6e 6f6e  _transaction_non
-00021200: 5f65 7869 7374 696e 675f 7472 616e 7361  _existing_transa
-00021210: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
-00021220: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00021230: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-00021240: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-00021250: 7065 3a20 4368 6563 6b73 756d 4164 6472  pe: ChecksumAddr
-00021260: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
-00021270: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
-00021280: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
-00021290: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-000212a0: 2266 726f 6d22 3a20 6b65 7966 696c 655f  "from": keyfile_
-000212b0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-000212c0: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-000212d0: 2020 2020 2020 2022 746f 223a 206b 6579         "to": key
-000212e0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000212f0: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
-00021300: 2020 2020 2020 2020 2020 2020 2276 616c              "val
-00021310: 7565 223a 2057 6569 2831 292c 0a20 2020  ue": Wei(1),.   
-00021320: 2020 2020 2020 2020 2022 6761 7322 3a20           "gas": 
-00021330: 3231 3030 302c 0a20 2020 2020 2020 2020  21000,.         
-00021340: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
-00021350: 223a 2077 332e 746f 5f77 6569 2833 2c20  ": w3.to_wei(3, 
-00021360: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-00021370: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
-00021380: 7946 6565 5065 7247 6173 223a 2077 332e  yFeePerGas": w3.
-00021390: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
-000213a0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-000213b0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-000213c0: 2e72 6169 7365 7328 5472 616e 7361 6374  .raises(Transact
-000213d0: 696f 6e4e 6f74 466f 756e 6429 3a0a 2020  ionNotFound):.  
-000213e0: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
-000213f0: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
-00021400: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00021410: 2020 2020 2020 4865 7853 7472 280a 2020        HexStr(.  
-00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021430: 2020 2230 7839 3865 3863 6330 3962 3331    "0x98e8cc09b31
-00021440: 3135 3833 6335 3037 3966 6136 3030 6636  1583c5079fa600f6
-00021450: 6332 6133 6265 6138 3631 3161 6631 3638  c2a3bea8611af168
-00021460: 6335 3265 3462 3630 6235 6232 3433 6134  c52e4b60b5b243a4
-00021470: 3431 3939 3722 0a20 2020 2020 2020 2020  41997".         
-00021480: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00021490: 2020 2020 2020 2020 2020 7478 6e5f 7061            txn_pa
-000214a0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-000214b0: 2020 290a 0a20 2020 2040 666c 616b 795f    )..    @flaky_
-000214c0: 6765 7468 5f64 6576 5f6d 696e 696e 670a  geth_dev_mining.
-000214d0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-000214e0: 5f72 6570 6c61 6365 5f74 7261 6e73 6163  _replace_transac
-000214f0: 7469 6f6e 5f61 6c72 6561 6479 5f6d 696e  tion_already_min
-00021500: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
-00021510: 2c20 7733 3a20 2257 6562 3322 2c20 6b65  , w3: "Web3", ke
-00021520: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00021530: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
-00021540: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-00021550: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00021560: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00021570: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
-00021580: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
-00021590: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
-000215a0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-000215b0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-000215c0: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
-000215d0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-000215e0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
-000215f0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
-00021600: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
-00021610: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
-00021620: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00021630: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
-00021640: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
-00021650: 6569 2229 2c0a 2020 2020 2020 2020 2020  ei"),.          
-00021660: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
-00021670: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
-00021680: 7765 6928 312c 2022 6777 6569 2229 2c0a  wei(1, "gwei"),.
-00021690: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000216a0: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
-000216b0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
-000216c0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
-000216d0: 0a20 2020 2020 2020 2077 332e 6574 682e  .        w3.eth.
-000216e0: 7761 6974 5f66 6f72 5f74 7261 6e73 6163  wait_for_transac
-000216f0: 7469 6f6e 5f72 6563 6569 7074 2874 786e  tion_receipt(txn
-00021700: 5f68 6173 682c 2074 696d 656f 7574 3d31  _hash, timeout=1
-00021710: 3029 0a0a 2020 2020 2020 2020 7478 6e5f  0)..        txn_
-00021720: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
-00021730: 7247 6173 225d 203d 2077 332e 746f 5f77  rGas"] = w3.to_w
-00021740: 6569 2833 2c20 2267 7765 6922 290a 2020  ei(3, "gwei").  
-00021750: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00021760: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
-00021770: 5065 7247 6173 225d 203d 2077 332e 746f  PerGas"] = w3.to
-00021780: 5f77 6569 2832 2c20 2267 7765 6922 290a  _wei(2, "gwei").
-00021790: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-000217a0: 6573 742e 7261 6973 6573 2857 6562 3356  est.raises(Web3V
-000217b0: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
-000217c0: 3d22 5375 7070 6c69 6564 2074 7261 6e73  ="Supplied trans
-000217d0: 6163 7469 6f6e 2077 6974 6820 6861 7368  action with hash
-000217e0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-000217f0: 7733 2e65 7468 2e72 6570 6c61 6365 5f74  w3.eth.replace_t
-00021800: 7261 6e73 6163 7469 6f6e 2874 786e 5f68  ransaction(txn_h
-00021810: 6173 682c 2074 786e 5f70 6172 616d 7329  ash, txn_params)
-00021820: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
-00021830: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
-00021840: 2064 6566 2074 6573 745f 6574 685f 7265   def test_eth_re
-00021850: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00021860: 6e5f 696e 636f 7272 6563 745f 6e6f 6e63  n_incorrect_nonc
-00021870: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00021880: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
-00021890: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000218a0: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
-000218b0: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-000218c0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-000218d0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-000218e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-000218f0: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
-00021900: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00021910: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-00021920: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
-00021930: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
-00021940: 2020 2020 2020 2020 2020 2276 616c 7565            "value
-00021950: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
-00021960: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
-00021970: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
-00021980: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
-00021990: 2077 332e 746f 5f77 6569 2832 2c20 2267   w3.to_wei(2, "g
-000219a0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-000219b0: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
-000219c0: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
-000219d0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
-000219e0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-000219f0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
-00021a00: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-00021a10: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-00021a20: 290a 2020 2020 2020 2020 7478 6e20 3d20  ).        txn = 
-00021a30: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
-00021a40: 6163 7469 6f6e 2874 786e 5f68 6173 6829  action(txn_hash)
-00021a50: 0a0a 2020 2020 2020 2020 7478 6e5f 7061  ..        txn_pa
-00021a60: 7261 6d73 5b22 6d61 7846 6565 5065 7247  rams["maxFeePerG
-00021a70: 6173 225d 203d 2077 332e 746f 5f77 6569  as"] = w3.to_wei
-00021a80: 2833 2c20 2267 7765 6922 290a 2020 2020  (3, "gwei").    
-00021a90: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
-00021aa0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
-00021ab0: 7247 6173 225d 203d 2077 332e 746f 5f77  rGas"] = w3.to_w
-00021ac0: 6569 2832 2c20 2267 7765 6922 290a 2020  ei(2, "gwei").  
-00021ad0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00021ae0: 5b22 6e6f 6e63 6522 5d20 3d20 4e6f 6e63  ["nonce"] = Nonc
-00021af0: 6528 7478 6e5b 226e 6f6e 6365 225d 202b  e(txn["nonce"] +
-00021b00: 2031 290a 2020 2020 2020 2020 7769 7468   1).        with
-00021b10: 2070 7974 6573 742e 7261 6973 6573 2857   pytest.raises(W
-00021b20: 6562 3356 616c 7565 4572 726f 7229 3a0a  eb3ValueError):.
-00021b30: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
-00021b40: 7468 2e72 6570 6c61 6365 5f74 7261 6e73  th.replace_trans
-00021b50: 6163 7469 6f6e 2874 786e 5f68 6173 682c  action(txn_hash,
-00021b60: 2074 786e 5f70 6172 616d 7329 0a0a 2020   txn_params)..  
-00021b70: 2020 4066 6c61 6b79 5f67 6574 685f 6465    @flaky_geth_de
-00021b80: 765f 6d69 6e69 6e67 0a20 2020 2064 6566  v_mining.    def
-00021b90: 2074 6573 745f 6574 685f 7265 706c 6163   test_eth_replac
-00021ba0: 655f 7472 616e 7361 6374 696f 6e5f 6761  e_transaction_ga
-00021bb0: 735f 7072 6963 655f 746f 6f5f 6c6f 7728  s_price_too_low(
-00021bc0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00021bd0: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
-00021be0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00021bf0: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
-00021c00: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-00021c10: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00021c20: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00021c30: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00021c40: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00021c50: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
-00021c60: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00021c70: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00021c80: 2022 746f 223a 206b 6579 6669 6c65 5f61   "to": keyfile_a
-00021c90: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
-00021ca0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
-00021cb0: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
-00021cc0: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
-00021cd0: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
-00021ce0: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-00021cf0: 7350 7269 6365 223a 2077 332e 746f 5f77  sPrice": w3.to_w
-00021d00: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
-00021d10: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00021d20: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
-00021d30: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-00021d40: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
-00021d50: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
-00021d60: 616d 735b 2267 6173 5072 6963 6522 5d20  ams["gasPrice"] 
-00021d70: 3d20 7733 2e74 6f5f 7765 6928 312c 2022  = w3.to_wei(1, "
-00021d80: 6777 6569 2229 0a20 2020 2020 2020 2077  gwei").        w
-00021d90: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00021da0: 7328 5765 6233 5661 6c75 6545 7272 6f72  s(Web3ValueError
-00021db0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00021dc0: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
-00021dd0: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
-00021de0: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
-00021df0: 0a20 2020 2040 666c 616b 795f 6765 7468  .    @flaky_geth
-00021e00: 5f64 6576 5f6d 696e 696e 670a 2020 2020  _dev_mining.    
-00021e10: 6465 6620 7465 7374 5f65 7468 5f72 6570  def test_eth_rep
-00021e20: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
-00021e30: 5f67 6173 5f70 7269 6365 5f64 6566 6175  _gas_price_defau
-00021e40: 6c74 696e 675f 6d69 6e69 6d75 6d28 0a20  lting_minimum(. 
-00021e50: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
-00021e60: 2022 5765 6233 222c 206b 6579 6669 6c65   "Web3", keyfile
-00021e70: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00021e80: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00021e90: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00021ea0: 0a20 2020 2020 2020 2067 6173 5f70 7269  .        gas_pri
-00021eb0: 6365 203d 2077 332e 746f 5f77 6569 2831  ce = w3.to_wei(1
-00021ec0: 2c20 2267 7765 6922 290a 0a20 2020 2020  , "gwei")..     
-00021ed0: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-00021ee0: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
-00021ef0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-00021f00: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00021f10: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
-00021f20: 2020 2020 2022 746f 223a 206b 6579 6669       "to": keyfi
-00021f30: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-00021f40: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
-00021f50: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
-00021f60: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
-00021f70: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
-00021f80: 2020 2020 2020 2022 6761 7350 7269 6365         "gasPrice
-00021f90: 223a 2067 6173 5f70 7269 6365 2c0a 2020  ": gas_price,.  
-00021fa0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00021fb0: 7478 6e5f 6861 7368 203d 2077 332e 6574  txn_hash = w3.et
-00021fc0: 682e 7365 6e64 5f74 7261 6e73 6163 7469  h.send_transacti
-00021fd0: 6f6e 2874 786e 5f70 6172 616d 7329 0a0a  on(txn_params)..
-00021fe0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00021ff0: 6d73 2e70 6f70 2822 6761 7350 7269 6365  ms.pop("gasPrice
-00022000: 2229 0a20 2020 2020 2020 2072 6570 6c61  ").        repla
-00022010: 6365 5f74 786e 5f68 6173 6820 3d20 7733  ce_txn_hash = w3
-00022020: 2e65 7468 2e72 6570 6c61 6365 5f74 7261  .eth.replace_tra
-00022030: 6e73 6163 7469 6f6e 2874 786e 5f68 6173  nsaction(txn_has
-00022040: 682c 2074 786e 5f70 6172 616d 7329 0a20  h, txn_params). 
-00022050: 2020 2020 2020 2072 6570 6c61 6365 5f74         replace_t
-00022060: 786e 203d 2077 332e 6574 682e 6765 745f  xn = w3.eth.get_
-00022070: 7472 616e 7361 6374 696f 6e28 7265 706c  transaction(repl
-00022080: 6163 655f 7478 6e5f 6861 7368 290a 0a20  ace_txn_hash).. 
-00022090: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-000220a0: 706c 6163 655f 7478 6e5b 2267 6173 5072  place_txn["gasPr
-000220b0: 6963 6522 5d20 3d3d 206d 6174 682e 6365  ice"] == math.ce
-000220c0: 696c 280a 2020 2020 2020 2020 2020 2020  il(.            
-000220d0: 6761 735f 7072 6963 6520 2a20 312e 3132  gas_price * 1.12
-000220e0: 350a 2020 2020 2020 2020 2920 2023 206d  5.        )  # m
-000220f0: 696e 696d 756d 2067 6173 2070 7269 6365  inimum gas price
-00022100: 0a0a 2020 2020 4066 6c61 6b79 5f67 6574  ..    @flaky_get
-00022110: 685f 6465 765f 6d69 6e69 6e67 0a20 2020  h_dev_mining.   
-00022120: 2064 6566 2074 6573 745f 6574 685f 7265   def test_eth_re
-00022130: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00022140: 6e5f 6761 735f 7072 6963 655f 6465 6661  n_gas_price_defa
-00022150: 756c 7469 6e67 5f73 7472 6174 6567 795f  ulting_strategy_
-00022160: 6869 6768 6572 280a 2020 2020 2020 2020  higher(.        
-00022170: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00022180: 2c20 6b65 7966 696c 655f 6163 636f 756e  , keyfile_accoun
-00022190: 745f 6164 6472 6573 733a 2043 6865 636b  t_address: Check
-000221a0: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-000221b0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000221c0: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
-000221d0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
-000221e0: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
-000221f0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00022200: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00022210: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
-00022220: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00022230: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-00022240: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-00022250: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-00022260: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
-00022270: 2020 2020 2020 2267 6173 5072 6963 6522        "gasPrice"
-00022280: 3a20 7733 2e74 6f5f 7765 6928 312c 2022  : w3.to_wei(1, "
-00022290: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
-000222a0: 7d0a 2020 2020 2020 2020 7478 6e5f 6861  }.        txn_ha
-000222b0: 7368 203d 2077 332e 6574 682e 7365 6e64  sh = w3.eth.send
-000222c0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
-000222d0: 5f70 6172 616d 7329 0a0a 2020 2020 2020  _params)..      
-000222e0: 2020 7477 6f5f 6777 6569 5f69 6e5f 7765    two_gwei_in_we
-000222f0: 6920 3d20 7733 2e74 6f5f 7765 6928 322c  i = w3.to_wei(2,
-00022300: 2022 6777 6569 2229 0a0a 2020 2020 2020   "gwei")..      
-00022310: 2020 6465 6620 6869 6768 6572 5f67 6173    def higher_gas
-00022320: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
-00022330: 7733 3a20 2257 6562 3322 2c20 7478 6e3a  w3: "Web3", txn:
-00022340: 2054 7850 6172 616d 7329 202d 3e20 5765   TxParams) -> We
-00022350: 693a 0a20 2020 2020 2020 2020 2020 2072  i:.            r
-00022360: 6574 7572 6e20 7477 6f5f 6777 6569 5f69  eturn two_gwei_i
-00022370: 6e5f 7765 690a 0a20 2020 2020 2020 2077  n_wei..        w
-00022380: 332e 6574 682e 7365 745f 6761 735f 7072  3.eth.set_gas_pr
-00022390: 6963 655f 7374 7261 7465 6779 2868 6967  ice_strategy(hig
-000223a0: 6865 725f 6761 735f 7072 6963 655f 7374  her_gas_price_st
-000223b0: 7261 7465 6779 290a 0a20 2020 2020 2020  rategy)..       
-000223c0: 2074 786e 5f70 6172 616d 732e 706f 7028   txn_params.pop(
-000223d0: 2267 6173 5072 6963 6522 290a 2020 2020  "gasPrice").    
-000223e0: 2020 2020 7265 706c 6163 655f 7478 6e5f      replace_txn_
-000223f0: 6861 7368 203d 2077 332e 6574 682e 7265  hash = w3.eth.re
-00022400: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
-00022410: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
-00022420: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00022430: 7265 706c 6163 655f 7478 6e20 3d20 7733  replace_txn = w3
-00022440: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-00022450: 7469 6f6e 2872 6570 6c61 6365 5f74 786e  tion(replace_txn
-00022460: 5f68 6173 6829 0a20 2020 2020 2020 2061  _hash).        a
-00022470: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-00022480: 2020 2020 7265 706c 6163 655f 7478 6e5b      replace_txn[
-00022490: 2267 6173 5072 6963 6522 5d20 3d3d 2074  "gasPrice"] == t
-000224a0: 776f 5f67 7765 695f 696e 5f77 6569 0a20  wo_gwei_in_wei. 
-000224b0: 2020 2020 2020 2029 2020 2320 5374 7261         )  # Stra
-000224c0: 7465 6779 2070 726f 7669 6465 7320 6869  tegy provides hi
-000224d0: 6768 6572 2067 6173 2070 7269 6365 0a20  gher gas price. 
-000224e0: 2020 2020 2020 2077 332e 6574 682e 7365         w3.eth.se
-000224f0: 745f 6761 735f 7072 6963 655f 7374 7261  t_gas_price_stra
-00022500: 7465 6779 284e 6f6e 6529 2020 2320 7265  tegy(None)  # re
-00022510: 7365 7420 7374 7261 7465 6779 0a0a 2020  set strategy..  
-00022520: 2020 4066 6c61 6b79 5f67 6574 685f 6465    @flaky_geth_de
-00022530: 765f 6d69 6e69 6e67 0a20 2020 2064 6566  v_mining.    def
-00022540: 2074 6573 745f 6574 685f 7265 706c 6163   test_eth_replac
-00022550: 655f 7472 616e 7361 6374 696f 6e5f 6761  e_transaction_ga
-00022560: 735f 7072 6963 655f 6465 6661 756c 7469  s_price_defaulti
-00022570: 6e67 5f73 7472 6174 6567 795f 6c6f 7765  ng_strategy_lowe
-00022580: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00022590: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
-000225a0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-000225b0: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
-000225c0: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
-000225d0: 6f6e 653a 0a20 2020 2020 2020 2067 6173  one:.        gas
-000225e0: 5f70 7269 6365 203d 2077 332e 746f 5f77  _price = w3.to_w
-000225f0: 6569 2832 2c20 2267 7765 6922 290a 0a20  ei(2, "gwei").. 
-00022600: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
-00022610: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
-00022620: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-00022630: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
-00022640: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
-00022650: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
-00022660: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00022670: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00022680: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-00022690: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-000226a0: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
-000226b0: 2020 2020 2020 2020 2020 2022 6761 7350             "gasP
-000226c0: 7269 6365 223a 2067 6173 5f70 7269 6365  rice": gas_price
-000226d0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-000226e0: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
-000226f0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
-00022700: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
-00022710: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
-00022720: 6c6f 7765 725f 6761 735f 7072 6963 655f  lower_gas_price_
-00022730: 7374 7261 7465 6779 2877 333a 2022 5765  strategy(w3: "We
-00022740: 6233 222c 2074 786e 3a20 5478 5061 7261  b3", txn: TxPara
-00022750: 6d73 2920 2d3e 2057 6569 3a0a 2020 2020  ms) -> Wei:.    
-00022760: 2020 2020 2020 2020 7265 7475 726e 2077          return w
-00022770: 332e 746f 5f77 6569 2831 2c20 2267 7765  3.to_wei(1, "gwe
-00022780: 6922 290a 0a20 2020 2020 2020 2077 332e  i")..        w3.
-00022790: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
-000227a0: 655f 7374 7261 7465 6779 286c 6f77 6572  e_strategy(lower
-000227b0: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
-000227c0: 6567 7929 0a0a 2020 2020 2020 2020 7478  egy)..        tx
-000227d0: 6e5f 7061 7261 6d73 2e70 6f70 2822 6761  n_params.pop("ga
-000227e0: 7350 7269 6365 2229 0a20 2020 2020 2020  sPrice").       
-000227f0: 2072 6570 6c61 6365 5f74 786e 5f68 6173   replace_txn_has
-00022800: 6820 3d20 7733 2e65 7468 2e72 6570 6c61  h = w3.eth.repla
-00022810: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
-00022820: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
-00022830: 616d 7329 0a20 2020 2020 2020 2072 6570  ams).        rep
-00022840: 6c61 6365 5f74 786e 203d 2077 332e 6574  lace_txn = w3.et
-00022850: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00022860: 6e28 7265 706c 6163 655f 7478 6e5f 6861  n(replace_txn_ha
-00022870: 7368 290a 2020 2020 2020 2020 2320 5374  sh).        # St
-00022880: 7261 7465 6779 2070 726f 7669 6465 7320  rategy provides 
-00022890: 6c6f 7765 7220 6761 7320 7072 6963 6520  lower gas price 
-000228a0: 2d20 6d69 6e69 6d75 6d20 7072 6566 6572  - minimum prefer
-000228b0: 7265 640a 2020 2020 2020 2020 6173 7365  red.        asse
-000228c0: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
-000228d0: 6761 7350 7269 6365 225d 203d 3d20 6d61  gasPrice"] == ma
-000228e0: 7468 2e63 6569 6c28 6761 735f 7072 6963  th.ceil(gas_pric
-000228f0: 6520 2a20 312e 3132 3529 0a20 2020 2020  e * 1.125).     
-00022900: 2020 2077 332e 6574 682e 7365 745f 6761     w3.eth.set_ga
-00022910: 735f 7072 6963 655f 7374 7261 7465 6779  s_price_strategy
-00022920: 284e 6f6e 6529 2020 2320 7265 7365 7420  (None)  # reset 
-00022930: 7374 7261 7465 6779 0a0a 2020 2020 6465  strategy..    de
-00022940: 6620 7465 7374 5f65 7468 5f6d 6f64 6966  f test_eth_modif
-00022950: 795f 7472 616e 7361 6374 696f 6e5f 6c65  y_transaction_le
-00022960: 6761 6379 280a 2020 2020 2020 2020 7365  gacy(.        se
-00022970: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00022980: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00022990: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
-000229a0: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
-000229b0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000229c0: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
-000229d0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-000229e0: 2020 2020 2022 6672 6f6d 223a 206b 6579       "from": key
-000229f0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00022a00: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-00022a10: 2020 2274 6f22 3a20 6b65 7966 696c 655f    "to": keyfile_
-00022a20: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
-00022a30: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
-00022a40: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
-00022a50: 2020 2020 2020 2020 2020 2267 6173 223a            "gas":
-00022a60: 2032 3130 3030 2c0a 2020 2020 2020 2020   21000,.        
-00022a70: 2020 2020 2267 6173 5072 6963 6522 3a20      "gasPrice": 
-00022a80: 7733 2e74 6f5f 7765 6928 0a20 2020 2020  w3.to_wei(.     
-00022a90: 2020 2020 2020 2020 2020 2031 2c20 2267             1, "g
-00022aa0: 7765 6922 0a20 2020 2020 2020 2020 2020  wei".           
-00022ab0: 2029 2c20 2023 206d 7573 7420 6265 2067   ),  # must be g
-00022ac0: 7265 6174 6572 2074 6861 6e20 6261 7365  reater than base
-00022ad0: 5f66 6565 2070 6f73 7420 4c6f 6e64 6f6e  _fee post London
-00022ae0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00022af0: 2020 2074 786e 5f68 6173 6820 3d20 7733     txn_hash = w3
-00022b00: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
-00022b10: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
-00022b20: 290a 0a20 2020 2020 2020 206d 6f64 6966  )..        modif
-00022b30: 6965 645f 7478 6e5f 6861 7368 203d 2077  ied_txn_hash = w
-00022b40: 332e 6574 682e 6d6f 6469 6679 5f74 7261  3.eth.modify_tra
-00022b50: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
-00022b60: 2020 2020 2020 7478 6e5f 6861 7368 2c20        txn_hash, 
-00022b70: 6761 7350 7269 6365 3d28 6361 7374 2869  gasPrice=(cast(i
-00022b80: 6e74 2c20 7478 6e5f 7061 7261 6d73 5b22  nt, txn_params["
-00022b90: 6761 7350 7269 6365 225d 2920 2a20 3229  gasPrice"]) * 2)
-00022ba0: 2c20 7661 6c75 653d 320a 2020 2020 2020  , value=2.      
-00022bb0: 2020 290a 2020 2020 2020 2020 6d6f 6469    ).        modi
-00022bc0: 6669 6564 5f74 786e 203d 2077 332e 6574  fied_txn = w3.et
-00022bd0: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
-00022be0: 6e28 6d6f 6469 6669 6564 5f74 786e 5f68  n(modified_txn_h
-00022bf0: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
-00022c00: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
-00022c10: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
-00022c20: 2020 6d6f 6469 6669 6564 5f74 786e 5b22    modified_txn["
-00022c30: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
-00022c40: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
-00022c50: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
-00022c60: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00022c70: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-00022c80: 6d65 5f61 6464 7265 7373 280a 2020 2020  me_address(.    
-00022c90: 2020 2020 2020 2020 6d6f 6469 6669 6564          modified
-00022ca0: 5f74 786e 5b22 746f 225d 2c20 6361 7374  _txn["to"], cast
-00022cb0: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
-00022cc0: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
-00022cd0: 225d 290a 2020 2020 2020 2020 290a 2020  "]).        ).  
-00022ce0: 2020 2020 2020 6173 7365 7274 206d 6f64        assert mod
-00022cf0: 6966 6965 645f 7478 6e5b 2276 616c 7565  ified_txn["value
-00022d00: 225d 203d 3d20 320a 2020 2020 2020 2020  "] == 2.        
-00022d10: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
-00022d20: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
-00022d30: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
-00022d40: 7274 206d 6f64 6966 6965 645f 7478 6e5b  rt modified_txn[
-00022d50: 2267 6173 5072 6963 6522 5d20 3d3d 2063  "gasPrice"] == c
-00022d60: 6173 7428 696e 742c 2074 786e 5f70 6172  ast(int, txn_par
-00022d70: 616d 735b 2267 6173 5072 6963 6522 5d29  ams["gasPrice"])
-00022d80: 202a 2032 0a0a 2020 2020 6465 6620 7465   * 2..    def te
-00022d90: 7374 5f65 7468 5f6d 6f64 6966 795f 7472  st_eth_modify_tr
-00022da0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-00022db0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
-00022dc0: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
-00022dd0: 6f75 6e74 5f61 6464 7265 7373 3a20 4368  ount_address: Ch
-00022de0: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
-00022df0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00022e00: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
-00022e10: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
-00022e20: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00022e30: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
-00022e40: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-00022e50: 2020 2020 2020 2022 746f 223a 206b 6579         "to": key
-00022e60: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
-00022e70: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
-00022e80: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00022e90: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00022ea0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
-00022eb0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-00022ec0: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-00022ed0: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
-00022ee0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-00022ef0: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
-00022f00: 223a 2077 332e 746f 5f77 6569 2832 2c20  ": w3.to_wei(2, 
-00022f10: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-00022f20: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
-00022f30: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
-00022f40: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
-00022f50: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
-00022f60: 2020 206d 6f64 6966 6965 645f 7478 6e5f     modified_txn_
-00022f70: 6861 7368 203d 2077 332e 6574 682e 6d6f  hash = w3.eth.mo
-00022f80: 6469 6679 5f74 7261 6e73 6163 7469 6f6e  dify_transaction
-00022f90: 280a 2020 2020 2020 2020 2020 2020 7478  (.            tx
-00022fa0: 6e5f 6861 7368 2c0a 2020 2020 2020 2020  n_hash,.        
-00022fb0: 2020 2020 7661 6c75 653d 322c 0a20 2020      value=2,.   
-00022fc0: 2020 2020 2020 2020 206d 6178 5072 696f           maxPrio
-00022fd0: 7269 7479 4665 6550 6572 4761 733d 2863  rityFeePerGas=(c
-00022fe0: 6173 7428 5765 692c 2074 786e 5f70 6172  ast(Wei, txn_par
-00022ff0: 616d 735b 226d 6178 5072 696f 7269 7479  ams["maxPriority
-00023000: 4665 6550 6572 4761 7322 5d29 202a 2032  FeePerGas"]) * 2
-00023010: 292c 0a20 2020 2020 2020 2020 2020 206d  ),.            m
-00023020: 6178 4665 6550 6572 4761 733d 2863 6173  axFeePerGas=(cas
-00023030: 7428 5765 692c 2074 786e 5f70 6172 616d  t(Wei, txn_param
-00023040: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
-00023050: 5d29 202a 2032 292c 0a20 2020 2020 2020  ]) * 2),.       
-00023060: 2029 0a20 2020 2020 2020 206d 6f64 6966   ).        modif
-00023070: 6965 645f 7478 6e20 3d20 7733 2e65 7468  ied_txn = w3.eth
-00023080: 2e67 6574 5f74 7261 6e73 6163 7469 6f6e  .get_transaction
-00023090: 286d 6f64 6966 6965 645f 7478 6e5f 6861  (modified_txn_ha
-000230a0: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
-000230b0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
-000230c0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
-000230d0: 206d 6f64 6966 6965 645f 7478 6e5b 2266   modified_txn["f
-000230e0: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
-000230f0: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
-00023100: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
-00023110: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00023120: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
-00023130: 655f 6164 6472 6573 7328 0a20 2020 2020  e_address(.     
-00023140: 2020 2020 2020 206d 6f64 6966 6965 645f         modified_
-00023150: 7478 6e5b 2274 6f22 5d2c 2063 6173 7428  txn["to"], cast(
-00023160: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00023170: 2074 786e 5f70 6172 616d 735b 2274 6f22   txn_params["to"
-00023180: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-00023190: 2020 2020 2061 7373 6572 7420 6d6f 6469       assert modi
-000231a0: 6669 6564 5f74 786e 5b22 7661 6c75 6522  fied_txn["value"
-000231b0: 5d20 3d3d 2032 0a20 2020 2020 2020 2061  ] == 2.        a
-000231c0: 7373 6572 7420 6d6f 6469 6669 6564 5f74  ssert modified_t
-000231d0: 786e 5b22 6761 7322 5d20 3d3d 2032 3130  xn["gas"] == 210
-000231e0: 3030 0a20 2020 2020 2020 2061 7373 6572  00.        asser
-000231f0: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
-00023200: 6d6f 6469 6669 6564 5f74 786e 5b22 6d61  modified_txn["ma
-00023210: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
-00023220: 6173 225d 0a20 2020 2020 2020 2020 2020  as"].           
-00023230: 203d 3d20 6361 7374 2857 6569 2c20 7478   == cast(Wei, tx
-00023240: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
-00023250: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
-00023260: 2920 2a20 320a 2020 2020 2020 2020 290a  ) * 2.        ).
-00023270: 2020 2020 2020 2020 6173 7365 7274 206d          assert m
-00023280: 6f64 6966 6965 645f 7478 6e5b 226d 6178  odified_txn["max
-00023290: 4665 6550 6572 4761 7322 5d20 3d3d 2063  FeePerGas"] == c
-000232a0: 6173 7428 5765 692c 2074 786e 5f70 6172  ast(Wei, txn_par
-000232b0: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
-000232c0: 7322 5d29 202a 2032 0a0a 2020 2020 6465  s"]) * 2..    de
-000232d0: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
-000232e0: 7261 775f 7472 616e 7361 6374 696f 6e28  raw_transaction(
-000232f0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00023300: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
-00023310: 6c65 5f61 6363 6f75 6e74 5f70 6b65 793a  le_account_pkey:
-00023320: 2048 6578 5374 720a 2020 2020 2920 2d3e   HexStr.    ) ->
-00023330: 204e 6f6e 653a 0a20 2020 2020 2020 206b   None:.        k
-00023340: 6579 6669 6c65 5f61 6363 6f75 6e74 203d  eyfile_account =
-00023350: 2077 332e 6574 682e 6163 636f 756e 742e   w3.eth.account.
-00023360: 6672 6f6d 5f6b 6579 286b 6579 6669 6c65  from_key(keyfile
-00023370: 5f61 6363 6f75 6e74 5f70 6b65 7929 0a20  _account_pkey). 
-00023380: 2020 2020 2020 2074 786e 203d 207b 0a20         txn = {. 
-00023390: 2020 2020 2020 2020 2020 2022 6368 6169             "chai
-000233a0: 6e49 6422 3a20 3133 3132 3737 3332 3239  nId": 1312773229
-000233b0: 3430 3533 372c 2020 2320 7468 6520 6368  40537,  # the ch
-000233c0: 6169 6e49 6420 7365 7420 666f 7220 7468  ainId set for th
-000233d0: 6520 6669 7874 7572 650a 2020 2020 2020  e fixture.      
-000233e0: 2020 2020 2020 2266 726f 6d22 3a20 6b65        "from": ke
-000233f0: 7966 696c 655f 6163 636f 756e 742e 6164  yfile_account.ad
-00023400: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
-00023410: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
-00023420: 5f61 6363 6f75 6e74 2e61 6464 7265 7373  _account.address
-00023430: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
-00023440: 616c 7565 223a 2057 6569 2830 292c 0a20  alue": Wei(0),. 
-00023450: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
-00023460: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
-00023470: 2020 2020 2022 6e6f 6e63 6522 3a20 7733       "nonce": w3
-00023480: 2e65 7468 2e67 6574 5f74 7261 6e73 6163  .eth.get_transac
-00023490: 7469 6f6e 5f63 6f75 6e74 286b 6579 6669  tion_count(keyfi
-000234a0: 6c65 5f61 6363 6f75 6e74 2e61 6464 7265  le_account.addre
-000234b0: 7373 2c20 2270 656e 6469 6e67 2229 2c0a  ss, "pending"),.
-000234c0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
-000234d0: 5072 6963 6522 3a20 3130 2a2a 392c 0a20  Price": 10**9,. 
-000234e0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-000234f0: 2073 6967 6e65 6420 3d20 6b65 7966 696c   signed = keyfil
-00023500: 655f 6163 636f 756e 742e 7369 676e 5f74  e_account.sign_t
-00023510: 7261 6e73 6163 7469 6f6e 2874 786e 290a  ransaction(txn).
-00023520: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-00023530: 203d 2077 332e 6574 682e 7365 6e64 5f72   = w3.eth.send_r
-00023540: 6177 5f74 7261 6e73 6163 7469 6f6e 2873  aw_transaction(s
-00023550: 6967 6e65 642e 7261 7754 7261 6e73 6163  igned.rawTransac
-00023560: 7469 6f6e 290a 2020 2020 2020 2020 6173  tion).        as
-00023570: 7365 7274 2074 786e 5f68 6173 6820 3d3d  sert txn_hash ==
-00023580: 2048 6578 4279 7465 7328 7369 676e 6564   HexBytes(signed
-00023590: 2e68 6173 6829 0a0a 2020 2020 6465 6620  .hash)..    def 
-000235a0: 7465 7374 5f65 7468 5f63 616c 6c28 7365  test_eth_call(se
-000235b0: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-000235c0: 6d61 7468 5f63 6f6e 7472 6163 743a 2022  math_contract: "
-000235d0: 436f 6e74 7261 6374 2229 202d 3e20 4e6f  Contract") -> No
-000235e0: 6e65 3a0a 2020 2020 2020 2020 636f 696e  ne:.        coin
-000235f0: 6261 7365 203d 2077 332e 6574 682e 636f  base = w3.eth.co
-00023600: 696e 6261 7365 0a20 2020 2020 2020 2074  inbase.        t
-00023610: 786e 5f70 6172 616d 7320 3d20 6d61 7468  xn_params = math
-00023620: 5f63 6f6e 7472 6163 742e 5f70 7265 7061  _contract._prepa
-00023630: 7265 5f74 7261 6e73 6163 7469 6f6e 280a  re_transaction(.
-00023640: 2020 2020 2020 2020 2020 2020 666e 5f6e              fn_n
-00023650: 616d 653d 2261 6464 222c 0a20 2020 2020  ame="add",.     
-00023660: 2020 2020 2020 2066 6e5f 6172 6773 3d28         fn_args=(
-00023670: 372c 2031 3129 2c0a 2020 2020 2020 2020  7, 11),.        
-00023680: 2020 2020 7472 616e 7361 6374 696f 6e3d      transaction=
-00023690: 7b22 6672 6f6d 223a 2063 6f69 6e62 6173  {"from": coinbas
-000236a0: 652c 2022 746f 223a 206d 6174 685f 636f  e, "to": math_co
-000236b0: 6e74 7261 6374 2e61 6464 7265 7373 7d2c  ntract.address},
-000236c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000236d0: 2020 2063 616c 6c5f 7265 7375 6c74 203d     call_result =
-000236e0: 2077 332e 6574 682e 6361 6c6c 2874 786e   w3.eth.call(txn
-000236f0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
-00023700: 2061 7373 6572 7420 6973 5f73 7472 696e   assert is_strin
-00023710: 6728 6361 6c6c 5f72 6573 756c 7429 0a20  g(call_result). 
-00023720: 2020 2020 2020 2028 7265 7375 6c74 2c29         (result,)
-00023730: 203d 2077 332e 636f 6465 632e 6465 636f   = w3.codec.deco
-00023740: 6465 285b 2275 696e 7432 3536 225d 2c20  de(["uint256"], 
-00023750: 6361 6c6c 5f72 6573 756c 7429 0a20 2020  call_result).   
-00023760: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-00023770: 6c74 203d 3d20 3138 0a0a 2020 2020 6465  lt == 18..    de
-00023780: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
-00023790: 7769 7468 5f6f 7665 7272 6964 655f 636f  with_override_co
-000237a0: 6465 280a 2020 2020 2020 2020 7365 6c66  de(.        self
-000237b0: 2c20 7733 3a20 2257 6562 3322 2c20 7265  , w3: "Web3", re
-000237c0: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-000237d0: 436f 6e74 7261 6374 220a 2020 2020 2920  Contract".    ) 
-000237e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000237f0: 2063 6f69 6e62 6173 6520 3d20 7733 2e65   coinbase = w3.e
-00023800: 7468 2e63 6f69 6e62 6173 650a 2020 2020  th.coinbase.    
-00023810: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
-00023820: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00023830: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
-00023840: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00023850: 2020 2066 6e5f 6e61 6d65 3d22 6e6f 726d     fn_name="norm
-00023860: 616c 4675 6e63 7469 6f6e 222c 0a20 2020  alFunction",.   
-00023870: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
-00023880: 7469 6f6e 3d7b 2266 726f 6d22 3a20 636f  tion={"from": co
-00023890: 696e 6261 7365 2c20 2274 6f22 3a20 7265  inbase, "to": re
-000238a0: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
-000238b0: 6472 6573 737d 2c0a 2020 2020 2020 2020  dress},.        
-000238c0: 290a 2020 2020 2020 2020 6361 6c6c 5f72  ).        call_r
-000238d0: 6573 756c 7420 3d20 7733 2e65 7468 2e63  esult = w3.eth.c
-000238e0: 616c 6c28 7478 6e5f 7061 7261 6d73 290a  all(txn_params).
-000238f0: 2020 2020 2020 2020 2872 6573 756c 742c          (result,
-00023900: 2920 3d20 7733 2e63 6f64 6563 2e64 6563  ) = w3.codec.dec
-00023910: 6f64 6528 5b22 626f 6f6c 225d 2c20 6361  ode(["bool"], ca
-00023920: 6c6c 5f72 6573 756c 7429 0a20 2020 2020  ll_result).     
-00023930: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
-00023940: 2069 7320 5472 7565 0a0a 2020 2020 2020   is True..      
-00023950: 2020 2320 6f76 6572 7269 6465 2072 756e    # override run
-00023960: 7469 6d65 2062 7974 6563 6f64 653a 2060  time bytecode: `
-00023970: 6e6f 726d 616c 4675 6e63 7469 6f6e 6020  normalFunction` 
-00023980: 7265 7475 726e 7320 6066 616c 7365 600a  returns `false`.
-00023990: 2020 2020 2020 2020 6f76 6572 7269 6465          override
-000239a0: 5f63 6f64 6520 3d20 4865 7853 7472 280a  _code = HexStr(.
-000239b0: 2020 2020 2020 2020 2020 2020 2230 7836              "0x6
-000239c0: 3038 3036 3034 3035 3233 3438 3031 3536  0806040523480156
-000239d0: 3030 6635 3736 3030 3038 3066 6435 6235  00f57600080fd5b5
-000239e0: 3036 3030 3433 3631 3036 3033 6335 3736  060043610603c576
-000239f0: 3030 3033 3536 3065 3031 6338 3036 3331  0003560e01c80631
-00023a00: 3835 6333 3861 3431 3436 3034 3135 3738  85c38a4146041578
-00023a10: 3036 3363 3036 6139 3763 6231 3436 3034  063c06a97cb14604
-00023a20: 3935 3738 3036 3364 3637 6534 6238 3431  9578063d67e4b841
-00023a30: 3436 3035 3135 3735 6236 3030 3038 3066  46051575b600080f
-00023a40: 6435 6236 3034 3736 3037 3135 3635 6230  d5b60476071565b0
-00023a50: 3035 6236 3034 6636 3064 6635 3635 6230  05b604f60df565b0
-00023a60: 3035 6236 3035 3736 3065 3435 3635 6236  05b605760e4565b6
-00023a70: 3034 3035 3138 3038 3231 3531 3531 3531  0405180821515151
-00023a80: 3538 3135 3236 3032 3030 3139 3135 3035  5815260200191505
-00023a90: 3036 3034 3035 3138 3039 3130 3339 3066  060405180910390f
-00023aa0: 3335 6236 3034 3035 3137 6630 3863 3337  35b6040517f08c37
-00023ab0: 3961 3030 3030 3030 3030 3030 3030 3030  9a00000000000000
-00023ac0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00019400: 3030 3030 3030 3030 3030 3030 3038 220a  00000000000008".
+00019410: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00019420: 2020 6173 7365 7274 2062 7974 6573 2873    assert bytes(s
+00019430: 6c6f 745f 345b 3a34 5d29 203d 3d20 6222  lot_4[:4]) == b"
+00019440: 666f 7572 220a 0a20 2020 2064 6566 2074  four"..    def t
+00019450: 6573 745f 6574 685f 6765 745f 7374 6f72  est_eth_get_stor
+00019460: 6167 655f 6174 5f65 6e73 5f6e 616d 6528  age_at_ens_name(
+00019470: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019480: 333a 2022 5765 6233 222c 2073 746f 7261  3: "Web3", stora
+00019490: 6765 5f63 6f6e 7472 6163 743a 2022 436f  ge_contract: "Co
+000194a0: 6e74 7261 6374 220a 2020 2020 2920 2d3e  ntract".    ) ->
+000194b0: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+000194c0: 6974 6820 656e 735f 6164 6472 6573 7365  ith ens_addresse
+000194d0: 7328 7733 2c20 7b22 7374 6f72 6167 652e  s(w3, {"storage.
+000194e0: 6574 6822 3a20 7374 6f72 6167 655f 636f  eth": storage_co
+000194f0: 6e74 7261 6374 2e61 6464 7265 7373 7d29  ntract.address})
+00019500: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00019510: 6f72 6167 6520 3d20 7733 2e65 7468 2e67  orage = w3.eth.g
+00019520: 6574 5f73 746f 7261 6765 5f61 7428 454e  et_storage_at(EN
+00019530: 5328 2273 746f 7261 6765 2e65 7468 2229  S("storage.eth")
+00019540: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+00019550: 2061 7373 6572 7420 7374 6f72 6167 6520   assert storage 
+00019560: 3d3d 2048 6578 4279 7465 7328 6622 3078  == HexBytes(f"0x
+00019570: 7b27 3030 2720 2a20 3331 7d30 3122 290a  {'00' * 31}01").
+00019580: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00019590: 685f 6765 745f 7374 6f72 6167 655f 6174  h_get_storage_at
+000195a0: 5f69 6e76 616c 6964 5f61 6464 7265 7373  _invalid_address
+000195b0: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+000195c0: 2229 202d 3e20 4e6f 6e65 3a0a 2020 2020  ") -> None:.    
+000195d0: 2020 2020 636f 696e 6261 7365 203d 2077      coinbase = w
+000195e0: 332e 6574 682e 636f 696e 6261 7365 0a20  3.eth.coinbase. 
+000195f0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00019600: 7374 2e72 6169 7365 7328 496e 7661 6c69  st.raises(Invali
+00019610: 6441 6464 7265 7373 293a 0a20 2020 2020  dAddress):.     
+00019620: 2020 2020 2020 2077 332e 6574 682e 6765         w3.eth.ge
+00019630: 745f 7374 6f72 6167 655f 6174 280a 2020  t_storage_at(.  
+00019640: 2020 2020 2020 2020 2020 2020 2020 4368                Ch
+00019650: 6563 6b73 756d 4164 6472 6573 7328 4865  ecksumAddress(He
+00019660: 7841 6464 7265 7373 2848 6578 5374 7228  xAddress(HexStr(
+00019670: 636f 696e 6261 7365 2e6c 6f77 6572 2829  coinbase.lower()
+00019680: 2929 292c 2030 0a20 2020 2020 2020 2020  ))), 0.         
+00019690: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+000196a0: 7374 5f65 7468 5f67 6574 5f74 7261 6e73  st_eth_get_trans
+000196b0: 6163 7469 6f6e 5f63 6f75 6e74 280a 2020  action_count(.  
+000196c0: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+000196d0: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+000196e0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+000196f0: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+00019700: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00019710: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00019720: 2020 7472 616e 7361 6374 696f 6e5f 636f    transaction_co
+00019730: 756e 7420 3d20 7733 2e65 7468 2e67 6574  unt = w3.eth.get
+00019740: 5f74 7261 6e73 6163 7469 6f6e 5f63 6f75  _transaction_cou
+00019750: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00019760: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00019770: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+00019780: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
+00019790: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+000197a0: 7465 6765 7228 7472 616e 7361 6374 696f  teger(transactio
+000197b0: 6e5f 636f 756e 7429 0a20 2020 2020 2020  n_count).       
+000197c0: 2061 7373 6572 7420 7472 616e 7361 6374   assert transact
+000197d0: 696f 6e5f 636f 756e 7420 3e3d 2030 0a0a  ion_count >= 0..
+000197e0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000197f0: 5f67 6574 5f74 7261 6e73 6163 7469 6f6e  _get_transaction
+00019800: 5f63 6f75 6e74 5f65 6e73 5f6e 616d 6528  _count_ens_name(
+00019810: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00019820: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
+00019830: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00019840: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
+00019850: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+00019860: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00019870: 2020 2020 2077 6974 6820 656e 735f 6164       with ens_ad
+00019880: 6472 6573 7365 7328 0a20 2020 2020 2020  dresses(.       
+00019890: 2020 2020 2077 332c 207b 2275 6e6c 6f63       w3, {"unloc
+000198a0: 6b65 642d 6163 6374 2d64 7561 6c2d 7479  ked-acct-dual-ty
+000198b0: 7065 2e65 7468 223a 206b 6579 6669 6c65  pe.eth": keyfile
+000198c0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+000198d0: 5f64 7561 6c5f 7479 7065 7d0a 2020 2020  _dual_type}.    
+000198e0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+000198f0: 2020 2074 7261 6e73 6163 7469 6f6e 5f63     transaction_c
+00019900: 6f75 6e74 203d 2077 332e 6574 682e 6765  ount = w3.eth.ge
+00019910: 745f 7472 616e 7361 6374 696f 6e5f 636f  t_transaction_co
+00019920: 756e 7428 0a20 2020 2020 2020 2020 2020  unt(.           
+00019930: 2020 2020 2045 4e53 2822 756e 6c6f 636b       ENS("unlock
+00019940: 6564 2d61 6363 742d 6475 616c 2d74 7970  ed-acct-dual-typ
+00019950: 652e 6574 6822 290a 2020 2020 2020 2020  e.eth").        
+00019960: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00019970: 2020 6173 7365 7274 2069 735f 696e 7465    assert is_inte
+00019980: 6765 7228 7472 616e 7361 6374 696f 6e5f  ger(transaction_
+00019990: 636f 756e 7429 0a20 2020 2020 2020 2020  count).         
+000199a0: 2020 2061 7373 6572 7420 7472 616e 7361     assert transa
+000199b0: 6374 696f 6e5f 636f 756e 7420 3e3d 2030  ction_count >= 0
+000199c0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+000199d0: 7468 5f67 6574 5f74 7261 6e73 6163 7469  th_get_transacti
+000199e0: 6f6e 5f63 6f75 6e74 5f69 6e76 616c 6964  on_count_invalid
+000199f0: 5f61 6464 7265 7373 2873 656c 662c 2077  _address(self, w
+00019a00: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
+00019a10: 6e65 3a0a 2020 2020 2020 2020 636f 696e  ne:.        coin
+00019a20: 6261 7365 203d 2077 332e 6574 682e 636f  base = w3.eth.co
+00019a30: 696e 6261 7365 0a20 2020 2020 2020 2077  inbase.        w
+00019a40: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00019a50: 7328 496e 7661 6c69 6441 6464 7265 7373  s(InvalidAddress
+00019a60: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+00019a70: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+00019a80: 6374 696f 6e5f 636f 756e 7428 0a20 2020  ction_count(.   
+00019a90: 2020 2020 2020 2020 2020 2020 2043 6865               Che
+00019aa0: 636b 7375 6d41 6464 7265 7373 2848 6578  cksumAddress(Hex
+00019ab0: 4164 6472 6573 7328 4865 7853 7472 2863  Address(HexStr(c
+00019ac0: 6f69 6e62 6173 652e 6c6f 7765 7228 2929  oinbase.lower())
+00019ad0: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
+00019ae0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00019af0: 7468 5f67 6574 426c 6f63 6b54 7261 6e73  th_getBlockTrans
+00019b00: 6163 7469 6f6e 436f 756e 7442 7948 6173  actionCountByHas
+00019b10: 685f 656d 7074 795f 626c 6f63 6b28 0a20  h_empty_block(. 
+00019b20: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+00019b30: 2022 5765 6233 222c 2065 6d70 7479 5f62   "Web3", empty_b
+00019b40: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
+00019b50: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00019b60: 2020 2020 2020 2074 7261 6e73 6163 7469         transacti
+00019b70: 6f6e 5f63 6f75 6e74 203d 2077 332e 6574  on_count = w3.et
+00019b80: 682e 6765 745f 626c 6f63 6b5f 7472 616e  h.get_block_tran
+00019b90: 7361 6374 696f 6e5f 636f 756e 7428 656d  saction_count(em
+00019ba0: 7074 795f 626c 6f63 6b5b 2268 6173 6822  pty_block["hash"
+00019bb0: 5d29 0a0a 2020 2020 2020 2020 6173 7365  ])..        asse
+00019bc0: 7274 2069 735f 696e 7465 6765 7228 7472  rt is_integer(tr
+00019bd0: 616e 7361 6374 696f 6e5f 636f 756e 7429  ansaction_count)
+00019be0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00019bf0: 7472 616e 7361 6374 696f 6e5f 636f 756e  transaction_coun
+00019c00: 7420 3d3d 2030 0a0a 2020 2020 6465 6620  t == 0..    def 
+00019c10: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
+00019c20: 6b54 7261 6e73 6163 7469 6f6e 436f 756e  kTransactionCoun
+00019c30: 7442 794e 756d 6265 725f 656d 7074 795f  tByNumber_empty_
+00019c40: 626c 6f63 6b28 0a20 2020 2020 2020 2073  block(.        s
+00019c50: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+00019c60: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+00019c70: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00019c80: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00019c90: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
+00019ca0: 203d 2077 332e 6574 682e 6765 745f 626c   = w3.eth.get_bl
+00019cb0: 6f63 6b5f 7472 616e 7361 6374 696f 6e5f  ock_transaction_
+00019cc0: 636f 756e 7428 656d 7074 795f 626c 6f63  count(empty_bloc
+00019cd0: 6b5b 226e 756d 6265 7222 5d29 0a0a 2020  k["number"])..  
+00019ce0: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00019cf0: 696e 7465 6765 7228 7472 616e 7361 6374  integer(transact
+00019d00: 696f 6e5f 636f 756e 7429 0a20 2020 2020  ion_count).     
+00019d10: 2020 2061 7373 6572 7420 7472 616e 7361     assert transa
+00019d20: 6374 696f 6e5f 636f 756e 7420 3d3d 2030  ction_count == 0
+00019d30: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+00019d40: 7468 5f67 6574 426c 6f63 6b54 7261 6e73  th_getBlockTrans
+00019d50: 6163 7469 6f6e 436f 756e 7442 7948 6173  actionCountByHas
+00019d60: 685f 626c 6f63 6b5f 7769 7468 5f74 786e  h_block_with_txn
+00019d70: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00019d80: 7733 3a20 2257 6562 3322 2c20 626c 6f63  w3: "Web3", bloc
+00019d90: 6b5f 7769 7468 5f74 786e 3a20 426c 6f63  k_with_txn: Bloc
+00019da0: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
+00019db0: 6f6e 653a 0a20 2020 2020 2020 2074 7261  one:.        tra
+00019dc0: 6e73 6163 7469 6f6e 5f63 6f75 6e74 203d  nsaction_count =
+00019dd0: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
+00019de0: 6b5f 7472 616e 7361 6374 696f 6e5f 636f  k_transaction_co
+00019df0: 756e 7428 626c 6f63 6b5f 7769 7468 5f74  unt(block_with_t
+00019e00: 786e 5b22 6861 7368 225d 290a 0a20 2020  xn["hash"])..   
+00019e10: 2020 2020 2061 7373 6572 7420 6973 5f69       assert is_i
+00019e20: 6e74 6567 6572 2874 7261 6e73 6163 7469  nteger(transacti
+00019e30: 6f6e 5f63 6f75 6e74 290a 2020 2020 2020  on_count).      
+00019e40: 2020 6173 7365 7274 2074 7261 6e73 6163    assert transac
+00019e50: 7469 6f6e 5f63 6f75 6e74 203e 3d20 310a  tion_count >= 1.
+00019e60: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00019e70: 685f 6765 7442 6c6f 636b 5472 616e 7361  h_getBlockTransa
+00019e80: 6374 696f 6e43 6f75 6e74 4279 4e75 6d62  ctionCountByNumb
+00019e90: 6572 5f62 6c6f 636b 5f77 6974 685f 7478  er_block_with_tx
+00019ea0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+00019eb0: 2077 333a 2022 5765 6233 222c 2062 6c6f   w3: "Web3", blo
+00019ec0: 636b 5f77 6974 685f 7478 6e3a 2042 6c6f  ck_with_txn: Blo
+00019ed0: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
+00019ee0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7472  None:.        tr
+00019ef0: 616e 7361 6374 696f 6e5f 636f 756e 7420  ansaction_count 
+00019f00: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
+00019f10: 636b 5f74 7261 6e73 6163 7469 6f6e 5f63  ck_transaction_c
+00019f20: 6f75 6e74 2862 6c6f 636b 5f77 6974 685f  ount(block_with_
+00019f30: 7478 6e5b 226e 756d 6265 7222 5d29 0a0a  txn["number"])..
+00019f40: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00019f50: 735f 696e 7465 6765 7228 7472 616e 7361  s_integer(transa
+00019f60: 6374 696f 6e5f 636f 756e 7429 0a20 2020  ction_count).   
+00019f70: 2020 2020 2061 7373 6572 7420 7472 616e       assert tran
+00019f80: 7361 6374 696f 6e5f 636f 756e 7420 3e3d  saction_count >=
+00019f90: 2031 0a0a 2020 2020 6465 6620 7465 7374   1..    def test
+00019fa0: 5f65 7468 5f67 6574 556e 636c 6543 6f75  _eth_getUncleCou
+00019fb0: 6e74 4279 426c 6f63 6b48 6173 6828 0a20  ntByBlockHash(. 
+00019fc0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+00019fd0: 2022 5765 6233 222c 2065 6d70 7479 5f62   "Web3", empty_b
+00019fe0: 6c6f 636b 3a20 426c 6f63 6b44 6174 610a  lock: BlockData.
+00019ff0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001a000: 2020 2020 2020 2075 6e63 6c65 5f63 6f75         uncle_cou
+0001a010: 6e74 203d 2077 332e 6574 682e 6765 745f  nt = w3.eth.get_
+0001a020: 756e 636c 655f 636f 756e 7428 656d 7074  uncle_count(empt
+0001a030: 795f 626c 6f63 6b5b 2268 6173 6822 5d29  y_block["hash"])
+0001a040: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+0001a050: 2069 735f 696e 7465 6765 7228 756e 636c   is_integer(uncl
+0001a060: 655f 636f 756e 7429 0a20 2020 2020 2020  e_count).       
+0001a070: 2061 7373 6572 7420 756e 636c 655f 636f   assert uncle_co
+0001a080: 756e 7420 3d3d 2030 0a0a 2020 2020 6465  unt == 0..    de
+0001a090: 6620 7465 7374 5f65 7468 5f67 6574 556e  f test_eth_getUn
+0001a0a0: 636c 6543 6f75 6e74 4279 426c 6f63 6b4e  cleCountByBlockN
+0001a0b0: 756d 6265 7228 0a20 2020 2020 2020 2073  umber(.        s
+0001a0c0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+0001a0d0: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+0001a0e0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+0001a0f0: 204e 6f6e 653a 0a20 2020 2020 2020 2075   None:.        u
+0001a100: 6e63 6c65 5f63 6f75 6e74 203d 2077 332e  ncle_count = w3.
+0001a110: 6574 682e 6765 745f 756e 636c 655f 636f  eth.get_uncle_co
+0001a120: 756e 7428 656d 7074 795f 626c 6f63 6b5b  unt(empty_block[
+0001a130: 226e 756d 6265 7222 5d29 0a0a 2020 2020  "number"])..    
+0001a140: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+0001a150: 7465 6765 7228 756e 636c 655f 636f 756e  teger(uncle_coun
+0001a160: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
+0001a170: 7420 756e 636c 655f 636f 756e 7420 3d3d  t uncle_count ==
+0001a180: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
+0001a190: 5f65 7468 5f67 6574 5f63 6f64 6528 0a20  _eth_get_code(. 
+0001a1a0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+0001a1b0: 2022 5765 6233 222c 206d 6174 685f 636f   "Web3", math_co
+0001a1c0: 6e74 7261 6374 5f61 6464 7265 7373 3a20  ntract_address: 
+0001a1d0: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+0001a1e0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001a1f0: 2020 2020 2020 2063 6f64 6520 3d20 7733         code = w3
+0001a200: 2e65 7468 2e67 6574 5f63 6f64 6528 6d61  .eth.get_code(ma
+0001a210: 7468 5f63 6f6e 7472 6163 745f 6164 6472  th_contract_addr
+0001a220: 6573 7329 0a20 2020 2020 2020 2061 7373  ess).        ass
+0001a230: 6572 7420 6973 696e 7374 616e 6365 2863  ert isinstance(c
+0001a240: 6f64 652c 2048 6578 4279 7465 7329 0a20  ode, HexBytes). 
+0001a250: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001a260: 6e28 636f 6465 2920 3e20 300a 0a20 2020  n(code) > 0..   
+0001a270: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+0001a280: 745f 636f 6465 5f65 6e73 5f61 6464 7265  t_code_ens_addre
+0001a290: 7373 280a 2020 2020 2020 2020 7365 6c66  ss(.        self
+0001a2a0: 2c20 7733 3a20 2257 6562 3322 2c20 6d61  , w3: "Web3", ma
+0001a2b0: 7468 5f63 6f6e 7472 6163 745f 6164 6472  th_contract_addr
+0001a2c0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+0001a2d0: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+0001a2e0: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+0001a2f0: 2065 6e73 5f61 6464 7265 7373 6573 2877   ens_addresses(w
+0001a300: 332c 207b 226d 6174 6863 6f6e 7472 6163  3, {"mathcontrac
+0001a310: 742e 6574 6822 3a20 6d61 7468 5f63 6f6e  t.eth": math_con
+0001a320: 7472 6163 745f 6164 6472 6573 737d 293a  tract_address}):
+0001a330: 0a20 2020 2020 2020 2020 2020 2063 6f64  .            cod
+0001a340: 6520 3d20 7733 2e65 7468 2e67 6574 5f63  e = w3.eth.get_c
+0001a350: 6f64 6528 454e 5328 226d 6174 6863 6f6e  ode(ENS("mathcon
+0001a360: 7472 6163 742e 6574 6822 2929 0a20 2020  tract.eth")).   
+0001a370: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001a380: 6973 696e 7374 616e 6365 2863 6f64 652c  isinstance(code,
+0001a390: 2048 6578 4279 7465 7329 0a20 2020 2020   HexBytes).     
+0001a3a0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001a3b0: 6e28 636f 6465 2920 3e20 300a 0a20 2020  n(code) > 0..   
+0001a3c0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+0001a3d0: 745f 636f 6465 5f69 6e76 616c 6964 5f61  t_code_invalid_a
+0001a3e0: 6464 7265 7373 280a 2020 2020 2020 2020  ddress(.        
+0001a3f0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
+0001a400: 2c20 6d61 7468 5f63 6f6e 7472 6163 743a  , math_contract:
+0001a410: 2022 436f 6e74 7261 6374 220a 2020 2020   "Contract".    
+0001a420: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001a430: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0001a440: 6169 7365 7328 496e 7661 6c69 6441 6464  aises(InvalidAdd
+0001a450: 7265 7373 293a 0a20 2020 2020 2020 2020  ress):.         
+0001a460: 2020 2077 332e 6574 682e 6765 745f 636f     w3.eth.get_co
+0001a470: 6465 280a 2020 2020 2020 2020 2020 2020  de(.            
+0001a480: 2020 2020 4368 6563 6b73 756d 4164 6472      ChecksumAddr
+0001a490: 6573 7328 4865 7841 6464 7265 7373 2848  ess(HexAddress(H
+0001a4a0: 6578 5374 7228 6d61 7468 5f63 6f6e 7472  exStr(math_contr
+0001a4b0: 6163 742e 6164 6472 6573 732e 6c6f 7765  act.address.lowe
+0001a4c0: 7228 2929 2929 0a20 2020 2020 2020 2020  r()))).         
+0001a4d0: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+0001a4e0: 7374 5f65 7468 5f67 6574 5f63 6f64 655f  st_eth_get_code_
+0001a4f0: 7769 7468 5f62 6c6f 636b 5f69 6465 6e74  with_block_ident
+0001a500: 6966 6965 7228 0a20 2020 2020 2020 2073  ifier(.        s
+0001a510: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+0001a520: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
+0001a530: 743a 2022 436f 6e74 7261 6374 220a 2020  t: "Contract".  
+0001a540: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001a550: 2020 2020 2063 6f64 6520 3d20 7733 2e65       code = w3.e
+0001a560: 7468 2e67 6574 5f63 6f64 6528 0a20 2020  th.get_code(.   
+0001a570: 2020 2020 2020 2020 2065 6d69 7474 6572           emitter
+0001a580: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+0001a590: 732c 2062 6c6f 636b 5f69 6465 6e74 6966  s, block_identif
+0001a5a0: 6965 723d 7733 2e65 7468 2e62 6c6f 636b  ier=w3.eth.block
+0001a5b0: 5f6e 756d 6265 720a 2020 2020 2020 2020  _number.        
+0001a5c0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001a5d0: 2069 7369 6e73 7461 6e63 6528 636f 6465   isinstance(code
+0001a5e0: 2c20 4865 7842 7974 6573 290a 2020 2020  , HexBytes).    
+0001a5f0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0001a600: 6f64 6529 203e 2030 0a0a 2020 2020 6465  ode) > 0..    de
+0001a610: 6620 7465 7374 5f65 7468 5f63 7265 6174  f test_eth_creat
+0001a620: 655f 6163 6365 7373 5f6c 6973 7428 0a20  e_access_list(. 
+0001a630: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001a640: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
+0001a650: 0a20 2020 2020 2020 206b 6579 6669 6c65  .        keyfile
+0001a660: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0001a670: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+0001a680: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
+0001a690: 2020 2020 206d 6174 685f 636f 6e74 7261       math_contra
+0001a6a0: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
+0001a6b0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001a6c0: 2020 2020 2020 2023 2062 7569 6c64 2074         # build t
+0001a6d0: 786e 0a20 2020 2020 2020 2074 786e 203d  xn.        txn =
+0001a6e0: 206d 6174 685f 636f 6e74 7261 6374 2e66   math_contract.f
+0001a6f0: 756e 6374 696f 6e73 2e69 6e63 7265 6d65  unctions.increme
+0001a700: 6e74 436f 756e 7465 7228 3129 2e62 7569  ntCounter(1).bui
+0001a710: 6c64 5f74 7261 6e73 6163 7469 6f6e 280a  ld_transaction(.
+0001a720: 2020 2020 2020 2020 2020 2020 7b22 6672              {"fr
+0001a730: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
+0001a740: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+0001a750: 6c5f 7479 7065 7d0a 2020 2020 2020 2020  l_type}.        
+0001a760: 290a 0a20 2020 2020 2020 2023 2063 7265  )..        # cre
+0001a770: 6174 6520 6163 6365 7373 206c 6973 740a  ate access list.
+0001a780: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+0001a790: 203d 2077 332e 6574 682e 6372 6561 7465   = w3.eth.create
+0001a7a0: 5f61 6363 6573 735f 6c69 7374 2874 786e  _access_list(txn
+0001a7b0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0001a7c0: 7420 6973 5f64 6963 7428 7265 7370 6f6e  t is_dict(respon
+0001a7d0: 7365 290a 2020 2020 2020 2020 6163 6365  se).        acce
+0001a7e0: 7373 5f6c 6973 7420 3d20 7265 7370 6f6e  ss_list = respon
+0001a7f0: 7365 5b22 6163 6365 7373 4c69 7374 225d  se["accessList"]
+0001a800: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001a810: 6c65 6e28 6163 6365 7373 5f6c 6973 7429  len(access_list)
+0001a820: 203e 2030 0a20 2020 2020 2020 2061 7373   > 0.        ass
+0001a830: 6572 7420 6163 6365 7373 5f6c 6973 745b  ert access_list[
+0001a840: 305d 5b22 6164 6472 6573 7322 5d20 6973  0]["address"] is
+0001a850: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
+0001a860: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
+0001a870: 6b73 756d 5f61 6464 7265 7373 2861 6363  ksum_address(acc
+0001a880: 6573 735f 6c69 7374 5b30 5d5b 2261 6464  ess_list[0]["add
+0001a890: 7265 7373 225d 290a 2020 2020 2020 2020  ress"]).        
+0001a8a0: 6173 7365 7274 206c 656e 2861 6363 6573  assert len(acces
+0001a8b0: 735f 6c69 7374 5b30 5d5b 2273 746f 7261  s_list[0]["stora
+0001a8c0: 6765 4b65 7973 225d 5b30 5d29 203d 3d20  geKeys"][0]) == 
+0001a8d0: 3332 0a20 2020 2020 2020 2061 7373 6572  32.        asser
+0001a8e0: 7420 696e 7428 7265 7370 6f6e 7365 5b22  t int(response["
+0001a8f0: 6761 7355 7365 6422 5d29 203e 3d20 300a  gasUsed"]) >= 0.
+0001a900: 0a20 2020 2020 2020 2023 2061 7373 6572  .        # asser
+0001a910: 7420 7468 6520 7265 7375 6c74 2063 616e  t the result can
+0001a920: 2062 6520 7573 6564 2064 6972 6563 746c   be used directl
+0001a930: 7920 696e 2061 2074 7261 6e73 6163 7469  y in a transacti
+0001a940: 6f6e 2064 6963 740a 2020 2020 2020 2020  on dict.        
+0001a950: 7478 6e5b 2261 6363 6573 734c 6973 7422  txn["accessList"
+0001a960: 5d20 3d20 7265 7370 6f6e 7365 5b22 6163  ] = response["ac
+0001a970: 6365 7373 4c69 7374 225d 0a20 2020 2020  cessList"].     
+0001a980: 2020 2074 786e 5b22 6761 7322 5d20 3d20     txn["gas"] = 
+0001a990: 7265 7370 6f6e 7365 5b22 6761 7355 7365  response["gasUse
+0001a9a0: 6422 5d0a 0a20 2020 2020 2020 2023 2073  d"]..        # s
+0001a9b0: 656e 6420 7478 6e20 7769 7468 2061 6363  end txn with acc
+0001a9c0: 6573 7320 6c69 7374 0a20 2020 2020 2020  ess list.       
+0001a9d0: 2077 332e 6574 682e 7365 6e64 5f74 7261   w3.eth.send_tra
+0001a9e0: 6e73 6163 7469 6f6e 2874 786e 290a 0a20  nsaction(txn).. 
+0001a9f0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001aa00: 7369 676e 280a 2020 2020 2020 2020 7365  sign(.        se
+0001aa10: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0001aa20: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001aa30: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001aa40: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0001aa50: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+0001aa60: 3a0a 2020 2020 2020 2020 7369 676e 6174  :.        signat
+0001aa70: 7572 6520 3d20 7733 2e65 7468 2e73 6967  ure = w3.eth.sig
+0001aa80: 6e28 0a20 2020 2020 2020 2020 2020 206b  n(.            k
+0001aa90: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001aaa0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0001aab0: 2c20 7465 7874 3d22 4d65 7373 6167 6520  , text="Message 
+0001aac0: 74c3 b620 7369 676e 2e20 4c6f 6e67 6572  t.. sign. Longer
+0001aad0: 2074 6861 6e20 6861 7368 2122 0a20 2020   than hash!".   
+0001aae0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+0001aaf0: 7373 6572 7420 6973 5f62 7974 6573 2873  ssert is_bytes(s
+0001ab00: 6967 6e61 7475 7265 290a 2020 2020 2020  ignature).      
+0001ab10: 2020 6173 7365 7274 206c 656e 2873 6967    assert len(sig
+0001ab20: 6e61 7475 7265 2920 3d3d 2033 3220 2b20  nature) == 32 + 
+0001ab30: 3332 202b 2031 0a0a 2020 2020 2020 2020  32 + 1..        
+0001ab40: 2320 7465 7374 206f 7468 6572 2066 6f72  # test other for
+0001ab50: 6d61 7473 0a20 2020 2020 2020 2068 6578  mats.        hex
+0001ab60: 7369 676e 203d 2077 332e 6574 682e 7369  sign = w3.eth.si
+0001ab70: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+0001ab80: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001ab90: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001aba0: 652c 0a20 2020 2020 2020 2020 2020 2068  e,.            h
+0001abb0: 6578 7374 723d 4865 7853 7472 280a 2020  exstr=HexStr(.  
+0001abc0: 2020 2020 2020 2020 2020 2020 2020 2230                "0
+0001abd0: 7834 6436 3537 3337 3336 3136 3736 3532  x4d6573736167652
+0001abe0: 3037 3463 3362 3632 3037 3336 3936 3736  074c3b6207369676
+0001abf0: 6532 6532 3034 6336 6636 6536 3736 3537  e2e204c6f6e67657
+0001ac00: 3232 3037 3436 3836 3136 6532 3036 3836  2207468616e20686
+0001ac10: 3137 3336 3832 3122 2020 2320 6e6f 7161  1736821"  # noqa
+0001ac20: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
+0001ac30: 2020 2029 2c0a 2020 2020 2020 2020 290a     ),.        ).
+0001ac40: 2020 2020 2020 2020 6173 7365 7274 2068          assert h
+0001ac50: 6578 7369 676e 203d 3d20 7369 676e 6174  exsign == signat
+0001ac60: 7572 650a 0a20 2020 2020 2020 2069 6e74  ure..        int
+0001ac70: 7369 676e 203d 2077 332e 6574 682e 7369  sign = w3.eth.si
+0001ac80: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+0001ac90: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001aca0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001acb0: 652c 0a20 2020 2020 2020 2020 2020 2030  e,.            0
+0001acc0: 7834 4436 3537 3337 3336 3136 3736 3532  x4D6573736167652
+0001acd0: 3037 3443 3342 3632 3037 3336 3936 3736  074C3B6207369676
+0001ace0: 4532 4532 3034 4336 4636 4536 3736 3537  E2E204C6F6E67657
+0001acf0: 3232 3037 3436 3836 3136 4532 3036 3836  2207468616E20686
+0001ad00: 3137 3336 3832 312c 0a20 2020 2020 2020  1736821,.       
+0001ad10: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+0001ad20: 7420 696e 7473 6967 6e20 3d3d 2073 6967  t intsign == sig
+0001ad30: 6e61 7475 7265 0a0a 2020 2020 2020 2020  nature..        
+0001ad40: 6279 7465 7373 6967 6e20 3d20 7733 2e65  bytessign = w3.e
+0001ad50: 7468 2e73 6967 6e28 0a20 2020 2020 2020  th.sign(.       
+0001ad60: 2020 2020 206b 6579 6669 6c65 5f61 6363       keyfile_acc
+0001ad70: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+0001ad80: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001ad90: 2020 2020 6222 4d65 7373 6167 6520 745c      b"Message t\
+0001ada0: 7863 335c 7862 3620 7369 676e 2e20 4c6f  xc3\xb6 sign. Lo
+0001adb0: 6e67 6572 2074 6861 6e20 6861 7368 2122  nger than hash!"
+0001adc0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001add0: 2020 2020 6173 7365 7274 2062 7974 6573      assert bytes
+0001ade0: 7369 676e 203d 3d20 7369 676e 6174 7572  sign == signatur
+0001adf0: 650a 0a20 2020 2020 2020 206e 6577 5f73  e..        new_s
+0001ae00: 6967 6e61 7475 7265 203d 2077 332e 6574  ignature = w3.et
+0001ae10: 682e 7369 676e 280a 2020 2020 2020 2020  h.sign(.        
+0001ae20: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
+0001ae30: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+0001ae40: 5f74 7970 652c 2074 6578 743d 2264 6966  _type, text="dif
+0001ae50: 6665 7265 6e74 206d 6573 7361 6765 2069  ferent message i
+0001ae60: 7320 6469 6666 6572 656e 7422 0a20 2020  s different".   
+0001ae70: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+0001ae80: 7373 6572 7420 6e65 775f 7369 676e 6174  ssert new_signat
+0001ae90: 7572 6520 213d 2073 6967 6e61 7475 7265  ure != signature
+0001aea0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0001aeb0: 7468 5f73 6967 6e5f 656e 735f 6e61 6d65  th_sign_ens_name
+0001aec0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0001aed0: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
+0001aee0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0001aef0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+0001af00: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+0001af10: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001af20: 2020 2020 2020 2077 6974 6820 656e 735f         with ens_
+0001af30: 6164 6472 6573 7365 7328 0a20 2020 2020  addresses(.     
+0001af40: 2020 2020 2020 2077 332c 207b 2275 6e6c         w3, {"unl
+0001af50: 6f63 6b65 642d 6163 6374 2e65 7468 223a  ocked-acct.eth":
+0001af60: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
+0001af70: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+0001af80: 7065 7d0a 2020 2020 2020 2020 293a 0a20  pe}.        ):. 
+0001af90: 2020 2020 2020 2020 2020 2073 6967 6e61             signa
+0001afa0: 7475 7265 203d 2077 332e 6574 682e 7369  ture = w3.eth.si
+0001afb0: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+0001afc0: 2020 2020 2275 6e6c 6f63 6b65 642d 6163      "unlocked-ac
+0001afd0: 6374 2e65 7468 222c 2074 6578 743d 224d  ct.eth", text="M
+0001afe0: 6573 7361 6765 2074 c3b6 2073 6967 6e2e  essage t.. sign.
+0001aff0: 204c 6f6e 6765 7220 7468 616e 2068 6173   Longer than has
+0001b000: 6821 220a 2020 2020 2020 2020 2020 2020  h!".            
+0001b010: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
+0001b020: 7365 7274 2069 735f 6279 7465 7328 7369  sert is_bytes(si
+0001b030: 676e 6174 7572 6529 0a20 2020 2020 2020  gnature).       
+0001b040: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0001b050: 7369 676e 6174 7572 6529 203d 3d20 3332  signature) == 32
+0001b060: 202b 2033 3220 2b20 310a 0a20 2020 2064   + 32 + 1..    d
+0001b070: 6566 2074 6573 745f 6574 685f 7369 676e  ef test_eth_sign
+0001b080: 5f74 7970 6564 5f64 6174 6128 0a20 2020  _typed_data(.   
+0001b090: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001b0a0: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+0001b0b0: 2020 2020 2020 206b 6579 6669 6c65 5f61         keyfile_a
+0001b0c0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001b0d0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+0001b0e0: 756d 4164 6472 6573 732c 0a20 2020 2020  umAddress,.     
+0001b0f0: 2020 2073 6b69 705f 6966 5f74 6573 7472     skip_if_testr
+0001b100: 7063 3a20 4361 6c6c 6162 6c65 5b5b 2257  pc: Callable[["W
+0001b110: 6562 3322 5d2c 204e 6f6e 655d 2c0a 2020  eb3"], None],.  
+0001b120: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001b130: 2020 2020 2076 616c 6964 4a53 4f4e 4d65       validJSONMe
+0001b140: 7373 6167 6520 3d20 2222 220a 2020 2020  ssage = """.    
+0001b150: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0001b160: 2020 2020 2020 2020 2020 2274 7970 6573            "types
+0001b170: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+0001b180: 2020 2020 2020 2020 2022 4549 5037 3132           "EIP712
+0001b190: 446f 6d61 696e 223a 205b 0a20 2020 2020  Domain": [.     
+0001b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b1b0: 2020 207b 226e 616d 6522 3a20 226e 616d     {"name": "nam
+0001b1c0: 6522 2c20 2274 7970 6522 3a20 2273 7472  e", "type": "str
+0001b1d0: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
+0001b1e0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001b1f0: 226e 616d 6522 3a20 2276 6572 7369 6f6e  "name": "version
+0001b200: 222c 2022 7479 7065 223a 2022 7374 7269  ", "type": "stri
+0001b210: 6e67 227d 2c0a 2020 2020 2020 2020 2020  ng"},.          
+0001b220: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001b230: 6e61 6d65 223a 2022 6368 6169 6e49 6422  name": "chainId"
+0001b240: 2c20 2274 7970 6522 3a20 2275 696e 7432  , "type": "uint2
+0001b250: 3536 227d 2c0a 2020 2020 2020 2020 2020  56"},.          
+0001b260: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001b270: 6e61 6d65 223a 2022 7665 7269 6679 696e  name": "verifyin
+0001b280: 6743 6f6e 7472 6163 7422 2c20 2274 7970  gContract", "typ
+0001b290: 6522 3a20 2261 6464 7265 7373 227d 0a20  e": "address"}. 
+0001b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b2b0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0001b2c0: 2020 2020 2020 2020 2020 2250 6572 736f            "Perso
+0001b2d0: 6e22 3a20 5b0a 2020 2020 2020 2020 2020  n": [.          
+0001b2e0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001b2f0: 6e61 6d65 223a 2022 6e61 6d65 222c 2022  name": "name", "
+0001b300: 7479 7065 223a 2022 7374 7269 6e67 227d  type": "string"}
+0001b310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b320: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+0001b330: 223a 2022 7761 6c6c 6574 222c 2022 7479  ": "wallet", "ty
+0001b340: 7065 223a 2022 6164 6472 6573 7322 7d0a  pe": "address"}.
+0001b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b360: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+0001b370: 2020 2020 2020 2020 2020 2022 4d61 696c             "Mail
+0001b380: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+0001b390: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
+0001b3a0: 616d 6522 3a20 2266 726f 6d22 2c20 2274  ame": "from", "t
+0001b3b0: 7970 6522 3a20 2250 6572 736f 6e22 7d2c  ype": "Person"},
+0001b3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b3d0: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+0001b3e0: 3a20 2274 6f22 2c20 2274 7970 6522 3a20  : "to", "type": 
+0001b3f0: 2250 6572 736f 6e22 7d2c 0a20 2020 2020  "Person"},.     
+0001b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b410: 2020 207b 226e 616d 6522 3a20 2263 6f6e     {"name": "con
+0001b420: 7465 6e74 7322 2c20 2274 7970 6522 3a20  tents", "type": 
+0001b430: 2273 7472 696e 6722 7d0a 2020 2020 2020  "string"}.      
+0001b440: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b460: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001b470: 2020 2022 7072 696d 6172 7954 7970 6522     "primaryType"
+0001b480: 3a20 224d 6169 6c22 2c0a 2020 2020 2020  : "Mail",.      
+0001b490: 2020 2020 2020 2020 2020 2264 6f6d 6169            "domai
+0001b4a0: 6e22 3a20 7b0a 2020 2020 2020 2020 2020  n": {.          
+0001b4b0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+0001b4c0: 3a20 2245 7468 6572 204d 6169 6c22 2c0a  : "Ether Mail",.
+0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4e0: 2020 2020 2276 6572 7369 6f6e 223a 2022      "version": "
+0001b4f0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0001b500: 2020 2020 2020 2020 2263 6861 696e 4964          "chainId
+0001b510: 223a 2022 3078 3031 222c 0a20 2020 2020  ": "0x01",.     
+0001b520: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b530: 7665 7269 6679 696e 6743 6f6e 7472 6163  verifyingContrac
+0001b540: 7422 3a20 2230 7843 6343 4363 6363 6343  t": "0xCcCCccccC
+0001b550: 4343 4363 4343 4343 4343 6343 6343 6363  CCCcCCCCCCcCcCcc
+0001b560: 4363 4343 4363 4363 6363 6363 6363 4322  CcCCCcCcccccccC"
+0001b570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b580: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+0001b590: 2020 2020 226d 6573 7361 6765 223a 207b      "message": {
+0001b5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b5b0: 2020 2020 2022 6672 6f6d 223a 207b 0a20       "from": {. 
+0001b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5d0: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
+0001b5e0: 436f 7722 2c0a 2020 2020 2020 2020 2020  Cow",.          
+0001b5f0: 2020 2020 2020 2020 2020 2020 2020 2277                "w
+0001b600: 616c 6c65 7422 3a20 2230 7843 4432 6133  allet": "0xCD2a3
+0001b610: 6439 4639 3338 4531 3343 4439 3437 4563  d9F938E13CD947Ec
+0001b620: 3035 4162 4337 4645 3733 3444 6638 4444  05AbC7FE734Df8DD
+0001b630: 3832 3622 0a20 2020 2020 2020 2020 2020  826".           
+0001b640: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0001b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b660: 2274 6f22 3a20 7b0a 2020 2020 2020 2020  "to": {.        
+0001b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b680: 226e 616d 6522 3a20 2242 6f62 222c 0a20  "name": "Bob",. 
+0001b690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6a0: 2020 2020 2020 2022 7761 6c6c 6574 223a         "wallet":
+0001b6b0: 2022 3078 6242 6242 4242 4262 6242 4242   "0xbBbBBBBbbBBB
+0001b6c0: 6262 6242 6262 4262 6262 6242 4262 4262  bbbBbbBbbbbBBbBb
+0001b6d0: 6262 6242 6242 6262 4242 6242 220a 2020  bbbBbBbbBBbB".  
+0001b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6f0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+0001b700: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0001b710: 7473 223a 2022 4865 6c6c 6f2c 2042 6f62  ts": "Hello, Bob
+0001b720: 2122 0a20 2020 2020 2020 2020 2020 2020  !".             
+0001b730: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0001b740: 207d 0a20 2020 2020 2020 2022 2222 0a20   }.        """. 
+0001b750: 2020 2020 2020 2073 6b69 705f 6966 5f74         skip_if_t
+0001b760: 6573 7472 7063 2877 3329 0a20 2020 2020  estrpc(w3).     
+0001b770: 2020 2073 6967 6e61 7475 7265 203d 2048     signature = H
+0001b780: 6578 4279 7465 7328 0a20 2020 2020 2020  exBytes(.       
+0001b790: 2020 2020 2077 332e 6574 682e 7369 676e       w3.eth.sign
+0001b7a0: 5f74 7970 6564 5f64 6174 6128 0a20 2020  _typed_data(.   
+0001b7b0: 2020 2020 2020 2020 2020 2020 206b 6579               key
+0001b7c0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0001b7d0: 7265 7373 5f64 7561 6c5f 7479 7065 2c20  ress_dual_type, 
+0001b7e0: 6a73 6f6e 2e6c 6f61 6473 2876 616c 6964  json.loads(valid
+0001b7f0: 4a53 4f4e 4d65 7373 6167 6529 0a20 2020  JSONMessage).   
+0001b800: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001b810: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+0001b820: 6572 7420 6c65 6e28 7369 676e 6174 7572  ert len(signatur
+0001b830: 6529 203d 3d20 3332 202b 2033 3220 2b20  e) == 32 + 32 + 
+0001b840: 310a 0a20 2020 2064 6566 2074 6573 745f  1..    def test_
+0001b850: 696e 7661 6c69 645f 6574 685f 7369 676e  invalid_eth_sign
+0001b860: 5f74 7970 6564 5f64 6174 6128 0a20 2020  _typed_data(.   
+0001b870: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001b880: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+0001b890: 2020 2020 2020 206b 6579 6669 6c65 5f61         keyfile_a
+0001b8a0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001b8b0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+0001b8c0: 756d 4164 6472 6573 732c 0a20 2020 2020  umAddress,.     
+0001b8d0: 2020 2073 6b69 705f 6966 5f74 6573 7472     skip_if_testr
+0001b8e0: 7063 3a20 4361 6c6c 6162 6c65 5b5b 2257  pc: Callable[["W
+0001b8f0: 6562 3322 5d2c 204e 6f6e 655d 2c0a 2020  eb3"], None],.  
+0001b900: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001b910: 2020 2020 2073 6b69 705f 6966 5f74 6573       skip_if_tes
+0001b920: 7472 7063 2877 3329 0a20 2020 2020 2020  trpc(w3).       
+0001b930: 2069 6e76 616c 6964 5f74 7970 6564 5f6d   invalid_typed_m
+0001b940: 6573 7361 6765 203d 2022 2222 0a20 2020  essage = """.   
+0001b950: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0001b960: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+0001b970: 7322 3a20 7b0a 2020 2020 2020 2020 2020  s": {.          
+0001b980: 2020 2020 2020 2020 2020 2245 4950 3731            "EIP71
+0001b990: 3244 6f6d 6169 6e22 3a20 5b0a 2020 2020  2Domain": [.    
+0001b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9b0: 2020 2020 7b22 6e61 6d65 223a 2022 6e61      {"name": "na
+0001b9c0: 6d65 222c 2022 7479 7065 223a 2022 7374  me", "type": "st
+0001b9d0: 7269 6e67 227d 2c0a 2020 2020 2020 2020  ring"},.        
+0001b9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9f0: 7b22 6e61 6d65 223a 2022 7665 7273 696f  {"name": "versio
+0001ba00: 6e22 2c20 2274 7970 6522 3a20 2273 7472  n", "type": "str
+0001ba10: 696e 6722 7d2c 0a20 2020 2020 2020 2020  ing"},.         
+0001ba20: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001ba30: 226e 616d 6522 3a20 2263 6861 696e 4964  "name": "chainId
+0001ba40: 222c 2022 7479 7065 223a 2022 7569 6e74  ", "type": "uint
+0001ba50: 3235 3622 7d2c 0a20 2020 2020 2020 2020  256"},.         
+0001ba60: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001ba70: 226e 616d 6522 3a20 2276 6572 6966 7969  "name": "verifyi
+0001ba80: 6e67 436f 6e74 7261 6374 222c 2022 7479  ngContract", "ty
+0001ba90: 7065 223a 2022 6164 6472 6573 7322 7d0a  pe": "address"}.
+0001baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bab0: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+0001bac0: 2020 2020 2020 2020 2020 2022 5065 7273             "Pers
+0001bad0: 6f6e 223a 205b 0a20 2020 2020 2020 2020  on": [.         
+0001bae0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0001baf0: 226e 616d 6522 3a20 226e 616d 6522 2c20  "name": "name", 
+0001bb00: 2274 7970 6522 3a20 2273 7472 696e 6722  "type": "string"
+0001bb10: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001bb20: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+0001bb30: 6522 3a20 2277 616c 6c65 7422 2c20 2274  e": "wallet", "t
+0001bb40: 7970 6522 3a20 2261 6464 7265 7373 227d  ype": "address"}
+0001bb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bb60: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0001bb70: 2020 2020 2020 2020 2020 2020 224d 6169              "Mai
+0001bb80: 6c22 3a20 5b0a 2020 2020 2020 2020 2020  l": [.          
+0001bb90: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001bba0: 6e61 6d65 223a 2022 6672 6f6d 222c 2022  name": "from", "
+0001bbb0: 7479 7065 223a 2022 5065 7273 6f6e 227d  type": "Person"}
+0001bbc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bbd0: 2020 2020 2020 2020 2020 7b22 6e61 6d65            {"name
+0001bbe0: 223a 2022 746f 222c 2022 7479 7065 223a  ": "to", "type":
+0001bbf0: 2022 5065 7273 6f6e 5b32 5d22 7d2c 0a20   "Person[2]"},. 
+0001bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc10: 2020 2020 2020 207b 226e 616d 6522 3a20         {"name": 
+0001bc20: 2263 6f6e 7465 6e74 7322 2c20 2274 7970  "contents", "typ
+0001bc30: 6522 3a20 2273 7472 696e 6722 7d0a 2020  e": "string"}.  
+0001bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc50: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+0001bc60: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0001bc70: 2020 2020 2020 2022 7072 696d 6172 7954         "primaryT
+0001bc80: 7970 6522 3a20 224d 6169 6c22 2c0a 2020  ype": "Mail",.  
+0001bc90: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+0001bca0: 6f6d 6169 6e22 3a20 7b0a 2020 2020 2020  omain": {.      
+0001bcb0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+0001bcc0: 616d 6522 3a20 2245 7468 6572 204d 6169  ame": "Ether Mai
+0001bcd0: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+0001bce0: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
+0001bcf0: 223a 2022 3122 2c0a 2020 2020 2020 2020  ": "1",.        
+0001bd00: 2020 2020 2020 2020 2020 2020 2263 6861              "cha
+0001bd10: 696e 4964 223a 2022 3078 3031 222c 0a20  inId": "0x01",. 
+0001bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd30: 2020 2022 7665 7269 6679 696e 6743 6f6e     "verifyingCon
+0001bd40: 7472 6163 7422 3a20 2230 7843 6343 4363  tract": "0xCcCCc
+0001bd50: 6363 6343 4343 4363 4343 4343 4343 6343  cccCCCCcCCCCCCcC
+0001bd60: 6343 6363 4363 4343 4363 4363 6363 6363  cCccCcCCCcCccccc
+0001bd70: 6363 4322 0a20 2020 2020 2020 2020 2020  ccC".           
+0001bd80: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0001bd90: 2020 2020 2020 2020 226d 6573 7361 6765          "message
+0001bda0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+0001bdb0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+0001bdc0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001bdd0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+0001bde0: 223a 2022 436f 7722 2c0a 2020 2020 2020  ": "Cow",.      
+0001bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be00: 2020 2277 616c 6c65 7422 3a20 2230 7843    "wallet": "0xC
+0001be10: 4432 6133 6439 4639 3338 4531 3343 4439  D2a3d9F938E13CD9
+0001be20: 3437 4563 3035 4162 4337 4645 3733 3444  47Ec05AbC7FE734D
+0001be30: 6638 4444 3832 3622 0a20 2020 2020 2020  f8DD826".       
+0001be40: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be60: 2020 2020 2274 6f22 3a20 5b7b 0a20 2020      "to": [{.   
+0001be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be80: 2020 2020 2022 6e61 6d65 223a 2022 426f       "name": "Bo
+0001be90: 6222 2c0a 2020 2020 2020 2020 2020 2020  b",.            
+0001bea0: 2020 2020 2020 2020 2020 2020 2277 616c              "wal
+0001beb0: 6c65 7422 3a20 2230 7862 4262 4242 4242  let": "0xbBbBBBB
+0001bec0: 6262 4242 4262 6262 4262 6242 6262 6262  bbBBBbbbBbbBbbbb
+0001bed0: 4242 6242 6262 6262 4262 4262 6242 4262  BBbBbbbbBbBbbBBb
+0001bee0: 4222 0a20 2020 2020 2020 2020 2020 2020  B".             
+0001bef0: 2020 2020 2020 207d 5d2c 0a20 2020 2020         }],.     
+0001bf00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001bf10: 636f 6e74 656e 7473 223a 2022 4865 6c6c  contents": "Hell
+0001bf20: 6f2c 2042 6f62 2122 0a20 2020 2020 2020  o, Bob!".       
+0001bf30: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0001bf40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001bf50: 2022 2222 0a20 2020 2020 2020 2077 6974   """.        wit
+0001bf60: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+0001bf70: 0a20 2020 2020 2020 2020 2020 2057 6562  .            Web
+0001bf80: 3356 616c 7565 4572 726f 722c 0a20 2020  3ValueError,.   
+0001bf90: 2020 2020 2020 2020 206d 6174 6368 3d72           match=r
+0001bfa0: 222e 2a45 7870 6563 7465 6420 3220 6974  ".*Expected 2 it
+0001bfb0: 656d 7320 666f 7220 6172 7261 7920 7479  ems for array ty
+0001bfc0: 7065 2050 6572 736f 6e5c 5b32 5c5d 2c20  pe Person\[2\], 
+0001bfd0: 676f 7420 3120 6974 656d 732e 2a22 2c0a  got 1 items.*",.
+0001bfe0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0001bff0: 2020 2020 2020 2077 332e 6574 682e 7369         w3.eth.si
+0001c000: 676e 5f74 7970 6564 5f64 6174 6128 0a20  gn_typed_data(. 
+0001c010: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+0001c020: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001c030: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0001c040: 2c20 6a73 6f6e 2e6c 6f61 6473 2869 6e76  , json.loads(inv
+0001c050: 616c 6964 5f74 7970 6564 5f6d 6573 7361  alid_typed_messa
+0001c060: 6765 290a 2020 2020 2020 2020 2020 2020  ge).            
+0001c070: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0001c080: 6574 685f 7369 676e 5f74 7261 6e73 6163  eth_sign_transac
+0001c090: 7469 6f6e 5f6c 6567 6163 7928 0a20 2020  tion_legacy(.   
+0001c0a0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+0001c0b0: 5765 6233 222c 206b 6579 6669 6c65 5f61  Web3", keyfile_a
+0001c0c0: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
+0001c0d0: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+0001c0e0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001c0f0: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+0001c100: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
+0001c110: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+0001c120: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
+0001c130: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
+0001c140: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
+0001c150: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001c160: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+0001c170: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+0001c180: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+0001c190: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
+0001c1a0: 2020 2020 2020 2020 2020 2022 6761 7350             "gasP
+0001c1b0: 7269 6365 223a 2077 332e 6574 682e 6761  rice": w3.eth.ga
+0001c1c0: 735f 7072 6963 652c 0a20 2020 2020 2020  s_price,.       
+0001c1d0: 2020 2020 2022 6e6f 6e63 6522 3a20 4e6f       "nonce": No
+0001c1e0: 6e63 6528 3029 2c0a 2020 2020 2020 2020  nce(0),.        
+0001c1f0: 7d0a 2020 2020 2020 2020 7265 7375 6c74  }.        result
+0001c200: 203d 2077 332e 6574 682e 7369 676e 5f74   = w3.eth.sign_t
+0001c210: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+0001c220: 6172 616d 7329 0a20 2020 2020 2020 2073  arams).        s
+0001c230: 6967 6e61 746f 7279 5f61 6363 6f75 6e74  ignatory_account
+0001c240: 203d 2077 332e 6574 682e 6163 636f 756e   = w3.eth.accoun
+0001c250: 742e 7265 636f 7665 725f 7472 616e 7361  t.recover_transa
+0001c260: 6374 696f 6e28 7265 7375 6c74 5b22 7261  ction(result["ra
+0001c270: 7722 5d29 0a20 2020 2020 2020 2061 7373  w"]).        ass
+0001c280: 6572 7420 6b65 7966 696c 655f 6163 636f  ert keyfile_acco
+0001c290: 756e 745f 6164 6472 6573 7320 3d3d 2073  unt_address == s
+0001c2a0: 6967 6e61 746f 7279 5f61 6363 6f75 6e74  ignatory_account
+0001c2b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001c2c0: 7265 7375 6c74 5b22 7478 225d 5b22 746f  result["tx"]["to
+0001c2d0: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+0001c2e0: 5b22 746f 225d 0a20 2020 2020 2020 2061  ["to"].        a
+0001c2f0: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+0001c300: 225d 5b22 7661 6c75 6522 5d20 3d3d 2074  "]["value"] == t
+0001c310: 786e 5f70 6172 616d 735b 2276 616c 7565  xn_params["value
+0001c320: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+0001c330: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
+0001c340: 6761 7322 5d20 3d3d 2074 786e 5f70 6172  gas"] == txn_par
+0001c350: 616d 735b 2267 6173 225d 0a20 2020 2020  ams["gas"].     
+0001c360: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+0001c370: 5b22 7478 225d 5b22 6761 7350 7269 6365  ["tx"]["gasPrice
+0001c380: 225d 203d 3d20 7478 6e5f 7061 7261 6d73  "] == txn_params
+0001c390: 5b22 6761 7350 7269 6365 225d 0a20 2020  ["gasPrice"].   
+0001c3a0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0001c3b0: 6c74 5b22 7478 225d 5b22 6e6f 6e63 6522  lt["tx"]["nonce"
+0001c3c0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+0001c3d0: 226e 6f6e 6365 225d 0a0a 2020 2020 6465  "nonce"]..    de
+0001c3e0: 6620 7465 7374 5f65 7468 5f73 6967 6e5f  f test_eth_sign_
+0001c3f0: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+0001c400: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+0001c410: 5765 6233 222c 206b 6579 6669 6c65 5f61  Web3", keyfile_a
+0001c420: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
+0001c430: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+0001c440: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0001c450: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+0001c460: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
+0001c470: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+0001c480: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
+0001c490: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
+0001c4a0: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
+0001c4b0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001c4c0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+0001c4d0: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+0001c4e0: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+0001c4f0: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
+0001c500: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
+0001c510: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+0001c520: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
+0001c530: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+0001c540: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+0001c550: 6173 223a 2077 332e 746f 5f77 6569 2831  as": w3.to_wei(1
+0001c560: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
+0001c570: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
+0001c580: 4e6f 6e63 6528 3029 2c0a 2020 2020 2020  Nonce(0),.      
+0001c590: 2020 7d0a 2020 2020 2020 2020 7265 7375    }.        resu
+0001c5a0: 6c74 203d 2077 332e 6574 682e 7369 676e  lt = w3.eth.sign
+0001c5b0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+0001c5c0: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+0001c5d0: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
+0001c5e0: 6e74 203d 2077 332e 6574 682e 6163 636f  nt = w3.eth.acco
+0001c5f0: 756e 742e 7265 636f 7665 725f 7472 616e  unt.recover_tran
+0001c600: 7361 6374 696f 6e28 7265 7375 6c74 5b22  saction(result["
+0001c610: 7261 7722 5d29 0a20 2020 2020 2020 2061  raw"]).        a
+0001c620: 7373 6572 7420 6b65 7966 696c 655f 6163  ssert keyfile_ac
+0001c630: 636f 756e 745f 6164 6472 6573 7320 3d3d  count_address ==
+0001c640: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
+0001c650: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
+0001c660: 7420 7265 7375 6c74 5b22 7478 225d 5b22  t result["tx"]["
+0001c670: 746f 225d 203d 3d20 7478 6e5f 7061 7261  to"] == txn_para
+0001c680: 6d73 5b22 746f 225d 0a20 2020 2020 2020  ms["to"].       
+0001c690: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+0001c6a0: 7478 225d 5b22 7661 6c75 6522 5d20 3d3d  tx"]["value"] ==
+0001c6b0: 2074 786e 5f70 6172 616d 735b 2276 616c   txn_params["val
+0001c6c0: 7565 225d 0a20 2020 2020 2020 2061 7373  ue"].        ass
+0001c6d0: 6572 7420 7265 7375 6c74 5b22 7478 225d  ert result["tx"]
+0001c6e0: 5b22 6761 7322 5d20 3d3d 2074 786e 5f70  ["gas"] == txn_p
+0001c6f0: 6172 616d 735b 2267 6173 225d 0a20 2020  arams["gas"].   
+0001c700: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0001c710: 6c74 5b22 7478 225d 5b22 6d61 7846 6565  lt["tx"]["maxFee
+0001c720: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
+0001c730: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
+0001c740: 7247 6173 225d 0a20 2020 2020 2020 2061  rGas"].        a
+0001c750: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+0001c760: 2020 2020 7265 7375 6c74 5b22 7478 225d      result["tx"]
+0001c770: 5b22 6d61 7850 7269 6f72 6974 7946 6565  ["maxPriorityFee
+0001c780: 5065 7247 6173 225d 203d 3d20 7478 6e5f  PerGas"] == txn_
+0001c790: 7061 7261 6d73 5b22 6d61 7850 7269 6f72  params["maxPrior
+0001c7a0: 6974 7946 6565 5065 7247 6173 225d 0a20  ityFeePerGas"]. 
+0001c7b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001c7c0: 2061 7373 6572 7420 7265 7375 6c74 5b22   assert result["
+0001c7d0: 7478 225d 5b22 6e6f 6e63 6522 5d20 3d3d  tx"]["nonce"] ==
+0001c7e0: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
+0001c7f0: 6365 225d 0a0a 2020 2020 6465 6620 7465  ce"]..    def te
+0001c800: 7374 5f65 7468 5f73 6967 6e5f 7472 616e  st_eth_sign_tran
+0001c810: 7361 6374 696f 6e5f 6865 785f 6665 6573  saction_hex_fees
+0001c820: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001c830: 7733 3a20 2257 6562 3322 2c20 6b65 7966  w3: "Web3", keyf
+0001c840: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0001c850: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+0001c860: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
+0001c870: 6e65 3a0a 2020 2020 2020 2020 7478 6e5f  ne:.        txn_
+0001c880: 7061 7261 6d73 3a20 5478 5061 7261 6d73  params: TxParams
+0001c890: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001c8a0: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
+0001c8b0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0001c8c0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0001c8d0: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
+0001c8e0: 756e 745f 6164 6472 6573 732c 0a20 2020  unt_address,.   
+0001c8f0: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0001c900: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0001c910: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+0001c920: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+0001c930: 226d 6178 4665 6550 6572 4761 7322 3a20  "maxFeePerGas": 
+0001c940: 6865 7828 7733 2e74 6f5f 7765 6928 322c  hex(w3.to_wei(2,
+0001c950: 2022 6777 6569 2229 292c 0a20 2020 2020   "gwei")),.     
+0001c960: 2020 2020 2020 2022 6d61 7850 7269 6f72         "maxPrior
+0001c970: 6974 7946 6565 5065 7247 6173 223a 2068  ityFeePerGas": h
+0001c980: 6578 2877 332e 746f 5f77 6569 2831 2c20  ex(w3.to_wei(1, 
+0001c990: 2267 7765 6922 2929 2c0a 2020 2020 2020  "gwei")),.      
+0001c9a0: 2020 2020 2020 226e 6f6e 6365 223a 204e        "nonce": N
+0001c9b0: 6f6e 6365 2830 292c 0a20 2020 2020 2020  once(0),.       
+0001c9c0: 207d 0a20 2020 2020 2020 2072 6573 756c   }.        resul
+0001c9d0: 7420 3d20 7733 2e65 7468 2e73 6967 6e5f  t = w3.eth.sign_
+0001c9e0: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+0001c9f0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0001ca00: 7369 676e 6174 6f72 795f 6163 636f 756e  signatory_accoun
+0001ca10: 7420 3d20 7733 2e65 7468 2e61 6363 6f75  t = w3.eth.accou
+0001ca20: 6e74 2e72 6563 6f76 6572 5f74 7261 6e73  nt.recover_trans
+0001ca30: 6163 7469 6f6e 2872 6573 756c 745b 2272  action(result["r
+0001ca40: 6177 225d 290a 2020 2020 2020 2020 6173  aw"]).        as
+0001ca50: 7365 7274 206b 6579 6669 6c65 5f61 6363  sert keyfile_acc
+0001ca60: 6f75 6e74 5f61 6464 7265 7373 203d 3d20  ount_address == 
+0001ca70: 7369 676e 6174 6f72 795f 6163 636f 756e  signatory_accoun
+0001ca80: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+0001ca90: 2072 6573 756c 745b 2274 7822 5d5b 2274   result["tx"]["t
+0001caa0: 6f22 5d20 3d3d 2074 786e 5f70 6172 616d  o"] == txn_param
+0001cab0: 735b 2274 6f22 5d0a 2020 2020 2020 2020  s["to"].        
+0001cac0: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
+0001cad0: 7822 5d5b 2276 616c 7565 225d 203d 3d20  x"]["value"] == 
+0001cae0: 7478 6e5f 7061 7261 6d73 5b22 7661 6c75  txn_params["valu
+0001caf0: 6522 5d0a 2020 2020 2020 2020 6173 7365  e"].        asse
+0001cb00: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+0001cb10: 2267 6173 225d 203d 3d20 7478 6e5f 7061  "gas"] == txn_pa
+0001cb20: 7261 6d73 5b22 6761 7322 5d0a 2020 2020  rams["gas"].    
+0001cb30: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+0001cb40: 745b 2274 7822 5d5b 226d 6178 4665 6550  t["tx"]["maxFeeP
+0001cb50: 6572 4761 7322 5d20 3d3d 2069 6e74 2873  erGas"] == int(s
+0001cb60: 7472 2874 786e 5f70 6172 616d 735b 226d  tr(txn_params["m
+0001cb70: 6178 4665 6550 6572 4761 7322 5d29 2c20  axFeePerGas"]), 
+0001cb80: 3136 290a 2020 2020 2020 2020 6173 7365  16).        asse
+0001cb90: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+0001cba0: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001cbb0: 6572 4761 7322 5d20 3d3d 2069 6e74 280a  erGas"] == int(.
+0001cbc0: 2020 2020 2020 2020 2020 2020 7374 7228              str(
+0001cbd0: 7478 6e5f 7061 7261 6d73 5b22 6d61 7850  txn_params["maxP
+0001cbe0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+0001cbf0: 225d 292c 2031 360a 2020 2020 2020 2020  "]), 16.        
+0001cc00: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001cc10: 2072 6573 756c 745b 2274 7822 5d5b 226e   result["tx"]["n
+0001cc20: 6f6e 6365 225d 203d 3d20 7478 6e5f 7061  once"] == txn_pa
+0001cc30: 7261 6d73 5b22 6e6f 6e63 6522 5d0a 0a20  rams["nonce"].. 
+0001cc40: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001cc50: 7369 676e 5f74 7261 6e73 6163 7469 6f6e  sign_transaction
+0001cc60: 5f65 6e73 5f6e 616d 6573 280a 2020 2020  _ens_names(.    
+0001cc70: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+0001cc80: 6562 3322 2c20 6b65 7966 696c 655f 6163  eb3", keyfile_ac
+0001cc90: 636f 756e 745f 6164 6472 6573 733a 2043  count_address: C
+0001cca0: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+0001ccb0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001ccc0: 2020 2020 2020 7769 7468 2065 6e73 5f61        with ens_a
+0001ccd0: 6464 7265 7373 6573 2877 332c 207b 2275  ddresses(w3, {"u
+0001cce0: 6e6c 6f63 6b65 642d 6163 636f 756e 742e  nlocked-account.
+0001ccf0: 6574 6822 3a20 6b65 7966 696c 655f 6163  eth": keyfile_ac
+0001cd00: 636f 756e 745f 6164 6472 6573 737d 293a  count_address}):
+0001cd10: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
+0001cd20: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001cd30: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001cd40: 2020 2020 2020 2266 726f 6d22 3a20 2275        "from": "u
+0001cd50: 6e6c 6f63 6b65 642d 6163 636f 756e 742e  nlocked-account.
+0001cd60: 6574 6822 2c0a 2020 2020 2020 2020 2020  eth",.          
+0001cd70: 2020 2020 2020 2274 6f22 3a20 2275 6e6c        "to": "unl
+0001cd80: 6f63 6b65 642d 6163 636f 756e 742e 6574  ocked-account.et
+0001cd90: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
+0001cda0: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+0001cdb0: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+0001cdc0: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+0001cdd0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0001cde0: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+0001cdf0: 223a 2077 332e 746f 5f77 6569 2832 2c20  ": w3.to_wei(2, 
+0001ce00: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+0001ce10: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+0001ce20: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+0001ce30: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
+0001ce40: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
+0001ce50: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
+0001ce60: 4e6f 6e63 6528 3029 2c0a 2020 2020 2020  Nonce(0),.      
+0001ce70: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0001ce80: 2020 2020 7265 7375 6c74 203d 2077 332e      result = w3.
+0001ce90: 6574 682e 7369 676e 5f74 7261 6e73 6163  eth.sign_transac
+0001cea0: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001ceb0: 0a20 2020 2020 2020 2020 2020 2073 6967  .            sig
+0001cec0: 6e61 746f 7279 5f61 6363 6f75 6e74 203d  natory_account =
+0001ced0: 2077 332e 6574 682e 6163 636f 756e 742e   w3.eth.account.
+0001cee0: 7265 636f 7665 725f 7472 616e 7361 6374  recover_transact
+0001cef0: 696f 6e28 7265 7375 6c74 5b22 7261 7722  ion(result["raw"
+0001cf00: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
+0001cf10: 7373 6572 7420 6b65 7966 696c 655f 6163  ssert keyfile_ac
+0001cf20: 636f 756e 745f 6164 6472 6573 7320 3d3d  count_address ==
+0001cf30: 2073 6967 6e61 746f 7279 5f61 6363 6f75   signatory_accou
+0001cf40: 6e74 0a20 2020 2020 2020 2020 2020 2061  nt.            a
+0001cf50: 7373 6572 7420 7265 7375 6c74 5b22 7478  ssert result["tx
+0001cf60: 225d 5b22 746f 225d 203d 3d20 6b65 7966  "]["to"] == keyf
+0001cf70: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0001cf80: 6573 730a 2020 2020 2020 2020 2020 2020  ess.            
+0001cf90: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
+0001cfa0: 7822 5d5b 2276 616c 7565 225d 203d 3d20  x"]["value"] == 
+0001cfb0: 7478 6e5f 7061 7261 6d73 5b22 7661 6c75  txn_params["valu
+0001cfc0: 6522 5d0a 2020 2020 2020 2020 2020 2020  e"].            
+0001cfd0: 6173 7365 7274 2072 6573 756c 745b 2274  assert result["t
+0001cfe0: 7822 5d5b 2267 6173 225d 203d 3d20 7478  x"]["gas"] == tx
+0001cff0: 6e5f 7061 7261 6d73 5b22 6761 7322 5d0a  n_params["gas"].
+0001d000: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0001d010: 7274 2072 6573 756c 745b 2274 7822 5d5b  rt result["tx"][
+0001d020: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
+0001d030: 3d3d 2074 786e 5f70 6172 616d 735b 226d  == txn_params["m
+0001d040: 6178 4665 6550 6572 4761 7322 5d0a 2020  axFeePerGas"].  
+0001d050: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0001d060: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0001d070: 2020 2072 6573 756c 745b 2274 7822 5d5b     result["tx"][
+0001d080: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001d090: 6572 4761 7322 5d0a 2020 2020 2020 2020  erGas"].        
+0001d0a0: 2020 2020 2020 2020 3d3d 2074 786e 5f70          == txn_p
+0001d0b0: 6172 616d 735b 226d 6178 5072 696f 7269  arams["maxPriori
+0001d0c0: 7479 4665 6550 6572 4761 7322 5d0a 2020  tyFeePerGas"].  
+0001d0d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001d0e0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0001d0f0: 6573 756c 745b 2274 7822 5d5b 226e 6f6e  esult["tx"]["non
+0001d100: 6365 225d 203d 3d20 7478 6e5f 7061 7261  ce"] == txn_para
+0001d110: 6d73 5b22 6e6f 6e63 6522 5d0a 0a20 2020  ms["nonce"]..   
+0001d120: 2064 6566 2074 6573 745f 6574 685f 7365   def test_eth_se
+0001d130: 6e64 5f74 7261 6e73 6163 7469 6f6e 5f61  nd_transaction_a
+0001d140: 6464 725f 6368 6563 6b73 756d 5f72 6571  ddr_checksum_req
+0001d150: 7569 7265 6428 0a20 2020 2020 2020 2073  uired(.        s
+0001d160: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+0001d170: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
+0001d180: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
+0001d190: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+0001d1a0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001d1b0: 206e 6f6e 5f63 6865 636b 7375 6d5f 6164   non_checksum_ad
+0001d1c0: 6472 203d 206b 6579 6669 6c65 5f61 6363  dr = keyfile_acc
+0001d1d0: 6f75 6e74 5f61 6464 7265 7373 2e6c 6f77  ount_address.low
+0001d1e0: 6572 2829 0a20 2020 2020 2020 2074 786e  er().        txn
+0001d1f0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001d200: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001d210: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
+0001d220: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0001d230: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
+0001d240: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
+0001d250: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
+0001d260: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+0001d270: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+0001d280: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+0001d290: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+0001d2a0: 2022 6d61 7846 6565 5065 7247 6173 223a   "maxFeePerGas":
+0001d2b0: 2077 332e 746f 5f77 6569 2832 2c20 2267   w3.to_wei(2, "g
+0001d2c0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
+0001d2d0: 2020 2022 6d61 7850 7269 6f72 6974 7946     "maxPriorityF
+0001d2e0: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+0001d2f0: 5f77 6569 2831 2c20 2267 7765 6922 292c  _wei(1, "gwei"),
+0001d300: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+0001d310: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+0001d320: 7261 6973 6573 2849 6e76 616c 6964 4164  raises(InvalidAd
+0001d330: 6472 6573 7329 3a0a 2020 2020 2020 2020  dress):.        
+0001d340: 2020 2020 696e 7661 6c69 645f 7061 7261      invalid_para
+0001d350: 6d73 203d 2063 6173 7428 0a20 2020 2020  ms = cast(.     
+0001d360: 2020 2020 2020 2020 2020 2054 7850 6172             TxPar
+0001d370: 616d 732c 2064 6963 7428 7478 6e5f 7061  ams, dict(txn_pa
+0001d380: 7261 6d73 2c20 2a2a 7b22 6672 6f6d 223a  rams, **{"from":
+0001d390: 206e 6f6e 5f63 6865 636b 7375 6d5f 6164   non_checksum_ad
+0001d3a0: 6472 7d29 0a20 2020 2020 2020 2020 2020  dr}).           
+0001d3b0: 2029 0a20 2020 2020 2020 2020 2020 2077   ).            w
+0001d3c0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0001d3d0: 6163 7469 6f6e 2869 6e76 616c 6964 5f70  action(invalid_p
+0001d3e0: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+0001d3f0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+0001d400: 6573 2849 6e76 616c 6964 4164 6472 6573  es(InvalidAddres
+0001d410: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0001d420: 696e 7661 6c69 645f 7061 7261 6d73 203d  invalid_params =
+0001d430: 2063 6173 7428 0a20 2020 2020 2020 2020   cast(.         
+0001d440: 2020 2020 2020 2054 7850 6172 616d 732c         TxParams,
+0001d450: 2064 6963 7428 7478 6e5f 7061 7261 6d73   dict(txn_params
+0001d460: 2c20 2a2a 7b22 746f 223a 206e 6f6e 5f63  , **{"to": non_c
+0001d470: 6865 636b 7375 6d5f 6164 6472 7d29 0a20  hecksum_addr}). 
+0001d480: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001d490: 2020 2020 2020 2020 2077 332e 6574 682e           w3.eth.
+0001d4a0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001d4b0: 2869 6e76 616c 6964 5f70 6172 616d 7329  (invalid_params)
+0001d4c0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0001d4d0: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
+0001d4e0: 696f 6e5f 6c65 6761 6379 280a 2020 2020  ion_legacy(.    
+0001d4f0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+0001d500: 6562 3322 2c20 6b65 7966 696c 655f 6163  eb3", keyfile_ac
+0001d510: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+0001d520: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
+0001d530: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+0001d540: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0001d550: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+0001d560: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0001d570: 2020 2020 2022 6672 6f6d 223a 206b 6579       "from": key
+0001d580: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0001d590: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+0001d5a0: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+0001d5b0: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+0001d5c0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+0001d5d0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0001d5e0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
+0001d5f0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+0001d600: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
+0001d610: 2020 2020 2020 2020 2267 6173 5072 6963          "gasPric
+0001d620: 6522 3a20 7733 2e74 6f5f 7765 6928 0a20  e": w3.to_wei(. 
+0001d630: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+0001d640: 2c20 2267 7765 6922 0a20 2020 2020 2020  , "gwei".       
+0001d650: 2020 2020 2029 2c20 2023 2070 6f73 742d       ),  # post-
+0001d660: 6c6f 6e64 6f6e 206e 6565 6473 2074 6f20  london needs to 
+0001d670: 6265 206d 6f72 6520 7468 616e 2074 6865  be more than the
+0001d680: 2062 6173 6520 6665 650a 2020 2020 2020   base fee.      
+0001d690: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+0001d6a0: 6861 7368 203d 2077 332e 6574 682e 7365  hash = w3.eth.se
+0001d6b0: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
+0001d6c0: 786e 5f70 6172 616d 7329 0a20 2020 2020  xn_params).     
+0001d6d0: 2020 2074 786e 203d 2077 332e 6574 682e     txn = w3.eth.
+0001d6e0: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
+0001d6f0: 7478 6e5f 6861 7368 290a 0a20 2020 2020  txn_hash)..     
+0001d700: 2020 2061 7373 6572 7420 6973 5f73 616d     assert is_sam
+0001d710: 655f 6164 6472 6573 7328 7478 6e5b 2266  e_address(txn["f
+0001d720: 726f 6d22 5d2c 2063 6173 7428 4368 6563  rom"], cast(Chec
+0001d730: 6b73 756d 4164 6472 6573 732c 2074 786e  ksumAddress, txn
+0001d740: 5f70 6172 616d 735b 2266 726f 6d22 5d29  _params["from"])
+0001d750: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001d760: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+0001d770: 2874 786e 5b22 746f 225d 2c20 6361 7374  (txn["to"], cast
+0001d780: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+0001d790: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
+0001d7a0: 225d 2929 0a20 2020 2020 2020 2061 7373  "])).        ass
+0001d7b0: 6572 7420 7478 6e5b 2276 616c 7565 225d  ert txn["value"]
+0001d7c0: 203d 3d20 310a 2020 2020 2020 2020 6173   == 1.        as
+0001d7d0: 7365 7274 2074 786e 5b22 6761 7322 5d20  sert txn["gas"] 
+0001d7e0: 3d3d 2032 3130 3030 0a20 2020 2020 2020  == 21000.       
+0001d7f0: 2061 7373 6572 7420 7478 6e5b 2267 6173   assert txn["gas
+0001d800: 5072 6963 6522 5d20 3d3d 2074 786e 5f70  Price"] == txn_p
+0001d810: 6172 616d 735b 2267 6173 5072 6963 6522  arams["gasPrice"
+0001d820: 5d0a 0a20 2020 2064 6566 2074 6573 745f  ]..    def test_
+0001d830: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
+0001d840: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
+0001d850: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0001d860: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001d870: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001d880: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0001d890: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+0001d8a0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+0001d8b0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+0001d8c0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001d8d0: 6672 6f6d 223a 206b 6579 6669 6c65 5f61  from": keyfile_a
+0001d8e0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001d8f0: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0001d900: 2020 2020 2020 2274 6f22 3a20 6b65 7966        "to": keyf
+0001d910: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0001d920: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
+0001d930: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001d940: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001d950: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+0001d960: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+0001d970: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+0001d980: 3a20 7733 2e74 6f5f 7765 6928 332c 2022  : w3.to_wei(3, "
+0001d990: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+0001d9a0: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+0001d9b0: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
+0001d9c0: 6f5f 7765 6928 312c 2022 6777 6569 2229  o_wei(1, "gwei")
+0001d9d0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0001d9e0: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
+0001d9f0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0001da00: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+0001da10: 7329 0a20 2020 2020 2020 2074 786e 203d  s).        txn =
+0001da20: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
+0001da30: 7361 6374 696f 6e28 7478 6e5f 6861 7368  saction(txn_hash
+0001da40: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0001da50: 7420 6973 5f73 616d 655f 6164 6472 6573  t is_same_addres
+0001da60: 7328 7478 6e5b 2266 726f 6d22 5d2c 2063  s(txn["from"], c
+0001da70: 6173 7428 4368 6563 6b73 756d 4164 6472  ast(ChecksumAddr
+0001da80: 6573 732c 2074 786e 5f70 6172 616d 735b  ess, txn_params[
+0001da90: 2266 726f 6d22 5d29 290a 2020 2020 2020  "from"])).      
+0001daa0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+0001dab0: 5f61 6464 7265 7373 2874 786e 5b22 746f  _address(txn["to
+0001dac0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+0001dad0: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+0001dae0: 7261 6d73 5b22 746f 225d 2929 0a20 2020  rams["to"])).   
+0001daf0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+0001db00: 2276 616c 7565 225d 203d 3d20 310a 2020  "value"] == 1.  
+0001db10: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+0001db20: 5b22 6761 7322 5d20 3d3d 2032 3130 3030  ["gas"] == 21000
+0001db30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001db40: 7478 6e5b 226d 6178 4665 6550 6572 4761  txn["maxFeePerGa
+0001db50: 7322 5d20 3d3d 2074 786e 5f70 6172 616d  s"] == txn_param
+0001db60: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
+0001db70: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+0001db80: 2074 786e 5b22 6d61 7850 7269 6f72 6974   txn["maxPriorit
+0001db90: 7946 6565 5065 7247 6173 225d 203d 3d20  yFeePerGas"] == 
+0001dba0: 7478 6e5f 7061 7261 6d73 5b22 6d61 7850  txn_params["maxP
+0001dbb0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+0001dbc0: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
+0001dbd0: 7420 7478 6e5b 2267 6173 5072 6963 6522  t txn["gasPrice"
+0001dbe0: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+0001dbf0: 226d 6178 4665 6550 6572 4761 7322 5d0a  "maxFeePerGas"].
+0001dc00: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+0001dc10: 685f 7365 6e64 5f74 7261 6e73 6163 7469  h_send_transacti
+0001dc20: 6f6e 5f77 6974 685f 6e6f 6e63 6528 0a20  on_with_nonce(. 
+0001dc30: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+0001dc40: 2022 5765 6233 222c 206b 6579 6669 6c65   "Web3", keyfile
+0001dc50: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0001dc60: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+0001dc70: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
+0001dc80: 0a20 2020 2020 2020 206d 6178 5f70 7269  .        max_pri
+0001dc90: 6f72 6974 795f 6665 655f 7065 725f 6761  ority_fee_per_ga
+0001dca0: 7320 3d20 7733 2e74 6f5f 7765 6928 312e  s = w3.to_wei(1.
+0001dcb0: 3233 342c 2022 6777 6569 2229 0a20 2020  234, "gwei").   
+0001dcc0: 2020 2020 206d 6178 5f66 6565 5f70 6572       max_fee_per
+0001dcd0: 5f67 6173 203d 2057 6569 280a 2020 2020  _gas = Wei(.    
+0001dce0: 2020 2020 2020 2020 7733 2e65 7468 2e67          w3.eth.g
+0001dcf0: 6574 5f62 6c6f 636b 2822 6c61 7465 7374  et_block("latest
+0001dd00: 2229 5b22 6261 7365 4665 6550 6572 4761  ")["baseFeePerGa
+0001dd10: 7322 5d20 2b20 6d61 785f 7072 696f 7269  s"] + max_priori
+0001dd20: 7479 5f66 6565 5f70 6572 5f67 6173 0a20  ty_fee_per_gas. 
+0001dd30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001dd40: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
+0001dd50: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0001dd60: 2020 2020 2020 2266 726f 6d22 3a20 6b65        "from": ke
+0001dd70: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+0001dd80: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+0001dd90: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
+0001dda0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+0001ddb0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+0001ddc0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+0001ddd0: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+0001dde0: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+0001ddf0: 2020 2020 2022 6d61 7846 6565 5065 7247       "maxFeePerG
+0001de00: 6173 223a 206d 6178 5f66 6565 5f70 6572  as": max_fee_per
+0001de10: 5f67 6173 2c0a 2020 2020 2020 2020 2020  _gas,.          
+0001de20: 2020 226d 6178 5072 696f 7269 7479 4665    "maxPriorityFe
+0001de30: 6550 6572 4761 7322 3a20 6d61 785f 7072  ePerGas": max_pr
+0001de40: 696f 7269 7479 5f66 6565 5f70 6572 5f67  iority_fee_per_g
+0001de50: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+0001de60: 226e 6f6e 6365 223a 204e 6f6e 6365 280a  "nonce": Nonce(.
+0001de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de80: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
+0001de90: 6163 7469 6f6e 5f63 6f75 6e74 286b 6579  action_count(key
+0001dea0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0001deb0: 7265 7373 2c20 2270 656e 6469 6e67 2229  ress, "pending")
+0001dec0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+0001ded0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0001dee0: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
+0001def0: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+0001df00: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001df10: 0a20 2020 2020 2020 2074 786e 203d 2077  .        txn = w
+0001df20: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+0001df30: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
+0001df40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001df50: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+0001df60: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
+0001df70: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
+0001df80: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
+0001df90: 726f 6d22 5d29 290a 2020 2020 2020 2020  rom"])).        
+0001dfa0: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
+0001dfb0: 6464 7265 7373 2874 786e 5b22 746f 225d  ddress(txn["to"]
+0001dfc0: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+0001dfd0: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+0001dfe0: 6d73 5b22 746f 225d 2929 0a20 2020 2020  ms["to"])).     
+0001dff0: 2020 2061 7373 6572 7420 7478 6e5b 2276     assert txn["v
+0001e000: 616c 7565 225d 203d 3d20 310a 2020 2020  alue"] == 1.    
+0001e010: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
+0001e020: 6761 7322 5d20 3d3d 2032 3130 3030 0a20  gas"] == 21000. 
+0001e030: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+0001e040: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
+0001e050: 5d20 3d3d 2074 786e 5f70 6172 616d 735b  ] == txn_params[
+0001e060: 226d 6178 4665 6550 6572 4761 7322 5d0a  "maxFeePerGas"].
+0001e070: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0001e080: 786e 5b22 6d61 7850 7269 6f72 6974 7946  xn["maxPriorityF
+0001e090: 6565 5065 7247 6173 225d 203d 3d20 7478  eePerGas"] == tx
+0001e0a0: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
+0001e0b0: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+0001e0c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e0d0: 7478 6e5b 226e 6f6e 6365 225d 203d 3d20  txn["nonce"] == 
+0001e0e0: 7478 6e5f 7061 7261 6d73 5b22 6e6f 6e63  txn_params["nonc
+0001e0f0: 6522 5d0a 2020 2020 2020 2020 6173 7365  e"].        asse
+0001e100: 7274 2069 735f 696e 7465 6765 7228 7478  rt is_integer(tx
+0001e110: 6e5b 2267 6173 5072 6963 6522 5d29 0a20  n["gasPrice"]). 
+0001e120: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0001e130: 5f69 6e74 6567 6572 2874 786e 5f70 6172  _integer(txn_par
+0001e140: 616d 735b 226d 6178 4665 6550 6572 4761  ams["maxFeePerGa
+0001e150: 7322 5d29 0a0a 2020 2020 6465 6620 7465  s"])..    def te
+0001e160: 7374 5f65 7468 5f73 656e 645f 7472 616e  st_eth_send_tran
+0001e170: 7361 6374 696f 6e5f 6465 6661 756c 745f  saction_default_
+0001e180: 6665 6573 280a 2020 2020 2020 2020 7365  fees(.        se
+0001e190: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0001e1a0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001e1b0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001e1c0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0001e1d0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+0001e1e0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+0001e1f0: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+0001e200: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001e210: 6672 6f6d 223a 206b 6579 6669 6c65 5f61  from": keyfile_a
+0001e220: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001e230: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0001e240: 2020 2020 2020 2274 6f22 3a20 6b65 7966        "to": keyf
+0001e250: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0001e260: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
+0001e270: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001e280: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001e290: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+0001e2a0: 3130 3030 2c0a 2020 2020 2020 2020 7d0a  1000,.        }.
+0001e2b0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+0001e2c0: 203d 2077 332e 6574 682e 7365 6e64 5f74   = w3.eth.send_t
+0001e2d0: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+0001e2e0: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+0001e2f0: 786e 203d 2077 332e 6574 682e 6765 745f  xn = w3.eth.get_
+0001e300: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+0001e310: 6861 7368 290a 0a20 2020 2020 2020 2061  hash)..        a
+0001e320: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
+0001e330: 6472 6573 7328 7478 6e5b 2266 726f 6d22  dress(txn["from"
+0001e340: 5d2c 2063 6173 7428 4368 6563 6b73 756d  ], cast(Checksum
+0001e350: 4164 6472 6573 732c 2074 786e 5f70 6172  Address, txn_par
+0001e360: 616d 735b 2266 726f 6d22 5d29 290a 2020  ams["from"])).  
+0001e370: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0001e380: 7361 6d65 5f61 6464 7265 7373 2874 786e  same_address(txn
+0001e390: 5b22 746f 225d 2c20 6361 7374 2843 6865  ["to"], cast(Che
+0001e3a0: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
+0001e3b0: 6e5f 7061 7261 6d73 5b22 746f 225d 2929  n_params["to"]))
+0001e3c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e3d0: 7478 6e5b 2276 616c 7565 225d 203d 3d20  txn["value"] == 
+0001e3e0: 310a 2020 2020 2020 2020 6173 7365 7274  1.        assert
+0001e3f0: 2074 786e 5b22 6761 7322 5d20 3d3d 2032   txn["gas"] == 2
+0001e400: 3130 3030 0a20 2020 2020 2020 2061 7373  1000.        ass
+0001e410: 6572 7420 6973 5f69 6e74 6567 6572 2874  ert is_integer(t
+0001e420: 786e 5b22 6d61 7850 7269 6f72 6974 7946  xn["maxPriorityF
+0001e430: 6565 5065 7247 6173 225d 290a 2020 2020  eePerGas"]).    
+0001e440: 2020 2020 6173 7365 7274 2069 735f 696e      assert is_in
+0001e450: 7465 6765 7228 7478 6e5b 226d 6178 4665  teger(txn["maxFe
+0001e460: 6550 6572 4761 7322 5d29 0a20 2020 2020  ePerGas"]).     
+0001e470: 2020 2061 7373 6572 7420 7478 6e5b 2267     assert txn["g
+0001e480: 6173 5072 6963 6522 5d20 3d3d 2074 786e  asPrice"] == txn
+0001e490: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+0001e4a0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0001e4b0: 7468 5f73 656e 645f 7472 616e 7361 6374  th_send_transact
+0001e4c0: 696f 6e5f 6865 785f 6665 6573 280a 2020  ion_hex_fees(.  
+0001e4d0: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+0001e4e0: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+0001e4f0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+0001e500: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+0001e510: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+0001e520: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0001e530: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+0001e540: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+0001e550: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
+0001e560: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001e570: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0001e580: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0001e590: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
+0001e5a0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+0001e5b0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+0001e5c0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+0001e5d0: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+0001e5e0: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+0001e5f0: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+0001e600: 6550 6572 4761 7322 3a20 6865 7828 3235  ePerGas": hex(25
+0001e610: 3020 2a20 3130 2a2a 3929 2c0a 2020 2020  0 * 10**9),.    
+0001e620: 2020 2020 2020 2020 226d 6178 5072 696f          "maxPrio
+0001e630: 7269 7479 4665 6550 6572 4761 7322 3a20  rityFeePerGas": 
+0001e640: 6865 7828 3220 2a20 3130 2a2a 3929 2c0a  hex(2 * 10**9),.
+0001e650: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0001e660: 2020 7478 6e5f 6861 7368 203d 2077 332e    txn_hash = w3.
+0001e670: 6574 682e 7365 6e64 5f74 7261 6e73 6163  eth.send_transac
+0001e680: 7469 6f6e 2874 786e 5f70 6172 616d 7329  tion(txn_params)
+0001e690: 0a20 2020 2020 2020 2074 786e 203d 2077  .        txn = w
+0001e6a0: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+0001e6b0: 6374 696f 6e28 7478 6e5f 6861 7368 290a  ction(txn_hash).
+0001e6c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e6d0: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
+0001e6e0: 7478 6e5b 2266 726f 6d22 5d2c 2063 6173  txn["from"], cas
+0001e6f0: 7428 4368 6563 6b73 756d 4164 6472 6573  t(ChecksumAddres
+0001e700: 732c 2074 786e 5f70 6172 616d 735b 2266  s, txn_params["f
+0001e710: 726f 6d22 5d29 290a 2020 2020 2020 2020  rom"])).        
+0001e720: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
+0001e730: 6464 7265 7373 2874 786e 5b22 746f 225d  ddress(txn["to"]
+0001e740: 2c20 6361 7374 2843 6865 636b 7375 6d41  , cast(ChecksumA
+0001e750: 6464 7265 7373 2c20 7478 6e5f 7061 7261  ddress, txn_para
+0001e760: 6d73 5b22 746f 225d 2929 0a20 2020 2020  ms["to"])).     
+0001e770: 2020 2061 7373 6572 7420 7478 6e5b 2276     assert txn["v
+0001e780: 616c 7565 225d 203d 3d20 310a 2020 2020  alue"] == 1.    
+0001e790: 2020 2020 6173 7365 7274 2074 786e 5b22      assert txn["
+0001e7a0: 6761 7322 5d20 3d3d 2032 3130 3030 0a20  gas"] == 21000. 
+0001e7b0: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+0001e7c0: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
+0001e7d0: 5d20 3d3d 2032 3530 202a 2031 302a 2a39  ] == 250 * 10**9
+0001e7e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e7f0: 7478 6e5b 226d 6178 5072 696f 7269 7479  txn["maxPriority
+0001e800: 4665 6550 6572 4761 7322 5d20 3d3d 2032  FeePerGas"] == 2
+0001e810: 202a 2031 302a 2a39 0a0a 2020 2020 6465   * 10**9..    de
+0001e820: 6620 7465 7374 5f65 7468 5f73 656e 645f  f test_eth_send_
+0001e830: 7472 616e 7361 6374 696f 6e5f 6e6f 5f67  transaction_no_g
+0001e840: 6173 280a 2020 2020 2020 2020 7365 6c66  as(.        self
+0001e850: 2c20 7733 3a20 2257 6562 3322 2c20 6b65  , w3: "Web3", ke
+0001e860: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+0001e870: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
+0001e880: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+0001e890: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+0001e8a0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+0001e8b0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+0001e8c0: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+0001e8d0: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
+0001e8e0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+0001e8f0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001e900: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
+0001e910: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0001e920: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+0001e930: 2020 2020 2020 2020 2022 7661 6c75 6522           "value"
+0001e940: 3a20 5765 6928 3129 2c0a 2020 2020 2020  : Wei(1),.      
+0001e950: 2020 2020 2020 226d 6178 4665 6550 6572        "maxFeePer
+0001e960: 4761 7322 3a20 5765 6928 3235 3020 2a20  Gas": Wei(250 * 
+0001e970: 3130 2a2a 3929 2c0a 2020 2020 2020 2020  10**9),.        
+0001e980: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+0001e990: 4665 6550 6572 4761 7322 3a20 5765 6928  FeePerGas": Wei(
+0001e9a0: 3220 2a20 3130 2a2a 3929 2c0a 2020 2020  2 * 10**9),.    
+0001e9b0: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+0001e9c0: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
+0001e9d0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001e9e0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+0001e9f0: 2020 2020 2074 786e 203d 2077 332e 6574       txn = w3.et
+0001ea00: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+0001ea10: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
+0001ea20: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+0001ea30: 616d 655f 6164 6472 6573 7328 7478 6e5b  ame_address(txn[
+0001ea40: 2266 726f 6d22 5d2c 2063 6173 7428 4368  "from"], cast(Ch
+0001ea50: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
+0001ea60: 786e 5f70 6172 616d 735b 2266 726f 6d22  xn_params["from"
+0001ea70: 5d29 290a 2020 2020 2020 2020 6173 7365  ])).        asse
+0001ea80: 7274 2069 735f 7361 6d65 5f61 6464 7265  rt is_same_addre
+0001ea90: 7373 2874 786e 5b22 746f 225d 2c20 6361  ss(txn["to"], ca
+0001eaa0: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
+0001eab0: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
+0001eac0: 746f 225d 2929 0a20 2020 2020 2020 2061  to"])).        a
+0001ead0: 7373 6572 7420 7478 6e5b 2276 616c 7565  ssert txn["value
+0001eae0: 225d 203d 3d20 310a 2020 2020 2020 2020  "] == 1.        
+0001eaf0: 6173 7365 7274 2074 786e 5b22 6761 7322  assert txn["gas"
+0001eb00: 5d20 3d3d 2031 3231 3030 3020 2023 2032  ] == 121000  # 2
+0001eb10: 3130 3030 202b 2062 7566 6665 720a 0a20  1000 + buffer.. 
+0001eb20: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0001eb30: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+0001eb40: 5f77 6974 685f 6761 735f 7072 6963 6528  _with_gas_price(
+0001eb50: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+0001eb60: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
+0001eb70: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+0001eb80: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
+0001eb90: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+0001eba0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001ebb0: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
+0001ebc0: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
+0001ebd0: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+0001ebe0: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+0001ebf0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+0001ec00: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0001ec10: 2022 746f 223a 206b 6579 6669 6c65 5f61   "to": keyfile_a
+0001ec20: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001ec30: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0001ec40: 2020 2020 2020 2276 616c 7565 223a 2057        "value": W
+0001ec50: 6569 2831 292c 0a20 2020 2020 2020 2020  ei(1),.         
+0001ec60: 2020 2022 6761 7322 3a20 3231 3030 302c     "gas": 21000,
+0001ec70: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
+0001ec80: 7350 7269 6365 223a 2057 6569 2831 292c  sPrice": Wei(1),
+0001ec90: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+0001eca0: 7846 6565 5065 7247 6173 223a 2057 6569  xFeePerGas": Wei
+0001ecb0: 2832 3530 202a 2031 302a 2a39 292c 0a20  (250 * 10**9),. 
+0001ecc0: 2020 2020 2020 2020 2020 2022 6d61 7850             "maxP
+0001ecd0: 7269 6f72 6974 7946 6565 5065 7247 6173  riorityFeePerGas
+0001ece0: 223a 2057 6569 2832 202a 2031 302a 2a39  ": Wei(2 * 10**9
+0001ecf0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+0001ed00: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0001ed10: 2e72 6169 7365 7328 5472 616e 7361 6374  .raises(Transact
+0001ed20: 696f 6e54 7970 654d 6973 6d61 7463 6829  ionTypeMismatch)
+0001ed30: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
+0001ed40: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+0001ed50: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+0001ed60: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0001ed70: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
+0001ed80: 7469 6f6e 5f6e 6f5f 7072 696f 7269 7479  tion_no_priority
+0001ed90: 5f66 6565 280a 2020 2020 2020 2020 7365  _fee(.        se
+0001eda0: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+0001edb0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001edc0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001edd0: 653a 2043 6865 636b 7375 6d41 6464 7265  e: ChecksumAddre
+0001ede0: 7373 0a20 2020 2029 202d 3e20 4e6f 6e65  ss.    ) -> None
+0001edf0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+0001ee00: 7261 6d73 3a20 5478 5061 7261 6d73 203d  rams: TxParams =
+0001ee10: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001ee20: 6672 6f6d 223a 206b 6579 6669 6c65 5f61  from": keyfile_a
+0001ee30: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001ee40: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0001ee50: 2020 2020 2020 2274 6f22 3a20 6b65 7966        "to": keyf
+0001ee60: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+0001ee70: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
+0001ee80: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+0001ee90: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+0001eea0: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+0001eeb0: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+0001eec0: 2020 226d 6178 4665 6550 6572 4761 7322    "maxFeePerGas"
+0001eed0: 3a20 5765 6928 3235 3020 2a20 3130 2a2a  : Wei(250 * 10**
+0001eee0: 3929 2c0a 2020 2020 2020 2020 7d0a 2020  9),.        }.  
+0001eef0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0001ef00: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+0001ef10: 2020 2020 2020 496e 7661 6c69 6454 7261        InvalidTra
+0001ef20: 6e73 6163 7469 6f6e 2c20 6d61 7463 683d  nsaction, match=
+0001ef30: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001ef40: 6572 4761 7320 6d75 7374 2062 6520 6465  erGas must be de
+0001ef50: 6669 6e65 6422 0a20 2020 2020 2020 2029  fined".        )
+0001ef60: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
+0001ef70: 2e65 7468 2e73 656e 645f 7472 616e 7361  .eth.send_transa
+0001ef80: 6374 696f 6e28 7478 6e5f 7061 7261 6d73  ction(txn_params
+0001ef90: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0001efa0: 6574 685f 7365 6e64 5f74 7261 6e73 6163  eth_send_transac
+0001efb0: 7469 6f6e 5f6e 6f5f 6d61 785f 6665 6528  tion_no_max_fee(
+0001efc0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+0001efd0: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
+0001efe0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+0001eff0: 7373 5f64 7561 6c5f 7479 7065 3a20 4368  ss_dual_type: Ch
+0001f000: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+0001f010: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+0001f020: 2020 2020 206d 6178 5f70 7269 6f72 6974       max_priorit
+0001f030: 795f 6665 655f 7065 725f 6761 7320 3d20  y_fee_per_gas = 
+0001f040: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+0001f050: 6569 2229 0a20 2020 2020 2020 2074 786e  ei").        txn
+0001f060: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001f070: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001f080: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
+0001f090: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0001f0a0: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+0001f0b0: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
+0001f0c0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001f0d0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0001f0e0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+0001f0f0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+0001f100: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+0001f110: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+0001f120: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
+0001f130: 7946 6565 5065 7247 6173 223a 206d 6178  yFeePerGas": max
+0001f140: 5f70 7269 6f72 6974 795f 6665 655f 7065  _priority_fee_pe
+0001f150: 725f 6761 732c 0a20 2020 2020 2020 207d  r_gas,.        }
+0001f160: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
+0001f170: 6820 3d20 7733 2e65 7468 2e73 656e 645f  h = w3.eth.send_
+0001f180: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+0001f190: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0001f1a0: 7478 6e20 3d20 7733 2e65 7468 2e67 6574  txn = w3.eth.get
+0001f1b0: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+0001f1c0: 5f68 6173 6829 0a0a 2020 2020 2020 2020  _hash)..        
+0001f1d0: 6173 7365 7274 2069 735f 7361 6d65 5f61  assert is_same_a
+0001f1e0: 6464 7265 7373 2874 786e 5b22 6672 6f6d  ddress(txn["from
+0001f1f0: 225d 2c20 6361 7374 2843 6865 636b 7375  "], cast(Checksu
+0001f200: 6d41 6464 7265 7373 2c20 7478 6e5f 7061  mAddress, txn_pa
+0001f210: 7261 6d73 5b22 6672 6f6d 225d 2929 0a20  rams["from"])). 
+0001f220: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0001f230: 5f73 616d 655f 6164 6472 6573 7328 7478  _same_address(tx
+0001f240: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
+0001f250: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
+0001f260: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
+0001f270: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0001f280: 2074 786e 5b22 7661 6c75 6522 5d20 3d3d   txn["value"] ==
+0001f290: 2031 0a20 2020 2020 2020 2061 7373 6572   1.        asser
+0001f2a0: 7420 7478 6e5b 2267 6173 225d 203d 3d20  t txn["gas"] == 
+0001f2b0: 3231 3030 300a 2020 2020 2020 2020 6173  21000.        as
+0001f2c0: 7365 7274 2069 735f 696e 7465 6765 7228  sert is_integer(
+0001f2d0: 7478 6e5b 226d 6178 5072 696f 7269 7479  txn["maxPriority
+0001f2e0: 4665 6550 6572 4761 7322 5d29 0a20 2020  FeePerGas"]).   
+0001f2f0: 2020 2020 2061 7373 6572 7420 7478 6e5b       assert txn[
+0001f300: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+0001f310: 6572 4761 7322 5d20 3d3d 206d 6178 5f70  erGas"] == max_p
+0001f320: 7269 6f72 6974 795f 6665 655f 7065 725f  riority_fee_per_
+0001f330: 6761 730a 2020 2020 2020 2020 6173 7365  gas.        asse
+0001f340: 7274 2069 735f 696e 7465 6765 7228 7478  rt is_integer(tx
+0001f350: 6e5b 226d 6178 4665 6550 6572 4761 7322  n["maxFeePerGas"
+0001f360: 5d29 0a0a 2020 2020 6465 6620 7465 7374  ])..    def test
+0001f370: 5f65 7468 5f73 656e 645f 7472 616e 7361  _eth_send_transa
+0001f380: 6374 696f 6e5f 6d61 785f 6665 655f 6c65  ction_max_fee_le
+0001f390: 7373 5f74 6861 6e5f 7469 7028 0a20 2020  ss_than_tip(.   
+0001f3a0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
+0001f3b0: 5765 6233 222c 206b 6579 6669 6c65 5f61  Web3", keyfile_a
+0001f3c0: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0001f3d0: 7561 6c5f 7479 7065 3a20 4368 6563 6b73  ual_type: Checks
+0001f3e0: 756d 4164 6472 6573 730a 2020 2020 2920  umAddress.    ) 
+0001f3f0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0001f400: 2074 786e 5f70 6172 616d 733a 2054 7850   txn_params: TxP
+0001f410: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0001f420: 2020 2020 2020 2266 726f 6d22 3a20 6b65        "from": ke
+0001f430: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+0001f440: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+0001f450: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+0001f460: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
+0001f470: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+0001f480: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0001f490: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+0001f4a0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001f4b0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+0001f4c0: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+0001f4d0: 5065 7247 6173 223a 2057 6569 2831 202a  PerGas": Wei(1 *
+0001f4e0: 2031 302a 2a39 292c 0a20 2020 2020 2020   10**9),.       
+0001f4f0: 2020 2020 2022 6d61 7850 7269 6f72 6974       "maxPriorit
+0001f500: 7946 6565 5065 7247 6173 223a 2057 6569  yFeePerGas": Wei
+0001f510: 2832 202a 2031 302a 2a39 292c 0a20 2020  (2 * 10**9),.   
+0001f520: 2020 2020 207d 0a20 2020 2020 2020 2077       }.        w
+0001f530: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0001f540: 7328 0a20 2020 2020 2020 2020 2020 2049  s(.            I
+0001f550: 6e76 616c 6964 5472 616e 7361 6374 696f  nvalidTransactio
+0001f560: 6e2c 206d 6174 6368 3d22 6d61 7846 6565  n, match="maxFee
+0001f570: 5065 7247 6173 206d 7573 7420 6265 203e  PerGas must be >
+0001f580: 3d20 6d61 7850 7269 6f72 6974 7946 6565  = maxPriorityFee
+0001f590: 5065 7247 6173 220a 2020 2020 2020 2020  PerGas".        
+0001f5a0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0001f5b0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0001f5c0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+0001f5d0: 7329 0a0a 2020 2020 6465 6620 7465 7374  s)..    def test
+0001f5e0: 5f76 616c 6964 6174 696f 6e5f 6d69 6464  _validation_midd
+0001f5f0: 6c65 7761 7265 5f63 6861 696e 5f69 645f  leware_chain_id_
+0001f600: 6d69 736d 6174 6368 280a 2020 2020 2020  mismatch(.      
+0001f610: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0001f620: 3322 2c20 6b65 7966 696c 655f 6163 636f  3", keyfile_acco
+0001f630: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+0001f640: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+0001f650: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+0001f660: 4e6f 6e65 3a0a 2020 2020 2020 2020 7772  None:.        wr
+0001f670: 6f6e 675f 6368 6169 6e5f 6964 203d 2031  ong_chain_id = 1
+0001f680: 3233 3435 3637 3839 300a 2020 2020 2020  234567890.      
+0001f690: 2020 6163 7475 616c 5f63 6861 696e 5f69    actual_chain_i
+0001f6a0: 6420 3d20 7733 2e65 7468 2e63 6861 696e  d = w3.eth.chain
+0001f6b0: 5f69 640a 0a20 2020 2020 2020 2074 786e  _id..        txn
+0001f6c0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+0001f6d0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0001f6e0: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
+0001f6f0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0001f700: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+0001f710: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
+0001f720: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0001f730: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0001f740: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+0001f750: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+0001f760: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+0001f770: 3a20 5765 6928 3231 3030 3029 2c0a 2020  : Wei(21000),.  
+0001f780: 2020 2020 2020 2020 2020 226d 6178 4665            "maxFe
+0001f790: 6550 6572 4761 7322 3a20 7733 2e74 6f5f  ePerGas": w3.to_
+0001f7a0: 7765 6928 322c 2022 6777 6569 2229 2c0a  wei(2, "gwei"),.
+0001f7b0: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+0001f7c0: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+0001f7d0: 7322 3a20 7733 2e74 6f5f 7765 6928 312c  s": w3.to_wei(1,
+0001f7e0: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+0001f7f0: 2020 2020 2020 2263 6861 696e 4964 223a        "chainId":
+0001f800: 2077 726f 6e67 5f63 6861 696e 5f69 642c   wrong_chain_id,
+0001f810: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+0001f820: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0001f830: 6169 7365 7328 0a20 2020 2020 2020 2020  aises(.         
+0001f840: 2020 2057 6562 3356 616c 6964 6174 696f     Web3Validatio
+0001f850: 6e45 7272 6f72 2c0a 2020 2020 2020 2020  nError,.        
+0001f860: 2020 2020 6d61 7463 683d 6622 5468 6520      match=f"The 
+0001f870: 7472 616e 7361 6374 696f 6e20 6465 636c  transaction decl
+0001f880: 6172 6564 2063 6861 696e 2049 4420 7b77  ared chain ID {w
+0001f890: 726f 6e67 5f63 6861 696e 5f69 647d 2c20  rong_chain_id}, 
+0001f8a0: 220a 2020 2020 2020 2020 2020 2020 6622  ".            f"
+0001f8b0: 6275 7420 7468 6520 636f 6e6e 6563 7465  but the connecte
+0001f8c0: 6420 6e6f 6465 2069 7320 6f6e 207b 6163  d node is on {ac
+0001f8d0: 7475 616c 5f63 6861 696e 5f69 647d 222c  tual_chain_id}",
+0001f8e0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+0001f8f0: 2020 2020 2020 2020 7733 2e65 7468 2e73          w3.eth.s
+0001f900: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
+0001f910: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
+0001f920: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
+0001f930: 7261 6d65 7472 697a 6528 0a20 2020 2020  rametrize(.     
+0001f940: 2020 2022 6d61 785f 6665 6522 2c20 2831     "max_fee", (1
+0001f950: 3030 3030 3030 3030 302c 204e 6f6e 6529  000000000, None)
+0001f960: 2c20 6964 733d 5b22 7769 7468 5f6d 6178  , ids=["with_max
+0001f970: 5f66 6565 222c 2022 7769 7468 6f75 745f  _fee", "without_
+0001f980: 6d61 785f 6665 6522 5d0a 2020 2020 290a  max_fee"].    ).
+0001f990: 2020 2020 6465 6620 7465 7374 5f67 6173      def test_gas
+0001f9a0: 5f70 7269 6365 5f66 726f 6d5f 7374 7261  _price_from_stra
+0001f9b0: 7465 6779 5f62 7970 6173 7365 645f 666f  tegy_bypassed_fo
+0001f9c0: 725f 6479 6e61 6d69 635f 6665 655f 7478  r_dynamic_fee_tx
+0001f9d0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+0001f9e0: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
+0001f9f0: 6233 222c 0a20 2020 2020 2020 206b 6579  b3",.        key
+0001fa00: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0001fa10: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+0001fa20: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+0001fa30: 0a20 2020 2020 2020 206d 6178 5f66 6565  .        max_fee
+0001fa40: 3a20 5765 692c 0a20 2020 2029 202d 3e20  : Wei,.    ) -> 
+0001fa50: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d61  None:.        ma
+0001fa60: 785f 7072 696f 7269 7479 5f66 6565 203d  x_priority_fee =
+0001fa70: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
+0001fa80: 7765 6922 290a 2020 2020 2020 2020 7478  wei").        tx
+0001fa90: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
+0001faa0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+0001fab0: 2020 2022 6672 6f6d 223a 206b 6579 6669     "from": keyfi
+0001fac0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+0001fad0: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+0001fae0: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+0001faf0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001fb00: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001fb10: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0001fb20: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+0001fb30: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+0001fb40: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+0001fb50: 2020 2020 2020 226d 6178 5072 696f 7269        "maxPriori
+0001fb60: 7479 4665 6550 6572 4761 7322 3a20 6d61  tyFeePerGas": ma
+0001fb70: 785f 7072 696f 7269 7479 5f66 6565 2c0a  x_priority_fee,.
+0001fb80: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0001fb90: 2020 6966 206d 6178 5f66 6565 2069 7320    if max_fee is 
+0001fba0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001fbb0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+0001fbc0: 203d 2061 7373 6f63 2874 786e 5f70 6172   = assoc(txn_par
+0001fbd0: 616d 732c 2022 6d61 7846 6565 5065 7247  ams, "maxFeePerG
+0001fbe0: 6173 222c 206d 6178 5f66 6565 290a 0a20  as", max_fee).. 
+0001fbf0: 2020 2020 2020 2064 6566 2067 6173 5f70         def gas_p
+0001fc00: 7269 6365 5f73 7472 6174 6567 7928 5f77  rice_strategy(_w
+0001fc10: 333a 2022 5765 6233 222c 205f 7478 6e3a  3: "Web3", _txn:
+0001fc20: 2054 7850 6172 616d 7329 202d 3e20 5765   TxParams) -> We
+0001fc30: 693a 0a20 2020 2020 2020 2020 2020 2072  i:.            r
+0001fc40: 6574 7572 6e20 7733 2e74 6f5f 7765 6928  eturn w3.to_wei(
+0001fc50: 322c 2022 6777 6569 2229 0a0a 2020 2020  2, "gwei")..    
+0001fc60: 2020 2020 7733 2e65 7468 2e73 6574 5f67      w3.eth.set_g
+0001fc70: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+0001fc80: 7928 6761 735f 7072 6963 655f 7374 7261  y(gas_price_stra
+0001fc90: 7465 6779 290a 0a20 2020 2020 2020 2074  tegy)..        t
+0001fca0: 786e 5f68 6173 6820 3d20 7733 2e65 7468  xn_hash = w3.eth
+0001fcb0: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+0001fcc0: 6e28 7478 6e5f 7061 7261 6d73 290a 2020  n(txn_params).  
+0001fcd0: 2020 2020 2020 7478 6e20 3d20 7733 2e65        txn = w3.e
+0001fce0: 7468 2e67 6574 5f74 7261 6e73 6163 7469  th.get_transacti
+0001fcf0: 6f6e 2874 786e 5f68 6173 6829 0a0a 2020  on(txn_hash)..  
+0001fd00: 2020 2020 2020 6c61 7465 7374 5f62 6c6f        latest_blo
+0001fd10: 636b 203d 2077 332e 6574 682e 6765 745f  ck = w3.eth.get_
+0001fd20: 626c 6f63 6b28 226c 6174 6573 7422 290a  block("latest").
+0001fd30: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
+0001fd40: 0a20 2020 2020 2020 2020 2020 2074 786e  .            txn
+0001fd50: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+0001fd60: 203d 3d20 6d61 785f 6665 650a 2020 2020   == max_fee.    
+0001fd70: 2020 2020 2020 2020 6966 206d 6178 5f66          if max_f
+0001fd80: 6565 2069 7320 6e6f 7420 4e6f 6e65 0a20  ee is not None. 
+0001fd90: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0001fda0: 3220 2a20 6c61 7465 7374 5f62 6c6f 636b  2 * latest_block
+0001fdb0: 5b22 6261 7365 4665 6550 6572 4761 7322  ["baseFeePerGas"
+0001fdc0: 5d20 2b20 6d61 785f 7072 696f 7269 7479  ] + max_priority
+0001fdd0: 5f66 6565 0a20 2020 2020 2020 2029 0a20  _fee.        ). 
+0001fde0: 2020 2020 2020 2061 7373 6572 7420 7478         assert tx
+0001fdf0: 6e5b 226d 6178 5072 696f 7269 7479 4665  n["maxPriorityFe
+0001fe00: 6550 6572 4761 7322 5d20 3d3d 206d 6178  ePerGas"] == max
+0001fe10: 5f70 7269 6f72 6974 795f 6665 650a 2020  _priority_fee.  
+0001fe20: 2020 2020 2020 6173 7365 7274 2074 786e        assert txn
+0001fe30: 5b22 6761 7350 7269 6365 225d 203d 3d20  ["gasPrice"] == 
+0001fe40: 7478 6e5b 226d 6178 4665 6550 6572 4761  txn["maxFeePerGa
+0001fe50: 7322 5d0a 0a20 2020 2020 2020 2077 332e  s"]..        w3.
+0001fe60: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
+0001fe70: 655f 7374 7261 7465 6779 284e 6f6e 6529  e_strategy(None)
+0001fe80: 2020 2320 7265 7365 7420 7374 7261 7465    # reset strate
+0001fe90: 6779 0a0a 2020 2020 6465 6620 7465 7374  gy..    def test
+0001fea0: 5f67 6173 5f70 7269 6365 5f66 726f 6d5f  _gas_price_from_
+0001feb0: 7374 7261 7465 6779 5f62 7970 6173 7365  strategy_bypasse
+0001fec0: 645f 666f 725f 6479 6e61 6d69 635f 6665  d_for_dynamic_fe
+0001fed0: 655f 7478 6e5f 6e6f 5f74 6970 280a 2020  e_txn_no_tip(.  
+0001fee0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001fef0: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
+0001ff00: 2020 2020 2020 2020 6b65 7966 696c 655f          keyfile_
+0001ff10: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+0001ff20: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+0001ff30: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
+0001ff40: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0001ff50: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
+0001ff60: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
+0001ff70: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
+0001ff80: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0001ff90: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+0001ffa0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0001ffb0: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
+0001ffc0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+0001ffd0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+0001ffe0: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+0001fff0: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+00020000: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
+00020010: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
+00020020: 6565 5065 7247 6173 223a 2057 6569 2831  eePerGas": Wei(1
+00020030: 3030 3030 3030 3030 3029 2c0a 2020 2020  000000000),.    
+00020040: 2020 2020 7d0a 0a20 2020 2020 2020 2064      }..        d
+00020050: 6566 2067 6173 5f70 7269 6365 5f73 7472  ef gas_price_str
+00020060: 6174 6567 7928 5f77 333a 2022 5765 6233  ategy(_w3: "Web3
+00020070: 222c 205f 7478 6e3a 2054 7850 6172 616d  ", _txn: TxParam
+00020080: 7329 202d 3e20 5765 693a 0a20 2020 2020  s) -> Wei:.     
+00020090: 2020 2020 2020 2072 6574 7572 6e20 7733         return w3
+000200a0: 2e74 6f5f 7765 6928 322c 2022 6777 6569  .to_wei(2, "gwei
+000200b0: 2229 0a0a 2020 2020 2020 2020 7733 2e65  ")..        w3.e
+000200c0: 7468 2e73 6574 5f67 6173 5f70 7269 6365  th.set_gas_price
+000200d0: 5f73 7472 6174 6567 7928 6761 735f 7072  _strategy(gas_pr
+000200e0: 6963 655f 7374 7261 7465 6779 290a 0a20  ice_strategy).. 
+000200f0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00020100: 7374 2e72 6169 7365 7328 0a20 2020 2020  st.raises(.     
+00020110: 2020 2020 2020 2049 6e76 616c 6964 5472         InvalidTr
+00020120: 616e 7361 6374 696f 6e2c 206d 6174 6368  ansaction, match
+00020130: 3d22 6d61 7850 7269 6f72 6974 7946 6565  ="maxPriorityFee
+00020140: 5065 7247 6173 206d 7573 7420 6265 2064  PerGas must be d
+00020150: 6566 696e 6564 220a 2020 2020 2020 2020  efined".        
+00020160: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+00020170: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00020180: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00020190: 7329 0a0a 2020 2020 2020 2020 7733 2e65  s)..        w3.e
+000201a0: 7468 2e73 6574 5f67 6173 5f70 7269 6365  th.set_gas_price
+000201b0: 5f73 7472 6174 6567 7928 4e6f 6e65 2920  _strategy(None) 
+000201c0: 2023 2072 6573 6574 2073 7472 6174 6567   # reset strateg
+000201d0: 790a 0a20 2020 2064 6566 2074 6573 745f  y..    def test_
+000201e0: 6761 735f 7072 6963 655f 7374 7261 7465  gas_price_strate
+000201f0: 6779 5f68 6578 5f76 616c 7565 280a 2020  gy_hex_value(.  
+00020200: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00020210: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+00020220: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00020230: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+00020240: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00020250: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00020260: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00020270: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00020280: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
+00020290: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+000202a0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+000202b0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+000202c0: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
+000202d0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+000202e0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+000202f0: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00020300: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00020310: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00020320: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00020330: 7477 6f5f 6777 6569 5f69 6e5f 7765 6920  two_gwei_in_wei 
+00020340: 3d20 7733 2e74 6f5f 7765 6928 322c 2022  = w3.to_wei(2, "
+00020350: 6777 6569 2229 0a0a 2020 2020 2020 2020  gwei")..        
+00020360: 6465 6620 6761 735f 7072 6963 655f 7374  def gas_price_st
+00020370: 7261 7465 6779 285f 7733 3a20 2257 6562  rategy(_w3: "Web
+00020380: 3322 2c20 5f74 786e 3a20 5478 5061 7261  3", _txn: TxPara
+00020390: 6d73 2920 2d3e 2073 7472 3a0a 2020 2020  ms) -> str:.    
+000203a0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+000203b0: 6578 2874 776f 5f67 7765 695f 696e 5f77  ex(two_gwei_in_w
+000203c0: 6569 290a 0a20 2020 2020 2020 2077 332e  ei)..        w3.
+000203d0: 6574 682e 7365 745f 6761 735f 7072 6963  eth.set_gas_pric
+000203e0: 655f 7374 7261 7465 6779 2867 6173 5f70  e_strategy(gas_p
+000203f0: 7269 6365 5f73 7472 6174 6567 7929 2020  rice_strategy)  
+00020400: 2320 7479 7065 3a20 6967 6e6f 7265 0a0a  # type: ignore..
+00020410: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+00020420: 203d 2077 332e 6574 682e 7365 6e64 5f74   = w3.eth.send_t
+00020430: 7261 6e73 6163 7469 6f6e 2874 786e 5f70  ransaction(txn_p
+00020440: 6172 616d 7329 0a20 2020 2020 2020 2074  arams).        t
+00020450: 786e 203d 2077 332e 6574 682e 6765 745f  xn = w3.eth.get_
+00020460: 7472 616e 7361 6374 696f 6e28 7478 6e5f  transaction(txn_
+00020470: 6861 7368 290a 0a20 2020 2020 2020 2061  hash)..        a
+00020480: 7373 6572 7420 7478 6e5b 2267 6173 5072  ssert txn["gasPr
+00020490: 6963 6522 5d20 3d3d 2074 776f 5f67 7765  ice"] == two_gwe
+000204a0: 695f 696e 5f77 6569 0a20 2020 2020 2020  i_in_wei.       
+000204b0: 2077 332e 6574 682e 7365 745f 6761 735f   w3.eth.set_gas_
+000204c0: 7072 6963 655f 7374 7261 7465 6779 284e  price_strategy(N
+000204d0: 6f6e 6529 2020 2320 7265 7365 7420 7374  one)  # reset st
+000204e0: 7261 7465 6779 0a0a 2020 2020 4066 6c61  rategy..    @fla
+000204f0: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
+00020500: 6e67 0a20 2020 2064 6566 2074 6573 745f  ng.    def test_
+00020510: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
+00020520: 7361 6374 696f 6e5f 6c65 6761 6379 280a  saction_legacy(.
+00020530: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+00020540: 3a20 2257 6562 3322 2c20 6b65 7966 696c  : "Web3", keyfil
+00020550: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00020560: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
+00020570: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00020580: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00020590: 2020 2020 7478 6e5f 7061 7261 6d73 3a20      txn_params: 
+000205a0: 5478 5061 7261 6d73 203d 207b 0a20 2020  TxParams = {.   
+000205b0: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+000205c0: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
+000205d0: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+000205e0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+000205f0: 2274 6f22 3a20 6b65 7966 696c 655f 6163  "to": keyfile_ac
+00020600: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00020610: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
+00020620: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00020630: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00020640: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00020650: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+00020660: 5072 6963 6522 3a20 7733 2e74 6f5f 7765  Price": w3.to_we
+00020670: 6928 0a20 2020 2020 2020 2020 2020 2020  i(.             
+00020680: 2020 2031 2c20 2267 7765 6922 0a20 2020     1, "gwei".   
+00020690: 2020 2020 2020 2020 2029 2c20 2023 206d           ),  # m
+000206a0: 7573 7420 6265 2067 7265 6174 6572 2074  ust be greater t
+000206b0: 6861 6e20 6261 7365 5f66 6565 2070 6f73  han base_fee pos
+000206c0: 7420 4c6f 6e64 6f6e 0a20 2020 2020 2020  t London.       
+000206d0: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+000206e0: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+000206f0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00020700: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
+00020710: 2020 2074 786e 5f70 6172 616d 735b 2267     txn_params["g
+00020720: 6173 5072 6963 6522 5d20 3d20 7733 2e74  asPrice"] = w3.t
+00020730: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
+00020740: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00020750: 5f74 786e 5f68 6173 6820 3d20 7733 2e65  _txn_hash = w3.e
+00020760: 7468 2e72 6570 6c61 6365 5f74 7261 6e73  th.replace_trans
+00020770: 6163 7469 6f6e 2874 786e 5f68 6173 682c  action(txn_hash,
+00020780: 2074 786e 5f70 6172 616d 7329 0a20 2020   txn_params).   
+00020790: 2020 2020 2072 6570 6c61 6365 5f74 786e       replace_txn
+000207a0: 203d 2077 332e 6574 682e 6765 745f 7472   = w3.eth.get_tr
+000207b0: 616e 7361 6374 696f 6e28 7265 706c 6163  ansaction(replac
+000207c0: 655f 7478 6e5f 6861 7368 290a 0a20 2020  e_txn_hash)..   
+000207d0: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+000207e0: 616d 655f 6164 6472 6573 7328 0a20 2020  ame_address(.   
+000207f0: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
+00020800: 5f74 786e 5b22 6672 6f6d 225d 2c20 6361  _txn["from"], ca
+00020810: 7374 2843 6865 636b 7375 6d41 6464 7265  st(ChecksumAddre
+00020820: 7373 2c20 7478 6e5f 7061 7261 6d73 5b22  ss, txn_params["
+00020830: 6672 6f6d 225d 290a 2020 2020 2020 2020  from"]).        
+00020840: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00020850: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+00020860: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+00020870: 706c 6163 655f 7478 6e5b 2274 6f22 5d2c  place_txn["to"],
+00020880: 2063 6173 7428 4368 6563 6b73 756d 4164   cast(ChecksumAd
+00020890: 6472 6573 732c 2074 786e 5f70 6172 616d  dress, txn_param
+000208a0: 735b 2274 6f22 5d29 0a20 2020 2020 2020  s["to"]).       
+000208b0: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+000208c0: 7420 7265 706c 6163 655f 7478 6e5b 2276  t replace_txn["v
+000208d0: 616c 7565 225d 203d 3d20 310a 2020 2020  alue"] == 1.    
+000208e0: 2020 2020 6173 7365 7274 2072 6570 6c61      assert repla
+000208f0: 6365 5f74 786e 5b22 6761 7322 5d20 3d3d  ce_txn["gas"] ==
+00020900: 2032 3130 3030 0a20 2020 2020 2020 2061   21000.        a
+00020910: 7373 6572 7420 7265 706c 6163 655f 7478  ssert replace_tx
+00020920: 6e5b 2267 6173 5072 6963 6522 5d20 3d3d  n["gasPrice"] ==
+00020930: 2074 786e 5f70 6172 616d 735b 2267 6173   txn_params["gas
+00020940: 5072 6963 6522 5d0a 0a20 2020 2040 666c  Price"]..    @fl
+00020950: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+00020960: 696e 670a 2020 2020 6465 6620 7465 7374  ing.    def test
+00020970: 5f65 7468 5f72 6570 6c61 6365 5f74 7261  _eth_replace_tra
+00020980: 6e73 6163 7469 6f6e 280a 2020 2020 2020  nsaction(.      
+00020990: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+000209a0: 3322 2c20 6b65 7966 696c 655f 6163 636f  3", keyfile_acco
+000209b0: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+000209c0: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+000209d0: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+000209e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7477  None:.        tw
+000209f0: 6f5f 6777 6569 5f69 6e5f 7765 6920 3d20  o_gwei_in_wei = 
+00020a00: 7733 2e74 6f5f 7765 6928 322c 2022 6777  w3.to_wei(2, "gw
+00020a10: 6569 2229 0a20 2020 2020 2020 2074 6872  ei").        thr
+00020a20: 6565 5f67 7765 695f 696e 5f77 6569 203d  ee_gwei_in_wei =
+00020a30: 2077 332e 746f 5f77 6569 2833 2c20 2267   w3.to_wei(3, "g
+00020a40: 7765 6922 290a 0a20 2020 2020 2020 2074  wei")..        t
+00020a50: 786e 5f70 6172 616d 733a 2054 7850 6172  xn_params: TxPar
+00020a60: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+00020a70: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
+00020a80: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00020a90: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
+00020aa0: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
+00020ab0: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
+00020ac0: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+00020ad0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00020ae0: 2276 616c 7565 223a 2057 6569 2831 292c  "value": Wei(1),
+00020af0: 0a20 2020 2020 2020 2020 2020 2022 6761  .            "ga
+00020b00: 7322 3a20 3231 3030 302c 0a20 2020 2020  s": 21000,.     
+00020b10: 2020 2020 2020 2022 6d61 7846 6565 5065         "maxFeePe
+00020b20: 7247 6173 223a 2074 776f 5f67 7765 695f  rGas": two_gwei_
+00020b30: 696e 5f77 6569 2c0a 2020 2020 2020 2020  in_wei,.        
+00020b40: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
+00020b50: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
+00020b60: 6f5f 7765 6928 312c 2022 6777 6569 2229  o_wei(1, "gwei")
+00020b70: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00020b80: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
+00020b90: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+00020ba0: 6163 7469 6f6e 2874 786e 5f70 6172 616d  action(txn_param
+00020bb0: 7329 0a0a 2020 2020 2020 2020 7478 6e5f  s)..        txn_
+00020bc0: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
+00020bd0: 7247 6173 225d 203d 2074 6872 6565 5f67  rGas"] = three_g
+00020be0: 7765 695f 696e 5f77 6569 0a20 2020 2020  wei_in_wei.     
+00020bf0: 2020 2074 786e 5f70 6172 616d 735b 226d     txn_params["m
+00020c00: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00020c10: 4761 7322 5d20 3d20 7477 6f5f 6777 6569  Gas"] = two_gwei
+00020c20: 5f69 6e5f 7765 690a 0a20 2020 2020 2020  _in_wei..       
+00020c30: 2072 6570 6c61 6365 5f74 786e 5f68 6173   replace_txn_has
+00020c40: 6820 3d20 7733 2e65 7468 2e72 6570 6c61  h = w3.eth.repla
+00020c50: 6365 5f74 7261 6e73 6163 7469 6f6e 2874  ce_transaction(t
+00020c60: 786e 5f68 6173 682c 2074 786e 5f70 6172  xn_hash, txn_par
+00020c70: 616d 7329 0a20 2020 2020 2020 2072 6570  ams).        rep
+00020c80: 6c61 6365 5f74 786e 203d 2077 332e 6574  lace_txn = w3.et
+00020c90: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00020ca0: 6e28 7265 706c 6163 655f 7478 6e5f 6861  n(replace_txn_ha
+00020cb0: 7368 290a 0a20 2020 2020 2020 2061 7373  sh)..        ass
+00020cc0: 6572 7420 6973 5f73 616d 655f 6164 6472  ert is_same_addr
+00020cd0: 6573 7328 0a20 2020 2020 2020 2020 2020  ess(.           
+00020ce0: 2072 6570 6c61 6365 5f74 786e 5b22 6672   replace_txn["fr
+00020cf0: 6f6d 225d 2c20 6361 7374 2843 6865 636b  om"], cast(Check
+00020d00: 7375 6d41 6464 7265 7373 2c20 7478 6e5f  sumAddress, txn_
+00020d10: 7061 7261 6d73 5b22 6672 6f6d 225d 290a  params["from"]).
+00020d20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00020d30: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+00020d40: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
+00020d50: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
+00020d60: 6e5b 2274 6f22 5d2c 2063 6173 7428 4368  n["to"], cast(Ch
+00020d70: 6563 6b73 756d 4164 6472 6573 732c 2074  ecksumAddress, t
+00020d80: 786e 5f70 6172 616d 735b 2274 6f22 5d29  xn_params["to"])
+00020d90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00020da0: 2020 2061 7373 6572 7420 7265 706c 6163     assert replac
+00020db0: 655f 7478 6e5b 2276 616c 7565 225d 203d  e_txn["value"] =
+00020dc0: 3d20 310a 2020 2020 2020 2020 6173 7365  = 1.        asse
+00020dd0: 7274 2072 6570 6c61 6365 5f74 786e 5b22  rt replace_txn["
+00020de0: 6761 7322 5d20 3d3d 2032 3130 3030 0a20  gas"] == 21000. 
+00020df0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00020e00: 706c 6163 655f 7478 6e5b 226d 6178 4665  place_txn["maxFe
+00020e10: 6550 6572 4761 7322 5d20 3d3d 2074 6872  ePerGas"] == thr
+00020e20: 6565 5f67 7765 695f 696e 5f77 6569 0a20  ee_gwei_in_wei. 
+00020e30: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+00020e40: 706c 6163 655f 7478 6e5b 226d 6178 5072  place_txn["maxPr
+00020e50: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00020e60: 5d20 3d3d 2074 776f 5f67 7765 695f 696e  ] == two_gwei_in
+00020e70: 5f77 6569 0a0a 2020 2020 4066 6c61 6b79  _wei..    @flaky
+00020e80: 5f67 6574 685f 6465 765f 6d69 6e69 6e67  _geth_dev_mining
+00020e90: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00020ea0: 685f 7265 706c 6163 655f 7472 616e 7361  h_replace_transa
+00020eb0: 6374 696f 6e5f 756e 6465 7270 7269 6365  ction_underprice
+00020ec0: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
+00020ed0: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
+00020ee0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00020ef0: 7265 7373 5f64 7561 6c5f 7479 7065 3a20  ress_dual_type: 
+00020f00: 4368 6563 6b73 756d 4164 6472 6573 730a  ChecksumAddress.
+00020f10: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00020f20: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00020f30: 733a 2054 7850 6172 616d 7320 3d20 7b0a  s: TxParams = {.
+00020f40: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+00020f50: 6d22 3a20 6b65 7966 696c 655f 6163 636f  m": keyfile_acco
+00020f60: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+00020f70: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+00020f80: 2020 2022 746f 223a 206b 6579 6669 6c65     "to": keyfile
+00020f90: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00020fa0: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00020fb0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00020fc0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00020fd0: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00020fe0: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00020ff0: 6d61 7846 6565 5065 7247 6173 223a 2077  maxFeePerGas": w
+00021000: 332e 746f 5f77 6569 2833 2c20 2267 7765  3.to_wei(3, "gwe
+00021010: 6922 292c 0a20 2020 2020 2020 2020 2020  i"),.           
+00021020: 2022 6d61 7850 7269 6f72 6974 7946 6565   "maxPriorityFee
+00021030: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
+00021040: 6569 2832 2c20 2267 7765 6922 292c 0a20  ei(2, "gwei"),. 
+00021050: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00021060: 2074 786e 5f68 6173 6820 3d20 7733 2e65   txn_hash = w3.e
+00021070: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
+00021080: 696f 6e28 7478 6e5f 7061 7261 6d73 290a  ion(txn_params).
+00021090: 0a20 2020 2020 2020 206f 6e65 5f67 7765  .        one_gwe
+000210a0: 695f 696e 5f77 6569 203d 2077 332e 746f  i_in_wei = w3.to
+000210b0: 5f77 6569 2831 2c20 2267 7765 6922 290a  _wei(1, "gwei").
+000210c0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+000210d0: 6d73 5b22 6d61 7846 6565 5065 7247 6173  ms["maxFeePerGas
+000210e0: 225d 203d 206f 6e65 5f67 7765 695f 696e  "] = one_gwei_in
+000210f0: 5f77 6569 0a20 2020 2020 2020 2074 786e  _wei.        txn
+00021100: 5f70 6172 616d 735b 226d 6178 5072 696f  _params["maxPrio
+00021110: 7269 7479 4665 6550 6572 4761 7322 5d20  rityFeePerGas"] 
+00021120: 3d20 6f6e 655f 6777 6569 5f69 6e5f 7765  = one_gwei_in_we
+00021130: 690a 0a20 2020 2020 2020 2077 6974 6820  i..        with 
+00021140: 7079 7465 7374 2e72 6169 7365 7328 5765  pytest.raises(We
+00021150: 6233 5250 4345 7272 6f72 2c20 6d61 7463  b3RPCError, matc
+00021160: 683d 2272 6570 6c61 6365 6d65 6e74 2074  h="replacement t
+00021170: 7261 6e73 6163 7469 6f6e 2075 6e64 6572  ransaction under
+00021180: 7072 6963 6564 2229 3a0a 2020 2020 2020  priced"):.      
+00021190: 2020 2020 2020 7733 2e65 7468 2e72 6570        w3.eth.rep
+000211a0: 6c61 6365 5f74 7261 6e73 6163 7469 6f6e  lace_transaction
+000211b0: 2874 786e 5f68 6173 682c 2074 786e 5f70  (txn_hash, txn_p
+000211c0: 6172 616d 7329 0a0a 2020 2020 4066 6c61  arams)..    @fla
+000211d0: 6b79 5f67 6574 685f 6465 765f 6d69 6e69  ky_geth_dev_mini
+000211e0: 6e67 0a20 2020 2064 6566 2074 6573 745f  ng.    def test_
+000211f0: 6574 685f 7265 706c 6163 655f 7472 616e  eth_replace_tran
+00021200: 7361 6374 696f 6e5f 6e6f 6e5f 6578 6973  saction_non_exis
+00021210: 7469 6e67 5f74 7261 6e73 6163 7469 6f6e  ting_transaction
+00021220: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00021230: 7733 3a20 2257 6562 3322 2c20 6b65 7966  w3: "Web3", keyf
+00021240: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00021250: 6573 735f 6475 616c 5f74 7970 653a 2043  ess_dual_type: C
+00021260: 6865 636b 7375 6d41 6464 7265 7373 0a20  hecksumAddress. 
+00021270: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00021280: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
+00021290: 3a20 5478 5061 7261 6d73 203d 207b 0a20  : TxParams = {. 
+000212a0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+000212b0: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
+000212c0: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
+000212d0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000212e0: 2020 2274 6f22 3a20 6b65 7966 696c 655f    "to": keyfile_
+000212f0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00021300: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
+00021310: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
+00021320: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
+00021330: 2020 2020 2267 6173 223a 2032 3130 3030      "gas": 21000
+00021340: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00021350: 6178 4665 6550 6572 4761 7322 3a20 7733  axFeePerGas": w3
+00021360: 2e74 6f5f 7765 6928 332c 2022 6777 6569  .to_wei(3, "gwei
+00021370: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00021380: 226d 6178 5072 696f 7269 7479 4665 6550  "maxPriorityFeeP
+00021390: 6572 4761 7322 3a20 7733 2e74 6f5f 7765  erGas": w3.to_we
+000213a0: 6928 312c 2022 6777 6569 2229 2c0a 2020  i(1, "gwei"),.  
+000213b0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+000213c0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+000213d0: 6573 2854 7261 6e73 6163 7469 6f6e 4e6f  es(TransactionNo
+000213e0: 7446 6f75 6e64 293a 0a20 2020 2020 2020  tFound):.       
+000213f0: 2020 2020 2077 332e 6574 682e 7265 706c       w3.eth.repl
+00021400: 6163 655f 7472 616e 7361 6374 696f 6e28  ace_transaction(
+00021410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021420: 2048 6578 5374 7228 0a20 2020 2020 2020   HexStr(.       
+00021430: 2020 2020 2020 2020 2020 2020 2022 3078               "0x
+00021440: 3938 6538 6363 3039 6233 3131 3538 3363  98e8cc09b311583c
+00021450: 3530 3739 6661 3630 3066 3663 3261 3362  5079fa600f6c2a3b
+00021460: 6561 3836 3131 6166 3136 3863 3532 6534  ea8611af168c52e4
+00021470: 6236 3062 3562 3234 3361 3434 3139 3937  b60b5b243a441997
+00021480: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00021490: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+000214a0: 2020 2020 2074 786e 5f70 6172 616d 732c       txn_params,
+000214b0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000214c0: 2020 2020 4066 6c61 6b79 5f67 6574 685f      @flaky_geth_
+000214d0: 6465 765f 6d69 6e69 6e67 0a20 2020 2064  dev_mining.    d
+000214e0: 6566 2074 6573 745f 6574 685f 7265 706c  ef test_eth_repl
+000214f0: 6163 655f 7472 616e 7361 6374 696f 6e5f  ace_transaction_
+00021500: 616c 7265 6164 795f 6d69 6e65 6428 0a20  already_mined(. 
+00021510: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+00021520: 2022 5765 6233 222c 206b 6579 6669 6c65   "Web3", keyfile
+00021530: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00021540: 5f64 7561 6c5f 7479 7065 3a20 4368 6563  _dual_type: Chec
+00021550: 6b73 756d 4164 6472 6573 730a 2020 2020  ksumAddress.    
+00021560: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00021570: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
+00021580: 7850 6172 616d 7320 3d20 7b0a 2020 2020  xParams = {.    
+00021590: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
+000215a0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+000215b0: 6164 6472 6573 735f 6475 616c 5f74 7970  address_dual_typ
+000215c0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+000215d0: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
+000215e0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+000215f0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00021600: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
+00021610: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
+00021620: 2022 6761 7322 3a20 3231 3030 302c 0a20   "gas": 21000,. 
+00021630: 2020 2020 2020 2020 2020 2022 6d61 7846             "maxF
+00021640: 6565 5065 7247 6173 223a 2077 332e 746f  eePerGas": w3.to
+00021650: 5f77 6569 2832 2c20 2267 7765 6922 292c  _wei(2, "gwei"),
+00021660: 0a20 2020 2020 2020 2020 2020 2022 6d61  .            "ma
+00021670: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00021680: 6173 223a 2077 332e 746f 5f77 6569 2831  as": w3.to_wei(1
+00021690: 2c20 2267 7765 6922 292c 0a20 2020 2020  , "gwei"),.     
+000216a0: 2020 207d 0a20 2020 2020 2020 2074 786e     }.        txn
+000216b0: 5f68 6173 6820 3d20 7733 2e65 7468 2e73  _hash = w3.eth.s
+000216c0: 656e 645f 7472 616e 7361 6374 696f 6e28  end_transaction(
+000216d0: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
+000216e0: 2020 2020 7733 2e65 7468 2e77 6169 745f      w3.eth.wait_
+000216f0: 666f 725f 7472 616e 7361 6374 696f 6e5f  for_transaction_
+00021700: 7265 6365 6970 7428 7478 6e5f 6861 7368  receipt(txn_hash
+00021710: 2c20 7469 6d65 6f75 743d 3130 290a 0a20  , timeout=10).. 
+00021720: 2020 2020 2020 2074 786e 5f70 6172 616d         txn_param
+00021730: 735b 226d 6178 4665 6550 6572 4761 7322  s["maxFeePerGas"
+00021740: 5d20 3d20 7733 2e74 6f5f 7765 6928 332c  ] = w3.to_wei(3,
+00021750: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
+00021760: 2074 786e 5f70 6172 616d 735b 226d 6178   txn_params["max
+00021770: 5072 696f 7269 7479 4665 6550 6572 4761  PriorityFeePerGa
+00021780: 7322 5d20 3d20 7733 2e74 6f5f 7765 6928  s"] = w3.to_wei(
+00021790: 322c 2022 6777 6569 2229 0a20 2020 2020  2, "gwei").     
+000217a0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+000217b0: 6169 7365 7328 5765 6233 5661 6c75 6545  aises(Web3ValueE
+000217c0: 7272 6f72 2c20 6d61 7463 683d 2253 7570  rror, match="Sup
+000217d0: 706c 6965 6420 7472 616e 7361 6374 696f  plied transactio
+000217e0: 6e20 7769 7468 2068 6173 6822 293a 0a20  n with hash"):. 
+000217f0: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+00021800: 682e 7265 706c 6163 655f 7472 616e 7361  h.replace_transa
+00021810: 6374 696f 6e28 7478 6e5f 6861 7368 2c20  ction(txn_hash, 
+00021820: 7478 6e5f 7061 7261 6d73 290a 0a20 2020  txn_params)..   
+00021830: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
+00021840: 5f6d 696e 696e 670a 2020 2020 6465 6620  _mining.    def 
+00021850: 7465 7374 5f65 7468 5f72 6570 6c61 6365  test_eth_replace
+00021860: 5f74 7261 6e73 6163 7469 6f6e 5f69 6e63  _transaction_inc
+00021870: 6f72 7265 6374 5f6e 6f6e 6365 280a 2020  orrect_nonce(.  
+00021880: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00021890: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+000218a0: 6163 636f 756e 745f 6164 6472 6573 733a  account_address:
+000218b0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+000218c0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000218d0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+000218e0: 6d73 3a20 5478 5061 7261 6d73 203d 207b  ms: TxParams = {
+000218f0: 0a20 2020 2020 2020 2020 2020 2022 6672  .            "fr
+00021900: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
+00021910: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
+00021920: 2020 2020 2020 2020 2020 2274 6f22 3a20            "to": 
+00021930: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00021940: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
+00021950: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00021960: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00021970: 2020 2267 6173 223a 2032 3130 3030 2c0a    "gas": 21000,.
+00021980: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00021990: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
+000219a0: 6f5f 7765 6928 322c 2022 6777 6569 2229  o_wei(2, "gwei")
+000219b0: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+000219c0: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+000219d0: 4761 7322 3a20 7733 2e74 6f5f 7765 6928  Gas": w3.to_wei(
+000219e0: 312c 2022 6777 6569 2229 2c0a 2020 2020  1, "gwei"),.    
+000219f0: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00021a00: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
+00021a10: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+00021a20: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+00021a30: 2020 2020 2074 786e 203d 2077 332e 6574       txn = w3.et
+00021a40: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00021a50: 6e28 7478 6e5f 6861 7368 290a 0a20 2020  n(txn_hash)..   
+00021a60: 2020 2020 2074 786e 5f70 6172 616d 735b       txn_params[
+00021a70: 226d 6178 4665 6550 6572 4761 7322 5d20  "maxFeePerGas"] 
+00021a80: 3d20 7733 2e74 6f5f 7765 6928 332c 2022  = w3.to_wei(3, "
+00021a90: 6777 6569 2229 0a20 2020 2020 2020 2074  gwei").        t
+00021aa0: 786e 5f70 6172 616d 735b 226d 6178 5072  xn_params["maxPr
+00021ab0: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00021ac0: 5d20 3d20 7733 2e74 6f5f 7765 6928 322c  ] = w3.to_wei(2,
+00021ad0: 2022 6777 6569 2229 0a20 2020 2020 2020   "gwei").       
+00021ae0: 2074 786e 5f70 6172 616d 735b 226e 6f6e   txn_params["non
+00021af0: 6365 225d 203d 204e 6f6e 6365 2874 786e  ce"] = Nonce(txn
+00021b00: 5b22 6e6f 6e63 6522 5d20 2b20 3129 0a20  ["nonce"] + 1). 
+00021b10: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00021b20: 7374 2e72 6169 7365 7328 5765 6233 5661  st.raises(Web3Va
+00021b30: 6c75 6545 7272 6f72 293a 0a20 2020 2020  lueError):.     
+00021b40: 2020 2020 2020 2077 332e 6574 682e 7265         w3.eth.re
+00021b50: 706c 6163 655f 7472 616e 7361 6374 696f  place_transactio
+00021b60: 6e28 7478 6e5f 6861 7368 2c20 7478 6e5f  n(txn_hash, txn_
+00021b70: 7061 7261 6d73 290a 0a20 2020 2040 666c  params)..    @fl
+00021b80: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+00021b90: 696e 670a 2020 2020 6465 6620 7465 7374  ing.    def test
+00021ba0: 5f65 7468 5f72 6570 6c61 6365 5f74 7261  _eth_replace_tra
+00021bb0: 6e73 6163 7469 6f6e 5f67 6173 5f70 7269  nsaction_gas_pri
+00021bc0: 6365 5f74 6f6f 5f6c 6f77 280a 2020 2020  ce_too_low(.    
+00021bd0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+00021be0: 6562 3322 2c20 6b65 7966 696c 655f 6163  eb3", keyfile_ac
+00021bf0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
+00021c00: 616c 5f74 7970 653a 2043 6865 636b 7375  al_type: Checksu
+00021c10: 6d41 6464 7265 7373 0a20 2020 2029 202d  mAddress.    ) -
+00021c20: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00021c30: 7478 6e5f 7061 7261 6d73 3a20 5478 5061  txn_params: TxPa
+00021c40: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+00021c50: 2020 2020 2022 6672 6f6d 223a 206b 6579       "from": key
+00021c60: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00021c70: 7265 7373 5f64 7561 6c5f 7479 7065 2c0a  ress_dual_type,.
+00021c80: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00021c90: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00021ca0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+00021cb0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00021cc0: 2022 7661 6c75 6522 3a20 5765 6928 3129   "value": Wei(1)
+00021cd0: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00021ce0: 6173 223a 2032 3130 3030 2c0a 2020 2020  as": 21000,.    
+00021cf0: 2020 2020 2020 2020 2267 6173 5072 6963          "gasPric
+00021d00: 6522 3a20 7733 2e74 6f5f 7765 6928 322c  e": w3.to_wei(2,
+00021d10: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00021d20: 2020 7d0a 2020 2020 2020 2020 7478 6e5f    }.        txn_
+00021d30: 6861 7368 203d 2077 332e 6574 682e 7365  hash = w3.eth.se
+00021d40: 6e64 5f74 7261 6e73 6163 7469 6f6e 2874  nd_transaction(t
+00021d50: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
+00021d60: 2020 2020 7478 6e5f 7061 7261 6d73 5b22      txn_params["
+00021d70: 6761 7350 7269 6365 225d 203d 2077 332e  gasPrice"] = w3.
+00021d80: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
+00021d90: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00021da0: 7974 6573 742e 7261 6973 6573 2857 6562  ytest.raises(Web
+00021db0: 3356 616c 7565 4572 726f 7229 3a0a 2020  3ValueError):.  
+00021dc0: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
+00021dd0: 2e72 6570 6c61 6365 5f74 7261 6e73 6163  .replace_transac
+00021de0: 7469 6f6e 2874 786e 5f68 6173 682c 2074  tion(txn_hash, t
+00021df0: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
+00021e00: 4066 6c61 6b79 5f67 6574 685f 6465 765f  @flaky_geth_dev_
+00021e10: 6d69 6e69 6e67 0a20 2020 2064 6566 2074  mining.    def t
+00021e20: 6573 745f 6574 685f 7265 706c 6163 655f  est_eth_replace_
+00021e30: 7472 616e 7361 6374 696f 6e5f 6761 735f  transaction_gas_
+00021e40: 7072 6963 655f 6465 6661 756c 7469 6e67  price_defaulting
+00021e50: 5f6d 696e 696d 756d 280a 2020 2020 2020  _minimum(.      
+00021e60: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00021e70: 3322 2c20 6b65 7966 696c 655f 6163 636f  3", keyfile_acco
+00021e80: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
+00021e90: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+00021ea0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00021eb0: 2020 2020 6761 735f 7072 6963 6520 3d20      gas_price = 
+00021ec0: 7733 2e74 6f5f 7765 6928 312c 2022 6777  w3.to_wei(1, "gw
+00021ed0: 6569 2229 0a0a 2020 2020 2020 2020 7478  ei")..        tx
+00021ee0: 6e5f 7061 7261 6d73 3a20 5478 5061 7261  n_params: TxPara
+00021ef0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00021f00: 2020 2022 6672 6f6d 223a 206b 6579 6669     "from": keyfi
+00021f10: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+00021f20: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
+00021f30: 2274 6f22 3a20 6b65 7966 696c 655f 6163  "to": keyfile_ac
+00021f40: 636f 756e 745f 6164 6472 6573 732c 0a20  count_address,. 
+00021f50: 2020 2020 2020 2020 2020 2022 7661 6c75             "valu
+00021f60: 6522 3a20 5765 6928 3129 2c0a 2020 2020  e": Wei(1),.    
+00021f70: 2020 2020 2020 2020 2267 6173 223a 2032          "gas": 2
+00021f80: 3130 3030 2c0a 2020 2020 2020 2020 2020  1000,.          
+00021f90: 2020 2267 6173 5072 6963 6522 3a20 6761    "gasPrice": ga
+00021fa0: 735f 7072 6963 652c 0a20 2020 2020 2020  s_price,.       
+00021fb0: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+00021fc0: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+00021fd0: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00021fe0: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
+00021ff0: 2020 2074 786e 5f70 6172 616d 732e 706f     txn_params.po
+00022000: 7028 2267 6173 5072 6963 6522 290a 2020  p("gasPrice").  
+00022010: 2020 2020 2020 7265 706c 6163 655f 7478        replace_tx
+00022020: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
+00022030: 7265 706c 6163 655f 7472 616e 7361 6374  replace_transact
+00022040: 696f 6e28 7478 6e5f 6861 7368 2c20 7478  ion(txn_hash, tx
+00022050: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
+00022060: 2020 7265 706c 6163 655f 7478 6e20 3d20    replace_txn = 
+00022070: 7733 2e65 7468 2e67 6574 5f74 7261 6e73  w3.eth.get_trans
+00022080: 6163 7469 6f6e 2872 6570 6c61 6365 5f74  action(replace_t
+00022090: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
+000220a0: 2020 6173 7365 7274 2072 6570 6c61 6365    assert replace
+000220b0: 5f74 786e 5b22 6761 7350 7269 6365 225d  _txn["gasPrice"]
+000220c0: 203d 3d20 6d61 7468 2e63 6569 6c28 0a20   == math.ceil(. 
+000220d0: 2020 2020 2020 2020 2020 2067 6173 5f70             gas_p
+000220e0: 7269 6365 202a 2031 2e31 3235 0a20 2020  rice * 1.125.   
+000220f0: 2020 2020 2029 2020 2320 6d69 6e69 6d75       )  # minimu
+00022100: 6d20 6761 7320 7072 6963 650a 0a20 2020  m gas price..   
+00022110: 2040 666c 616b 795f 6765 7468 5f64 6576   @flaky_geth_dev
+00022120: 5f6d 696e 696e 670a 2020 2020 6465 6620  _mining.    def 
+00022130: 7465 7374 5f65 7468 5f72 6570 6c61 6365  test_eth_replace
+00022140: 5f74 7261 6e73 6163 7469 6f6e 5f67 6173  _transaction_gas
+00022150: 5f70 7269 6365 5f64 6566 6175 6c74 696e  _price_defaultin
+00022160: 675f 7374 7261 7465 6779 5f68 6967 6865  g_strategy_highe
+00022170: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+00022180: 2077 333a 2022 5765 6233 222c 206b 6579   w3: "Web3", key
+00022190: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+000221a0: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
+000221b0: 6472 6573 730a 2020 2020 2920 2d3e 204e  dress.    ) -> N
+000221c0: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
+000221d0: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
+000221e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+000221f0: 2020 2266 726f 6d22 3a20 6b65 7966 696c    "from": keyfil
+00022200: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00022210: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
+00022220: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
+00022230: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
+00022240: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+00022250: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+00022260: 2020 2020 2020 2022 6761 7322 3a20 3231         "gas": 21
+00022270: 3030 302c 0a20 2020 2020 2020 2020 2020  000,.           
+00022280: 2022 6761 7350 7269 6365 223a 2077 332e   "gasPrice": w3.
+00022290: 746f 5f77 6569 2831 2c20 2267 7765 6922  to_wei(1, "gwei"
+000222a0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+000222b0: 2020 2020 2074 786e 5f68 6173 6820 3d20       txn_hash = 
+000222c0: 7733 2e65 7468 2e73 656e 645f 7472 616e  w3.eth.send_tran
+000222d0: 7361 6374 696f 6e28 7478 6e5f 7061 7261  saction(txn_para
+000222e0: 6d73 290a 0a20 2020 2020 2020 2074 776f  ms)..        two
+000222f0: 5f67 7765 695f 696e 5f77 6569 203d 2077  _gwei_in_wei = w
+00022300: 332e 746f 5f77 6569 2832 2c20 2267 7765  3.to_wei(2, "gwe
+00022310: 6922 290a 0a20 2020 2020 2020 2064 6566  i")..        def
+00022320: 2068 6967 6865 725f 6761 735f 7072 6963   higher_gas_pric
+00022330: 655f 7374 7261 7465 6779 2877 333a 2022  e_strategy(w3: "
+00022340: 5765 6233 222c 2074 786e 3a20 5478 5061  Web3", txn: TxPa
+00022350: 7261 6d73 2920 2d3e 2057 6569 3a0a 2020  rams) -> Wei:.  
+00022360: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00022370: 2074 776f 5f67 7765 695f 696e 5f77 6569   two_gwei_in_wei
+00022380: 0a0a 2020 2020 2020 2020 7733 2e65 7468  ..        w3.eth
+00022390: 2e73 6574 5f67 6173 5f70 7269 6365 5f73  .set_gas_price_s
+000223a0: 7472 6174 6567 7928 6869 6768 6572 5f67  trategy(higher_g
+000223b0: 6173 5f70 7269 6365 5f73 7472 6174 6567  as_price_strateg
+000223c0: 7929 0a0a 2020 2020 2020 2020 7478 6e5f  y)..        txn_
+000223d0: 7061 7261 6d73 2e70 6f70 2822 6761 7350  params.pop("gasP
+000223e0: 7269 6365 2229 0a20 2020 2020 2020 2072  rice").        r
+000223f0: 6570 6c61 6365 5f74 786e 5f68 6173 6820  eplace_txn_hash 
+00022400: 3d20 7733 2e65 7468 2e72 6570 6c61 6365  = w3.eth.replace
+00022410: 5f74 7261 6e73 6163 7469 6f6e 2874 786e  _transaction(txn
+00022420: 5f68 6173 682c 2074 786e 5f70 6172 616d  _hash, txn_param
+00022430: 7329 0a20 2020 2020 2020 2072 6570 6c61  s).        repla
+00022440: 6365 5f74 786e 203d 2077 332e 6574 682e  ce_txn = w3.eth.
+00022450: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
+00022460: 7265 706c 6163 655f 7478 6e5f 6861 7368  replace_txn_hash
+00022470: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00022480: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
+00022490: 6570 6c61 6365 5f74 786e 5b22 6761 7350  eplace_txn["gasP
+000224a0: 7269 6365 225d 203d 3d20 7477 6f5f 6777  rice"] == two_gw
+000224b0: 6569 5f69 6e5f 7765 690a 2020 2020 2020  ei_in_wei.      
+000224c0: 2020 2920 2023 2053 7472 6174 6567 7920    )  # Strategy 
+000224d0: 7072 6f76 6964 6573 2068 6967 6865 7220  provides higher 
+000224e0: 6761 7320 7072 6963 650a 2020 2020 2020  gas price.      
+000224f0: 2020 7733 2e65 7468 2e73 6574 5f67 6173    w3.eth.set_gas
+00022500: 5f70 7269 6365 5f73 7472 6174 6567 7928  _price_strategy(
+00022510: 4e6f 6e65 2920 2023 2072 6573 6574 2073  None)  # reset s
+00022520: 7472 6174 6567 790a 0a20 2020 2040 666c  trategy..    @fl
+00022530: 616b 795f 6765 7468 5f64 6576 5f6d 696e  aky_geth_dev_min
+00022540: 696e 670a 2020 2020 6465 6620 7465 7374  ing.    def test
+00022550: 5f65 7468 5f72 6570 6c61 6365 5f74 7261  _eth_replace_tra
+00022560: 6e73 6163 7469 6f6e 5f67 6173 5f70 7269  nsaction_gas_pri
+00022570: 6365 5f64 6566 6175 6c74 696e 675f 7374  ce_defaulting_st
+00022580: 7261 7465 6779 5f6c 6f77 6572 280a 2020  rategy_lower(.  
+00022590: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+000225a0: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+000225b0: 6163 636f 756e 745f 6164 6472 6573 733a  account_address:
+000225c0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+000225d0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000225e0: 2020 2020 2020 2020 6761 735f 7072 6963          gas_pric
+000225f0: 6520 3d20 7733 2e74 6f5f 7765 6928 322c  e = w3.to_wei(2,
+00022600: 2022 6777 6569 2229 0a0a 2020 2020 2020   "gwei")..      
+00022610: 2020 7478 6e5f 7061 7261 6d73 3a20 5478    txn_params: Tx
+00022620: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+00022630: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
+00022640: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00022650: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00022660: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
+00022670: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+00022680: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
+00022690: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
+000226a0: 2020 2020 2020 2020 2020 2020 2267 6173              "gas
+000226b0: 223a 2032 3130 3030 2c0a 2020 2020 2020  ": 21000,.      
+000226c0: 2020 2020 2020 2267 6173 5072 6963 6522        "gasPrice"
+000226d0: 3a20 6761 735f 7072 6963 652c 0a20 2020  : gas_price,.   
+000226e0: 2020 2020 207d 0a20 2020 2020 2020 2074       }.        t
+000226f0: 786e 5f68 6173 6820 3d20 7733 2e65 7468  xn_hash = w3.eth
+00022700: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+00022710: 6e28 7478 6e5f 7061 7261 6d73 290a 0a20  n(txn_params).. 
+00022720: 2020 2020 2020 2064 6566 206c 6f77 6572         def lower
+00022730: 5f67 6173 5f70 7269 6365 5f73 7472 6174  _gas_price_strat
+00022740: 6567 7928 7733 3a20 2257 6562 3322 2c20  egy(w3: "Web3", 
+00022750: 7478 6e3a 2054 7850 6172 616d 7329 202d  txn: TxParams) -
+00022760: 3e20 5765 693a 0a20 2020 2020 2020 2020  > Wei:.         
+00022770: 2020 2072 6574 7572 6e20 7733 2e74 6f5f     return w3.to_
+00022780: 7765 6928 312c 2022 6777 6569 2229 0a0a  wei(1, "gwei")..
+00022790: 2020 2020 2020 2020 7733 2e65 7468 2e73          w3.eth.s
+000227a0: 6574 5f67 6173 5f70 7269 6365 5f73 7472  et_gas_price_str
+000227b0: 6174 6567 7928 6c6f 7765 725f 6761 735f  ategy(lower_gas_
+000227c0: 7072 6963 655f 7374 7261 7465 6779 290a  price_strategy).
+000227d0: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+000227e0: 616d 732e 706f 7028 2267 6173 5072 6963  ams.pop("gasPric
+000227f0: 6522 290a 2020 2020 2020 2020 7265 706c  e").        repl
+00022800: 6163 655f 7478 6e5f 6861 7368 203d 2077  ace_txn_hash = w
+00022810: 332e 6574 682e 7265 706c 6163 655f 7472  3.eth.replace_tr
+00022820: 616e 7361 6374 696f 6e28 7478 6e5f 6861  ansaction(txn_ha
+00022830: 7368 2c20 7478 6e5f 7061 7261 6d73 290a  sh, txn_params).
+00022840: 2020 2020 2020 2020 7265 706c 6163 655f          replace_
+00022850: 7478 6e20 3d20 7733 2e65 7468 2e67 6574  txn = w3.eth.get
+00022860: 5f74 7261 6e73 6163 7469 6f6e 2872 6570  _transaction(rep
+00022870: 6c61 6365 5f74 786e 5f68 6173 6829 0a20  lace_txn_hash). 
+00022880: 2020 2020 2020 2023 2053 7472 6174 6567         # Strateg
+00022890: 7920 7072 6f76 6964 6573 206c 6f77 6572  y provides lower
+000228a0: 2067 6173 2070 7269 6365 202d 206d 696e   gas price - min
+000228b0: 696d 756d 2070 7265 6665 7272 6564 0a20  imum preferred. 
+000228c0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+000228d0: 706c 6163 655f 7478 6e5b 2267 6173 5072  place_txn["gasPr
+000228e0: 6963 6522 5d20 3d3d 206d 6174 682e 6365  ice"] == math.ce
+000228f0: 696c 2867 6173 5f70 7269 6365 202a 2031  il(gas_price * 1
+00022900: 2e31 3235 290a 2020 2020 2020 2020 7733  .125).        w3
+00022910: 2e65 7468 2e73 6574 5f67 6173 5f70 7269  .eth.set_gas_pri
+00022920: 6365 5f73 7472 6174 6567 7928 4e6f 6e65  ce_strategy(None
+00022930: 2920 2023 2072 6573 6574 2073 7472 6174  )  # reset strat
+00022940: 6567 790a 0a20 2020 2064 6566 2074 6573  egy..    def tes
+00022950: 745f 6574 685f 6d6f 6469 6679 5f74 7261  t_eth_modify_tra
+00022960: 6e73 6163 7469 6f6e 5f6c 6567 6163 7928  nsaction_legacy(
+00022970: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
+00022980: 333a 2022 5765 6233 222c 206b 6579 6669  3: "Web3", keyfi
+00022990: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+000229a0: 7373 3a20 4368 6563 6b73 756d 4164 6472  ss: ChecksumAddr
+000229b0: 6573 730a 2020 2020 2920 2d3e 204e 6f6e  ess.    ) -> Non
+000229c0: 653a 0a20 2020 2020 2020 2074 786e 5f70  e:.        txn_p
+000229d0: 6172 616d 733a 2054 7850 6172 616d 7320  arams: TxParams 
+000229e0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000229f0: 2266 726f 6d22 3a20 6b65 7966 696c 655f  "from": keyfile_
+00022a00: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
+00022a10: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+00022a20: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
+00022a30: 6e74 5f61 6464 7265 7373 2c0a 2020 2020  nt_address,.    
+00022a40: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00022a50: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00022a60: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
+00022a70: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+00022a80: 6761 7350 7269 6365 223a 2077 332e 746f  gasPrice": w3.to
+00022a90: 5f77 6569 280a 2020 2020 2020 2020 2020  _wei(.          
+00022aa0: 2020 2020 2020 312c 2022 6777 6569 220a        1, "gwei".
+00022ab0: 2020 2020 2020 2020 2020 2020 292c 2020              ),  
+00022ac0: 2320 6d75 7374 2062 6520 6772 6561 7465  # must be greate
+00022ad0: 7220 7468 616e 2062 6173 655f 6665 6520  r than base_fee 
+00022ae0: 706f 7374 204c 6f6e 646f 6e0a 2020 2020  post London.    
+00022af0: 2020 2020 7d0a 2020 2020 2020 2020 7478      }.        tx
+00022b00: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
+00022b10: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
+00022b20: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
+00022b30: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
+00022b40: 786e 5f68 6173 6820 3d20 7733 2e65 7468  xn_hash = w3.eth
+00022b50: 2e6d 6f64 6966 795f 7472 616e 7361 6374  .modify_transact
+00022b60: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00022b70: 2074 786e 5f68 6173 682c 2067 6173 5072   txn_hash, gasPr
+00022b80: 6963 653d 2863 6173 7428 5765 692c 2074  ice=(cast(Wei, t
+00022b90: 786e 5f70 6172 616d 735b 2267 6173 5072  xn_params["gasPr
+00022ba0: 6963 6522 5d20 2a20 3229 292c 2076 616c  ice"] * 2)), val
+00022bb0: 7565 3d57 6569 2832 290a 2020 2020 2020  ue=Wei(2).      
+00022bc0: 2020 290a 2020 2020 2020 2020 6d6f 6469    ).        modi
+00022bd0: 6669 6564 5f74 786e 203d 2077 332e 6574  fied_txn = w3.et
+00022be0: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00022bf0: 6e28 6d6f 6469 6669 6564 5f74 786e 5f68  n(modified_txn_h
+00022c00: 6173 6829 0a0a 2020 2020 2020 2020 6173  ash)..        as
+00022c10: 7365 7274 2069 735f 7361 6d65 5f61 6464  sert is_same_add
+00022c20: 7265 7373 280a 2020 2020 2020 2020 2020  ress(.          
+00022c30: 2020 6d6f 6469 6669 6564 5f74 786e 5b22    modified_txn["
+00022c40: 6672 6f6d 225d 2c20 6361 7374 2843 6865  from"], cast(Che
+00022c50: 636b 7375 6d41 6464 7265 7373 2c20 7478  cksumAddress, tx
+00022c60: 6e5f 7061 7261 6d73 5b22 6672 6f6d 225d  n_params["from"]
+00022c70: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00022c80: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
+00022c90: 6d65 5f61 6464 7265 7373 280a 2020 2020  me_address(.    
+00022ca0: 2020 2020 2020 2020 6d6f 6469 6669 6564          modified
+00022cb0: 5f74 786e 5b22 746f 225d 2c20 6361 7374  _txn["to"], cast
+00022cc0: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+00022cd0: 2c20 7478 6e5f 7061 7261 6d73 5b22 746f  , txn_params["to
+00022ce0: 225d 290a 2020 2020 2020 2020 290a 2020  "]).        ).  
+00022cf0: 2020 2020 2020 6173 7365 7274 206d 6f64        assert mod
+00022d00: 6966 6965 645f 7478 6e5b 2276 616c 7565  ified_txn["value
+00022d10: 225d 203d 3d20 320a 2020 2020 2020 2020  "] == 2.        
+00022d20: 6173 7365 7274 206d 6f64 6966 6965 645f  assert modified_
+00022d30: 7478 6e5b 2267 6173 225d 203d 3d20 3231  txn["gas"] == 21
+00022d40: 3030 300a 2020 2020 2020 2020 6173 7365  000.        asse
+00022d50: 7274 206d 6f64 6966 6965 645f 7478 6e5b  rt modified_txn[
+00022d60: 2267 6173 5072 6963 6522 5d20 3d3d 2063  "gasPrice"] == c
+00022d70: 6173 7428 696e 742c 2074 786e 5f70 6172  ast(int, txn_par
+00022d80: 616d 735b 2267 6173 5072 6963 6522 5d29  ams["gasPrice"])
+00022d90: 202a 2032 0a0a 2020 2020 6465 6620 7465   * 2..    def te
+00022da0: 7374 5f65 7468 5f6d 6f64 6966 795f 7472  st_eth_modify_tr
+00022db0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00022dc0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+00022dd0: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
+00022de0: 6f75 6e74 5f61 6464 7265 7373 3a20 4368  ount_address: Ch
+00022df0: 6563 6b73 756d 4164 6472 6573 730a 2020  ecksumAddress.  
+00022e00: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00022e10: 2020 2020 2074 786e 5f70 6172 616d 733a       txn_params:
+00022e20: 2054 7850 6172 616d 7320 3d20 7b0a 2020   TxParams = {.  
+00022e30: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+00022e40: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00022e50: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00022e60: 2020 2020 2020 2022 746f 223a 206b 6579         "to": key
+00022e70: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00022e80: 7265 7373 2c0a 2020 2020 2020 2020 2020  ress,.          
+00022e90: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
+00022ea0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+00022eb0: 6761 7322 3a20 3231 3030 302c 0a20 2020  gas": 21000,.   
+00022ec0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
+00022ed0: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
+00022ee0: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
+00022ef0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
+00022f00: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
+00022f10: 223a 2077 332e 746f 5f77 6569 2832 2c20  ": w3.to_wei(2, 
+00022f20: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
+00022f30: 207d 0a20 2020 2020 2020 2074 786e 5f68   }.        txn_h
+00022f40: 6173 6820 3d20 7733 2e65 7468 2e73 656e  ash = w3.eth.sen
+00022f50: 645f 7472 616e 7361 6374 696f 6e28 7478  d_transaction(tx
+00022f60: 6e5f 7061 7261 6d73 290a 0a20 2020 2020  n_params)..     
+00022f70: 2020 206d 6f64 6966 6965 645f 7478 6e5f     modified_txn_
+00022f80: 6861 7368 203d 2077 332e 6574 682e 6d6f  hash = w3.eth.mo
+00022f90: 6469 6679 5f74 7261 6e73 6163 7469 6f6e  dify_transaction
+00022fa0: 280a 2020 2020 2020 2020 2020 2020 7478  (.            tx
+00022fb0: 6e5f 6861 7368 2c0a 2020 2020 2020 2020  n_hash,.        
+00022fc0: 2020 2020 7661 6c75 653d 5765 6928 3229      value=Wei(2)
+00022fd0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+00022fe0: 7850 7269 6f72 6974 7946 6565 5065 7247  xPriorityFeePerG
+00022ff0: 6173 3d28 6361 7374 2857 6569 2c20 7478  as=(cast(Wei, tx
+00023000: 6e5f 7061 7261 6d73 5b22 6d61 7850 7269  n_params["maxPri
+00023010: 6f72 6974 7946 6565 5065 7247 6173 225d  orityFeePerGas"]
+00023020: 202a 2032 2929 2c0a 2020 2020 2020 2020   * 2)),.        
+00023030: 2020 2020 6d61 7846 6565 5065 7247 6173      maxFeePerGas
+00023040: 3d28 6361 7374 2857 6569 2c20 7478 6e5f  =(cast(Wei, txn_
+00023050: 7061 7261 6d73 5b22 6d61 7846 6565 5065  params["maxFeePe
+00023060: 7247 6173 225d 202a 2032 2929 2c0a 2020  rGas"] * 2)),.  
+00023070: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023080: 6d6f 6469 6669 6564 5f74 786e 203d 2077  modified_txn = w
+00023090: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+000230a0: 6374 696f 6e28 6d6f 6469 6669 6564 5f74  ction(modified_t
+000230b0: 786e 5f68 6173 6829 0a0a 2020 2020 2020  xn_hash)..      
+000230c0: 2020 6173 7365 7274 2069 735f 7361 6d65    assert is_same
+000230d0: 5f61 6464 7265 7373 280a 2020 2020 2020  _address(.      
+000230e0: 2020 2020 2020 6d6f 6469 6669 6564 5f74        modified_t
+000230f0: 786e 5b22 6672 6f6d 225d 2c20 6361 7374  xn["from"], cast
+00023100: 2843 6865 636b 7375 6d41 6464 7265 7373  (ChecksumAddress
+00023110: 2c20 7478 6e5f 7061 7261 6d73 5b22 6672  , txn_params["fr
+00023120: 6f6d 225d 290a 2020 2020 2020 2020 290a  om"]).        ).
+00023130: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00023140: 735f 7361 6d65 5f61 6464 7265 7373 280a  s_same_address(.
+00023150: 2020 2020 2020 2020 2020 2020 6d6f 6469              modi
+00023160: 6669 6564 5f74 786e 5b22 746f 225d 2c20  fied_txn["to"], 
+00023170: 6361 7374 2843 6865 636b 7375 6d41 6464  cast(ChecksumAdd
+00023180: 7265 7373 2c20 7478 6e5f 7061 7261 6d73  ress, txn_params
+00023190: 5b22 746f 225d 290a 2020 2020 2020 2020  ["to"]).        
+000231a0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+000231b0: 206d 6f64 6966 6965 645f 7478 6e5b 2276   modified_txn["v
+000231c0: 616c 7565 225d 203d 3d20 320a 2020 2020  alue"] == 2.    
+000231d0: 2020 2020 6173 7365 7274 206d 6f64 6966      assert modif
+000231e0: 6965 645f 7478 6e5b 2267 6173 225d 203d  ied_txn["gas"] =
+000231f0: 3d20 3231 3030 300a 2020 2020 2020 2020  = 21000.        
+00023200: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+00023210: 2020 2020 206d 6f64 6966 6965 645f 7478       modified_tx
+00023220: 6e5b 226d 6178 5072 696f 7269 7479 4665  n["maxPriorityFe
+00023230: 6550 6572 4761 7322 5d0a 2020 2020 2020  ePerGas"].      
+00023240: 2020 2020 2020 3d3d 2063 6173 7428 5765        == cast(We
+00023250: 692c 2074 786e 5f70 6172 616d 735b 226d  i, txn_params["m
+00023260: 6178 5072 696f 7269 7479 4665 6550 6572  axPriorityFeePer
+00023270: 4761 7322 5d29 202a 2032 0a20 2020 2020  Gas"]) * 2.     
+00023280: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+00023290: 6572 7420 6d6f 6469 6669 6564 5f74 786e  ert modified_txn
+000232a0: 5b22 6d61 7846 6565 5065 7247 6173 225d  ["maxFeePerGas"]
+000232b0: 203d 3d20 6361 7374 2857 6569 2c20 7478   == cast(Wei, tx
+000232c0: 6e5f 7061 7261 6d73 5b22 6d61 7846 6565  n_params["maxFee
+000232d0: 5065 7247 6173 225d 2920 2a20 320a 0a20  PerGas"]) * 2.. 
+000232e0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+000232f0: 7365 6e64 5f72 6177 5f74 7261 6e73 6163  send_raw_transac
+00023300: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
+00023310: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00023320: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+00023330: 706b 6579 3a20 4865 7853 7472 0a20 2020  pkey: HexStr.   
+00023340: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00023350: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
+00023360: 756e 7420 3d20 7733 2e65 7468 2e61 6363  unt = w3.eth.acc
+00023370: 6f75 6e74 2e66 726f 6d5f 6b65 7928 6b65  ount.from_key(ke
+00023380: 7966 696c 655f 6163 636f 756e 745f 706b  yfile_account_pk
+00023390: 6579 290a 2020 2020 2020 2020 7478 6e20  ey).        txn 
+000233a0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000233b0: 2263 6861 696e 4964 223a 2031 3331 3237  "chainId": 13127
+000233c0: 3733 3232 3934 3035 3337 2c20 2023 2074  7322940537,  # t
+000233d0: 6865 2063 6861 696e 4964 2073 6574 2066  he chainId set f
+000233e0: 6f72 2074 6865 2066 6978 7475 7265 0a20  or the fixture. 
+000233f0: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+00023400: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
+00023410: 6e74 2e61 6464 7265 7373 2c0a 2020 2020  nt.address,.    
+00023420: 2020 2020 2020 2020 2274 6f22 3a20 6b65          "to": ke
+00023430: 7966 696c 655f 6163 636f 756e 742e 6164  yfile_account.ad
+00023440: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+00023450: 2020 2022 7661 6c75 6522 3a20 5765 6928     "value": Wei(
+00023460: 3029 2c0a 2020 2020 2020 2020 2020 2020  0),.            
+00023470: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
+00023480: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
+00023490: 223a 2077 332e 6574 682e 6765 745f 7472  ": w3.eth.get_tr
+000234a0: 616e 7361 6374 696f 6e5f 636f 756e 7428  ansaction_count(
+000234b0: 6b65 7966 696c 655f 6163 636f 756e 742e  keyfile_account.
+000234c0: 6164 6472 6573 732c 2022 7065 6e64 696e  address, "pendin
+000234d0: 6722 292c 0a20 2020 2020 2020 2020 2020  g"),.           
+000234e0: 2022 6761 7350 7269 6365 223a 2031 302a   "gasPrice": 10*
+000234f0: 2a39 2c0a 2020 2020 2020 2020 7d0a 2020  *9,.        }.  
+00023500: 2020 2020 2020 7369 676e 6564 203d 206b        signed = k
+00023510: 6579 6669 6c65 5f61 6363 6f75 6e74 2e73  eyfile_account.s
+00023520: 6967 6e5f 7472 616e 7361 6374 696f 6e28  ign_transaction(
+00023530: 7478 6e29 0a20 2020 2020 2020 2074 786e  txn).        txn
+00023540: 5f68 6173 6820 3d20 7733 2e65 7468 2e73  _hash = w3.eth.s
+00023550: 656e 645f 7261 775f 7472 616e 7361 6374  end_raw_transact
+00023560: 696f 6e28 7369 676e 6564 2e72 6177 5f74  ion(signed.raw_t
+00023570: 7261 6e73 6163 7469 6f6e 290a 2020 2020  ransaction).    
+00023580: 2020 2020 6173 7365 7274 2074 786e 5f68      assert txn_h
+00023590: 6173 6820 3d3d 2048 6578 4279 7465 7328  ash == HexBytes(
+000235a0: 7369 676e 6564 2e68 6173 6829 0a0a 2020  signed.hash)..  
+000235b0: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
+000235c0: 616c 6c28 7365 6c66 2c20 7733 3a20 2257  all(self, w3: "W
+000235d0: 6562 3322 2c20 6d61 7468 5f63 6f6e 7472  eb3", math_contr
+000235e0: 6163 743a 2022 436f 6e74 7261 6374 2229  act: "Contract")
+000235f0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00023600: 2020 636f 696e 6261 7365 203d 2077 332e    coinbase = w3.
+00023610: 6574 682e 636f 696e 6261 7365 0a20 2020  eth.coinbase.   
+00023620: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
+00023630: 3d20 6d61 7468 5f63 6f6e 7472 6163 742e  = math_contract.
+00023640: 5f70 7265 7061 7265 5f74 7261 6e73 6163  _prepare_transac
+00023650: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00023660: 2020 666e 5f6e 616d 653d 2261 6464 222c    fn_name="add",
+00023670: 0a20 2020 2020 2020 2020 2020 2066 6e5f  .            fn_
+00023680: 6172 6773 3d28 372c 2031 3129 2c0a 2020  args=(7, 11),.  
+00023690: 2020 2020 2020 2020 2020 7472 616e 7361            transa
+000236a0: 6374 696f 6e3d 7b22 6672 6f6d 223a 2063  ction={"from": c
+000236b0: 6f69 6e62 6173 652c 2022 746f 223a 206d  oinbase, "to": m
+000236c0: 6174 685f 636f 6e74 7261 6374 2e61 6464  ath_contract.add
+000236d0: 7265 7373 7d2c 0a20 2020 2020 2020 2029  ress},.        )
+000236e0: 0a20 2020 2020 2020 2063 616c 6c5f 7265  .        call_re
+000236f0: 7375 6c74 203d 2077 332e 6574 682e 6361  sult = w3.eth.ca
+00023700: 6c6c 2874 786e 5f70 6172 616d 7329 0a20  ll(txn_params). 
+00023710: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00023720: 5f73 7472 696e 6728 6361 6c6c 5f72 6573  _string(call_res
+00023730: 756c 7429 0a20 2020 2020 2020 2028 7265  ult).        (re
+00023740: 7375 6c74 2c29 203d 2077 332e 636f 6465  sult,) = w3.code
+00023750: 632e 6465 636f 6465 285b 2275 696e 7432  c.decode(["uint2
+00023760: 3536 225d 2c20 6361 6c6c 5f72 6573 756c  56"], call_resul
+00023770: 7429 0a20 2020 2020 2020 2061 7373 6572  t).        asser
+00023780: 7420 7265 7375 6c74 203d 3d20 3138 0a0a  t result == 18..
+00023790: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000237a0: 5f63 616c 6c5f 7769 7468 5f6f 7665 7272  _call_with_overr
+000237b0: 6964 655f 636f 6465 280a 2020 2020 2020  ide_code(.      
+000237c0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+000237d0: 3322 2c20 7265 7665 7274 5f63 6f6e 7472  3", revert_contr
+000237e0: 6163 743a 2022 436f 6e74 7261 6374 220a  act: "Contract".
+000237f0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00023800: 2020 2020 2020 2063 6f69 6e62 6173 6520         coinbase 
+00023810: 3d20 7733 2e65 7468 2e63 6f69 6e62 6173  = w3.eth.coinbas
+00023820: 650a 2020 2020 2020 2020 7478 6e5f 7061  e.        txn_pa
+00023830: 7261 6d73 203d 2072 6576 6572 745f 636f  rams = revert_co
+00023840: 6e74 7261 6374 2e5f 7072 6570 6172 655f  ntract._prepare_
+00023850: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+00023860: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
+00023870: 3d22 6e6f 726d 616c 4675 6e63 7469 6f6e  ="normalFunction
+00023880: 222c 0a20 2020 2020 2020 2020 2020 2074  ",.            t
+00023890: 7261 6e73 6163 7469 6f6e 3d7b 2266 726f  ransaction={"fro
+000238a0: 6d22 3a20 636f 696e 6261 7365 2c20 2274  m": coinbase, "t
+000238b0: 6f22 3a20 7265 7665 7274 5f63 6f6e 7472  o": revert_contr
+000238c0: 6163 742e 6164 6472 6573 737d 2c0a 2020  act.address},.  
+000238d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000238e0: 6361 6c6c 5f72 6573 756c 7420 3d20 7733  call_result = w3
+000238f0: 2e65 7468 2e63 616c 6c28 7478 6e5f 7061  .eth.call(txn_pa
+00023900: 7261 6d73 290a 2020 2020 2020 2020 2872  rams).        (r
+00023910: 6573 756c 742c 2920 3d20 7733 2e63 6f64  esult,) = w3.cod
+00023920: 6563 2e64 6563 6f64 6528 5b22 626f 6f6c  ec.decode(["bool
+00023930: 225d 2c20 6361 6c6c 5f72 6573 756c 7429  "], call_result)
+00023940: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00023950: 7265 7375 6c74 2069 7320 5472 7565 0a0a  result is True..
+00023960: 2020 2020 2020 2020 2320 6f76 6572 7269          # overri
+00023970: 6465 2072 756e 7469 6d65 2062 7974 6563  de runtime bytec
+00023980: 6f64 653a 2060 6e6f 726d 616c 4675 6e63  ode: `normalFunc
+00023990: 7469 6f6e 6020 7265 7475 726e 7320 6066  tion` returns `f
+000239a0: 616c 7365 600a 2020 2020 2020 2020 6f76  alse`.        ov
+000239b0: 6572 7269 6465 5f63 6f64 6520 3d20 4865  erride_code = He
+000239c0: 7853 7472 280a 2020 2020 2020 2020 2020  xStr(.          
+000239d0: 2020 2230 7836 3038 3036 3034 3035 3233    "0x60806040523
+000239e0: 3438 3031 3536 3030 6635 3736 3030 3038  48015600f5760008
+000239f0: 3066 6435 6235 3036 3030 3433 3631 3036  0fd5b50600436106
+00023a00: 3033 6335 3736 3030 3033 3536 3065 3031  03c5760003560e01
+00023a10: 6338 3036 3331 3835 6333 3861 3431 3436  c8063185c38a4146
+00023a20: 3034 3135 3738 3036 3363 3036 6139 3763  041578063c06a97c
+00023a30: 6231 3436 3034 3935 3738 3036 3364 3637  b146049578063d67
+00023a40: 6534 6238 3431 3436 3035 3135 3735 6236  e4b84146051575b6
+00023a50: 3030 3038 3066 6435 6236 3034 3736 3037  00080fd5b6047607
+00023a60: 3135 3635 6230 3035 6236 3034 6636 3064  1565b005b604f60d
+00023a70: 6635 3635 6230 3035 6236 3035 3736 3065  f565b005b605760e
+00023a80: 3435 3635 6236 3034 3035 3138 3038 3231  4565b60405180821
+00023a90: 3531 3531 3531 3538 3135 3236 3032 3030  5151515815260200
+00023aa0: 3139 3135 3035 3036 3034 3035 3138 3039  1915050604051809
+00023ab0: 3130 3339 3066 3335 6236 3034 3035 3137  10390f35b6040517
+00023ac0: 6630 3863 3337 3961 3030 3030 3030 3030  f08c379a00000000
 00023ad0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00023ae0: 3030 3030 3030 3030 3030 3038 3135 3236  0000000000081526
-00023af0: 3030 3430 3138 3038 3036 3032 3030 3138  0040180806020018
-00023b00: 3238 3130 3338 3235 3236 3031 6238 3135  281038252601b815
-00023b10: 3236 3032 3030 3138 3037 6634 3637 3536  2602001807f46756
-00023b20: 6536 3337 3436 3936 6636 6532 3036 3836  e6374696f6e20686
-00023b30: 3137 3332 3036 3236 3536 3536 6532 3037  173206265656e207
-00023b40: 3236 3537 3636 3537 3237 3436 3536 3432  2657665727465642
-00023b50: 6530 3030 3030 3030 3030 3038 3135 3235  e000000000081525
-00023b60: 3036 3032 3030 3139 3135 3035 3036 3034  0602001915050604
-00023b70: 3035 3138 3039 3130 3339 3066 6435 6236  05180910390fd5b6
-00023b80: 3030 3038 3066 6435 6236 3030 3038 3039  00080fd5b6000809
-00023b90: 3035 3039 3035 3666 6561 3236 3436 3937  0509056fea264697
-00023ba0: 3036 3637 3335 3832 3231 3232 3062 6237  0667358221220bb7
-00023bb0: 3165 3965 3961 3265 3237 3163 6430 6662  1e9e9a2e271cd0fb
-00023bc0: 6538 3333 3532 3461 3365 6136 3764 6639  e833524a3ea67df9
-00023bd0: 3566 3235 6561 3133 6165 6635 6230 6137  5f25ea13aef5b0a7
-00023be0: 3631 6661 3532 6235 3338 6631 3036 3437  61fa52b538f10647
-00023bf0: 3336 6636 6336 3334 3330 3030 3630 3130  36f6c63430006010
-00023c00: 3033 3322 2020 2320 6e6f 7161 3a20 4535  033"  # noqa: E5
-00023c10: 3031 0a20 2020 2020 2020 2029 0a20 2020  01.        ).   
-00023c20: 2020 2020 2063 616c 6c5f 7265 7375 6c74       call_result
-00023c30: 203d 2077 332e 6574 682e 6361 6c6c 280a   = w3.eth.call(.
-00023c40: 2020 2020 2020 2020 2020 2020 7478 6e5f              txn_
-00023c50: 7061 7261 6d73 2c20 226c 6174 6573 7422  params, "latest"
-00023c60: 2c20 7b72 6576 6572 745f 636f 6e74 7261  , {revert_contra
-00023c70: 6374 2e61 6464 7265 7373 3a20 7b22 636f  ct.address: {"co
-00023c80: 6465 223a 206f 7665 7272 6964 655f 636f  de": override_co
-00023c90: 6465 7d7d 0a20 2020 2020 2020 2029 0a20  de}}.        ). 
-00023ca0: 2020 2020 2020 2028 7265 7375 6c74 2c29         (result,)
-00023cb0: 203d 2077 332e 636f 6465 632e 6465 636f   = w3.codec.deco
-00023cc0: 6465 285b 2262 6f6f 6c22 5d2c 2063 616c  de(["bool"], cal
-00023cd0: 6c5f 7265 7375 6c74 290a 2020 2020 2020  l_result).      
-00023ce0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
-00023cf0: 6973 2046 616c 7365 0a0a 2020 2020 2020  is False..      
-00023d00: 2020 2320 7465 7374 2062 7974 6573 0a0a    # test bytes..
-00023d10: 2020 2020 2020 2020 6279 7465 735f 6361          bytes_ca
-00023d20: 6c6c 5f72 6573 756c 7420 3d20 7733 2e65  ll_result = w3.e
-00023d30: 7468 2e63 616c 6c28 0a20 2020 2020 2020  th.call(.       
-00023d40: 2020 2020 2074 786e 5f70 6172 616d 732c       txn_params,
-00023d50: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-00023d60: 7465 7374 222c 0a20 2020 2020 2020 2020  test",.         
-00023d70: 2020 207b 7265 7665 7274 5f63 6f6e 7472     {revert_contr
-00023d80: 6163 742e 6164 6472 6573 733a 207b 2263  act.address: {"c
-00023d90: 6f64 6522 3a20 746f 5f62 7974 6573 2868  ode": to_bytes(h
-00023da0: 6578 7374 723d 6f76 6572 7269 6465 5f63  exstr=override_c
-00023db0: 6f64 6529 7d7d 2c0a 2020 2020 2020 2020  ode)}},.        
-00023dc0: 290a 2020 2020 2020 2020 2862 7974 6573  ).        (bytes
-00023dd0: 5f72 6573 756c 742c 2920 3d20 7733 2e63  _result,) = w3.c
-00023de0: 6f64 6563 2e64 6563 6f64 6528 5b22 626f  odec.decode(["bo
-00023df0: 6f6c 225d 2c20 6279 7465 735f 6361 6c6c  ol"], bytes_call
-00023e00: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
-00023e10: 2061 7373 6572 7420 6279 7465 735f 7265   assert bytes_re
-00023e20: 7375 6c74 2069 7320 4661 6c73 650a 0a20  sult is False.. 
-00023e30: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-00023e40: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-00023e50: 2020 2020 2022 7061 7261 6d73 222c 0a20       "params",. 
-00023e60: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00023e70: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00023e80: 2020 2020 2020 2022 6e6f 6e63 6522 3a20         "nonce": 
-00023e90: 312c 2020 2320 696e 740a 2020 2020 2020  1,  # int.      
-00023ea0: 2020 2020 2020 2020 2020 2262 616c 616e            "balan
-00023eb0: 6365 223a 2031 2c20 2023 2069 6e74 0a20  ce": 1,  # int. 
-00023ec0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00023ed0: 636f 6465 223a 2048 6578 5374 7228 2230  code": HexStr("0
-00023ee0: 7822 292c 2020 2320 4865 7853 7472 0a20  x"),  # HexStr. 
-00023ef0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00023f00: 2077 6974 6820 7374 6174 650a 2020 2020   with state.    
-00023f10: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-00023f20: 7465 223a 207b 4865 7853 7472 2866 2230  te": {HexStr(f"0
-00023f30: 787b 2730 3027 202a 2033 327d 2229 3a20  x{'00' * 32}"): 
-00023f40: 4865 7853 7472 2866 2230 787b 2730 3027  HexStr(f"0x{'00'
-00023f50: 202a 2033 327d 2229 7d2c 0a20 2020 2020   * 32}")},.     
-00023f60: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00023f70: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00023f80: 2020 2020 2020 2020 226e 6f6e 6365 223a          "nonce":
-00023f90: 2048 6578 5374 7228 2230 7831 2229 2c20   HexStr("0x1"), 
-00023fa0: 2023 2048 6578 5374 720a 2020 2020 2020   # HexStr.      
-00023fb0: 2020 2020 2020 2020 2020 2262 616c 616e            "balan
-00023fc0: 6365 223a 2048 6578 5374 7228 2230 7831  ce": HexStr("0x1
-00023fd0: 2229 2c20 2023 2048 6578 5374 720a 2020  "),  # HexStr.  
-00023fe0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00023ff0: 6f64 6522 3a20 6222 5c78 3030 222c 2020  ode": b"\x00",  
-00024000: 2320 6279 7465 730a 2020 2020 2020 2020  # bytes.        
-00024010: 2020 2020 2020 2020 2320 7769 7468 2073          # with s
-00024020: 7461 7465 4469 6666 0a20 2020 2020 2020  tateDiff.       
-00024030: 2020 2020 2020 2020 2022 7374 6174 6544           "stateD
-00024040: 6966 6622 3a20 7b48 6578 5374 7228 6622  iff": {HexStr(f"
-00024050: 3078 7b27 3030 2720 2a20 3332 7d22 293a  0x{'00' * 32}"):
-00024060: 2048 6578 5374 7228 6622 3078 7b27 3030   HexStr(f"0x{'00
-00024070: 2720 2a20 3332 7d22 297d 2c0a 2020 2020  ' * 32}")},.    
-00024080: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00024090: 2020 2029 2c0a 2020 2020 290a 2020 2020     ),.    ).    
-000240a0: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
-000240b0: 6c5f 7769 7468 5f6f 7665 7272 6964 655f  l_with_override_
-000240c0: 7061 7261 6d5f 7479 7065 5f63 6865 636b  param_type_check
-000240d0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000240e0: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-000240f0: 3322 2c0a 2020 2020 2020 2020 6d61 7468  3",.        math
-00024100: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-00024110: 7261 6374 222c 0a20 2020 2020 2020 2070  ract",.        p
-00024120: 6172 616d 733a 2053 7461 7465 4f76 6572  arams: StateOver
-00024130: 7269 6465 5061 7261 6d73 2c0a 2020 2020  rideParams,.    
-00024140: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00024150: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
-00024160: 7850 6172 616d 7320 3d20 7b22 6672 6f6d  xParams = {"from
-00024170: 223a 2077 332e 6574 682e 636f 696e 6261  ": w3.eth.coinba
-00024180: 7365 7d0a 0a20 2020 2020 2020 2023 2061  se}..        # a
-00024190: 7373 6572 7420 646f 6573 206e 6f74 2072  ssert does not r
-000241a0: 6169 7365 0a20 2020 2020 2020 2077 332e  aise.        w3.
-000241b0: 6574 682e 6361 6c6c 2874 786e 5f70 6172  eth.call(txn_par
-000241c0: 616d 732c 2022 6c61 7465 7374 222c 207b  ams, "latest", {
-000241d0: 6d61 7468 5f63 6f6e 7472 6163 742e 6164  math_contract.ad
-000241e0: 6472 6573 733a 2070 6172 616d 737d 290a  dress: params}).
-000241f0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00024200: 685f 6361 6c6c 5f77 6974 685f 305f 7265  h_call_with_0_re
-00024210: 7375 6c74 280a 2020 2020 2020 2020 7365  sult(.        se
-00024220: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00024230: 6d61 7468 5f63 6f6e 7472 6163 743a 2022  math_contract: "
-00024240: 436f 6e74 7261 6374 220a 2020 2020 2920  Contract".    ) 
-00024250: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00024260: 2063 6f69 6e62 6173 6520 3d20 7733 2e65   coinbase = w3.e
-00024270: 7468 2e63 6f69 6e62 6173 650a 2020 2020  th.coinbase.    
-00024280: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
-00024290: 206d 6174 685f 636f 6e74 7261 6374 2e5f   math_contract._
-000242a0: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
-000242b0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-000242c0: 2066 6e5f 6e61 6d65 3d22 6164 6422 2c0a   fn_name="add",.
-000242d0: 2020 2020 2020 2020 2020 2020 666e 5f61              fn_a
-000242e0: 7267 733d 2830 2c20 3029 2c0a 2020 2020  rgs=(0, 0),.    
-000242f0: 2020 2020 2020 2020 7472 616e 7361 6374          transact
-00024300: 696f 6e3d 7b22 6672 6f6d 223a 2063 6f69  ion={"from": coi
-00024310: 6e62 6173 652c 2022 746f 223a 206d 6174  nbase, "to": mat
-00024320: 685f 636f 6e74 7261 6374 2e61 6464 7265  h_contract.addre
-00024330: 7373 7d2c 0a20 2020 2020 2020 2029 0a20  ss},.        ). 
-00024340: 2020 2020 2020 2063 616c 6c5f 7265 7375         call_resu
-00024350: 6c74 203d 2077 332e 6574 682e 6361 6c6c  lt = w3.eth.call
-00024360: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-00024370: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
-00024380: 7472 696e 6728 6361 6c6c 5f72 6573 756c  tring(call_resul
-00024390: 7429 0a20 2020 2020 2020 2028 7265 7375  t).        (resu
-000243a0: 6c74 2c29 203d 2077 332e 636f 6465 632e  lt,) = w3.codec.
-000243b0: 6465 636f 6465 285b 2275 696e 7432 3536  decode(["uint256
-000243c0: 225d 2c20 6361 6c6c 5f72 6573 756c 7429  "], call_result)
-000243d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000243e0: 7265 7375 6c74 203d 3d20 300a 0a20 2020  result == 0..   
-000243f0: 2064 6566 2074 6573 745f 6574 685f 6361   def test_eth_ca
-00024400: 6c6c 5f72 6576 6572 745f 7769 7468 5f6d  ll_revert_with_m
-00024410: 7367 280a 2020 2020 2020 2020 7365 6c66  sg(.        self
-00024420: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
-00024430: 6562 3322 2c0a 2020 2020 2020 2020 7265  eb3",.        re
-00024440: 7665 7274 5f63 6f6e 7472 6163 743a 2022  vert_contract: "
-00024450: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
-00024460: 2020 206b 6579 6669 6c65 5f61 6363 6f75     keyfile_accou
-00024470: 6e74 5f61 6464 7265 7373 3a20 4368 6563  nt_address: Chec
-00024480: 6b73 756d 4164 6472 6573 732c 0a20 2020  ksumAddress,.   
-00024490: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-000244a0: 2020 2020 7478 6e5f 7061 7261 6d73 203d      txn_params =
-000244b0: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-000244c0: 2e5f 7072 6570 6172 655f 7472 616e 7361  ._prepare_transa
-000244d0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-000244e0: 2020 2066 6e5f 6e61 6d65 3d22 7265 7665     fn_name="reve
-000244f0: 7274 5769 7468 4d65 7373 6167 6522 2c0a  rtWithMessage",.
-00024500: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-00024510: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
-00024520: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00024530: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
-00024540: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-00024550: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00024560: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00024570: 2e61 6464 7265 7373 2c0a 2020 2020 2020  .address,.      
-00024580: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00024590: 2029 0a20 2020 2020 2020 2064 6174 6120   ).        data 
-000245a0: 3d20 2230 7830 3863 3337 3961 3030 3030  = "0x08c379a0000
-000245b0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000245c0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023ae0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023af0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00023b00: 3038 3135 3236 3030 3430 3138 3038 3036  0815260040180806
+00023b10: 3032 3030 3138 3238 3130 3338 3235 3236  0200182810382526
+00023b20: 3031 6238 3135 3236 3032 3030 3138 3037  01b8152602001807
+00023b30: 6634 3637 3536 6536 3337 3436 3936 6636  f46756e6374696f6
+00023b40: 6532 3036 3836 3137 3332 3036 3236 3536  e206861732062656
+00023b50: 3536 6532 3037 3236 3537 3636 3537 3237  56e2072657665727
+00023b60: 3436 3536 3432 6530 3030 3030 3030 3030  465642e000000000
+00023b70: 3038 3135 3235 3036 3032 3030 3139 3135  0815250602001915
+00023b80: 3035 3036 3034 3035 3138 3039 3130 3339  0506040518091039
+00023b90: 3066 6435 6236 3030 3038 3066 6435 6236  0fd5b600080fd5b6
+00023ba0: 3030 3038 3039 3035 3039 3035 3666 6561  0008090509056fea
+00023bb0: 3236 3436 3937 3036 3637 3335 3832 3231  2646970667358221
+00023bc0: 3232 3062 6237 3165 3965 3961 3265 3237  220bb71e9e9a2e27
+00023bd0: 3163 6430 6662 6538 3333 3532 3461 3365  1cd0fbe833524a3e
+00023be0: 6136 3764 6639 3566 3235 6561 3133 6165  a67df95f25ea13ae
+00023bf0: 6635 6230 6137 3631 6661 3532 6235 3338  f5b0a761fa52b538
+00023c00: 6631 3036 3437 3336 6636 6336 3334 3330  f1064736f6c63430
+00023c10: 3030 3630 3130 3033 3322 2020 2320 6e6f  006010033"  # no
+00023c20: 7161 3a20 4535 3031 0a20 2020 2020 2020  qa: E501.       
+00023c30: 2029 0a20 2020 2020 2020 2063 616c 6c5f   ).        call_
+00023c40: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
+00023c50: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00023c60: 2020 7478 6e5f 7061 7261 6d73 2c20 226c    txn_params, "l
+00023c70: 6174 6573 7422 2c20 7b72 6576 6572 745f  atest", {revert_
+00023c80: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+00023c90: 3a20 7b22 636f 6465 223a 206f 7665 7272  : {"code": overr
+00023ca0: 6964 655f 636f 6465 7d7d 0a20 2020 2020  ide_code}}.     
+00023cb0: 2020 2029 0a20 2020 2020 2020 2028 7265     ).        (re
+00023cc0: 7375 6c74 2c29 203d 2077 332e 636f 6465  sult,) = w3.code
+00023cd0: 632e 6465 636f 6465 285b 2262 6f6f 6c22  c.decode(["bool"
+00023ce0: 5d2c 2063 616c 6c5f 7265 7375 6c74 290a  ], call_result).
+00023cf0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00023d00: 6573 756c 7420 6973 2046 616c 7365 0a0a  esult is False..
+00023d10: 2020 2020 2020 2020 2320 7465 7374 2062          # test b
+00023d20: 7974 6573 0a0a 2020 2020 2020 2020 6279  ytes..        by
+00023d30: 7465 735f 6361 6c6c 5f72 6573 756c 7420  tes_call_result 
+00023d40: 3d20 7733 2e65 7468 2e63 616c 6c28 0a20  = w3.eth.call(. 
+00023d50: 2020 2020 2020 2020 2020 2074 786e 5f70             txn_p
+00023d60: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+00023d70: 2020 2022 6c61 7465 7374 222c 0a20 2020     "latest",.   
+00023d80: 2020 2020 2020 2020 207b 7265 7665 7274           {revert
+00023d90: 5f63 6f6e 7472 6163 742e 6164 6472 6573  _contract.addres
+00023da0: 733a 207b 2263 6f64 6522 3a20 746f 5f62  s: {"code": to_b
+00023db0: 7974 6573 2868 6578 7374 723d 6f76 6572  ytes(hexstr=over
+00023dc0: 7269 6465 5f63 6f64 6529 7d7d 2c0a 2020  ride_code)}},.  
+00023dd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023de0: 2862 7974 6573 5f72 6573 756c 742c 2920  (bytes_result,) 
+00023df0: 3d20 7733 2e63 6f64 6563 2e64 6563 6f64  = w3.codec.decod
+00023e00: 6528 5b22 626f 6f6c 225d 2c20 6279 7465  e(["bool"], byte
+00023e10: 735f 6361 6c6c 5f72 6573 756c 7429 0a20  s_call_result). 
+00023e20: 2020 2020 2020 2061 7373 6572 7420 6279         assert by
+00023e30: 7465 735f 7265 7375 6c74 2069 7320 4661  tes_result is Fa
+00023e40: 6c73 650a 0a20 2020 2040 7079 7465 7374  lse..    @pytest
+00023e50: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+00023e60: 6528 0a20 2020 2020 2020 2022 7061 7261  e(.        "para
+00023e70: 6d73 222c 0a20 2020 2020 2020 2028 0a20  ms",.        (. 
+00023e80: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00023e90: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
+00023ea0: 6e63 6522 3a20 312c 2020 2320 696e 740a  nce": 1,  # int.
+00023eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ec0: 2262 616c 616e 6365 223a 2031 2c20 2023  "balance": 1,  #
+00023ed0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00023ee0: 2020 2020 2022 636f 6465 223a 2048 6578       "code": Hex
+00023ef0: 5374 7228 2230 7822 292c 2020 2320 4865  Str("0x"),  # He
+00023f00: 7853 7472 0a20 2020 2020 2020 2020 2020  xStr.           
+00023f10: 2020 2020 2023 2077 6974 6820 7374 6174       # with stat
+00023f20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00023f30: 2020 2273 7461 7465 223a 207b 4865 7853    "state": {HexS
+00023f40: 7472 2866 2230 787b 2730 3027 202a 2033  tr(f"0x{'00' * 3
+00023f50: 327d 2229 3a20 4865 7853 7472 2866 2230  2}"): HexStr(f"0
+00023f60: 787b 2730 3027 202a 2033 327d 2229 7d2c  x{'00' * 32}")},
+00023f70: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
+00023f80: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00023f90: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00023fa0: 6f6e 6365 223a 2048 6578 5374 7228 2230  once": HexStr("0
+00023fb0: 7831 2229 2c20 2023 2048 6578 5374 720a  x1"),  # HexStr.
+00023fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023fd0: 2262 616c 616e 6365 223a 2048 6578 5374  "balance": HexSt
+00023fe0: 7228 2230 7831 2229 2c20 2023 2048 6578  r("0x1"),  # Hex
+00023ff0: 5374 720a 2020 2020 2020 2020 2020 2020  Str.            
+00024000: 2020 2020 2263 6f64 6522 3a20 6222 5c78      "code": b"\x
+00024010: 3030 222c 2020 2320 6279 7465 730a 2020  00",  # bytes.  
+00024020: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00024030: 7769 7468 2073 7461 7465 4469 6666 0a20  with stateDiff. 
+00024040: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00024050: 7374 6174 6544 6966 6622 3a20 7b48 6578  stateDiff": {Hex
+00024060: 5374 7228 6622 3078 7b27 3030 2720 2a20  Str(f"0x{'00' * 
+00024070: 3332 7d22 293a 2048 6578 5374 7228 6622  32}"): HexStr(f"
+00024080: 3078 7b27 3030 2720 2a20 3332 7d22 297d  0x{'00' * 32}")}
+00024090: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+000240a0: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
+000240b0: 290a 2020 2020 6465 6620 7465 7374 5f65  ).    def test_e
+000240c0: 7468 5f63 616c 6c5f 7769 7468 5f6f 7665  th_call_with_ove
+000240d0: 7272 6964 655f 7061 7261 6d5f 7479 7065  rride_param_type
+000240e0: 5f63 6865 636b 280a 2020 2020 2020 2020  _check(.        
+000240f0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
+00024100: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
+00024110: 2020 6d61 7468 5f63 6f6e 7472 6163 743a    math_contract:
+00024120: 2022 436f 6e74 7261 6374 222c 0a20 2020   "Contract",.   
+00024130: 2020 2020 2070 6172 616d 733a 2053 7461       params: Sta
+00024140: 7465 4f76 6572 7269 6465 5061 7261 6d73  teOverrideParams
+00024150: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00024160: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00024170: 616d 733a 2054 7850 6172 616d 7320 3d20  ams: TxParams = 
+00024180: 7b22 6672 6f6d 223a 2077 332e 6574 682e  {"from": w3.eth.
+00024190: 636f 696e 6261 7365 7d0a 0a20 2020 2020  coinbase}..     
+000241a0: 2020 2023 2061 7373 6572 7420 646f 6573     # assert does
+000241b0: 206e 6f74 2072 6169 7365 0a20 2020 2020   not raise.     
+000241c0: 2020 2077 332e 6574 682e 6361 6c6c 2874     w3.eth.call(t
+000241d0: 786e 5f70 6172 616d 732c 2022 6c61 7465  xn_params, "late
+000241e0: 7374 222c 207b 6d61 7468 5f63 6f6e 7472  st", {math_contr
+000241f0: 6163 742e 6164 6472 6573 733a 2070 6172  act.address: par
+00024200: 616d 737d 290a 0a20 2020 2064 6566 2074  ams})..    def t
+00024210: 6573 745f 6574 685f 6361 6c6c 5f77 6974  est_eth_call_wit
+00024220: 685f 305f 7265 7375 6c74 280a 2020 2020  h_0_result(.    
+00024230: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+00024240: 6562 3322 2c20 6d61 7468 5f63 6f6e 7472  eb3", math_contr
+00024250: 6163 743a 2022 436f 6e74 7261 6374 220a  act: "Contract".
+00024260: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00024270: 2020 2020 2020 2063 6f69 6e62 6173 6520         coinbase 
+00024280: 3d20 7733 2e65 7468 2e63 6f69 6e62 6173  = w3.eth.coinbas
+00024290: 650a 2020 2020 2020 2020 7478 6e5f 7061  e.        txn_pa
+000242a0: 7261 6d73 203d 206d 6174 685f 636f 6e74  rams = math_cont
+000242b0: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
+000242c0: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+000242d0: 2020 2020 2020 2066 6e5f 6e61 6d65 3d22         fn_name="
+000242e0: 6164 6422 2c0a 2020 2020 2020 2020 2020  add",.          
+000242f0: 2020 666e 5f61 7267 733d 2830 2c20 3029    fn_args=(0, 0)
+00024300: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
+00024310: 616e 7361 6374 696f 6e3d 7b22 6672 6f6d  ansaction={"from
+00024320: 223a 2063 6f69 6e62 6173 652c 2022 746f  ": coinbase, "to
+00024330: 223a 206d 6174 685f 636f 6e74 7261 6374  ": math_contract
+00024340: 2e61 6464 7265 7373 7d2c 0a20 2020 2020  .address},.     
+00024350: 2020 2029 0a20 2020 2020 2020 2063 616c     ).        cal
+00024360: 6c5f 7265 7375 6c74 203d 2077 332e 6574  l_result = w3.et
+00024370: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
+00024380: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+00024390: 7420 6973 5f73 7472 696e 6728 6361 6c6c  t is_string(call
+000243a0: 5f72 6573 756c 7429 0a20 2020 2020 2020  _result).       
+000243b0: 2028 7265 7375 6c74 2c29 203d 2077 332e   (result,) = w3.
+000243c0: 636f 6465 632e 6465 636f 6465 285b 2275  codec.decode(["u
+000243d0: 696e 7432 3536 225d 2c20 6361 6c6c 5f72  int256"], call_r
+000243e0: 6573 756c 7429 0a20 2020 2020 2020 2061  esult).        a
+000243f0: 7373 6572 7420 7265 7375 6c74 203d 3d20  ssert result == 
+00024400: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
+00024410: 6574 685f 6361 6c6c 5f72 6576 6572 745f  eth_call_revert_
+00024420: 7769 7468 5f6d 7367 280a 2020 2020 2020  with_msg(.      
+00024430: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00024440: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
+00024450: 2020 2020 7265 7665 7274 5f63 6f6e 7472      revert_contr
+00024460: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
+00024470: 0a20 2020 2020 2020 206b 6579 6669 6c65  .        keyfile
+00024480: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00024490: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
+000244a0: 732c 0a20 2020 2029 202d 3e20 4e6f 6e65  s,.    ) -> None
+000244b0: 3a0a 2020 2020 2020 2020 7478 6e5f 7061  :.        txn_pa
+000244c0: 7261 6d73 203d 2072 6576 6572 745f 636f  rams = revert_co
+000244d0: 6e74 7261 6374 2e5f 7072 6570 6172 655f  ntract._prepare_
+000244e0: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
+000244f0: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
+00024500: 3d22 7265 7665 7274 5769 7468 4d65 7373  ="revertWithMess
+00024510: 6167 6522 2c0a 2020 2020 2020 2020 2020  age",.          
+00024520: 2020 7472 616e 7361 6374 696f 6e3d 7b0a    transaction={.
+00024530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024540: 2266 726f 6d22 3a20 6b65 7966 696c 655f  "from": keyfile_
+00024550: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
+00024560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024570: 2022 746f 223a 2072 6576 6572 745f 636f   "to": revert_co
+00024580: 6e74 7261 6374 2e61 6464 7265 7373 2c0a  ntract.address,.
+00024590: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+000245a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000245b0: 2064 6174 6120 3d20 2230 7830 3863 3337   data = "0x08c37
+000245c0: 3961 3030 3030 3030 3030 3030 3030 3030  9a00000000000000
 000245d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-000245e0: 3030 3030 3030 3030 3030 3032 3030 3030  0000000000020000
+000245e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 000245f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00024600: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00024600: 3032 3030 3030 3030 3030 3030 3030 3030  0200000000000000
 00024610: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-00024620: 3030 3030 3030 3030 3030 3031 6234 3637  000000000001b467
-00024630: 3536 6536 3337 3436 3936 6636 6532 3036  56e6374696f6e206
-00024640: 3836 3137 3332 3036 3236 3536 3536 6532  86173206265656e2
-00024650: 3037 3236 3537 3636 3537 3237 3436 3536  0726576657274656
-00024660: 3432 6530 3030 3030 3030 3030 3022 2020  42e0000000000"  
-00024670: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
-00024680: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-00024690: 2e72 6169 7365 7328 0a20 2020 2020 2020  .raises(.       
-000246a0: 2020 2020 2043 6f6e 7472 6163 744c 6f67       ContractLog
-000246b0: 6963 4572 726f 722c 206d 6174 6368 3d22  icError, match="
-000246c0: 6578 6563 7574 696f 6e20 7265 7665 7274  execution revert
-000246d0: 6564 3a20 4675 6e63 7469 6f6e 2068 6173  ed: Function has
-000246e0: 2062 6565 6e20 7265 7665 7274 6564 220a   been reverted".
-000246f0: 2020 2020 2020 2020 2920 6173 2065 7863          ) as exc
-00024700: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-00024710: 2020 7733 2e65 7468 2e63 616c 6c28 7478    w3.eth.call(tx
-00024720: 6e5f 7061 7261 6d73 290a 2020 2020 2020  n_params).      
-00024730: 2020 6173 7365 7274 2065 7863 696e 666f    assert excinfo
-00024740: 2e76 616c 7565 2e64 6174 6120 3d3d 2064  .value.data == d
-00024750: 6174 610a 0a20 2020 2064 6566 2074 6573  ata..    def tes
-00024760: 745f 6574 685f 6361 6c6c 5f72 6576 6572  t_eth_call_rever
-00024770: 745f 7769 7468 6f75 745f 6d73 6728 0a20  t_without_msg(. 
-00024780: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00024790: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
-000247a0: 0a20 2020 2020 2020 2072 6576 6572 745f  .        revert_
-000247b0: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-000247c0: 6163 7422 2c0a 2020 2020 2020 2020 6b65  act",.        ke
-000247d0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-000247e0: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-000247f0: 6464 7265 7373 2c0a 2020 2020 2920 2d3e  ddress,.    ) ->
-00024800: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
-00024810: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00024820: 7328 436f 6e74 7261 6374 4c6f 6769 6345  s(ContractLogicE
-00024830: 7272 6f72 2c20 6d61 7463 683d 2265 7865  rror, match="exe
-00024840: 6375 7469 6f6e 2072 6576 6572 7465 6422  cution reverted"
-00024850: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
-00024860: 786e 5f70 6172 616d 7320 3d20 7265 7665  xn_params = reve
-00024870: 7274 5f63 6f6e 7472 6163 742e 5f70 7265  rt_contract._pre
-00024880: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
-00024890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000248a0: 2020 666e 5f6e 616d 653d 2272 6576 6572    fn_name="rever
-000248b0: 7457 6974 686f 7574 4d65 7373 6167 6522  tWithoutMessage"
-000248c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000248d0: 2020 7472 616e 7361 6374 696f 6e3d 7b0a    transaction={.
-000248e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000248f0: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-00024900: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00024910: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-00024920: 2020 2020 2020 2020 2022 746f 223a 2072           "to": r
-00024930: 6576 6572 745f 636f 6e74 7261 6374 2e61  evert_contract.a
-00024940: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00024950: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00024960: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00024970: 2020 2020 2077 332e 6574 682e 6361 6c6c       w3.eth.call
-00024980: 2874 786e 5f70 6172 616d 7329 0a0a 2020  (txn_params)..  
-00024990: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-000249a0: 616c 6c5f 6375 7374 6f6d 5f65 7272 6f72  all_custom_error
-000249b0: 5f72 6576 6572 745f 7769 7468 5f6d 7367  _revert_with_msg
-000249c0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000249d0: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-000249e0: 3322 2c0a 2020 2020 2020 2020 7265 7665  3",.        reve
-000249f0: 7274 5f63 6f6e 7472 6163 743a 2022 436f  rt_contract: "Co
-00024a00: 6e74 7261 6374 222c 0a20 2020 2020 2020  ntract",.       
-00024a10: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-00024a20: 5f61 6464 7265 7373 3a20 4368 6563 6b73  _address: Checks
-00024a30: 756d 4164 6472 6573 732c 0a20 2020 2029  umAddress,.    )
-00024a40: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00024a50: 2020 6461 7461 203d 2072 6576 6572 745f    data = revert_
-00024a60: 636f 6e74 7261 6374 2e65 6e63 6f64 655f  contract.encode_
-00024a70: 6162 6928 0a20 2020 2020 2020 2020 2020  abi(.           
-00024a80: 2066 6e5f 6e61 6d65 3d22 556e 6175 7468   fn_name="Unauth
-00024a90: 6f72 697a 6564 5769 7468 4d65 7373 6167  orizedWithMessag
-00024aa0: 6522 2c20 6172 6773 3d5b 2259 6f75 2061  e", args=["You a
-00024ab0: 7265 206e 6f74 2061 7574 686f 7269 7a65  re not authorize
-00024ac0: 6422 5d0a 2020 2020 2020 2020 290a 2020  d"].        ).  
-00024ad0: 2020 2020 2020 7478 6e5f 7061 7261 6d73        txn_params
-00024ae0: 203d 2072 6576 6572 745f 636f 6e74 7261   = revert_contra
-00024af0: 6374 2e5f 7072 6570 6172 655f 7472 616e  ct._prepare_tran
-00024b00: 7361 6374 696f 6e28 0a20 2020 2020 2020  saction(.       
-00024b10: 2020 2020 2066 6e5f 6e61 6d65 3d22 6375       fn_name="cu
-00024b20: 7374 6f6d 4572 726f 7257 6974 684d 6573  stomErrorWithMes
-00024b30: 7361 6765 222c 0a20 2020 2020 2020 2020  sage",.         
-00024b40: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
-00024b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024b60: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
-00024b70: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00024b80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00024b90: 2020 2274 6f22 3a20 7265 7665 7274 5f63    "to": revert_c
-00024ba0: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
-00024bb0: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
-00024bc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00024bd0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00024be0: 6973 6573 2843 6f6e 7472 6163 7443 7573  ises(ContractCus
-00024bf0: 746f 6d45 7272 6f72 2c20 6d61 7463 683d  tomError, match=
-00024c00: 6461 7461 2920 6173 2065 7863 696e 666f  data) as excinfo
-00024c10: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
-00024c20: 2e65 7468 2e63 616c 6c28 7478 6e5f 7061  .eth.call(txn_pa
-00024c30: 7261 6d73 290a 2020 2020 2020 2020 6173  rams).        as
-00024c40: 7365 7274 2065 7863 696e 666f 2e76 616c  sert excinfo.val
-00024c50: 7565 2e64 6174 6120 3d3d 2064 6174 610a  ue.data == data.
-00024c60: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00024c70: 685f 6361 6c6c 5f63 7573 746f 6d5f 6572  h_call_custom_er
-00024c80: 726f 725f 7265 7665 7274 5f77 6974 686f  ror_revert_witho
-00024c90: 7574 5f6d 7367 280a 2020 2020 2020 2020  ut_msg(.        
-00024ca0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-00024cb0: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-00024cc0: 2020 7265 7665 7274 5f63 6f6e 7472 6163    revert_contrac
-00024cd0: 743a 2022 436f 6e74 7261 6374 222c 0a20  t: "Contract",. 
-00024ce0: 2020 2020 2020 206b 6579 6669 6c65 5f61         keyfile_a
-00024cf0: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
-00024d00: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-00024d10: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00024d20: 2020 2020 2020 2020 6461 7461 203d 2072          data = r
-00024d30: 6576 6572 745f 636f 6e74 7261 6374 2e65  evert_contract.e
-00024d40: 6e63 6f64 655f 6162 6928 666e 5f6e 616d  ncode_abi(fn_nam
-00024d50: 653d 2255 6e61 7574 686f 7269 7a65 6422  e="Unauthorized"
-00024d60: 290a 2020 2020 2020 2020 7478 6e5f 7061  ).        txn_pa
-00024d70: 7261 6d73 203d 2072 6576 6572 745f 636f  rams = revert_co
-00024d80: 6e74 7261 6374 2e5f 7072 6570 6172 655f  ntract._prepare_
-00024d90: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-00024da0: 2020 2020 2020 2020 2066 6e5f 6e61 6d65           fn_name
-00024db0: 3d22 6375 7374 6f6d 4572 726f 7257 6974  ="customErrorWit
-00024dc0: 686f 7574 4d65 7373 6167 6522 2c0a 2020  houtMessage",.  
-00024dd0: 2020 2020 2020 2020 2020 7472 616e 7361            transa
-00024de0: 6374 696f 6e3d 7b0a 2020 2020 2020 2020  ction={.        
-00024df0: 2020 2020 2020 2020 2266 726f 6d22 3a20          "from": 
-00024e00: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00024e10: 6164 6472 6573 732c 0a20 2020 2020 2020  address,.       
-00024e20: 2020 2020 2020 2020 2022 746f 223a 2072           "to": r
-00024e30: 6576 6572 745f 636f 6e74 7261 6374 2e61  evert_contract.a
-00024e40: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00024e50: 2020 2020 7d2c 0a20 2020 2020 2020 2029      },.        )
-00024e60: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00024e70: 7465 7374 2e72 6169 7365 7328 436f 6e74  test.raises(Cont
-00024e80: 7261 6374 4375 7374 6f6d 4572 726f 722c  ractCustomError,
-00024e90: 206d 6174 6368 3d64 6174 6129 2061 7320   match=data) as 
-00024ea0: 6578 6369 6e66 6f3a 0a20 2020 2020 2020  excinfo:.       
-00024eb0: 2020 2020 2077 332e 6574 682e 6361 6c6c       w3.eth.call
-00024ec0: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
-00024ed0: 2020 2020 2061 7373 6572 7420 6578 6369       assert exci
-00024ee0: 6e66 6f2e 7661 6c75 652e 6461 7461 203d  nfo.value.data =
-00024ef0: 3d20 6461 7461 0a0a 2020 2020 4070 7974  = data..    @pyt
-00024f00: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00024f10: 7269 7a65 280a 2020 2020 2020 2020 2270  rize(.        "p
-00024f20: 616e 6963 5f65 7272 6f72 2c70 6172 616d  anic_error,param
-00024f30: 7322 2c0a 2020 2020 2020 2020 280a 2020  s",.        (.  
-00024f40: 2020 2020 2020 2020 2020 2822 3031 222c            ("01",
-00024f50: 205b 5d29 2c0a 2020 2020 2020 2020 2020   []),.          
-00024f60: 2020 2822 3131 222c 205b 5d29 2c0a 2020    ("11", []),.  
-00024f70: 2020 2020 2020 2020 2020 2822 3132 222c            ("12",
-00024f80: 205b 305d 292c 0a20 2020 2020 2020 2020   [0]),.         
-00024f90: 2020 2028 2232 3122 2c20 5b2d 315d 292c     ("21", [-1]),
-00024fa0: 0a20 2020 2020 2020 2020 2020 2028 2232  .            ("2
-00024fb0: 3222 2c20 5b5d 292c 0a20 2020 2020 2020  2", []),.       
-00024fc0: 2020 2020 2028 2233 3122 2c20 5b5d 292c       ("31", []),
-00024fd0: 0a20 2020 2020 2020 2020 2020 2028 2233  .            ("3
-00024fe0: 3222 2c20 5b5d 292c 0a20 2020 2020 2020  2", []),.       
-00024ff0: 2020 2020 2028 2234 3122 2c20 5b5d 292c       ("41", []),
-00025000: 0a20 2020 2020 2020 2020 2020 2028 2235  .            ("5
-00025010: 3122 2c20 5b5d 292c 0a20 2020 2020 2020  1", []),.       
-00025020: 2029 2c0a 2020 2020 290a 2020 2020 6465   ),.    ).    de
-00025030: 6620 7465 7374 5f63 6f6e 7472 6163 745f  f test_contract_
-00025040: 7061 6e69 635f 6572 726f 7273 280a 2020  panic_errors(.  
-00025050: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00025060: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
-00025070: 2020 2020 2020 2020 7061 6e69 635f 6572          panic_er
-00025080: 726f 7273 5f63 6f6e 7472 6163 743a 2022  rors_contract: "
-00025090: 436f 6e74 7261 6374 222c 0a20 2020 2020  Contract",.     
-000250a0: 2020 2070 616e 6963 5f65 7272 6f72 3a20     panic_error: 
-000250b0: 7374 722c 0a20 2020 2020 2020 2070 6172  str,.        par
-000250c0: 616d 733a 204c 6973 745b 416e 795d 2c0a  ams: List[Any],.
-000250d0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-000250e0: 2020 2020 2020 206d 6574 686f 6420 3d20         method = 
-000250f0: 6765 7461 7474 7228 0a20 2020 2020 2020  getattr(.       
-00025100: 2020 2020 2070 616e 6963 5f65 7272 6f72       panic_error
-00025110: 735f 636f 6e74 7261 6374 2e66 756e 6374  s_contract.funct
-00025120: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-00025130: 2020 6622 6572 726f 7243 6f64 657b 7061    f"errorCode{pa
-00025140: 6e69 635f 6572 726f 727d 222c 0a20 2020  nic_error}",.   
-00025150: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00025160: 7272 6f72 5f6d 7367 203d 2050 414e 4943  rror_msg = PANIC
-00025170: 5f45 5252 4f52 5f43 4f44 4553 5b70 616e  _ERROR_CODES[pan
-00025180: 6963 5f65 7272 6f72 5d0a 0a20 2020 2020  ic_error]..     
-00025190: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-000251a0: 6169 7365 7328 436f 6e74 7261 6374 5061  aises(ContractPa
-000251b0: 6e69 6345 7272 6f72 2c20 6d61 7463 683d  nicError, match=
-000251c0: 7265 2e65 7363 6170 6528 6572 726f 725f  re.escape(error_
-000251d0: 6d73 6729 293a 0a20 2020 2020 2020 2020  msg)):.         
-000251e0: 2020 206d 6574 686f 6428 2a70 6172 616d     method(*param
-000251f0: 7329 2e63 616c 6c28 290a 0a20 2020 2064  s).call()..    d
-00025200: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
-00025210: 5f6f 6666 6368 6169 6e5f 6c6f 6f6b 7570  _offchain_lookup
-00025220: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00025230: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
-00025240: 3322 2c0a 2020 2020 2020 2020 6f66 6663  3",.        offc
-00025250: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-00025260: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-00025270: 2c0a 2020 2020 2020 2020 6b65 7966 696c  ,.        keyfil
-00025280: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-00025290: 733a 2043 6865 636b 7375 6d41 6464 7265  s: ChecksumAddre
-000252a0: 7373 2c0a 2020 2020 2020 2020 6d6f 6e6b  ss,.        monk
-000252b0: 6579 7061 7463 683a 2022 4d6f 6e6b 6579  eypatch: "Monkey
-000252c0: 5061 7463 6822 2c0a 2020 2020 2920 2d3e  Patch",.    ) ->
-000252d0: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
-000252e0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
-000252f0: 6374 5f61 6464 7265 7373 203d 2074 6f5f  ct_address = to_
-00025300: 6865 785f 6966 5f62 7974 6573 280a 2020  hex_if_bytes(.  
-00025310: 2020 2020 2020 2020 2020 6f66 6663 6861            offcha
-00025320: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-00025330: 6374 2e61 6464 7265 7373 0a20 2020 2020  ct.address.     
-00025340: 2020 2029 2e6c 6f77 6572 2829 0a20 2020     ).lower().   
-00025350: 2020 2020 206d 6f63 6b5f 6f66 6663 6861       mock_offcha
-00025360: 696e 5f6c 6f6f 6b75 705f 7265 7175 6573  in_lookup_reques
-00025370: 745f 7265 7370 6f6e 7365 280a 2020 2020  t_response(.    
-00025380: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-00025390: 7463 682c 0a20 2020 2020 2020 2020 2020  tch,.           
-000253a0: 206d 6f63 6b65 645f 7265 7175 6573 745f   mocked_request_
-000253b0: 7572 6c3d 6622 6874 7470 733a 2f2f 7765  url=f"https://we
-000253c0: 6233 2e70 792f 6761 7465 7761 792f 7b6e  b3.py/gateway/{n
-000253d0: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
-000253e0: 6374 5f61 6464 7265 7373 7d2f 7b4f 4646  ct_address}/{OFF
-000253f0: 4348 4149 4e5f 4c4f 4f4b 5550 5f54 4553  CHAIN_LOOKUP_TES
-00025400: 545f 4441 5441 7d2e 6a73 6f6e 222c 2020  T_DATA}.json",  
-00025410: 2320 6e6f 7161 3a20 4535 3031 0a20 2020  # noqa: E501.   
-00025420: 2020 2020 2020 2020 206d 6f63 6b65 645f           mocked_
-00025430: 6a73 6f6e 5f64 6174 613d 5745 4233 5059  json_data=WEB3PY
-00025440: 5f41 535f 4845 5842 5954 4553 2c0a 2020  _AS_HEXBYTES,.  
-00025450: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00025460: 7265 7370 6f6e 7365 203d 206f 6666 6368  response = offch
-00025470: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-00025480: 6163 742e 6675 6e63 7469 6f6e 732e 7465  act.functions.te
-00025490: 7374 4f66 6663 6861 696e 4c6f 6f6b 7570  stOffchainLookup
-000254a0: 280a 2020 2020 2020 2020 2020 2020 4f46  (.            OF
-000254b0: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-000254c0: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
-000254d0: 292e 6361 6c6c 2829 0a20 2020 2020 2020  ).call().       
-000254e0: 2061 7373 6572 7420 7733 2e63 6f64 6563   assert w3.codec
-000254f0: 2e64 6563 6f64 6528 5b22 7374 7269 6e67  .decode(["string
-00025500: 225d 2c20 7265 7370 6f6e 7365 295b 305d  "], response)[0]
-00025510: 203d 3d20 2277 6562 3370 7922 0a0a 2020   == "web3py"..  
-00025520: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-00025530: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
-00025540: 6b75 705f 7261 6973 6573 5f77 6865 6e5f  kup_raises_when_
-00025550: 6363 6970 5f72 6561 645f 6973 5f64 6973  ccip_read_is_dis
-00025560: 6162 6c65 6428 0a20 2020 2020 2020 2073  abled(.        s
-00025570: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
-00025580: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
-00025590: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
-000255a0: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-000255b0: 7261 6374 222c 0a20 2020 2029 202d 3e20  ract",.    ) -> 
-000255c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-000255d0: 7475 726e 5f64 6174 6120 3d20 280a 2020  turn_data = (.  
-000255e0: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
-000255f0: 494e 5f4c 4f4f 4b55 505f 3442 5954 455f  IN_LOOKUP_4BYTE_
-00025600: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
-00025610: 202b 2061 6269 5f65 6e63 6f64 6564 5f6f   + abi_encoded_o
-00025620: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-00025630: 6f6e 7472 6163 745f 6164 6472 6573 7328  ontract_address(
-00025640: 7733 2c20 6f66 6663 6861 696e 5f6c 6f6f  w3, offchain_loo
-00025650: 6b75 705f 636f 6e74 7261 6374 290a 2020  kup_contract).  
-00025660: 2020 2020 2020 2020 2020 2b20 4f46 4643            + OFFC
-00025670: 4841 494e 5f4c 4f4f 4b55 505f 5245 5455  HAIN_LOOKUP_RETU
-00025680: 524e 5f44 4154 410a 2020 2020 2020 2020  RN_DATA.        
-00025690: 290a 2020 2020 2020 2020 2320 7465 7374  ).        # test
-000256a0: 2043 6f6e 7472 6163 7446 756e 6374 696f   ContractFunctio
-000256b0: 6e20 6361 6c6c 0a20 2020 2020 2020 2077  n call.        w
-000256c0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-000256d0: 7328 4f66 6663 6861 696e 4c6f 6f6b 7570  s(OffchainLookup
-000256e0: 2920 6173 2065 3a0a 2020 2020 2020 2020  ) as e:.        
-000256f0: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
-00025700: 6b75 705f 636f 6e74 7261 6374 2e66 756e  kup_contract.fun
-00025710: 6374 696f 6e73 2e74 6573 744f 6666 6368  ctions.testOffch
-00025720: 6169 6e4c 6f6f 6b75 7028 0a20 2020 2020  ainLookup(.     
-00025730: 2020 2020 2020 2020 2020 204f 4646 4348             OFFCH
-00025740: 4149 4e5f 4c4f 4f4b 5550 5f54 4553 545f  AIN_LOOKUP_TEST_
-00025750: 4441 5441 0a20 2020 2020 2020 2020 2020  DATA.           
-00025760: 2029 2e63 616c 6c28 6363 6970 5f72 6561   ).call(ccip_rea
-00025770: 645f 656e 6162 6c65 643d 4661 6c73 6529  d_enabled=False)
-00025780: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00025790: 652e 7661 6c75 652e 6461 7461 203d 3d20  e.value.data == 
-000257a0: 7265 7475 726e 5f64 6174 610a 0a20 2020  return_data..   
-000257b0: 2020 2020 2023 2074 6573 7420 436f 6e74       # test Cont
-000257c0: 7261 6374 4361 6c6c 6572 2063 616c 6c0a  ractCaller call.
-000257d0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-000257e0: 6573 742e 7261 6973 6573 284f 6666 6368  est.raises(Offch
-000257f0: 6169 6e4c 6f6f 6b75 7029 2061 7320 6578  ainLookup) as ex
-00025800: 6369 6e66 6f3a 0a20 2020 2020 2020 2020  cinfo:.         
-00025810: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
-00025820: 7570 5f63 6f6e 7472 6163 742e 6361 6c6c  up_contract.call
-00025830: 6572 2863 6369 705f 7265 6164 5f65 6e61  er(ccip_read_ena
-00025840: 626c 6564 3d46 616c 7365 292e 7465 7374  bled=False).test
-00025850: 4f66 6663 6861 696e 4c6f 6f6b 7570 280a  OffchainLookup(.
-00025860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025870: 4f46 4643 4841 494e 5f4c 4f4f 4b55 505f  OFFCHAIN_LOOKUP_
-00025880: 5445 5354 5f44 4154 410a 2020 2020 2020  TEST_DATA.      
-00025890: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000258a0: 6173 7365 7274 2065 7863 696e 666f 2e76  assert excinfo.v
-000258b0: 616c 7565 2e64 6174 6120 3d3d 2072 6574  alue.data == ret
-000258c0: 7572 6e5f 6461 7461 0a0a 2020 2020 2020  urn_data..      
-000258d0: 2020 2320 7465 7374 2067 6c6f 6261 6c20    # test global 
-000258e0: 666c 6167 206f 6e20 7468 6520 7072 6f76  flag on the prov
-000258f0: 6964 6572 0a20 2020 2020 2020 2077 332e  ider.        w3.
-00025900: 7072 6f76 6964 6572 2e67 6c6f 6261 6c5f  provider.global_
-00025910: 6363 6970 5f72 6561 645f 656e 6162 6c65  ccip_read_enable
-00025920: 6420 3d20 4661 6c73 650a 0a20 2020 2020  d = False..     
-00025930: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00025940: 6169 7365 7328 4f66 6663 6861 696e 4c6f  aises(OffchainLo
-00025950: 6f6b 7570 2920 6173 2065 7863 5f69 6e66  okup) as exc_inf
-00025960: 6f3a 0a20 2020 2020 2020 2020 2020 206f  o:.            o
-00025970: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-00025980: 6f6e 7472 6163 742e 6675 6e63 7469 6f6e  ontract.function
-00025990: 732e 7465 7374 4f66 6663 6861 696e 4c6f  s.testOffchainLo
-000259a0: 6f6b 7570 280a 2020 2020 2020 2020 2020  okup(.          
-000259b0: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
-000259c0: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
-000259d0: 2020 2020 2020 2020 2020 2020 292e 6361              ).ca
-000259e0: 6c6c 2829 0a20 2020 2020 2020 2061 7373  ll().        ass
-000259f0: 6572 7420 6578 635f 696e 666f 2e76 616c  ert exc_info.val
-00025a00: 7565 2e64 6174 6120 3d3d 2072 6574 7572  ue.data == retur
-00025a10: 6e5f 6461 7461 0a0a 2020 2020 2020 2020  n_data..        
-00025a20: 7733 2e70 726f 7669 6465 722e 676c 6f62  w3.provider.glob
-00025a30: 616c 5f63 6369 705f 7265 6164 5f65 6e61  al_ccip_read_ena
-00025a40: 626c 6564 203d 2054 7275 6520 2023 2063  bled = True  # c
-00025a50: 6c65 616e 7570 0a0a 2020 2020 6465 6620  leanup..    def 
-00025a60: 7465 7374 5f65 7468 5f63 616c 6c5f 6f66  test_eth_call_of
-00025a70: 6663 6861 696e 5f6c 6f6f 6b75 705f 6361  fchain_lookup_ca
-00025a80: 6c6c 5f66 6c61 675f 6f76 6572 7269 6465  ll_flag_override
-00025a90: 735f 7072 6f76 6964 6572 5f66 6c61 6728  s_provider_flag(
-00025aa0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00025ab0: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
-00025ac0: 222c 0a20 2020 2020 2020 206f 6666 6368  ",.        offch
-00025ad0: 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472  ain_lookup_contr
-00025ae0: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-00025af0: 0a20 2020 2020 2020 206b 6579 6669 6c65  .        keyfile
-00025b00: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00025b10: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00025b20: 732c 0a20 2020 2020 2020 206d 6f6e 6b65  s,.        monke
-00025b30: 7970 6174 6368 3a20 224d 6f6e 6b65 7950  ypatch: "MonkeyP
-00025b40: 6174 6368 222c 0a20 2020 2029 202d 3e20  atch",.    ) -> 
-00025b50: 4e6f 6e65 3a0a 2020 2020 2020 2020 6e6f  None:.        no
-00025b60: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-00025b70: 745f 6164 6472 6573 7320 3d20 746f 5f68  t_address = to_h
-00025b80: 6578 5f69 665f 6279 7465 7328 0a20 2020  ex_if_bytes(.   
-00025b90: 2020 2020 2020 2020 206f 6666 6368 6169           offchai
-00025ba0: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
-00025bb0: 742e 6164 6472 6573 730a 2020 2020 2020  t.address.      
-00025bc0: 2020 292e 6c6f 7765 7228 290a 2020 2020    ).lower().    
-00025bd0: 2020 2020 6d6f 636b 5f6f 6666 6368 6169      mock_offchai
-00025be0: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
-00025bf0: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
-00025c00: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
-00025c10: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
-00025c20: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
-00025c30: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
-00025c40: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
-00025c50: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
-00025c60: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
-00025c70: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
-00025c80: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
-00025c90: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
-00025ca0: 2020 2020 2020 2020 6d6f 636b 6564 5f6a          mocked_j
-00025cb0: 736f 6e5f 6461 7461 3d57 4542 3350 595f  son_data=WEB3PY_
-00025cc0: 4153 5f48 4558 4259 5445 532c 0a20 2020  AS_HEXBYTES,.   
-00025cd0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00025ce0: 7733 2e70 726f 7669 6465 722e 676c 6f62  w3.provider.glob
-00025cf0: 616c 5f63 6369 705f 7265 6164 5f65 6e61  al_ccip_read_ena
-00025d00: 626c 6564 203d 2046 616c 7365 0a0a 2020  bled = False..  
-00025d10: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00025d20: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
-00025d30: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
-00025d40: 6f6e 732e 7465 7374 4f66 6663 6861 696e  ons.testOffchain
-00025d50: 4c6f 6f6b 7570 280a 2020 2020 2020 2020  Lookup(.        
-00025d60: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
-00025d70: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
-00025d80: 2020 2020 2020 292e 6361 6c6c 2863 6369        ).call(cci
-00025d90: 705f 7265 6164 5f65 6e61 626c 6564 3d54  p_read_enabled=T
-00025da0: 7275 6529 0a20 2020 2020 2020 2061 7373  rue).        ass
-00025db0: 6572 7420 7733 2e63 6f64 6563 2e64 6563  ert w3.codec.dec
-00025dc0: 6f64 6528 5b22 7374 7269 6e67 225d 2c20  ode(["string"], 
-00025dd0: 7265 7370 6f6e 7365 295b 305d 203d 3d20  response)[0] == 
-00025de0: 2277 6562 3370 7922 0a0a 2020 2020 2020  "web3py"..      
-00025df0: 2020 7733 2e70 726f 7669 6465 722e 676c    w3.provider.gl
-00025e00: 6f62 616c 5f63 6369 705f 7265 6164 5f65  obal_ccip_read_e
-00025e10: 6e61 626c 6564 203d 2054 7275 6520 2023  nabled = True  #
-00025e20: 2063 6c65 616e 7570 0a0a 2020 2020 4070   cleanup..    @p
-00025e30: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00025e40: 6574 7269 7a65 2822 6d61 785f 7265 6469  etrize("max_redi
-00025e50: 7265 6374 7322 2c20 7261 6e67 6528 2d31  rects", range(-1
-00025e60: 2c20 3429 290a 2020 2020 6465 6620 7465  , 4)).    def te
-00025e70: 7374 5f65 7468 5f63 616c 6c5f 6f66 6663  st_eth_call_offc
-00025e80: 6861 696e 5f6c 6f6f 6b75 705f 7261 6973  hain_lookup_rais
-00025e90: 6573 5f69 665f 6d61 785f 7265 6469 7265  es_if_max_redire
-00025ea0: 6374 735f 6973 5f6c 6573 735f 7468 616e  cts_is_less_than
-00025eb0: 5f34 280a 2020 2020 2020 2020 7365 6c66  _4(.        self
-00025ec0: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
-00025ed0: 6562 3322 2c0a 2020 2020 2020 2020 6f66  eb3",.        of
-00025ee0: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-00025ef0: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
-00025f00: 7422 2c0a 2020 2020 2020 2020 6d61 785f  t",.        max_
-00025f10: 7265 6469 7265 6374 733a 2069 6e74 2c0a  redirects: int,.
-00025f20: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00025f30: 2020 2020 2020 2064 6566 6175 6c74 5f6d         default_m
-00025f40: 6178 5f72 6564 6972 6563 7473 203d 2077  ax_redirects = w
-00025f50: 332e 7072 6f76 6964 6572 2e63 6369 705f  3.provider.ccip_
-00025f60: 7265 6164 5f6d 6178 5f72 6564 6972 6563  read_max_redirec
-00025f70: 7473 0a0a 2020 2020 2020 2020 7733 2e70  ts..        w3.p
-00025f80: 726f 7669 6465 722e 6363 6970 5f72 6561  rovider.ccip_rea
-00025f90: 645f 6d61 785f 7265 6469 7265 6374 7320  d_max_redirects 
-00025fa0: 3d20 6d61 785f 7265 6469 7265 6374 730a  = max_redirects.
-00025fb0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-00025fc0: 6573 742e 7261 6973 6573 2857 6562 3356  est.raises(Web3V
-00025fd0: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
-00025fe0: 3d22 6174 206c 6561 7374 2034 2229 3a0a  ="at least 4"):.
-00025ff0: 2020 2020 2020 2020 2020 2020 6f66 6663              offc
-00026000: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
-00026010: 7261 6374 2e66 756e 6374 696f 6e73 2e74  ract.functions.t
-00026020: 6573 744f 6666 6368 6169 6e4c 6f6f 6b75  estOffchainLooku
-00026030: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00026040: 2020 204f 4646 4348 4149 4e5f 4c4f 4f4b     OFFCHAIN_LOOK
-00026050: 5550 5f54 4553 545f 4441 5441 0a20 2020  UP_TEST_DATA.   
-00026060: 2020 2020 2020 2020 2029 2e63 616c 6c28           ).call(
-00026070: 290a 0a20 2020 2020 2020 2077 332e 7072  )..        w3.pr
-00026080: 6f76 6964 6572 2e63 6369 705f 7265 6164  ovider.ccip_read
-00026090: 5f6d 6178 5f72 6564 6972 6563 7473 203d  _max_redirects =
-000260a0: 2064 6566 6175 6c74 5f6d 6178 5f72 6564   default_max_red
-000260b0: 6972 6563 7473 2020 2320 636c 6561 6e75  irects  # cleanu
-000260c0: 700a 0a20 2020 2064 6566 2074 6573 745f  p..    def test_
-000260d0: 6574 685f 6361 6c6c 5f6f 6666 6368 6169  eth_call_offchai
-000260e0: 6e5f 6c6f 6f6b 7570 5f72 6169 7365 735f  n_lookup_raises_
-000260f0: 666f 725f 696d 7072 6f70 6572 6c79 5f66  for_improperly_f
-00026100: 6f72 6d61 7474 6564 5f72 6573 745f 7265  ormatted_rest_re
-00026110: 7175 6573 745f 7265 7370 6f6e 7365 2820  quest_response( 
-00026120: 2023 206e 6f71 613a 2045 3530 310a 2020   # noqa: E501.  
-00026130: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00026140: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
-00026150: 2020 2020 2020 2020 6f66 6663 6861 696e          offchain
-00026160: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
-00026170: 3a20 2243 6f6e 7472 6163 7422 2c0a 2020  : "Contract",.  
-00026180: 2020 2020 2020 6b65 7966 696c 655f 6163        keyfile_ac
-00026190: 636f 756e 745f 6164 6472 6573 733a 2043  count_address: C
-000261a0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-000261b0: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-000261c0: 7463 683a 2022 4d6f 6e6b 6579 5061 7463  tch: "MonkeyPatc
-000261d0: 6822 2c0a 2020 2020 2920 2d3e 204e 6f6e  h",.    ) -> Non
-000261e0: 653a 0a20 2020 2020 2020 206e 6f72 6d61  e:.        norma
-000261f0: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
-00026200: 6464 7265 7373 203d 2074 6f5f 6865 785f  ddress = to_hex_
-00026210: 6966 5f62 7974 6573 280a 2020 2020 2020  if_bytes(.      
-00026220: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
-00026230: 6f6f 6b75 705f 636f 6e74 7261 6374 2e61  ookup_contract.a
-00026240: 6464 7265 7373 0a20 2020 2020 2020 2029  ddress.        )
-00026250: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
-00026260: 206d 6f63 6b5f 6f66 6663 6861 696e 5f6c   mock_offchain_l
-00026270: 6f6f 6b75 705f 7265 7175 6573 745f 7265  ookup_request_re
-00026280: 7370 6f6e 7365 280a 2020 2020 2020 2020  sponse(.        
-00026290: 2020 2020 6d6f 6e6b 6579 7061 7463 682c      monkeypatch,
-000262a0: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-000262b0: 6b65 645f 7265 7175 6573 745f 7572 6c3d  ked_request_url=
-000262c0: 6622 6874 7470 733a 2f2f 7765 6233 2e70  f"https://web3.p
-000262d0: 792f 6761 7465 7761 792f 7b6e 6f72 6d61  y/gateway/{norma
-000262e0: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
-000262f0: 6464 7265 7373 7d2f 7b4f 4646 4348 4149  ddress}/{OFFCHAI
-00026300: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
-00026310: 5441 7d2e 6a73 6f6e 222c 2020 2320 6e6f  TA}.json",  # no
-00026320: 7161 3a20 4535 3031 0a20 2020 2020 2020  qa: E501.       
-00026330: 2020 2020 206d 6f63 6b65 645f 6a73 6f6e       mocked_json
-00026340: 5f64 6174 613d 5745 4233 5059 5f41 535f  _data=WEB3PY_AS_
-00026350: 4845 5842 5954 4553 2c0a 2020 2020 2020  HEXBYTES,.      
-00026360: 2020 2020 2020 6a73 6f6e 5f64 6174 615f        json_data_
-00026370: 6669 656c 643d 226e 6f74 5f64 6174 6122  field="not_data"
-00026380: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00026390: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000263a0: 7261 6973 6573 2857 6562 3356 616c 6964  raises(Web3Valid
-000263b0: 6174 696f 6e45 7272 6f72 2c20 6d61 7463  ationError, matc
-000263c0: 683d 226d 6973 7369 6e67 2027 6461 7461  h="missing 'data
-000263d0: 2720 6669 656c 6422 293a 0a20 2020 2020  ' field"):.     
-000263e0: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
-000263f0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-00026400: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-00026410: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
-00026420: 2020 2020 2020 2020 2020 2020 2020 4f46                OF
-00026430: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-00026440: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
-00026450: 2020 2020 292e 6361 6c6c 2829 0a0a 2020      ).call()..  
-00026460: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
-00026470: 6172 616d 6574 7269 7a65 2822 7374 6174  arametrize("stat
-00026480: 7573 5f63 6f64 655f 6e6f 6e5f 3478 785f  us_code_non_4xx_
-00026490: 6572 726f 7222 2c20 5b31 3030 2c20 3330  error", [100, 30
-000264a0: 302c 2035 3030 2c20 3630 305d 290a 2020  0, 500, 600]).  
-000264b0: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-000264c0: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
-000264d0: 6b75 705f 7472 6965 735f 6e65 7874 5f75  kup_tries_next_u
-000264e0: 726c 5f66 6f72 5f6e 6f6e 5f34 7878 5f65  rl_for_non_4xx_e
-000264f0: 7272 6f72 5f73 7461 7475 735f 616e 645f  rror_status_and_
-00026500: 7465 7374 735f 504f 5354 2820 2023 206e  tests_POST(  # n
-00026510: 6f71 613a 2045 3530 310a 2020 2020 2020  oqa: E501.      
-00026520: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00026530: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
-00026540: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
-00026550: 6b75 705f 636f 6e74 7261 6374 3a20 2243  kup_contract: "C
-00026560: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
-00026570: 2020 6b65 7966 696c 655f 6163 636f 756e    keyfile_accoun
-00026580: 745f 6164 6472 6573 733a 2043 6865 636b  t_address: Check
-00026590: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
-000265a0: 2020 2020 6d6f 6e6b 6579 7061 7463 683a      monkeypatch:
-000265b0: 2022 4d6f 6e6b 6579 5061 7463 6822 2c0a   "MonkeyPatch",.
-000265c0: 2020 2020 2020 2020 7374 6174 7573 5f63          status_c
-000265d0: 6f64 655f 6e6f 6e5f 3478 785f 6572 726f  ode_non_4xx_erro
-000265e0: 723a 2069 6e74 2c0a 2020 2020 2920 2d3e  r: int,.    ) ->
-000265f0: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
-00026600: 6f72 6d61 6c69 7a65 645f 636f 6e74 7261  ormalized_contra
-00026610: 6374 5f61 6464 7265 7373 203d 2074 6f5f  ct_address = to_
-00026620: 6865 785f 6966 5f62 7974 6573 280a 2020  hex_if_bytes(.  
-00026630: 2020 2020 2020 2020 2020 6f66 6663 6861            offcha
-00026640: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
-00026650: 6374 2e61 6464 7265 7373 0a20 2020 2020  ct.address.     
-00026660: 2020 2029 2e6c 6f77 6572 2829 0a0a 2020     ).lower()..  
-00026670: 2020 2020 2020 2320 5468 6520 6e65 7874        # The next
-00026680: 2075 726c 2069 6e20 6f75 7220 7465 7374   url in our test
-00026690: 2063 6f6e 7472 6163 7420 646f 6573 6e27   contract doesn'
-000266a0: 7420 636f 6e74 6169 6e20 277b 6461 7461  t contain '{data
-000266b0: 7d27 2c20 7472 6967 6765 7269 6e67 0a20  }', triggering. 
-000266c0: 2020 2020 2020 2023 2074 6865 2050 4f53         # the POS
-000266d0: 5420 7265 7175 6573 7420 6c6f 6769 632e  T request logic.
-000266e0: 2054 6865 2069 6465 6120 6865 7265 2069   The idea here i
-000266f0: 7320 746f 2072 6574 7572 6e20 6120 6261  s to return a ba
-00026700: 6420 7374 6174 7573 2066 6f72 0a20 2020  d status for.   
-00026710: 2020 2020 2023 2074 6865 2066 6972 7374       # the first
-00026720: 2075 726c 2028 4745 5429 2061 6e64 2061   url (GET) and a
-00026730: 2073 7563 6365 7373 2073 7461 7475 7320   success status 
-00026740: 6672 6f6d 2074 6865 2073 6563 6f6e 6420  from the second 
-00026750: 6361 6c6c 2028 504f 5354 290a 2020 2020  call (POST).    
-00026760: 2020 2020 2320 746f 2074 6573 7420 626f      # to test bo
-00026770: 7468 2074 6861 7420 7765 206d 6f76 6520  th that we move 
-00026780: 6f6e 2074 6f20 7468 6520 6e65 7874 2075  on to the next u
-00026790: 726c 2077 6974 6820 6e6f 6e20 3478 7820  rl with non 4xx 
-000267a0: 7374 6174 7573 2061 6e64 0a20 2020 2020  status and.     
-000267b0: 2020 2023 2074 6861 7420 7468 6520 504f     # that the PO
-000267c0: 5354 206c 6f67 6963 2069 7320 616c 736f  ST logic is also
-000267d0: 2077 6f72 6b69 6e67 2061 7320 6578 7065   working as expe
-000267e0: 6374 6564 2e0a 2020 2020 2020 2020 6d6f  cted..        mo
-000267f0: 636b 5f6f 6666 6368 6169 6e5f 6c6f 6f6b  ck_offchain_look
-00026800: 7570 5f72 6571 7565 7374 5f72 6573 706f  up_request_respo
-00026810: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
-00026820: 206d 6f6e 6b65 7970 6174 6368 2c0a 2020   monkeypatch,.  
-00026830: 2020 2020 2020 2020 2020 6d6f 636b 6564            mocked
-00026840: 5f72 6571 7565 7374 5f75 726c 3d66 2268  _request_url=f"h
-00026850: 7474 7073 3a2f 2f77 6562 332e 7079 2f67  ttps://web3.py/g
-00026860: 6174 6577 6179 2f7b 6e6f 726d 616c 697a  ateway/{normaliz
-00026870: 6564 5f63 6f6e 7472 6163 745f 6164 6472  ed_contract_addr
-00026880: 6573 737d 2f7b 4f46 4643 4841 494e 5f4c  ess}/{OFFCHAIN_L
-00026890: 4f4f 4b55 505f 5445 5354 5f44 4154 417d  OOKUP_TEST_DATA}
-000268a0: 2e6a 736f 6e22 2c20 2023 206e 6f71 613a  .json",  # noqa:
-000268b0: 2045 3530 310a 2020 2020 2020 2020 2020   E501.          
-000268c0: 2020 6d6f 636b 6564 5f73 7461 7475 735f    mocked_status_
-000268d0: 636f 6465 3d73 7461 7475 735f 636f 6465  code=status_code
-000268e0: 5f6e 6f6e 5f34 7878 5f65 7272 6f72 2c0a  _non_4xx_error,.
-000268f0: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
-00026900: 6564 5f6a 736f 6e5f 6461 7461 3d57 4542  ed_json_data=WEB
-00026910: 3350 595f 4153 5f48 4558 4259 5445 532c  3PY_AS_HEXBYTES,
-00026920: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00026930: 2020 206d 6f63 6b5f 6f66 6663 6861 696e     mock_offchain
-00026940: 5f6c 6f6f 6b75 705f 7265 7175 6573 745f  _lookup_request_
-00026950: 7265 7370 6f6e 7365 280a 2020 2020 2020  response(.      
-00026960: 2020 2020 2020 6d6f 6e6b 6579 7061 7463        monkeypatc
-00026970: 682c 0a20 2020 2020 2020 2020 2020 2068  h,.            h
-00026980: 7474 705f 6d65 7468 6f64 3d22 504f 5354  ttp_method="POST
-00026990: 222c 0a20 2020 2020 2020 2020 2020 206d  ",.            m
-000269a0: 6f63 6b65 645f 7265 7175 6573 745f 7572  ocked_request_ur
-000269b0: 6c3d 6622 6874 7470 733a 2f2f 7765 6233  l=f"https://web3
-000269c0: 2e70 792f 6761 7465 7761 792f 7b6e 6f72  .py/gateway/{nor
-000269d0: 6d61 6c69 7a65 645f 636f 6e74 7261 6374  malized_contract
-000269e0: 5f61 6464 7265 7373 7d2e 6a73 6f6e 222c  _address}.json",
-000269f0: 2020 2320 6e6f 7161 3a20 4535 3031 0a20    # noqa: E501. 
-00026a00: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
-00026a10: 645f 7374 6174 7573 5f63 6f64 653d 3230  d_status_code=20
-00026a20: 302c 0a20 2020 2020 2020 2020 2020 206d  0,.            m
-00026a30: 6f63 6b65 645f 6a73 6f6e 5f64 6174 613d  ocked_json_data=
-00026a40: 5745 4233 5059 5f41 535f 4845 5842 5954  WEB3PY_AS_HEXBYT
-00026a50: 4553 2c0a 2020 2020 2020 2020 2020 2020  ES,.            
-00026a60: 7365 6e64 6572 3d6e 6f72 6d61 6c69 7a65  sender=normalize
-00026a70: 645f 636f 6e74 7261 6374 5f61 6464 7265  d_contract_addre
-00026a80: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
-00026a90: 6361 6c6c 6461 7461 3d4f 4646 4348 4149  calldata=OFFCHAI
-00026aa0: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
-00026ab0: 5441 2c0a 2020 2020 2020 2020 290a 2020  TA,.        ).  
-00026ac0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00026ad0: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
-00026ae0: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
-00026af0: 6f6e 732e 7465 7374 4f66 6663 6861 696e  ons.testOffchain
-00026b00: 4c6f 6f6b 7570 280a 2020 2020 2020 2020  Lookup(.        
-00026b10: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
-00026b20: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
-00026b30: 2020 2020 2020 292e 6361 6c6c 2829 0a20        ).call(). 
-00026b40: 2020 2020 2020 2061 7373 6572 7420 7733         assert w3
-00026b50: 2e63 6f64 6563 2e64 6563 6f64 6528 5b22  .codec.decode(["
-00026b60: 7374 7269 6e67 225d 2c20 7265 7370 6f6e  string"], respon
-00026b70: 7365 295b 305d 203d 3d20 2277 6562 3370  se)[0] == "web3p
-00026b80: 7922 0a0a 2020 2020 6465 6620 7465 7374  y"..    def test
-00026b90: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
-00026ba0: 696e 5f6c 6f6f 6b75 705f 6361 6c6c 735f  in_lookup_calls_
-00026bb0: 7261 6973 655f 666f 725f 7374 6174 7573  raise_for_status
-00026bc0: 5f66 6f72 5f34 7878 5f73 7461 7475 735f  _for_4xx_status_
-00026bd0: 636f 6465 280a 2020 2020 2020 2020 7365  code(.        se
-00026be0: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
-00026bf0: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
-00026c00: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00026c10: 636f 6e74 7261 6374 3a20 2243 6f6e 7472  contract: "Contr
-00026c20: 6163 7422 2c0a 2020 2020 2020 2020 6b65  act",.        ke
-00026c30: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-00026c40: 6472 6573 733a 2043 6865 636b 7375 6d41  dress: ChecksumA
-00026c50: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-00026c60: 6d6f 6e6b 6579 7061 7463 683a 2022 4d6f  monkeypatch: "Mo
-00026c70: 6e6b 6579 5061 7463 6822 2c0a 2020 2020  nkeyPatch",.    
-00026c80: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00026c90: 2020 206e 6f72 6d61 6c69 7a65 645f 636f     normalized_co
-00026ca0: 6e74 7261 6374 5f61 6464 7265 7373 203d  ntract_address =
-00026cb0: 2074 6f5f 6865 785f 6966 5f62 7974 6573   to_hex_if_bytes
-00026cc0: 280a 2020 2020 2020 2020 2020 2020 6f66  (.            of
-00026cd0: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
-00026ce0: 6e74 7261 6374 2e61 6464 7265 7373 0a20  ntract.address. 
-00026cf0: 2020 2020 2020 2029 2e6c 6f77 6572 2829         ).lower()
-00026d00: 0a20 2020 2020 2020 206d 6f63 6b5f 6f66  .        mock_of
-00026d10: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
-00026d20: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
-00026d30: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
-00026d40: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
-00026d50: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
-00026d60: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
-00026d70: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
-00026d80: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
-00026d90: 6e74 7261 6374 5f61 6464 7265 7373 7d2f  ntract_address}/
-00026da0: 7b4f 4646 4348 4149 4e5f 4c4f 4f4b 5550  {OFFCHAIN_LOOKUP
-00026db0: 5f54 4553 545f 4441 5441 7d2e 6a73 6f6e  _TEST_DATA}.json
-00026dc0: 222c 2020 2320 6e6f 7161 3a20 4535 3031  ",  # noqa: E501
-00026dd0: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
-00026de0: 6b65 645f 7374 6174 7573 5f63 6f64 653d  ked_status_code=
-00026df0: 7261 6e64 696e 7428 3430 302c 2034 3939  randint(400, 499
-00026e00: 292c 0a20 2020 2020 2020 2020 2020 206d  ),.            m
-00026e10: 6f63 6b65 645f 6a73 6f6e 5f64 6174 613d  ocked_json_data=
-00026e20: 5745 4233 5059 5f41 535f 4845 5842 5954  WEB3PY_AS_HEXBYT
-00026e30: 4553 2c0a 2020 2020 2020 2020 290a 2020  ES,.        ).  
-00026e40: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00026e50: 742e 7261 6973 6573 2845 7863 6570 7469  t.raises(Excepti
-00026e60: 6f6e 2c20 6d61 7463 683d 2263 616c 6c65  on, match="calle
-00026e70: 6420 7261 6973 655f 666f 725f 7374 6174  d raise_for_stat
-00026e80: 7573 5c5c 285c 5c29 2229 3a0a 2020 2020  us\\(\\)"):.    
-00026e90: 2020 2020 2020 2020 6f66 6663 6861 696e          offchain
-00026ea0: 5f6c 6f6f 6b75 705f 636f 6e74 7261 6374  _lookup_contract
-00026eb0: 2e66 756e 6374 696f 6e73 2e74 6573 744f  .functions.testO
-00026ec0: 6666 6368 6169 6e4c 6f6f 6b75 7028 0a20  ffchainLookup(. 
-00026ed0: 2020 2020 2020 2020 2020 2020 2020 204f                 O
-00026ee0: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
-00026ef0: 4553 545f 4441 5441 0a20 2020 2020 2020  EST_DATA.       
-00026f00: 2020 2020 2029 2e63 616c 6c28 290a 0a20       ).call().. 
-00026f10: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00026f20: 6361 6c6c 5f6f 6666 6368 6169 6e5f 6c6f  call_offchain_lo
-00026f30: 6f6b 7570 5f72 6169 7365 735f 7768 656e  okup_raises_when
-00026f40: 5f61 6c6c 5f73 7570 706c 6965 645f 7572  _all_supplied_ur
-00026f50: 6c73 5f66 6169 6c28 0a20 2020 2020 2020  ls_fail(.       
-00026f60: 2073 656c 662c 0a20 2020 2020 2020 206f   self,.        o
-00026f70: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
-00026f80: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
-00026f90: 6374 222c 0a20 2020 2029 202d 3e20 4e6f  ct",.    ) -> No
-00026fa0: 6e65 3a0a 2020 2020 2020 2020 2320 4745  ne:.        # GE
-00026fb0: 5420 616e 6420 504f 5354 2072 6571 7565  T and POST reque
-00026fc0: 7374 7320 7368 6f75 6c64 2066 6169 6c20  sts should fail 
-00026fd0: 7369 6e63 6520 7265 7370 6f6e 7365 7320  since responses 
-00026fe0: 6172 6520 6e6f 7420 6d6f 636b 6564 0a20  are not mocked. 
-00026ff0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00027000: 7374 2e72 6169 7365 7328 0a20 2020 2020  st.raises(.     
-00027010: 2020 2020 2020 204d 756c 7469 706c 6546         MultipleF
-00027020: 6169 6c65 6452 6571 7565 7374 732c 206d  ailedRequests, m
-00027030: 6174 6368 3d22 4f66 6663 6861 696e 206c  atch="Offchain l
-00027040: 6f6f 6b75 7020 6661 696c 6564 2066 6f72  ookup failed for
-00027050: 2073 7570 706c 6965 6420 7572 6c73 220a   supplied urls".
-00027060: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00027070: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
-00027080: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
-00027090: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
-000270a0: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
-000270b0: 2020 2020 2020 2020 2020 2020 2020 4f46                OF
-000270c0: 4643 4841 494e 5f4c 4f4f 4b55 505f 5445  FCHAIN_LOOKUP_TE
-000270d0: 5354 5f44 4154 410a 2020 2020 2020 2020  ST_DATA.        
-000270e0: 2020 2020 292e 6361 6c6c 2829 0a0a 2020      ).call()..  
-000270f0: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
-00027100: 616c 6c5f 636f 6e74 696e 756f 7573 5f6f  all_continuous_o
-00027110: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
-00027120: 6169 7365 735f 7769 7468 5f74 6f6f 5f6d  aises_with_too_m
-00027130: 616e 795f 7265 7175 6573 7473 280a 2020  any_requests(.  
-00027140: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00027150: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
-00027160: 6b75 705f 636f 6e74 7261 6374 3a20 2243  kup_contract: "C
-00027170: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
-00027180: 2020 6d6f 6e6b 6579 7061 7463 683a 2022    monkeypatch: "
-00027190: 4d6f 6e6b 6579 5061 7463 6822 2c0a 2020  MonkeyPatch",.  
-000271a0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000271b0: 2020 2020 206e 6f72 6d61 6c69 7a65 645f       normalized_
-000271c0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-000271d0: 203d 2074 6f5f 6865 785f 6966 5f62 7974   = to_hex_if_byt
-000271e0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-000271f0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00027200: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
-00027210: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
-00027220: 2829 0a20 2020 2020 2020 206d 6f63 6b5f  ().        mock_
-00027230: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
-00027240: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
-00027250: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
-00027260: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
-00027270: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
-00027280: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
-00027290: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
-000272a0: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
-000272b0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
-000272c0: 7d2f 3078 2e6a 736f 6e22 2c20 2023 206e  }/0x.json",  # n
-000272d0: 6f71 613a 2045 3530 310a 2020 2020 2020  oqa: E501.      
-000272e0: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-000272f0: 2070 7974 6573 742e 7261 6973 6573 2854   pytest.raises(T
-00027300: 6f6f 4d61 6e79 5265 7175 6573 7473 2c20  ooManyRequests, 
-00027310: 6d61 7463 683d 2254 6f6f 206d 616e 7920  match="Too many 
-00027320: 4343 4950 2072 6561 6420 7265 6469 7265  CCIP read redire
-00027330: 6374 7322 293a 0a20 2020 2020 2020 2020  cts"):.         
-00027340: 2020 206f 6666 6368 6169 6e5f 6c6f 6f6b     offchain_look
-00027350: 7570 5f63 6f6e 7472 6163 742e 6361 6c6c  up_contract.call
-00027360: 6572 2829 2e63 6f6e 7469 6e75 6f75 734f  er().continuousO
-00027370: 6666 6368 6169 6e4c 6f6f 6b75 7028 290a  ffchainLookup().
-00027380: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00027390: 685f 6573 7469 6d61 7465 5f67 6173 5f72  h_estimate_gas_r
-000273a0: 6576 6572 745f 7769 7468 5f6d 7367 280a  evert_with_msg(.
-000273b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000273c0: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
-000273d0: 2c0a 2020 2020 2020 2020 7265 7665 7274  ,.        revert
-000273e0: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
-000273f0: 7261 6374 222c 0a20 2020 2020 2020 206b  ract",.        k
-00027400: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00027410: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
-00027420: 4164 6472 6573 732c 0a20 2020 2029 202d  Address,.    ) -
-00027430: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00027440: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00027450: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00027460: 436f 6e74 7261 6374 4c6f 6769 6345 7272  ContractLogicErr
-00027470: 6f72 2c20 6d61 7463 683d 2265 7865 6375  or, match="execu
-00027480: 7469 6f6e 2072 6576 6572 7465 643a 2046  tion reverted: F
-00027490: 756e 6374 696f 6e20 6861 7320 6265 656e  unction has been
-000274a0: 2072 6576 6572 7465 6422 0a20 2020 2020   reverted".     
-000274b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-000274c0: 2020 7478 6e5f 7061 7261 6d73 203d 2072    txn_params = r
-000274d0: 6576 6572 745f 636f 6e74 7261 6374 2e5f  evert_contract._
-000274e0: 7072 6570 6172 655f 7472 616e 7361 6374  prepare_transact
-000274f0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00027500: 2020 2020 2066 6e5f 6e61 6d65 3d22 7265       fn_name="re
-00027510: 7665 7274 5769 7468 4d65 7373 6167 6522  vertWithMessage"
-00027520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027530: 2020 7472 616e 7361 6374 696f 6e3d 7b0a    transaction={.
-00027540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027550: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-00027560: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00027570: 6573 732c 0a20 2020 2020 2020 2020 2020  ess,.           
-00027580: 2020 2020 2020 2020 2022 746f 223a 2072           "to": r
-00027590: 6576 6572 745f 636f 6e74 7261 6374 2e61  evert_contract.a
-000275a0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
-000275b0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-000275c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000275d0: 2020 2020 2077 332e 6574 682e 6573 7469       w3.eth.esti
-000275e0: 6d61 7465 5f67 6173 2874 786e 5f70 6172  mate_gas(txn_par
-000275f0: 616d 7329 0a0a 2020 2020 6465 6620 7465  ams)..    def te
-00027600: 7374 5f65 7468 5f65 7374 696d 6174 655f  st_eth_estimate_
-00027610: 6761 735f 7265 7665 7274 5f77 6974 686f  gas_revert_witho
-00027620: 7574 5f6d 7367 280a 2020 2020 2020 2020  ut_msg(.        
-00027630: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-00027640: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-00027650: 2020 7265 7665 7274 5f63 6f6e 7472 6163    revert_contrac
-00027660: 743a 2022 436f 6e74 7261 6374 222c 0a20  t: "Contract",. 
-00027670: 2020 2020 2020 206b 6579 6669 6c65 5f61         keyfile_a
-00027680: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
-00027690: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
-000276a0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-000276b0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-000276c0: 6573 742e 7261 6973 6573 2843 6f6e 7472  est.raises(Contr
-000276d0: 6163 744c 6f67 6963 4572 726f 722c 206d  actLogicError, m
-000276e0: 6174 6368 3d22 6578 6563 7574 696f 6e20  atch="execution 
-000276f0: 7265 7665 7274 6564 2229 3a0a 2020 2020  reverted"):.    
-00027700: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
-00027710: 6d73 203d 2072 6576 6572 745f 636f 6e74  ms = revert_cont
-00027720: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
-00027730: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
-00027740: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
-00027750: 6d65 3d22 7265 7665 7274 5769 7468 6f75  me="revertWithou
-00027760: 744d 6573 7361 6765 222c 0a20 2020 2020  tMessage",.     
-00027770: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00027780: 6163 7469 6f6e 3d7b 0a20 2020 2020 2020  action={.       
-00027790: 2020 2020 2020 2020 2020 2020 2022 6672               "fr
-000277a0: 6f6d 223a 206b 6579 6669 6c65 5f61 6363  om": keyfile_acc
-000277b0: 6f75 6e74 5f61 6464 7265 7373 2c0a 2020  ount_address,.  
-000277c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000277d0: 2020 2274 6f22 3a20 7265 7665 7274 5f63    "to": revert_c
-000277e0: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
-000277f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027800: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00027810: 290a 2020 2020 2020 2020 2020 2020 7733  ).            w3
-00027820: 2e65 7468 2e65 7374 696d 6174 655f 6761  .eth.estimate_ga
-00027830: 7328 7478 6e5f 7061 7261 6d73 290a 0a20  s(txn_params).. 
-00027840: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00027850: 6573 7469 6d61 7465 5f67 6173 5f63 7573  estimate_gas_cus
-00027860: 746f 6d5f 6572 726f 725f 7265 7665 7274  tom_error_revert
-00027870: 5f77 6974 685f 6d73 6728 0a20 2020 2020  _with_msg(.     
-00027880: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00027890: 2077 333a 2022 5765 6233 222c 0a20 2020   w3: "Web3",.   
-000278a0: 2020 2020 2072 6576 6572 745f 636f 6e74       revert_cont
-000278b0: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-000278c0: 2c0a 2020 2020 2020 2020 6b65 7966 696c  ,.        keyfil
-000278d0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-000278e0: 733a 2043 6865 636b 7375 6d41 6464 7265  s: ChecksumAddre
-000278f0: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
-00027900: 653a 0a20 2020 2020 2020 2064 6174 6120  e:.        data 
-00027910: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
-00027920: 742e 656e 636f 6465 5f61 6269 280a 2020  t.encode_abi(.  
-00027930: 2020 2020 2020 2020 2020 666e 5f6e 616d            fn_nam
-00027940: 653d 2255 6e61 7574 686f 7269 7a65 6457  e="UnauthorizedW
-00027950: 6974 684d 6573 7361 6765 222c 2061 7267  ithMessage", arg
-00027960: 733d 5b22 596f 7520 6172 6520 6e6f 7420  s=["You are not 
-00027970: 6175 7468 6f72 697a 6564 225d 0a20 2020  authorized"].   
-00027980: 2020 2020 2029 0a20 2020 2020 2020 2074       ).        t
-00027990: 786e 5f70 6172 616d 7320 3d20 7265 7665  xn_params = reve
-000279a0: 7274 5f63 6f6e 7472 6163 742e 5f70 7265  rt_contract._pre
-000279b0: 7061 7265 5f74 7261 6e73 6163 7469 6f6e  pare_transaction
-000279c0: 280a 2020 2020 2020 2020 2020 2020 666e  (.            fn
-000279d0: 5f6e 616d 653d 2263 7573 746f 6d45 7272  _name="customErr
-000279e0: 6f72 5769 7468 4d65 7373 6167 6522 2c0a  orWithMessage",.
-000279f0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-00027a00: 7361 6374 696f 6e3d 7b0a 2020 2020 2020  saction={.      
-00027a10: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
-00027a20: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
-00027a30: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
-00027a40: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-00027a50: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
-00027a60: 2e61 6464 7265 7373 2c0a 2020 2020 2020  .address,.      
-00027a70: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00027a80: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
-00027a90: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
-00027aa0: 6e74 7261 6374 4375 7374 6f6d 4572 726f  ntractCustomErro
-00027ab0: 722c 206d 6174 6368 3d64 6174 6129 2061  r, match=data) a
-00027ac0: 7320 6578 6369 6e66 6f3a 0a20 2020 2020  s excinfo:.     
-00027ad0: 2020 2020 2020 2077 332e 6574 682e 6573         w3.eth.es
-00027ae0: 7469 6d61 7465 5f67 6173 2874 786e 5f70  timate_gas(txn_p
-00027af0: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-00027b00: 7373 6572 7420 6578 6369 6e66 6f2e 7661  ssert excinfo.va
-00027b10: 6c75 652e 6461 7461 203d 3d20 6461 7461  lue.data == data
-00027b20: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-00027b30: 7468 5f65 7374 696d 6174 655f 6761 735f  th_estimate_gas_
-00027b40: 6375 7374 6f6d 5f65 7272 6f72 5f72 6576  custom_error_rev
-00027b50: 6572 745f 7769 7468 6f75 745f 6d73 6728  ert_without_msg(
-00027b60: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00027b70: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
-00027b80: 222c 0a20 2020 2020 2020 2072 6576 6572  ",.        rever
-00027b90: 745f 636f 6e74 7261 6374 3a20 2243 6f6e  t_contract: "Con
-00027ba0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
-00027bb0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
-00027bc0: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
-00027bd0: 6d41 6464 7265 7373 2c0a 2020 2020 2920  mAddress,.    ) 
-00027be0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00027bf0: 2064 6174 6120 3d20 7265 7665 7274 5f63   data = revert_c
-00027c00: 6f6e 7472 6163 742e 656e 636f 6465 5f61  ontract.encode_a
-00027c10: 6269 2866 6e5f 6e61 6d65 3d22 556e 6175  bi(fn_name="Unau
-00027c20: 7468 6f72 697a 6564 2229 0a20 2020 2020  thorized").     
-00027c30: 2020 2074 786e 5f70 6172 616d 7320 3d20     txn_params = 
-00027c40: 7265 7665 7274 5f63 6f6e 7472 6163 742e  revert_contract.
-00027c50: 5f70 7265 7061 7265 5f74 7261 6e73 6163  _prepare_transac
-00027c60: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00027c70: 2020 666e 5f6e 616d 653d 2263 7573 746f    fn_name="custo
-00027c80: 6d45 7272 6f72 5769 7468 6f75 744d 6573  mErrorWithoutMes
-00027c90: 7361 6765 222c 0a20 2020 2020 2020 2020  sage",.         
-00027ca0: 2020 2074 7261 6e73 6163 7469 6f6e 3d7b     transaction={
-00027cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027cc0: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
-00027cd0: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-00027ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027cf0: 2020 2274 6f22 3a20 7265 7665 7274 5f63    "to": revert_c
-00027d00: 6f6e 7472 6163 742e 6164 6472 6573 732c  ontract.address,
-00027d10: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
-00027d20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00027d30: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00027d40: 6973 6573 2843 6f6e 7472 6163 7443 7573  ises(ContractCus
-00027d50: 746f 6d45 7272 6f72 2c20 6d61 7463 683d  tomError, match=
-00027d60: 6461 7461 2920 6173 2065 7863 696e 666f  data) as excinfo
-00027d70: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
-00027d80: 2e65 7468 2e65 7374 696d 6174 655f 6761  .eth.estimate_ga
-00027d90: 7328 7478 6e5f 7061 7261 6d73 290a 2020  s(txn_params).  
-00027da0: 2020 2020 2020 6173 7365 7274 2065 7863        assert exc
-00027db0: 696e 666f 2e76 616c 7565 2e64 6174 6120  info.value.data 
-00027dc0: 3d3d 2064 6174 610a 0a20 2020 2064 6566  == data..    def
-00027dd0: 2074 6573 745f 6574 685f 6573 7469 6d61   test_eth_estima
-00027de0: 7465 5f67 6173 280a 2020 2020 2020 2020  te_gas(.        
-00027df0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00027e00: 2c20 6b65 7966 696c 655f 6163 636f 756e  , keyfile_accoun
-00027e10: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-00027e20: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-00027e30: 7265 7373 0a20 2020 2029 202d 3e20 4e6f  ress.    ) -> No
-00027e40: 6e65 3a0a 2020 2020 2020 2020 6761 735f  ne:.        gas_
-00027e50: 6573 7469 6d61 7465 203d 2077 332e 6574  estimate = w3.et
-00027e60: 682e 6573 7469 6d61 7465 5f67 6173 280a  h.estimate_gas(.
-00027e70: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00027e80: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00027e90: 726f 6d22 3a20 6b65 7966 696c 655f 6163  rom": keyfile_ac
-00027ea0: 636f 756e 745f 6164 6472 6573 735f 6475  count_address_du
-00027eb0: 616c 5f74 7970 652c 0a20 2020 2020 2020  al_type,.       
-00027ec0: 2020 2020 2020 2020 2022 746f 223a 206b           "to": k
-00027ed0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00027ee0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00027ef0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00027f00: 2020 2276 616c 7565 223a 2057 6569 2831    "value": Wei(1
-00027f10: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
-00027f20: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00027f30: 2020 2061 7373 6572 7420 6973 5f69 6e74     assert is_int
-00027f40: 6567 6572 2867 6173 5f65 7374 696d 6174  eger(gas_estimat
-00027f50: 6529 0a20 2020 2020 2020 2061 7373 6572  e).        asser
-00027f60: 7420 6761 735f 6573 7469 6d61 7465 203e  t gas_estimate >
-00027f70: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
-00027f80: 5f65 7468 5f65 7374 696d 6174 655f 6761  _eth_estimate_ga
-00027f90: 735f 7769 7468 5f62 6c6f 636b 280a 2020  s_with_block(.  
-00027fa0: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
-00027fb0: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
-00027fc0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-00027fd0: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
-00027fe0: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
-00027ff0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00028000: 2020 6761 735f 6573 7469 6d61 7465 203d    gas_estimate =
-00028010: 2077 332e 6574 682e 6573 7469 6d61 7465   w3.eth.estimate
-00028020: 5f67 6173 280a 2020 2020 2020 2020 2020  _gas(.          
-00028030: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00028040: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
-00028050: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00028060: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-00028070: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028080: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
-00028090: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
-000280a0: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
-000280b0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-000280c0: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
-000280d0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-000280e0: 2020 2020 226c 6174 6573 7422 2c0a 2020      "latest",.  
-000280f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00028100: 6173 7365 7274 2069 735f 696e 7465 6765  assert is_intege
-00028110: 7228 6761 735f 6573 7469 6d61 7465 290a  r(gas_estimate).
-00028120: 2020 2020 2020 2020 6173 7365 7274 2067          assert g
-00028130: 6173 5f65 7374 696d 6174 6520 3e20 300a  as_estimate > 0.
-00028140: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
-00028150: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
-00028160: 2020 2020 2020 2022 7061 7261 6d73 222c         "params",
-00028170: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00028180: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00028190: 2020 2020 2020 2020 2022 6e6f 6e63 6522           "nonce"
-000281a0: 3a20 312c 2020 2320 696e 740a 2020 2020  : 1,  # int.    
-000281b0: 2020 2020 2020 2020 2020 2020 2262 616c              "bal
-000281c0: 616e 6365 223a 2031 2c20 2023 2069 6e74  ance": 1,  # int
-000281d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000281e0: 2022 636f 6465 223a 2048 6578 5374 7228   "code": HexStr(
-000281f0: 2230 7822 292c 2020 2320 4865 7853 7472  "0x"),  # HexStr
-00028200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028210: 2023 2077 6974 6820 7374 6174 650a 2020   # with state.  
-00028220: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00028230: 7461 7465 223a 207b 4865 7853 7472 2866  tate": {HexStr(f
-00028240: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
-00028250: 3a20 4865 7853 7472 2866 2230 787b 2730  : HexStr(f"0x{'0
-00028260: 3027 202a 2033 327d 2229 7d2c 0a20 2020  0' * 32}")},.   
-00028270: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00028280: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00028290: 2020 2020 2020 2020 2020 226e 6f6e 6365            "nonce
-000282a0: 223a 2048 6578 5374 7228 2230 7831 2229  ": HexStr("0x1")
-000282b0: 2c20 2023 2048 6578 5374 720a 2020 2020  ,  # HexStr.    
-000282c0: 2020 2020 2020 2020 2020 2020 2262 616c              "bal
-000282d0: 616e 6365 223a 2048 6578 5374 7228 2230  ance": HexStr("0
-000282e0: 7831 2229 2c20 2023 2048 6578 5374 720a  x1"),  # HexStr.
-000282f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028300: 2263 6f64 6522 3a20 6222 5c78 3030 222c  "code": b"\x00",
-00028310: 2020 2320 6279 7465 730a 2020 2020 2020    # bytes.      
-00028320: 2020 2020 2020 2020 2020 2320 7769 7468            # with
-00028330: 2073 7461 7465 4469 6666 0a20 2020 2020   stateDiff.     
-00028340: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
-00028350: 6544 6966 6622 3a20 7b48 6578 5374 7228  eDiff": {HexStr(
-00028360: 6622 3078 7b27 3030 2720 2a20 3332 7d22  f"0x{'00' * 32}"
-00028370: 293a 2048 6578 5374 7228 6622 3078 7b27  ): HexStr(f"0x{'
-00028380: 3030 2720 2a20 3332 7d22 297d 2c0a 2020  00' * 32}")},.  
-00028390: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-000283a0: 2020 2020 2029 2c0a 2020 2020 290a 2020       ),.    ).  
-000283b0: 2020 6465 6620 7465 7374 5f65 7468 5f65    def test_eth_e
-000283c0: 7374 696d 6174 655f 6761 735f 7769 7468  stimate_gas_with
-000283d0: 5f6f 7665 7272 6964 655f 7061 7261 6d5f  _override_param_
-000283e0: 7479 7065 5f63 6865 636b 280a 2020 2020  type_check(.    
-000283f0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00028400: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
-00028410: 2020 2020 2020 6d61 7468 5f63 6f6e 7472        math_contr
-00028420: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
-00028430: 0a20 2020 2020 2020 2070 6172 616d 733a  .        params:
-00028440: 2053 7461 7465 4f76 6572 7269 6465 5061   StateOverridePa
-00028450: 7261 6d73 2c0a 2020 2020 2920 2d3e 204e  rams,.    ) -> N
-00028460: 6f6e 653a 0a20 2020 2020 2020 2074 786e  one:.        txn
-00028470: 5f70 6172 616d 733a 2054 7850 6172 616d  _params: TxParam
-00028480: 7320 3d20 7b22 6672 6f6d 223a 2077 332e  s = {"from": w3.
-00028490: 6574 682e 636f 696e 6261 7365 7d0a 0a20  eth.coinbase}.. 
-000284a0: 2020 2020 2020 2023 2061 7373 6572 7420         # assert 
-000284b0: 646f 6573 206e 6f74 2072 6169 7365 0a20  does not raise. 
-000284c0: 2020 2020 2020 2077 332e 6574 682e 6573         w3.eth.es
-000284d0: 7469 6d61 7465 5f67 6173 2874 786e 5f70  timate_gas(txn_p
-000284e0: 6172 616d 732c 204e 6f6e 652c 207b 6d61  arams, None, {ma
-000284f0: 7468 5f63 6f6e 7472 6163 742e 6164 6472  th_contract.addr
-00028500: 6573 733a 2070 6172 616d 737d 290a 0a20  ess: params}).. 
-00028510: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00028520: 6765 7442 6c6f 636b 4279 4861 7368 2873  getBlockByHash(s
-00028530: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
-00028540: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
-00028550: 6f63 6b44 6174 6129 202d 3e20 4e6f 6e65  ockData) -> None
-00028560: 3a0a 2020 2020 2020 2020 626c 6f63 6b20  :.        block 
-00028570: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
-00028580: 636b 2865 6d70 7479 5f62 6c6f 636b 5b22  ck(empty_block["
-00028590: 6861 7368 225d 290a 2020 2020 2020 2020  hash"]).        
-000285a0: 6173 7365 7274 2062 6c6f 636b 5b22 6861  assert block["ha
-000285b0: 7368 225d 203d 3d20 656d 7074 795f 626c  sh"] == empty_bl
-000285c0: 6f63 6b5b 2268 6173 6822 5d0a 2020 2020  ock["hash"].    
-000285d0: 2020 2020 6173 7365 7274 2062 6c6f 636b      assert block
-000285e0: 5b22 7265 6365 6970 7473 526f 6f74 225d  ["receiptsRoot"]
-000285f0: 203d 3d20 656d 7074 795f 626c 6f63 6b5b   == empty_block[
-00028600: 2272 6563 6569 7074 7352 6f6f 7422 5d0a  "receiptsRoot"].
-00028610: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00028620: 6c6f 636b 5b22 6c6f 6773 426c 6f6f 6d22  lock["logsBloom"
-00028630: 5d20 3d3d 2065 6d70 7479 5f62 6c6f 636b  ] == empty_block
-00028640: 5b22 6c6f 6773 426c 6f6f 6d22 5d0a 0a20  ["logsBloom"].. 
-00028650: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-00028660: 6765 7442 6c6f 636b 4279 4861 7368 5f6e  getBlockByHash_n
-00028670: 6f74 5f66 6f75 6e64 280a 2020 2020 2020  ot_found(.      
-00028680: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-00028690: 3322 2c20 656d 7074 795f 626c 6f63 6b3a  3", empty_block:
-000286a0: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
-000286b0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000286c0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-000286d0: 6973 6573 2842 6c6f 636b 4e6f 7446 6f75  ises(BlockNotFou
-000286e0: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
-000286f0: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
-00028700: 6b28 554e 4b4e 4f57 4e5f 4841 5348 290a  k(UNKNOWN_HASH).
-00028710: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00028720: 685f 6765 7442 6c6f 636b 4279 4861 7368  h_getBlockByHash
-00028730: 5f70 656e 6469 6e67 2873 656c 662c 2077  _pending(self, w
-00028740: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
-00028750: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00028760: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-00028770: 6c6f 636b 2822 7065 6e64 696e 6722 290a  lock("pending").
-00028780: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00028790: 6c6f 636b 5b22 6861 7368 225d 2069 7320  lock["hash"] is 
-000287a0: 4e6f 6e65 0a0a 2020 2020 6465 6620 7465  None..    def te
-000287b0: 7374 5f65 7468 5f67 6574 426c 6f63 6b42  st_eth_getBlockB
-000287c0: 794e 756d 6265 725f 7769 7468 5f69 6e74  yNumber_with_int
-000287d0: 6567 6572 280a 2020 2020 2020 2020 7365  eger(.        se
-000287e0: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-000287f0: 656d 7074 795f 626c 6f63 6b3a 2042 6c6f  empty_block: Blo
-00028800: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
-00028810: 4e6f 6e65 3a0a 2020 2020 2020 2020 626c  None:.        bl
-00028820: 6f63 6b20 3d20 7733 2e65 7468 2e67 6574  ock = w3.eth.get
-00028830: 5f62 6c6f 636b 2865 6d70 7479 5f62 6c6f  _block(empty_blo
-00028840: 636b 5b22 6e75 6d62 6572 225d 290a 2020  ck["number"]).  
-00028850: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
-00028860: 636b 5b22 6e75 6d62 6572 225d 203d 3d20  ck["number"] == 
-00028870: 656d 7074 795f 626c 6f63 6b5b 226e 756d  empty_block["num
-00028880: 6265 7222 5d0a 0a20 2020 2064 6566 2074  ber"]..    def t
-00028890: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-000288a0: 4279 4e75 6d62 6572 5f6c 6174 6573 7428  ByNumber_latest(
-000288b0: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-000288c0: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
-000288d0: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
-000288e0: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
-000288f0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
-00028900: 5f62 6c6f 636b 5f6e 756d 6265 7220 3d20  _block_number = 
-00028910: 7733 2e65 7468 2e62 6c6f 636b 5f6e 756d  w3.eth.block_num
-00028920: 6265 720a 2020 2020 2020 2020 626c 6f63  ber.        bloc
-00028930: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-00028940: 6c6f 636b 2822 6c61 7465 7374 2229 0a20  lock("latest"). 
-00028950: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
-00028960: 6f63 6b5b 226e 756d 6265 7222 5d20 3d3d  ock["number"] ==
-00028970: 2063 7572 7265 6e74 5f62 6c6f 636b 5f6e   current_block_n
-00028980: 756d 6265 720a 0a20 2020 2064 6566 2074  umber..    def t
-00028990: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-000289a0: 4279 4e75 6d62 6572 5f6e 6f74 5f66 6f75  ByNumber_not_fou
-000289b0: 6e64 280a 2020 2020 2020 2020 7365 6c66  nd(.        self
-000289c0: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-000289d0: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-000289e0: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-000289f0: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-00028a00: 2070 7974 6573 742e 7261 6973 6573 2842   pytest.raises(B
-00028a10: 6c6f 636b 4e6f 7446 6f75 6e64 293a 0a20  lockNotFound):. 
-00028a20: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
-00028a30: 682e 6765 745f 626c 6f63 6b28 426c 6f63  h.get_block(Bloc
-00028a40: 6b4e 756d 6265 7228 3132 3334 3529 290a  kNumber(12345)).
-00028a50: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00028a60: 685f 6765 7442 6c6f 636b 4279 4e75 6d62  h_getBlockByNumb
-00028a70: 6572 5f70 656e 6469 6e67 280a 2020 2020  er_pending(.    
-00028a80: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00028a90: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-00028aa0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00028ab0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028ac0: 2020 2020 6375 7272 656e 745f 626c 6f63      current_bloc
-00028ad0: 6b5f 6e75 6d62 6572 203d 2077 332e 6574  k_number = w3.et
-00028ae0: 682e 626c 6f63 6b5f 6e75 6d62 6572 0a20  h.block_number. 
-00028af0: 2020 2020 2020 2062 6c6f 636b 203d 2077         block = w
-00028b00: 332e 6574 682e 6765 745f 626c 6f63 6b28  3.eth.get_block(
-00028b10: 2270 656e 6469 6e67 2229 0a20 2020 2020  "pending").     
-00028b20: 2020 2061 7373 6572 7420 626c 6f63 6b5b     assert block[
-00028b30: 226e 756d 6265 7222 5d20 3d3d 2063 7572  "number"] == cur
-00028b40: 7265 6e74 5f62 6c6f 636b 5f6e 756d 6265  rent_block_numbe
-00028b50: 7220 2b20 310a 0a20 2020 2064 6566 2074  r + 1..    def t
-00028b60: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028b70: 4279 4e75 6d62 6572 5f65 6172 6c69 6573  ByNumber_earlies
-00028b80: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00028b90: 2077 333a 2022 5765 6233 222c 2065 6d70   w3: "Web3", emp
-00028ba0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
-00028bb0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
-00028bc0: 653a 0a20 2020 2020 2020 2067 656e 6573  e:.        genes
-00028bd0: 6973 5f62 6c6f 636b 203d 2077 332e 6574  is_block = w3.et
-00028be0: 682e 6765 745f 626c 6f63 6b28 426c 6f63  h.get_block(Bloc
-00028bf0: 6b4e 756d 6265 7228 3029 290a 2020 2020  kNumber(0)).    
-00028c00: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-00028c10: 7468 2e67 6574 5f62 6c6f 636b 2822 6561  th.get_block("ea
-00028c20: 726c 6965 7374 2229 0a20 2020 2020 2020  rliest").       
-00028c30: 2061 7373 6572 7420 626c 6f63 6b5b 226e   assert block["n
-00028c40: 756d 6265 7222 5d20 3d3d 2030 0a20 2020  umber"] == 0.   
-00028c50: 2020 2020 2061 7373 6572 7420 626c 6f63       assert bloc
-00028c60: 6b5b 2268 6173 6822 5d20 3d3d 2067 656e  k["hash"] == gen
-00028c70: 6573 6973 5f62 6c6f 636b 5b22 6861 7368  esis_block["hash
-00028c80: 225d 0a0a 2020 2020 6465 6620 7465 7374  "]..    def test
-00028c90: 5f65 7468 5f67 6574 426c 6f63 6b42 794e  _eth_getBlockByN
-00028ca0: 756d 6265 725f 7361 6665 280a 2020 2020  umber_safe(.    
-00028cb0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-00028cc0: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
-00028cd0: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
-00028ce0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028cf0: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-00028d00: 7468 2e67 6574 5f62 6c6f 636b 2822 7361  th.get_block("sa
-00028d10: 6665 2229 0a20 2020 2020 2020 2061 7373  fe").        ass
-00028d20: 6572 7420 626c 6f63 6b20 6973 206e 6f74  ert block is not
-00028d30: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
-00028d40: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00028d50: 626c 6f63 6b5b 226e 756d 6265 7222 5d2c  block["number"],
-00028d60: 2069 6e74 290a 0a20 2020 2064 6566 2074   int)..    def t
-00028d70: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
-00028d80: 4279 4e75 6d62 6572 5f66 696e 616c 697a  ByNumber_finaliz
-00028d90: 6564 280a 2020 2020 2020 2020 7365 6c66  ed(.        self
-00028da0: 2c20 7733 3a20 2257 6562 3322 2c20 656d  , w3: "Web3", em
-00028db0: 7074 795f 626c 6f63 6b3a 2042 6c6f 636b  pty_block: Block
-00028dc0: 4461 7461 0a20 2020 2029 202d 3e20 4e6f  Data.    ) -> No
-00028dd0: 6e65 3a0a 2020 2020 2020 2020 626c 6f63  ne:.        bloc
-00028de0: 6b20 3d20 7733 2e65 7468 2e67 6574 5f62  k = w3.eth.get_b
-00028df0: 6c6f 636b 2822 6669 6e61 6c69 7a65 6422  lock("finalized"
-00028e00: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00028e10: 2062 6c6f 636b 2069 7320 6e6f 7420 4e6f   block is not No
-00028e20: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
-00028e30: 7420 6973 696e 7374 616e 6365 2862 6c6f  t isinstance(blo
-00028e40: 636b 5b22 6e75 6d62 6572 225d 2c20 696e  ck["number"], in
-00028e50: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
-00028e60: 5f65 7468 5f67 6574 426c 6f63 6b42 794e  _eth_getBlockByN
-00028e70: 756d 6265 725f 6675 6c6c 5f74 7261 6e73  umber_full_trans
-00028e80: 6163 7469 6f6e 7328 0a20 2020 2020 2020  actions(.       
-00028e90: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
-00028ea0: 222c 2062 6c6f 636b 5f77 6974 685f 7478  ", block_with_tx
-00028eb0: 6e3a 2042 6c6f 636b 4461 7461 0a20 2020  n: BlockData.   
-00028ec0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00028ed0: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
-00028ee0: 7468 2e67 6574 5f62 6c6f 636b 2862 6c6f  th.get_block(blo
-00028ef0: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-00028f00: 6265 7222 5d2c 2054 7275 6529 0a20 2020  ber"], True).   
-00028f10: 2020 2020 2074 7261 6e73 6163 7469 6f6e       transaction
-00028f20: 203d 2062 6c6f 636b 5b22 7472 616e 7361   = block["transa
-00028f30: 6374 696f 6e73 225d 5b30 5d0a 2020 2020  ctions"][0].    
-00028f40: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00028f50: 6163 7469 6f6e 5b22 6861 7368 225d 203d  action["hash"] =
-00028f60: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
-00028f70: 5b22 7472 616e 7361 6374 696f 6e73 225d  ["transactions"]
-00028f80: 5b30 5d0a 0a20 2020 2064 6566 2074 6573  [0]..    def tes
-00028f90: 745f 6574 685f 6765 7442 6c6f 636b 5265  t_eth_getBlockRe
-00028fa0: 6365 6970 7473 5f68 6173 6828 0a20 2020  ceipts_hash(.   
-00028fb0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-00028fc0: 5765 6233 222c 2065 6d70 7479 5f62 6c6f  Web3", empty_blo
-00028fd0: 636b 3a20 426c 6f63 6b44 6174 610a 2020  ck: BlockData.  
-00028fe0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00028ff0: 2020 2020 2072 6563 6569 7074 7320 3d20       receipts = 
-00029000: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
-00029010: 5f72 6563 6569 7074 7328 656d 7074 795f  _receipts(empty_
-00029020: 626c 6f63 6b5b 2268 6173 6822 5d29 0a20  block["hash"]). 
-00029030: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00029040: 696e 7374 616e 6365 2872 6563 6569 7074  instance(receipt
-00029050: 732c 206c 6973 7429 0a0a 2020 2020 6465  s, list)..    de
-00029060: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
-00029070: 6f63 6b52 6563 6569 7074 735f 6e6f 745f  ockReceipts_not_
-00029080: 666f 756e 6428 7365 6c66 2c20 7733 3a20  found(self, w3: 
-00029090: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-000290a0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-000290b0: 7465 7374 2e72 6169 7365 7328 426c 6f63  test.raises(Bloc
-000290c0: 6b4e 6f74 466f 756e 6429 3a0a 2020 2020  kNotFound):.    
-000290d0: 2020 2020 2020 2020 7733 2e65 7468 2e67          w3.eth.g
-000290e0: 6574 5f62 6c6f 636b 5f72 6563 6569 7074  et_block_receipt
-000290f0: 7328 554e 4b4e 4f57 4e5f 4841 5348 290a  s(UNKNOWN_HASH).
-00029100: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00029110: 685f 6765 7442 6c6f 636b 5265 6365 6970  h_getBlockReceip
-00029120: 7473 5f77 6974 685f 696e 7465 6765 7228  ts_with_integer(
-00029130: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00029140: 333a 2022 5765 6233 222c 2065 6d70 7479  3: "Web3", empty
-00029150: 5f62 6c6f 636b 3a20 426c 6f63 6b44 6174  _block: BlockDat
-00029160: 610a 2020 2020 2920 2d3e 204e 6f6e 653a  a.    ) -> None:
-00029170: 0a20 2020 2020 2020 2072 6563 6569 7074  .        receipt
-00029180: 7320 3d20 7733 2e65 7468 2e67 6574 5f62  s = w3.eth.get_b
-00029190: 6c6f 636b 5f72 6563 6569 7074 7328 656d  lock_receipts(em
-000291a0: 7074 795f 626c 6f63 6b5b 226e 756d 6265  pty_block["numbe
-000291b0: 7222 5d29 0a20 2020 2020 2020 2061 7373  r"]).        ass
-000291c0: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
-000291d0: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
-000291e0: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-000291f0: 5f67 6574 426c 6f63 6b52 6563 6569 7074  _getBlockReceipt
-00029200: 735f 7361 6665 280a 2020 2020 2020 2020  s_safe(.        
-00029210: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00029220: 2c20 656d 7074 795f 626c 6f63 6b3a 2042  , empty_block: B
-00029230: 6c6f 636b 4461 7461 0a20 2020 2029 202d  lockData.    ) -
-00029240: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00029250: 7265 6365 6970 7473 203d 2077 332e 6574  receipts = w3.et
-00029260: 682e 6765 745f 626c 6f63 6b5f 7265 6365  h.get_block_rece
-00029270: 6970 7473 2822 7361 6665 2229 0a20 2020  ipts("safe").   
-00029280: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00029290: 7374 616e 6365 2872 6563 6569 7074 732c  stance(receipts,
-000292a0: 206c 6973 7429 0a0a 2020 2020 6465 6620   list)..    def 
-000292b0: 7465 7374 5f65 7468 5f67 6574 426c 6f63  test_eth_getBloc
-000292c0: 6b52 6563 6569 7074 735f 6669 6e61 6c69  kReceipts_finali
-000292d0: 7a65 6428 0a20 2020 2020 2020 2073 656c  zed(.        sel
-000292e0: 662c 2077 333a 2022 5765 6233 222c 2065  f, w3: "Web3", e
-000292f0: 6d70 7479 5f62 6c6f 636b 3a20 426c 6f63  mpty_block: Bloc
-00029300: 6b44 6174 610a 2020 2020 2920 2d3e 204e  kData.    ) -> N
-00029310: 6f6e 653a 0a20 2020 2020 2020 2072 6563  one:.        rec
-00029320: 6569 7074 7320 3d20 7733 2e65 7468 2e67  eipts = w3.eth.g
-00029330: 6574 5f62 6c6f 636b 5f72 6563 6569 7074  et_block_receipt
-00029340: 7328 2266 696e 616c 697a 6564 2229 0a20  s("finalized"). 
-00029350: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00029360: 696e 7374 616e 6365 2872 6563 6569 7074  instance(receipt
-00029370: 732c 206c 6973 7429 0a0a 2020 2020 6465  s, list)..    de
-00029380: 6620 7465 7374 5f65 7468 5f67 6574 5472  f test_eth_getTr
-00029390: 616e 7361 6374 696f 6e42 7948 6173 6828  ansactionByHash(
-000293a0: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-000293b0: 2c20 6d69 6e65 645f 7478 6e5f 6861 7368  , mined_txn_hash
-000293c0: 3a20 4865 7853 7472 2920 2d3e 204e 6f6e  : HexStr) -> Non
-000293d0: 653a 0a20 2020 2020 2020 2074 7261 6e73  e:.        trans
-000293e0: 6163 7469 6f6e 203d 2077 332e 6574 682e  action = w3.eth.
-000293f0: 6765 745f 7472 616e 7361 6374 696f 6e28  get_transaction(
-00029400: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
-00029410: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00029420: 735f 6469 6374 2874 7261 6e73 6163 7469  s_dict(transacti
-00029430: 6f6e 290a 2020 2020 2020 2020 6173 7365  on).        asse
-00029440: 7274 2074 7261 6e73 6163 7469 6f6e 5b22  rt transaction["
-00029450: 6861 7368 225d 203d 3d20 4865 7842 7974  hash"] == HexByt
-00029460: 6573 286d 696e 6564 5f74 786e 5f68 6173  es(mined_txn_has
-00029470: 6829 0a0a 2020 2020 6465 6620 7465 7374  h)..    def test
-00029480: 5f65 7468 5f67 6574 5472 616e 7361 6374  _eth_getTransact
-00029490: 696f 6e42 7948 6173 685f 636f 6e74 7261  ionByHash_contra
-000294a0: 6374 5f63 7265 6174 696f 6e28 0a20 2020  ct_creation(.   
-000294b0: 2020 2020 2073 656c 662c 2077 333a 2022       self, w3: "
-000294c0: 5765 6233 222c 206d 6174 685f 636f 6e74  Web3", math_cont
-000294d0: 7261 6374 5f64 6570 6c6f 795f 7478 6e5f  ract_deploy_txn_
-000294e0: 6861 7368 3a20 4865 7853 7472 0a20 2020  hash: HexStr.   
-000294f0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-00029500: 2020 2020 7472 616e 7361 6374 696f 6e20      transaction 
-00029510: 3d20 7733 2e65 7468 2e67 6574 5f74 7261  = w3.eth.get_tra
-00029520: 6e73 6163 7469 6f6e 286d 6174 685f 636f  nsaction(math_co
-00029530: 6e74 7261 6374 5f64 6570 6c6f 795f 7478  ntract_deploy_tx
-00029540: 6e5f 6861 7368 290a 2020 2020 2020 2020  n_hash).        
-00029550: 6173 7365 7274 2069 735f 6469 6374 2874  assert is_dict(t
-00029560: 7261 6e73 6163 7469 6f6e 290a 2020 2020  ransaction).    
-00029570: 2020 2020 6173 7365 7274 2074 7261 6e73      assert trans
-00029580: 6163 7469 6f6e 5b22 746f 225d 2069 7320  action["to"] is 
-00029590: 4e6f 6e65 2c20 6622 746f 2066 6965 6c64  None, f"to field
-000295a0: 2069 7320 7b74 7261 6e73 6163 7469 6f6e   is {transaction
-000295b0: 5b27 746f 275d 2172 7d22 0a0a 2020 2020  ['to']!r}"..    
-000295c0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-000295d0: 5472 616e 7361 6374 696f 6e42 7942 6c6f  TransactionByBlo
-000295e0: 636b 4861 7368 416e 6449 6e64 6578 280a  ckHashAndIndex(.
-000295f0: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
-00029600: 3a20 2257 6562 3322 2c20 626c 6f63 6b5f  : "Web3", block_
-00029610: 7769 7468 5f74 786e 3a20 426c 6f63 6b44  with_txn: BlockD
-00029620: 6174 612c 206d 696e 6564 5f74 786e 5f68  ata, mined_txn_h
-00029630: 6173 683a 2048 6578 5374 720a 2020 2020  ash: HexStr.    
-00029640: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00029650: 2020 2074 7261 6e73 6163 7469 6f6e 203d     transaction =
-00029660: 2077 332e 6574 682e 6765 745f 7472 616e   w3.eth.get_tran
-00029670: 7361 6374 696f 6e5f 6279 5f62 6c6f 636b  saction_by_block
-00029680: 2862 6c6f 636b 5f77 6974 685f 7478 6e5b  (block_with_txn[
-00029690: 2268 6173 6822 5d2c 2030 290a 2020 2020  "hash"], 0).    
-000296a0: 2020 2020 6173 7365 7274 2069 735f 6469      assert is_di
-000296b0: 6374 2874 7261 6e73 6163 7469 6f6e 290a  ct(transaction).
-000296c0: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-000296d0: 7261 6e73 6163 7469 6f6e 5b22 6861 7368  ransaction["hash
-000296e0: 225d 203d 3d20 4865 7842 7974 6573 286d  "] == HexBytes(m
-000296f0: 696e 6564 5f74 786e 5f68 6173 6829 0a0a  ined_txn_hash)..
-00029700: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-00029710: 5f67 6574 5472 616e 7361 6374 696f 6e42  _getTransactionB
-00029720: 7942 6c6f 636b 4e75 6d62 6572 416e 6449  yBlockNumberAndI
-00029730: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
-00029740: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
-00029750: 626c 6f63 6b5f 7769 7468 5f74 786e 3a20  block_with_txn: 
-00029760: 426c 6f63 6b44 6174 612c 206d 696e 6564  BlockData, mined
-00029770: 5f74 786e 5f68 6173 683a 2048 6578 5374  _txn_hash: HexSt
-00029780: 720a 2020 2020 2920 2d3e 204e 6f6e 653a  r.    ) -> None:
-00029790: 0a20 2020 2020 2020 2074 7261 6e73 6163  .        transac
-000297a0: 7469 6f6e 203d 2077 332e 6574 682e 6765  tion = w3.eth.ge
-000297b0: 745f 7472 616e 7361 6374 696f 6e5f 6279  t_transaction_by
-000297c0: 5f62 6c6f 636b 2862 6c6f 636b 5f77 6974  _block(block_wit
-000297d0: 685f 7478 6e5b 226e 756d 6265 7222 5d2c  h_txn["number"],
-000297e0: 2030 290a 2020 2020 2020 2020 6173 7365   0).        asse
-000297f0: 7274 2069 735f 6469 6374 2874 7261 6e73  rt is_dict(trans
-00029800: 6163 7469 6f6e 290a 2020 2020 2020 2020  action).        
-00029810: 6173 7365 7274 2074 7261 6e73 6163 7469  assert transacti
-00029820: 6f6e 5b22 6861 7368 225d 203d 3d20 4865  on["hash"] == He
-00029830: 7842 7974 6573 286d 696e 6564 5f74 786e  xBytes(mined_txn
-00029840: 5f68 6173 6829 0a0a 2020 2020 6465 6620  _hash)..    def 
-00029850: 7465 7374 5f65 7468 5f67 6574 5f74 7261  test_eth_get_tra
-00029860: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00029870: 5f6d 696e 6564 280a 2020 2020 2020 2020  _mined(.        
-00029880: 7365 6c66 2c20 7733 3a20 2257 6562 3322  self, w3: "Web3"
-00029890: 2c20 626c 6f63 6b5f 7769 7468 5f74 786e  , block_with_txn
-000298a0: 3a20 426c 6f63 6b44 6174 612c 206d 696e  : BlockData, min
-000298b0: 6564 5f74 786e 5f68 6173 683a 2048 6578  ed_txn_hash: Hex
-000298c0: 5374 720a 2020 2020 2920 2d3e 204e 6f6e  Str.    ) -> Non
-000298d0: 653a 0a20 2020 2020 2020 2072 6563 6569  e:.        recei
-000298e0: 7074 203d 2077 332e 6574 682e 6765 745f  pt = w3.eth.get_
-000298f0: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-00029900: 6970 7428 6d69 6e65 645f 7478 6e5f 6861  ipt(mined_txn_ha
-00029910: 7368 290a 2020 2020 2020 2020 6173 7365  sh).        asse
-00029920: 7274 2069 735f 6469 6374 2872 6563 6569  rt is_dict(recei
-00029930: 7074 290a 2020 2020 2020 2020 6173 7365  pt).        asse
-00029940: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
-00029950: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
-00029960: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-00029970: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
-00029980: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
-00029990: 6f63 6b48 6173 6822 5d20 3d3d 2062 6c6f  ockHash"] == blo
-000299a0: 636b 5f77 6974 685f 7478 6e5b 2268 6173  ck_with_txn["has
-000299b0: 6822 5d0a 2020 2020 2020 2020 6173 7365  h"].        asse
-000299c0: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-000299d0: 7361 6374 696f 6e49 6e64 6578 225d 203d  sactionIndex"] =
-000299e0: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-000299f0: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-00029a00: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-00029a10: 2048 6578 4279 7465 7328 6d69 6e65 645f   HexBytes(mined_
-00029a20: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
-00029a30: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
-00029a40: 6b73 756d 5f61 6464 7265 7373 2872 6563  ksum_address(rec
-00029a50: 6569 7074 5b22 746f 225d 290a 2020 2020  eipt["to"]).    
-00029a60: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-00029a70: 7074 5b22 6672 6f6d 225d 2069 7320 6e6f  pt["from"] is no
-00029a80: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
-00029a90: 7373 6572 7420 6973 5f63 6865 636b 7375  ssert is_checksu
-00029aa0: 6d5f 6164 6472 6573 7328 7265 6365 6970  m_address(receip
-00029ab0: 745b 2266 726f 6d22 5d29 0a0a 2020 2020  t["from"])..    
-00029ac0: 2020 2020 6566 6665 6374 6976 655f 6761      effective_ga
-00029ad0: 735f 7072 6963 6520 3d20 7265 6365 6970  s_price = receip
-00029ae0: 745b 2265 6666 6563 7469 7665 4761 7350  t["effectiveGasP
-00029af0: 7269 6365 225d 0a20 2020 2020 2020 2061  rice"].        a
-00029b00: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-00029b10: 2865 6666 6563 7469 7665 5f67 6173 5f70  (effective_gas_p
-00029b20: 7269 6365 2c20 696e 7429 0a20 2020 2020  rice, int).     
-00029b30: 2020 2061 7373 6572 7420 6566 6665 6374     assert effect
-00029b40: 6976 655f 6761 735f 7072 6963 6520 3e20  ive_gas_price > 
-00029b50: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
-00029b60: 6574 685f 6765 745f 7472 616e 7361 6374  eth_get_transact
-00029b70: 696f 6e5f 7265 6365 6970 745f 756e 6d69  ion_receipt_unmi
-00029b80: 6e65 6428 0a20 2020 2020 2020 2073 656c  ned(.        sel
-00029b90: 662c 2077 333a 2022 5765 6233 222c 206b  f, w3: "Web3", k
-00029ba0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
-00029bb0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
-00029bc0: 3a20 4368 6563 6b73 756d 4164 6472 6573  : ChecksumAddres
-00029bd0: 730a 2020 2020 2920 2d3e 204e 6f6e 653a  s.    ) -> None:
-00029be0: 0a20 2020 2020 2020 2074 786e 5f68 6173  .        txn_has
-00029bf0: 6820 3d20 7733 2e65 7468 2e73 656e 645f  h = w3.eth.send_
-00029c00: 7472 616e 7361 6374 696f 6e28 0a20 2020  transaction(.   
-00029c10: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00029c20: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-00029c30: 223a 206b 6579 6669 6c65 5f61 6363 6f75  ": keyfile_accou
-00029c40: 6e74 5f61 6464 7265 7373 5f64 7561 6c5f  nt_address_dual_
-00029c50: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00029c60: 2020 2020 2020 2274 6f22 3a20 6b65 7966        "to": keyf
-00029c70: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
-00029c80: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
-00029c90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029ca0: 7661 6c75 6522 3a20 5765 6928 3129 2c0a  value": Wei(1),.
-00029cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cc0: 2267 6173 223a 2032 3130 3030 2c0a 2020  "gas": 21000,.  
-00029cd0: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-00029ce0: 6178 4665 6550 6572 4761 7322 3a20 7733  axFeePerGas": w3
-00029cf0: 2e74 6f5f 7765 6928 332c 2022 6777 6569  .to_wei(3, "gwei
-00029d00: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00029d10: 2020 2020 226d 6178 5072 696f 7269 7479      "maxPriority
-00029d20: 4665 6550 6572 4761 7322 3a20 7733 2e74  FeePerGas": w3.t
-00029d30: 6f5f 7765 6928 312c 2022 6777 6569 2229  o_wei(1, "gwei")
-00029d40: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
-00029d50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00029d60: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00029d70: 6973 6573 2854 7261 6e73 6163 7469 6f6e  ises(Transaction
-00029d80: 4e6f 7446 6f75 6e64 293a 0a20 2020 2020  NotFound):.     
-00029d90: 2020 2020 2020 2077 332e 6574 682e 6765         w3.eth.ge
-00029da0: 745f 7472 616e 7361 6374 696f 6e5f 7265  t_transaction_re
-00029db0: 6365 6970 7428 7478 6e5f 6861 7368 290a  ceipt(txn_hash).
-00029dc0: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-00029dd0: 685f 6765 745f 7472 616e 7361 6374 696f  h_get_transactio
-00029de0: 6e5f 7265 6365 6970 745f 7769 7468 5f6c  n_receipt_with_l
-00029df0: 6f67 5f65 6e74 7279 280a 2020 2020 2020  og_entry(.      
-00029e00: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00029e10: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
-00029e20: 2020 2020 626c 6f63 6b5f 7769 7468 5f74      block_with_t
-00029e30: 786e 5f77 6974 685f 6c6f 673a 2042 6c6f  xn_with_log: Blo
-00029e40: 636b 4461 7461 2c0a 2020 2020 2020 2020  ckData,.        
-00029e50: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
-00029e60: 3a20 2243 6f6e 7472 6163 7422 2c0a 2020  : "Contract",.  
-00029e70: 2020 2020 2020 7478 6e5f 6861 7368 5f77        txn_hash_w
-00029e80: 6974 685f 6c6f 673a 2048 6578 5374 722c  ith_log: HexStr,
-00029e90: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00029ea0: 2020 2020 2020 2020 7265 6365 6970 7420          receipt 
-00029eb0: 3d20 7733 2e65 7468 2e67 6574 5f74 7261  = w3.eth.get_tra
-00029ec0: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-00029ed0: 2874 786e 5f68 6173 685f 7769 7468 5f6c  (txn_hash_with_l
-00029ee0: 6f67 290a 2020 2020 2020 2020 6173 7365  og).        asse
-00029ef0: 7274 2069 735f 6469 6374 2872 6563 6569  rt is_dict(recei
-00029f00: 7074 290a 2020 2020 2020 2020 6173 7365  pt).        asse
-00029f10: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
-00029f20: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
-00029f30: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
-00029f40: 5f6c 6f67 5b22 6e75 6d62 6572 225d 0a20  _log["number"]. 
-00029f50: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-00029f60: 6365 6970 745b 2262 6c6f 636b 4861 7368  ceipt["blockHash
-00029f70: 225d 203d 3d20 626c 6f63 6b5f 7769 7468  "] == block_with
-00029f80: 5f74 786e 5f77 6974 685f 6c6f 675b 2268  _txn_with_log["h
-00029f90: 6173 6822 5d0a 2020 2020 2020 2020 6173  ash"].        as
-00029fa0: 7365 7274 2072 6563 6569 7074 5b22 7472  sert receipt["tr
-00029fb0: 616e 7361 6374 696f 6e49 6e64 6578 225d  ansactionIndex"]
-00029fc0: 203d 3d20 300a 2020 2020 2020 2020 6173   == 0.        as
-00029fd0: 7365 7274 2072 6563 6569 7074 5b22 7472  sert receipt["tr
-00029fe0: 616e 7361 6374 696f 6e48 6173 6822 5d20  ansactionHash"] 
-00029ff0: 3d3d 2048 6578 4279 7465 7328 7478 6e5f  == HexBytes(txn_
-0002a000: 6861 7368 5f77 6974 685f 6c6f 6729 0a0a  hash_with_log)..
-0002a010: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0002a020: 656e 2872 6563 6569 7074 5b22 6c6f 6773  en(receipt["logs
-0002a030: 225d 2920 3d3d 2031 0a20 2020 2020 2020  "]) == 1.       
-0002a040: 206c 6f67 5f65 6e74 7279 203d 2072 6563   log_entry = rec
-0002a050: 6569 7074 5b22 6c6f 6773 225d 5b30 5d0a  eipt["logs"][0].
-0002a060: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002a070: 6c6f 675f 656e 7472 795b 2262 6c6f 636b  log_entry["block
-0002a080: 4e75 6d62 6572 225d 203d 3d20 626c 6f63  Number"] == bloc
-0002a090: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
-0002a0a0: 6c6f 675b 226e 756d 6265 7222 5d0a 2020  log["number"].  
-0002a0b0: 2020 2020 2020 6173 7365 7274 206c 6f67        assert log
-0002a0c0: 5f65 6e74 7279 5b22 626c 6f63 6b48 6173  _entry["blockHas
-0002a0d0: 6822 5d20 3d3d 2062 6c6f 636b 5f77 6974  h"] == block_wit
-0002a0e0: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
-0002a0f0: 6861 7368 225d 0a20 2020 2020 2020 2061  hash"].        a
-0002a100: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
-0002a110: 226c 6f67 496e 6465 7822 5d20 3d3d 2030  "logIndex"] == 0
-0002a120: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002a130: 6973 5f73 616d 655f 6164 6472 6573 7328  is_same_address(
-0002a140: 6c6f 675f 656e 7472 795b 2261 6464 7265  log_entry["addre
-0002a150: 7373 225d 2c20 656d 6974 7465 725f 636f  ss"], emitter_co
-0002a160: 6e74 7261 6374 2e61 6464 7265 7373 290a  ntract.address).
-0002a170: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0002a180: 6f67 5f65 6e74 7279 5b22 7472 616e 7361  og_entry["transa
-0002a190: 6374 696f 6e49 6e64 6578 225d 203d 3d20  ctionIndex"] == 
-0002a1a0: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
-0002a1b0: 206c 6f67 5f65 6e74 7279 5b22 7472 616e   log_entry["tran
-0002a1c0: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-0002a1d0: 2048 6578 4279 7465 7328 7478 6e5f 6861   HexBytes(txn_ha
-0002a1e0: 7368 5f77 6974 685f 6c6f 6729 0a0a 2020  sh_with_log)..  
-0002a1f0: 2020 6465 6620 7465 7374 5f65 7468 5f77    def test_eth_w
-0002a200: 6169 745f 666f 725f 7472 616e 7361 6374  ait_for_transact
-0002a210: 696f 6e5f 7265 6365 6970 745f 6d69 6e65  ion_receipt_mine
-0002a220: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
-0002a230: 2077 333a 2022 5765 6233 222c 2062 6c6f   w3: "Web3", blo
-0002a240: 636b 5f77 6974 685f 7478 6e3a 2042 6c6f  ck_with_txn: Blo
-0002a250: 636b 4461 7461 2c20 6d69 6e65 645f 7478  ckData, mined_tx
-0002a260: 6e5f 6861 7368 3a20 4865 7853 7472 0a20  n_hash: HexStr. 
-0002a270: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0002a280: 2020 2020 2020 7265 6365 6970 7420 3d20        receipt = 
-0002a290: 7733 2e65 7468 2e77 6169 745f 666f 725f  w3.eth.wait_for_
-0002a2a0: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
-0002a2b0: 6970 7428 6d69 6e65 645f 7478 6e5f 6861  ipt(mined_txn_ha
-0002a2c0: 7368 290a 2020 2020 2020 2020 6173 7365  sh).        asse
-0002a2d0: 7274 2069 735f 6469 6374 2872 6563 6569  rt is_dict(recei
-0002a2e0: 7074 290a 2020 2020 2020 2020 6173 7365  pt).        asse
-0002a2f0: 7274 2072 6563 6569 7074 5b22 626c 6f63  rt receipt["bloc
-0002a300: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
-0002a310: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
-0002a320: 6265 7222 5d0a 2020 2020 2020 2020 6173  ber"].        as
-0002a330: 7365 7274 2072 6563 6569 7074 5b22 626c  sert receipt["bl
-0002a340: 6f63 6b48 6173 6822 5d20 3d3d 2062 6c6f  ockHash"] == blo
-0002a350: 636b 5f77 6974 685f 7478 6e5b 2268 6173  ck_with_txn["has
-0002a360: 6822 5d0a 2020 2020 2020 2020 6173 7365  h"].        asse
-0002a370: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-0002a380: 7361 6374 696f 6e49 6e64 6578 225d 203d  sactionIndex"] =
-0002a390: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-0002a3a0: 7274 2072 6563 6569 7074 5b22 7472 616e  rt receipt["tran
-0002a3b0: 7361 6374 696f 6e48 6173 6822 5d20 3d3d  sactionHash"] ==
-0002a3c0: 2048 6578 4279 7465 7328 6d69 6e65 645f   HexBytes(mined_
-0002a3d0: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
-0002a3e0: 2020 6173 7365 7274 2069 735f 6368 6563    assert is_chec
-0002a3f0: 6b73 756d 5f61 6464 7265 7373 2872 6563  ksum_address(rec
-0002a400: 6569 7074 5b22 746f 225d 290a 2020 2020  eipt["to"]).    
-0002a410: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
-0002a420: 7074 5b22 6672 6f6d 225d 2069 7320 6e6f  pt["from"] is no
-0002a430: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
-0002a440: 7373 6572 7420 6973 5f63 6865 636b 7375  ssert is_checksu
-0002a450: 6d5f 6164 6472 6573 7328 7265 6365 6970  m_address(receip
-0002a460: 745b 2266 726f 6d22 5d29 0a0a 2020 2020  t["from"])..    
-0002a470: 2020 2020 6566 6665 6374 6976 655f 6761      effective_ga
-0002a480: 735f 7072 6963 6520 3d20 7265 6365 6970  s_price = receip
-0002a490: 745b 2265 6666 6563 7469 7665 4761 7350  t["effectiveGasP
-0002a4a0: 7269 6365 225d 0a20 2020 2020 2020 2061  rice"].        a
-0002a4b0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0002a4c0: 2865 6666 6563 7469 7665 5f67 6173 5f70  (effective_gas_p
-0002a4d0: 7269 6365 2c20 696e 7429 0a20 2020 2020  rice, int).     
-0002a4e0: 2020 2061 7373 6572 7420 6566 6665 6374     assert effect
-0002a4f0: 6976 655f 6761 735f 7072 6963 6520 3e20  ive_gas_price > 
-0002a500: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
-0002a510: 6574 685f 7761 6974 5f66 6f72 5f74 7261  eth_wait_for_tra
-0002a520: 6e73 6163 7469 6f6e 5f72 6563 6569 7074  nsaction_receipt
-0002a530: 5f75 6e6d 696e 6564 280a 2020 2020 2020  _unmined(.      
-0002a540: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
-0002a550: 3322 2c20 6b65 7966 696c 655f 6163 636f  3", keyfile_acco
-0002a560: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0002a570: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
-0002a580: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
-0002a590: 4e6f 6e65 3a0a 2020 2020 2020 2020 7478  None:.        tx
-0002a5a0: 6e5f 6861 7368 203d 2077 332e 6574 682e  n_hash = w3.eth.
-0002a5b0: 7365 6e64 5f74 7261 6e73 6163 7469 6f6e  send_transaction
-0002a5c0: 280a 2020 2020 2020 2020 2020 2020 7b0a  (.            {.
-0002a5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5e0: 2266 726f 6d22 3a20 6b65 7966 696c 655f  "from": keyfile_
-0002a5f0: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
-0002a600: 6475 616c 5f74 7970 652c 0a20 2020 2020  dual_type,.     
-0002a610: 2020 2020 2020 2020 2020 2022 746f 223a             "to":
-0002a620: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
-0002a630: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
-0002a640: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0002a650: 2020 2020 2276 616c 7565 223a 2057 6569      "value": Wei
-0002a660: 2831 292c 0a20 2020 2020 2020 2020 2020  (1),.           
-0002a670: 2020 2020 2022 6761 7322 3a20 3231 3030       "gas": 2100
-0002a680: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0002a690: 2020 2022 6d61 7846 6565 5065 7247 6173     "maxFeePerGas
-0002a6a0: 223a 2077 332e 746f 5f77 6569 2833 2c20  ": w3.to_wei(3, 
-0002a6b0: 2267 7765 6922 292c 0a20 2020 2020 2020  "gwei"),.       
-0002a6c0: 2020 2020 2020 2020 2022 6d61 7850 7269           "maxPri
-0002a6d0: 6f72 6974 7946 6565 5065 7247 6173 223a  orityFeePerGas":
-0002a6e0: 2077 332e 746f 5f77 6569 2831 2c20 2267   w3.to_wei(1, "g
-0002a6f0: 7765 6922 292c 0a20 2020 2020 2020 2020  wei"),.         
-0002a700: 2020 207d 0a20 2020 2020 2020 2029 0a0a     }.        )..
-0002a710: 2020 2020 2020 2020 7469 6d65 6f75 7420          timeout 
-0002a720: 3d20 302e 3031 0a20 2020 2020 2020 2077  = 0.01.        w
-0002a730: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-0002a740: 7328 5469 6d65 4578 6861 7573 7465 6429  s(TimeExhausted)
-0002a750: 2061 7320 6578 635f 696e 666f 3a0a 2020   as exc_info:.  
-0002a760: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
-0002a770: 2e77 6169 745f 666f 725f 7472 616e 7361  .wait_for_transa
-0002a780: 6374 696f 6e5f 7265 6365 6970 7428 7478  ction_receipt(tx
-0002a790: 6e5f 6861 7368 2c20 7469 6d65 6f75 743d  n_hash, timeout=
-0002a7a0: 7469 6d65 6f75 7429 0a0a 2020 2020 2020  timeout)..      
-0002a7b0: 2020 6173 7365 7274 2028 5f20 696e 2073    assert (_ in s
-0002a7c0: 7472 2865 7863 5f69 6e66 6f29 2066 6f72  tr(exc_info) for
-0002a7d0: 205f 2069 6e20 5b72 6570 7228 7478 6e5f   _ in [repr(txn_
-0002a7e0: 6861 7368 292c 2074 696d 656f 7574 5d29  hash), timeout])
-0002a7f0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0002a800: 7468 5f77 6169 745f 666f 725f 7472 616e  th_wait_for_tran
-0002a810: 7361 6374 696f 6e5f 7265 6365 6970 745f  saction_receipt_
-0002a820: 7769 7468 5f6c 6f67 5f65 6e74 7279 280a  with_log_entry(.
-0002a830: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0002a840: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
-0002a850: 2c0a 2020 2020 2020 2020 626c 6f63 6b5f  ,.        block_
-0002a860: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
-0002a870: 673a 2042 6c6f 636b 4461 7461 2c0a 2020  g: BlockData,.  
-0002a880: 2020 2020 2020 656d 6974 7465 725f 636f        emitter_co
-0002a890: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
-0002a8a0: 7422 2c0a 2020 2020 2020 2020 7478 6e5f  t",.        txn_
-0002a8b0: 6861 7368 5f77 6974 685f 6c6f 673a 2048  hash_with_log: H
-0002a8c0: 6578 5374 722c 0a20 2020 2029 202d 3e20  exStr,.    ) -> 
-0002a8d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-0002a8e0: 6365 6970 7420 3d20 7733 2e65 7468 2e77  ceipt = w3.eth.w
-0002a8f0: 6169 745f 666f 725f 7472 616e 7361 6374  ait_for_transact
-0002a900: 696f 6e5f 7265 6365 6970 7428 7478 6e5f  ion_receipt(txn_
-0002a910: 6861 7368 5f77 6974 685f 6c6f 6729 0a20  hash_with_log). 
-0002a920: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-0002a930: 5f64 6963 7428 7265 6365 6970 7429 0a20  _dict(receipt). 
-0002a940: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
-0002a950: 6365 6970 745b 2262 6c6f 636b 4e75 6d62  ceipt["blockNumb
-0002a960: 6572 225d 203d 3d20 626c 6f63 6b5f 7769  er"] == block_wi
-0002a970: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-0002a980: 226e 756d 6265 7222 5d0a 2020 2020 2020  "number"].      
-0002a990: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
-0002a9a0: 5b22 626c 6f63 6b48 6173 6822 5d20 3d3d  ["blockHash"] ==
-0002a9b0: 2062 6c6f 636b 5f77 6974 685f 7478 6e5f   block_with_txn_
-0002a9c0: 7769 7468 5f6c 6f67 5b22 6861 7368 225d  with_log["hash"]
-0002a9d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002a9e0: 7265 6365 6970 745b 2274 7261 6e73 6163  receipt["transac
-0002a9f0: 7469 6f6e 496e 6465 7822 5d20 3d3d 2030  tionIndex"] == 0
-0002aa00: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002aa10: 7265 6365 6970 745b 2274 7261 6e73 6163  receipt["transac
-0002aa20: 7469 6f6e 4861 7368 225d 203d 3d20 4865  tionHash"] == He
-0002aa30: 7842 7974 6573 2874 786e 5f68 6173 685f  xBytes(txn_hash_
-0002aa40: 7769 7468 5f6c 6f67 290a 0a20 2020 2020  with_log)..     
-0002aa50: 2020 2061 7373 6572 7420 6c65 6e28 7265     assert len(re
-0002aa60: 6365 6970 745b 226c 6f67 7322 5d29 203d  ceipt["logs"]) =
-0002aa70: 3d20 310a 2020 2020 2020 2020 6c6f 675f  = 1.        log_
-0002aa80: 656e 7472 7920 3d20 7265 6365 6970 745b  entry = receipt[
-0002aa90: 226c 6f67 7322 5d5b 305d 0a0a 2020 2020  "logs"][0]..    
-0002aaa0: 2020 2020 6173 7365 7274 206c 6f67 5f65      assert log_e
-0002aab0: 6e74 7279 5b22 626c 6f63 6b4e 756d 6265  ntry["blockNumbe
-0002aac0: 7222 5d20 3d3d 2062 6c6f 636b 5f77 6974  r"] == block_wit
-0002aad0: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
-0002aae0: 6e75 6d62 6572 225d 0a20 2020 2020 2020  number"].       
-0002aaf0: 2061 7373 6572 7420 6c6f 675f 656e 7472   assert log_entr
-0002ab00: 795b 2262 6c6f 636b 4861 7368 225d 203d  y["blockHash"] =
-0002ab10: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
-0002ab20: 5f77 6974 685f 6c6f 675b 2268 6173 6822  _with_log["hash"
-0002ab30: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
-0002ab40: 206c 6f67 5f65 6e74 7279 5b22 6c6f 6749   log_entry["logI
-0002ab50: 6e64 6578 225d 203d 3d20 300a 2020 2020  ndex"] == 0.    
-0002ab60: 2020 2020 6173 7365 7274 2069 735f 7361      assert is_sa
-0002ab70: 6d65 5f61 6464 7265 7373 286c 6f67 5f65  me_address(log_e
-0002ab80: 6e74 7279 5b22 6164 6472 6573 7322 5d2c  ntry["address"],
-0002ab90: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
-0002aba0: 742e 6164 6472 6573 7329 0a20 2020 2020  t.address).     
-0002abb0: 2020 2061 7373 6572 7420 6c6f 675f 656e     assert log_en
-0002abc0: 7472 795b 2274 7261 6e73 6163 7469 6f6e  try["transaction
-0002abd0: 496e 6465 7822 5d20 3d3d 2030 0a20 2020  Index"] == 0.   
-0002abe0: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
-0002abf0: 656e 7472 795b 2274 7261 6e73 6163 7469  entry["transacti
-0002ac00: 6f6e 4861 7368 225d 203d 3d20 4865 7842  onHash"] == HexB
-0002ac10: 7974 6573 2874 786e 5f68 6173 685f 7769  ytes(txn_hash_wi
-0002ac20: 7468 5f6c 6f67 290a 0a20 2020 2064 6566  th_log)..    def
-0002ac30: 2074 6573 745f 6574 685f 6765 7455 6e63   test_eth_getUnc
-0002ac40: 6c65 4279 426c 6f63 6b48 6173 6841 6e64  leByBlockHashAnd
-0002ac50: 496e 6465 7828 7365 6c66 2c20 7733 3a20  Index(self, w3: 
-0002ac60: 2257 6562 3322 2920 2d3e 204e 6f6e 653a  "Web3") -> None:
-0002ac70: 0a20 2020 2020 2020 2023 2054 4f44 4f3a  .        # TODO:
-0002ac80: 2068 6f77 2064 6f20 7765 206d 616b 6520   how do we make 
-0002ac90: 756e 636c 6573 2e2e 2e2e 0a20 2020 2020  uncles.....     
-0002aca0: 2020 2070 6173 730a 0a20 2020 2064 6566     pass..    def
-0002acb0: 2074 6573 745f 6574 685f 6765 7455 6e63   test_eth_getUnc
-0002acc0: 6c65 4279 426c 6f63 6b4e 756d 6265 7241  leByBlockNumberA
-0002acd0: 6e64 496e 6465 7828 7365 6c66 2c20 7733  ndIndex(self, w3
-0002ace0: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
-0002acf0: 653a 0a20 2020 2020 2020 2023 2054 4f44  e:.        # TOD
-0002ad00: 4f3a 2068 6f77 2064 6f20 7765 206d 616b  O: how do we mak
-0002ad10: 6520 756e 636c 6573 2e2e 2e2e 0a20 2020  e uncles.....   
-0002ad20: 2020 2020 2070 6173 730a 0a20 2020 2064       pass..    d
-0002ad30: 6566 2074 6573 745f 6574 685f 6e65 775f  ef test_eth_new_
-0002ad40: 6669 6c74 6572 2873 656c 662c 2077 333a  filter(self, w3:
-0002ad50: 2022 5765 6233 2229 202d 3e20 4e6f 6e65   "Web3") -> None
-0002ad60: 3a0a 2020 2020 2020 2020 6669 6c74 6572  :.        filter
-0002ad70: 203d 2077 332e 6574 682e 6669 6c74 6572   = w3.eth.filter
-0002ad80: 287b 7d29 0a0a 2020 2020 2020 2020 6368  ({})..        ch
-0002ad90: 616e 6765 7320 3d20 7733 2e65 7468 2e67  anges = w3.eth.g
-0002ada0: 6574 5f66 696c 7465 725f 6368 616e 6765  et_filter_change
-0002adb0: 7328 6669 6c74 6572 2e66 696c 7465 725f  s(filter.filter_
-0002adc0: 6964 290a 2020 2020 2020 2020 6173 7365  id).        asse
-0002add0: 7274 2069 735f 6c69 7374 5f6c 696b 6528  rt is_list_like(
-0002ade0: 6368 616e 6765 7329 0a20 2020 2020 2020  changes).       
-0002adf0: 2061 7373 6572 7420 6e6f 7420 6368 616e   assert not chan
-0002ae00: 6765 730a 0a20 2020 2020 2020 206c 6f67  ges..        log
-0002ae10: 7320 3d20 7733 2e65 7468 2e67 6574 5f66  s = w3.eth.get_f
-0002ae20: 696c 7465 725f 6c6f 6773 2866 696c 7465  ilter_logs(filte
-0002ae30: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
-0002ae40: 2020 2020 2061 7373 6572 7420 6973 5f6c       assert is_l
-0002ae50: 6973 745f 6c69 6b65 286c 6f67 7329 0a20  ist_like(logs). 
-0002ae60: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
-0002ae70: 7420 6c6f 6773 0a0a 2020 2020 2020 2020  t logs..        
-0002ae80: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
-0002ae90: 756e 696e 7374 616c 6c5f 6669 6c74 6572  uninstall_filter
-0002aea0: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-0002aeb0: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
-0002aec0: 7420 7265 7375 6c74 2069 7320 5472 7565  t result is True
-0002aed0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0002aee0: 7468 5f6e 6577 5f62 6c6f 636b 5f66 696c  th_new_block_fil
-0002aef0: 7465 7228 7365 6c66 2c20 7733 3a20 2257  ter(self, w3: "W
-0002af00: 6562 3322 2920 2d3e 204e 6f6e 653a 0a20  eb3") -> None:. 
-0002af10: 2020 2020 2020 2066 696c 7465 7220 3d20         filter = 
-0002af20: 7733 2e65 7468 2e66 696c 7465 7228 226c  w3.eth.filter("l
-0002af30: 6174 6573 7422 290a 2020 2020 2020 2020  atest").        
-0002af40: 6173 7365 7274 2069 735f 7374 7269 6e67  assert is_string
-0002af50: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-0002af60: 6429 0a0a 2020 2020 2020 2020 6368 616e  d)..        chan
-0002af70: 6765 7320 3d20 7733 2e65 7468 2e67 6574  ges = w3.eth.get
-0002af80: 5f66 696c 7465 725f 6368 616e 6765 7328  _filter_changes(
-0002af90: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
-0002afa0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0002afb0: 2069 735f 6c69 7374 5f6c 696b 6528 6368   is_list_like(ch
-0002afc0: 616e 6765 7329 0a0a 2020 2020 2020 2020  anges)..        
-0002afd0: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
-0002afe0: 756e 696e 7374 616c 6c5f 6669 6c74 6572  uninstall_filter
-0002aff0: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
-0002b000: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
-0002b010: 7420 7265 7375 6c74 2069 7320 5472 7565  t result is True
-0002b020: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0002b030: 7468 5f6e 6577 5f70 656e 6469 6e67 5f74  th_new_pending_t
-0002b040: 7261 6e73 6163 7469 6f6e 5f66 696c 7465  ransaction_filte
-0002b050: 7228 7365 6c66 2c20 7733 3a20 2257 6562  r(self, w3: "Web
-0002b060: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
-0002b070: 2020 2020 2066 696c 7465 7220 3d20 7733       filter = w3
-0002b080: 2e65 7468 2e66 696c 7465 7228 2270 656e  .eth.filter("pen
-0002b090: 6469 6e67 2229 0a20 2020 2020 2020 2061  ding").        a
-0002b0a0: 7373 6572 7420 6973 5f73 7472 696e 6728  ssert is_string(
-0002b0b0: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
-0002b0c0: 290a 0a20 2020 2020 2020 2063 6861 6e67  )..        chang
-0002b0d0: 6573 203d 2077 332e 6574 682e 6765 745f  es = w3.eth.get_
-0002b0e0: 6669 6c74 6572 5f63 6861 6e67 6573 2866  filter_changes(f
-0002b0f0: 696c 7465 722e 6669 6c74 6572 5f69 6429  ilter.filter_id)
-0002b100: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002b110: 6973 5f6c 6973 745f 6c69 6b65 2863 6861  is_list_like(cha
-0002b120: 6e67 6573 290a 2020 2020 2020 2020 6173  nges).        as
-0002b130: 7365 7274 206e 6f74 2063 6861 6e67 6573  sert not changes
-0002b140: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-0002b150: 203d 2077 332e 6574 682e 756e 696e 7374   = w3.eth.uninst
-0002b160: 616c 6c5f 6669 6c74 6572 2866 696c 7465  all_filter(filte
-0002b170: 722e 6669 6c74 6572 5f69 6429 0a20 2020  r.filter_id).   
-0002b180: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-0002b190: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
-0002b1a0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
-0002b1b0: 5f6c 6f67 735f 7769 7468 6f75 745f 6c6f  _logs_without_lo
-0002b1c0: 6773 280a 2020 2020 2020 2020 7365 6c66  gs(.        self
-0002b1d0: 2c20 7733 3a20 2257 6562 3322 2c20 626c  , w3: "Web3", bl
-0002b1e0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-0002b1f0: 685f 6c6f 673a 2042 6c6f 636b 4461 7461  h_log: BlockData
-0002b200: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0002b210: 2020 2020 2020 2020 2320 5465 7374 2077          # Test w
-0002b220: 6974 6820 626c 6f63 6b20 7261 6e67 650a  ith block range.
-0002b230: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
-0002b240: 7061 7261 6d73 3a20 4669 6c74 6572 5061  params: FilterPa
-0002b250: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0002b260: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
-0002b270: 3a20 426c 6f63 6b4e 756d 6265 7228 3029  : BlockNumber(0)
-0002b280: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0002b290: 6f42 6c6f 636b 223a 2042 6c6f 636b 4e75  oBlock": BlockNu
-0002b2a0: 6d62 6572 2862 6c6f 636b 5f77 6974 685f  mber(block_with_
-0002b2b0: 7478 6e5f 7769 7468 5f6c 6f67 5b22 6e75  txn_with_log["nu
-0002b2c0: 6d62 6572 225d 202d 2031 292c 0a20 2020  mber"] - 1),.   
-0002b2d0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-0002b2e0: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
-0002b2f0: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
-0002b300: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-0002b310: 7373 6572 7420 6c65 6e28 7265 7375 6c74  ssert len(result
-0002b320: 2920 3d3d 2030 0a0a 2020 2020 2020 2020  ) == 0..        
-0002b330: 2320 7468 6520 7261 6e67 6520 6973 2077  # the range is w
-0002b340: 726f 6e67 0a20 2020 2020 2020 2066 696c  rong.        fil
-0002b350: 7465 725f 7061 7261 6d73 203d 207b 0a20  ter_params = {. 
-0002b360: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
-0002b370: 426c 6f63 6b22 3a20 626c 6f63 6b5f 7769  Block": block_wi
-0002b380: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-0002b390: 226e 756d 6265 7222 5d2c 0a20 2020 2020  "number"],.     
-0002b3a0: 2020 2020 2020 2022 746f 426c 6f63 6b22         "toBlock"
-0002b3b0: 3a20 426c 6f63 6b4e 756d 6265 7228 626c  : BlockNumber(bl
-0002b3c0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-0002b3d0: 685f 6c6f 675b 226e 756d 6265 7222 5d20  h_log["number"] 
-0002b3e0: 2d20 3129 2c0a 2020 2020 2020 2020 7d0a  - 1),.        }.
-0002b3f0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0002b400: 6573 742e 7261 6973 6573 2857 6562 3352  est.raises(Web3R
-0002b410: 5043 4572 726f 7229 3a0a 2020 2020 2020  PCError):.      
-0002b420: 2020 2020 2020 7733 2e65 7468 2e67 6574        w3.eth.get
-0002b430: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
-0002b440: 616d 7329 0a0a 2020 2020 2020 2020 2320  ams)..        # 
-0002b450: 5465 7374 2077 6974 6820 6061 6464 7265  Test with `addre
-0002b460: 7373 600a 0a20 2020 2020 2020 2023 2066  ss`..        # f
-0002b470: 696c 7465 7220 7769 7468 206f 7468 6572  ilter with other
-0002b480: 2061 6464 7265 7373 0a20 2020 2020 2020   address.       
-0002b490: 2066 696c 7465 725f 7061 7261 6d73 203d   filter_params =
-0002b4a0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0002b4b0: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
-0002b4c0: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
-0002b4d0: 2020 2020 2020 2020 2261 6464 7265 7373          "address
-0002b4e0: 223a 2055 4e4b 4e4f 574e 5f41 4444 5245  ": UNKNOWN_ADDRE
-0002b4f0: 5353 2c0a 2020 2020 2020 2020 7d0a 2020  SS,.        }.  
-0002b500: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
-0002b510: 332e 6574 682e 6765 745f 6c6f 6773 2866  3.eth.get_logs(f
-0002b520: 696c 7465 725f 7061 7261 6d73 290a 2020  ilter_params).  
-0002b530: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-0002b540: 2872 6573 756c 7429 203d 3d20 300a 0a20  (result) == 0.. 
-0002b550: 2020 2020 2020 2023 2054 6573 7420 7769         # Test wi
-0002b560: 7468 206d 756c 7469 706c 6520 6061 6464  th multiple `add
-0002b570: 7265 7373 600a 0a20 2020 2020 2020 2023  ress`..        #
-0002b580: 2066 696c 7465 7220 7769 7468 206f 7468   filter with oth
-0002b590: 6572 2061 6464 7265 7373 0a20 2020 2020  er address.     
-0002b5a0: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
-0002b5b0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0002b5c0: 2022 6672 6f6d 426c 6f63 6b22 3a20 426c   "fromBlock": Bl
-0002b5d0: 6f63 6b4e 756d 6265 7228 3029 2c0a 2020  ockNumber(0),.  
-0002b5e0: 2020 2020 2020 2020 2020 2261 6464 7265            "addre
-0002b5f0: 7373 223a 205b 554e 4b4e 4f57 4e5f 4144  ss": [UNKNOWN_AD
-0002b600: 4452 4553 532c 2055 4e4b 4e4f 574e 5f41  DRESS, UNKNOWN_A
-0002b610: 4444 5245 5353 5d2c 0a20 2020 2020 2020  DDRESS],.       
-0002b620: 207d 0a20 2020 2020 2020 2072 6573 756c   }.        resul
-0002b630: 7420 3d20 7733 2e65 7468 2e67 6574 5f6c  t = w3.eth.get_l
-0002b640: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
-0002b650: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-0002b660: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
-0002b670: 2030 0a0a 2020 2020 6465 6620 7465 7374   0..    def test
-0002b680: 5f65 7468 5f67 6574 5f6c 6f67 735f 7769  _eth_get_logs_wi
-0002b690: 7468 5f6c 6f67 7328 0a20 2020 2020 2020  th_logs(.       
-0002b6a0: 2073 656c 662c 0a20 2020 2020 2020 2077   self,.        w
-0002b6b0: 333a 2022 5765 6233 222c 0a20 2020 2020  3: "Web3",.     
-0002b6c0: 2020 2062 6c6f 636b 5f77 6974 685f 7478     block_with_tx
-0002b6d0: 6e5f 7769 7468 5f6c 6f67 3a20 426c 6f63  n_with_log: Bloc
-0002b6e0: 6b44 6174 612c 0a20 2020 2020 2020 2065  kData,.        e
-0002b6f0: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
-0002b700: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
-0002b710: 6d41 6464 7265 7373 2c0a 2020 2020 2020  mAddress,.      
-0002b720: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
-0002b730: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
-0002b740: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0002b750: 2020 2020 2320 5465 7374 2077 6974 6820      # Test with 
-0002b760: 626c 6f63 6b20 7261 6e67 650a 0a20 2020  block range..   
-0002b770: 2020 2020 2023 2074 6865 2072 616e 6765       # the range
-0002b780: 2069 6e63 6c75 6465 7320 7468 6520 626c   includes the bl
-0002b790: 6f63 6b20 7768 6572 6520 7468 6520 6c6f  ock where the lo
-0002b7a0: 6720 7265 7369 6465 7320 696e 0a20 2020  g resides in.   
-0002b7b0: 2020 2020 2066 696c 7465 725f 7061 7261       filter_para
-0002b7c0: 6d73 3a20 4669 6c74 6572 5061 7261 6d73  ms: FilterParams
-0002b7d0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0002b7e0: 2022 6672 6f6d 426c 6f63 6b22 3a20 626c   "fromBlock": bl
-0002b7f0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
-0002b800: 685f 6c6f 675b 226e 756d 6265 7222 5d2c  h_log["number"],
-0002b810: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-0002b820: 426c 6f63 6b22 3a20 626c 6f63 6b5f 7769  Block": block_wi
-0002b830: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
-0002b840: 226e 756d 6265 7222 5d2c 0a20 2020 2020  "number"],.     
-0002b850: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
-0002b860: 756c 7420 3d20 7733 2e65 7468 2e67 6574  ult = w3.eth.get
-0002b870: 5f6c 6f67 7328 6669 6c74 6572 5f70 6172  _logs(filter_par
-0002b880: 616d 7329 0a20 2020 2020 2020 2061 7373  ams).        ass
-0002b890: 6572 745f 636f 6e74 6169 6e73 5f6c 6f67  ert_contains_log
-0002b8a0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-0002b8b0: 7375 6c74 2c20 626c 6f63 6b5f 7769 7468  sult, block_with
-0002b8c0: 5f74 786e 5f77 6974 685f 6c6f 672c 2065  _txn_with_log, e
-0002b8d0: 6d69 7474 6572 5f63 6f6e 7472 6163 745f  mitter_contract_
-0002b8e0: 6164 6472 6573 732c 2074 786e 5f68 6173  address, txn_has
-0002b8f0: 685f 7769 7468 5f6c 6f67 0a20 2020 2020  h_with_log.     
-0002b900: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-0002b910: 7370 6563 6966 7920 6f6e 6c79 2060 6672  specify only `fr
-0002b920: 6f6d 5f62 6c6f 636b 602e 2062 7920 6465  om_block`. by de
-0002b930: 6661 756c 7420 6074 6f5f 626c 6f63 6b60  fault `to_block`
-0002b940: 2073 686f 756c 6420 6265 2027 6c61 7465   should be 'late
-0002b950: 7374 270a 2020 2020 2020 2020 6669 6c74  st'.        filt
-0002b960: 6572 5f70 6172 616d 7320 3d20 7b0a 2020  er_params = {.  
-0002b970: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
-0002b980: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
-0002b990: 6572 2830 292c 0a20 2020 2020 2020 207d  er(0),.        }
-0002b9a0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0002b9b0: 3d20 7733 2e65 7468 2e67 6574 5f6c 6f67  = w3.eth.get_log
-0002b9c0: 7328 6669 6c74 6572 5f70 6172 616d 7329  s(filter_params)
-0002b9d0: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
-0002b9e0: 636f 6e74 6169 6e73 5f6c 6f67 280a 2020  contains_log(.  
-0002b9f0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0002ba00: 2c20 626c 6f63 6b5f 7769 7468 5f74 786e  , block_with_txn
-0002ba10: 5f77 6974 685f 6c6f 672c 2065 6d69 7474  _with_log, emitt
-0002ba20: 6572 5f63 6f6e 7472 6163 745f 6164 6472  er_contract_addr
-0002ba30: 6573 732c 2074 786e 5f68 6173 685f 7769  ess, txn_hash_wi
-0002ba40: 7468 5f6c 6f67 0a20 2020 2020 2020 2029  th_log.        )
-0002ba50: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-0002ba60: 2077 6974 6820 6061 6464 7265 7373 600a   with `address`.
-0002ba70: 0a20 2020 2020 2020 2023 2066 696c 7465  .        # filte
-0002ba80: 7220 7769 7468 2065 6d69 7474 6572 5f63  r with emitter_c
-0002ba90: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
-0002baa0: 2020 2020 2020 2020 6669 6c74 6572 5f70          filter_p
-0002bab0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-0002bac0: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
-0002bad0: 223a 2042 6c6f 636b 4e75 6d62 6572 2830  ": BlockNumber(0
-0002bae0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0002baf0: 6164 6472 6573 7322 3a20 656d 6974 7465  address": emitte
-0002bb00: 725f 636f 6e74 7261 6374 5f61 6464 7265  r_contract_addre
-0002bb10: 7373 2c0a 2020 2020 2020 2020 7d0a 0a20  ss,.        }.. 
-0002bb20: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
-0002bb30: 6765 745f 6c6f 6773 5f77 6974 685f 6c6f  get_logs_with_lo
-0002bb40: 6773 5f74 6f70 6963 5f61 7267 7328 0a20  gs_topic_args(. 
-0002bb50: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0002bb60: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
-0002bb70: 0a20 2020 2020 2020 2062 6c6f 636b 5f77  .        block_w
-0002bb80: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
-0002bb90: 3a20 426c 6f63 6b44 6174 612c 0a20 2020  : BlockData,.   
-0002bba0: 2020 2020 2065 6d69 7474 6572 5f63 6f6e       emitter_con
-0002bbb0: 7472 6163 745f 6164 6472 6573 733a 2043  tract_address: C
-0002bbc0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
-0002bbd0: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
-0002bbe0: 5f77 6974 685f 6c6f 673a 2048 6578 5374  _with_log: HexSt
-0002bbf0: 722c 0a20 2020 2029 202d 3e20 4e6f 6e65  r,.    ) -> None
-0002bc00: 3a0a 2020 2020 2020 2020 2320 5465 7374  :.        # Test
-0002bc10: 2077 6974 6820 4e6f 6e65 2065 7665 6e74   with None event
-0002bc20: 2073 6967 0a0a 2020 2020 2020 2020 6669   sig..        fi
-0002bc30: 6c74 6572 5f70 6172 616d 733a 2046 696c  lter_params: Fil
-0002bc40: 7465 7250 6172 616d 7320 3d20 7b0a 2020  terParams = {.  
-0002bc50: 2020 2020 2020 2020 2020 2266 726f 6d42            "fromB
-0002bc60: 6c6f 636b 223a 2042 6c6f 636b 4e75 6d62  lock": BlockNumb
-0002bc70: 6572 2830 292c 0a20 2020 2020 2020 2020  er(0),.         
-0002bc80: 2020 2022 746f 7069 6373 223a 205b 0a20     "topics": [. 
-0002bc90: 2020 2020 2020 2020 2020 2020 2020 204e                 N
-0002bca0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0002bcb0: 2020 2020 2048 6578 5374 7228 0a20 2020       HexStr(.   
-0002bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bcd0: 2022 3078 3030 3030 3030 3030 3030 3030   "0x000000000000
-0002bce0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00024620: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00024630: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+00024640: 3031 6234 3637 3536 6536 3337 3436 3936  01b46756e6374696
+00024650: 6636 6532 3036 3836 3137 3332 3036 3236  f6e2068617320626
+00024660: 3536 3536 6532 3037 3236 3537 3636 3537  5656e20726576657
+00024670: 3237 3436 3536 3432 6530 3030 3030 3030  27465642e0000000
+00024680: 3030 3022 2020 2320 6e6f 7161 3a20 4535  000"  # noqa: E5
+00024690: 3031 0a20 2020 2020 2020 2077 6974 6820  01.        with 
+000246a0: 7079 7465 7374 2e72 6169 7365 7328 0a20  pytest.raises(. 
+000246b0: 2020 2020 2020 2020 2020 2043 6f6e 7472             Contr
+000246c0: 6163 744c 6f67 6963 4572 726f 722c 206d  actLogicError, m
+000246d0: 6174 6368 3d22 6578 6563 7574 696f 6e20  atch="execution 
+000246e0: 7265 7665 7274 6564 3a20 4675 6e63 7469  reverted: Functi
+000246f0: 6f6e 2068 6173 2062 6565 6e20 7265 7665  on has been reve
+00024700: 7274 6564 220a 2020 2020 2020 2020 2920  rted".        ) 
+00024710: 6173 2065 7863 696e 666f 3a0a 2020 2020  as excinfo:.    
+00024720: 2020 2020 2020 2020 7733 2e65 7468 2e63          w3.eth.c
+00024730: 616c 6c28 7478 6e5f 7061 7261 6d73 290a  all(txn_params).
+00024740: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
+00024750: 7863 696e 666f 2e76 616c 7565 2e64 6174  xcinfo.value.dat
+00024760: 6120 3d3d 2064 6174 610a 0a20 2020 2064  a == data..    d
+00024770: 6566 2074 6573 745f 6574 685f 6361 6c6c  ef test_eth_call
+00024780: 5f72 6576 6572 745f 7769 7468 6f75 745f  _revert_without_
+00024790: 6d73 6728 0a20 2020 2020 2020 2073 656c  msg(.        sel
+000247a0: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
+000247b0: 5765 6233 222c 0a20 2020 2020 2020 2072  Web3",.        r
+000247c0: 6576 6572 745f 636f 6e74 7261 6374 3a20  evert_contract: 
+000247d0: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
+000247e0: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
+000247f0: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
+00024800: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
+00024810: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00024820: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+00024830: 2e72 6169 7365 7328 436f 6e74 7261 6374  .raises(Contract
+00024840: 4c6f 6769 6345 7272 6f72 2c20 6d61 7463  LogicError, matc
+00024850: 683d 2265 7865 6375 7469 6f6e 2072 6576  h="execution rev
+00024860: 6572 7465 6422 293a 0a20 2020 2020 2020  erted"):.       
+00024870: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
+00024880: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
+00024890: 742e 5f70 7265 7061 7265 5f74 7261 6e73  t._prepare_trans
+000248a0: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+000248b0: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
+000248c0: 2272 6576 6572 7457 6974 686f 7574 4d65  "revertWithoutMe
+000248d0: 7373 6167 6522 2c0a 2020 2020 2020 2020  ssage",.        
+000248e0: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+000248f0: 696f 6e3d 7b0a 2020 2020 2020 2020 2020  ion={.          
+00024900: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+00024910: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00024920: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00024930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00024940: 746f 223a 2072 6576 6572 745f 636f 6e74  to": revert_cont
+00024950: 7261 6374 2e61 6464 7265 7373 2c0a 2020  ract.address,.  
+00024960: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00024970: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00024980: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+00024990: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
+000249a0: 7329 0a0a 2020 2020 6465 6620 7465 7374  s)..    def test
+000249b0: 5f65 7468 5f63 616c 6c5f 6375 7374 6f6d  _eth_call_custom
+000249c0: 5f65 7272 6f72 5f72 6576 6572 745f 7769  _error_revert_wi
+000249d0: 7468 5f6d 7367 280a 2020 2020 2020 2020  th_msg(.        
+000249e0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
+000249f0: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
+00024a00: 2020 7265 7665 7274 5f63 6f6e 7472 6163    revert_contrac
+00024a10: 743a 2022 436f 6e74 7261 6374 222c 0a20  t: "Contract",. 
+00024a20: 2020 2020 2020 206b 6579 6669 6c65 5f61         keyfile_a
+00024a30: 6363 6f75 6e74 5f61 6464 7265 7373 3a20  ccount_address: 
+00024a40: 4368 6563 6b73 756d 4164 6472 6573 732c  ChecksumAddress,
+00024a50: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00024a60: 2020 2020 2020 2020 6461 7461 203d 2072          data = r
+00024a70: 6576 6572 745f 636f 6e74 7261 6374 2e65  evert_contract.e
+00024a80: 6e63 6f64 655f 6162 6928 0a20 2020 2020  ncode_abi(.     
+00024a90: 2020 2020 2020 2066 6e5f 6e61 6d65 3d22         fn_name="
+00024aa0: 556e 6175 7468 6f72 697a 6564 5769 7468  UnauthorizedWith
+00024ab0: 4d65 7373 6167 6522 2c20 6172 6773 3d5b  Message", args=[
+00024ac0: 2259 6f75 2061 7265 206e 6f74 2061 7574  "You are not aut
+00024ad0: 686f 7269 7a65 6422 5d0a 2020 2020 2020  horized"].      
+00024ae0: 2020 290a 2020 2020 2020 2020 7478 6e5f    ).        txn_
+00024af0: 7061 7261 6d73 203d 2072 6576 6572 745f  params = revert_
+00024b00: 636f 6e74 7261 6374 2e5f 7072 6570 6172  contract._prepar
+00024b10: 655f 7472 616e 7361 6374 696f 6e28 0a20  e_transaction(. 
+00024b20: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
+00024b30: 6d65 3d22 6375 7374 6f6d 4572 726f 7257  me="customErrorW
+00024b40: 6974 684d 6573 7361 6765 222c 0a20 2020  ithMessage",.   
+00024b50: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
+00024b60: 7469 6f6e 3d7b 0a20 2020 2020 2020 2020  tion={.         
+00024b70: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
+00024b80: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00024b90: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00024ba0: 2020 2020 2020 2020 2274 6f22 3a20 7265          "to": re
+00024bb0: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
+00024bc0: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+00024bd0: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
+00024be0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00024bf0: 6573 742e 7261 6973 6573 2843 6f6e 7472  est.raises(Contr
+00024c00: 6163 7443 7573 746f 6d45 7272 6f72 2c20  actCustomError, 
+00024c10: 6d61 7463 683d 6461 7461 2920 6173 2065  match=data) as e
+00024c20: 7863 696e 666f 3a0a 2020 2020 2020 2020  xcinfo:.        
+00024c30: 2020 2020 7733 2e65 7468 2e63 616c 6c28      w3.eth.call(
+00024c40: 7478 6e5f 7061 7261 6d73 290a 2020 2020  txn_params).    
+00024c50: 2020 2020 6173 7365 7274 2065 7863 696e      assert excin
+00024c60: 666f 2e76 616c 7565 2e64 6174 6120 3d3d  fo.value.data ==
+00024c70: 2064 6174 610a 0a20 2020 2064 6566 2074   data..    def t
+00024c80: 6573 745f 6574 685f 6361 6c6c 5f63 7573  est_eth_call_cus
+00024c90: 746f 6d5f 6572 726f 725f 7265 7665 7274  tom_error_revert
+00024ca0: 5f77 6974 686f 7574 5f6d 7367 280a 2020  _without_msg(.  
+00024cb0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00024cc0: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
+00024cd0: 2020 2020 2020 2020 7265 7665 7274 5f63          revert_c
+00024ce0: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
+00024cf0: 6374 222c 0a20 2020 2020 2020 206b 6579  ct",.        key
+00024d00: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+00024d10: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
+00024d20: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+00024d30: 4e6f 6e65 3a0a 2020 2020 2020 2020 6461  None:.        da
+00024d40: 7461 203d 2072 6576 6572 745f 636f 6e74  ta = revert_cont
+00024d50: 7261 6374 2e65 6e63 6f64 655f 6162 6928  ract.encode_abi(
+00024d60: 666e 5f6e 616d 653d 2255 6e61 7574 686f  fn_name="Unautho
+00024d70: 7269 7a65 6422 290a 2020 2020 2020 2020  rized").        
+00024d80: 7478 6e5f 7061 7261 6d73 203d 2072 6576  txn_params = rev
+00024d90: 6572 745f 636f 6e74 7261 6374 2e5f 7072  ert_contract._pr
+00024da0: 6570 6172 655f 7472 616e 7361 6374 696f  epare_transactio
+00024db0: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
+00024dc0: 6e5f 6e61 6d65 3d22 6375 7374 6f6d 4572  n_name="customEr
+00024dd0: 726f 7257 6974 686f 7574 4d65 7373 6167  rorWithoutMessag
+00024de0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00024df0: 7472 616e 7361 6374 696f 6e3d 7b0a 2020  transaction={.  
+00024e00: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00024e10: 726f 6d22 3a20 6b65 7966 696c 655f 6163  rom": keyfile_ac
+00024e20: 636f 756e 745f 6164 6472 6573 732c 0a20  count_address,. 
+00024e30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00024e40: 746f 223a 2072 6576 6572 745f 636f 6e74  to": revert_cont
+00024e50: 7261 6374 2e61 6464 7265 7373 2c0a 2020  ract.address,.  
+00024e60: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00024e70: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+00024e80: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00024e90: 7328 436f 6e74 7261 6374 4375 7374 6f6d  s(ContractCustom
+00024ea0: 4572 726f 722c 206d 6174 6368 3d64 6174  Error, match=dat
+00024eb0: 6129 2061 7320 6578 6369 6e66 6f3a 0a20  a) as excinfo:. 
+00024ec0: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+00024ed0: 682e 6361 6c6c 2874 786e 5f70 6172 616d  h.call(txn_param
+00024ee0: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
+00024ef0: 7420 6578 6369 6e66 6f2e 7661 6c75 652e  t excinfo.value.
+00024f00: 6461 7461 203d 3d20 6461 7461 0a0a 2020  data == data..  
+00024f10: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+00024f20: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00024f30: 2020 2020 2270 616e 6963 5f65 7272 6f72      "panic_error
+00024f40: 2c70 6172 616d 7322 2c0a 2020 2020 2020  ,params",.      
+00024f50: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00024f60: 2822 3031 222c 205b 5d29 2c0a 2020 2020  ("01", []),.    
+00024f70: 2020 2020 2020 2020 2822 3131 222c 205b          ("11", [
+00024f80: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+00024f90: 2822 3132 222c 205b 305d 292c 0a20 2020  ("12", [0]),.   
+00024fa0: 2020 2020 2020 2020 2028 2232 3122 2c20           ("21", 
+00024fb0: 5b2d 315d 292c 0a20 2020 2020 2020 2020  [-1]),.         
+00024fc0: 2020 2028 2232 3222 2c20 5b5d 292c 0a20     ("22", []),. 
+00024fd0: 2020 2020 2020 2020 2020 2028 2233 3122             ("31"
+00024fe0: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
+00024ff0: 2020 2028 2233 3222 2c20 5b5d 292c 0a20     ("32", []),. 
+00025000: 2020 2020 2020 2020 2020 2028 2234 3122             ("41"
+00025010: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
+00025020: 2020 2028 2235 3122 2c20 5b5d 292c 0a20     ("51", []),. 
+00025030: 2020 2020 2020 2029 2c0a 2020 2020 290a         ),.    ).
+00025040: 2020 2020 6465 6620 7465 7374 5f63 6f6e      def test_con
+00025050: 7472 6163 745f 7061 6e69 635f 6572 726f  tract_panic_erro
+00025060: 7273 280a 2020 2020 2020 2020 7365 6c66  rs(.        self
+00025070: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
+00025080: 6562 3322 2c0a 2020 2020 2020 2020 7061  eb3",.        pa
+00025090: 6e69 635f 6572 726f 7273 5f63 6f6e 7472  nic_errors_contr
+000250a0: 6163 743a 2022 436f 6e74 7261 6374 222c  act: "Contract",
+000250b0: 0a20 2020 2020 2020 2070 616e 6963 5f65  .        panic_e
+000250c0: 7272 6f72 3a20 7374 722c 0a20 2020 2020  rror: str,.     
+000250d0: 2020 2070 6172 616d 733a 204c 6973 745b     params: List[
+000250e0: 416e 795d 2c0a 2020 2020 2920 2d3e 204e  Any],.    ) -> N
+000250f0: 6f6e 653a 0a20 2020 2020 2020 206d 6574  one:.        met
+00025100: 686f 6420 3d20 6765 7461 7474 7228 0a20  hod = getattr(. 
+00025110: 2020 2020 2020 2020 2020 2070 616e 6963             panic
+00025120: 5f65 7272 6f72 735f 636f 6e74 7261 6374  _errors_contract
+00025130: 2e66 756e 6374 696f 6e73 2c0a 2020 2020  .functions,.    
+00025140: 2020 2020 2020 2020 6622 6572 726f 7243          f"errorC
+00025150: 6f64 657b 7061 6e69 635f 6572 726f 727d  ode{panic_error}
+00025160: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
+00025170: 2020 2020 2065 7272 6f72 5f6d 7367 203d       error_msg =
+00025180: 2050 414e 4943 5f45 5252 4f52 5f43 4f44   PANIC_ERROR_COD
+00025190: 4553 5b70 616e 6963 5f65 7272 6f72 5d0a  ES[panic_error].
+000251a0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+000251b0: 7465 7374 2e72 6169 7365 7328 436f 6e74  test.raises(Cont
+000251c0: 7261 6374 5061 6e69 6345 7272 6f72 2c20  ractPanicError, 
+000251d0: 6d61 7463 683d 7265 2e65 7363 6170 6528  match=re.escape(
+000251e0: 6572 726f 725f 6d73 6729 293a 0a20 2020  error_msg)):.   
+000251f0: 2020 2020 2020 2020 206d 6574 686f 6428           method(
+00025200: 2a70 6172 616d 7329 2e63 616c 6c28 290a  *params).call().
+00025210: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+00025220: 685f 6361 6c6c 5f6f 6666 6368 6169 6e5f  h_call_offchain_
+00025230: 6c6f 6f6b 7570 280a 2020 2020 2020 2020  lookup(.        
+00025240: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
+00025250: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
+00025260: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
+00025270: 705f 636f 6e74 7261 6374 3a20 2243 6f6e  p_contract: "Con
+00025280: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
+00025290: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+000252a0: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
+000252b0: 6d41 6464 7265 7373 2c0a 2020 2020 2020  mAddress,.      
+000252c0: 2020 6d6f 6e6b 6579 7061 7463 683a 2022    monkeypatch: "
+000252d0: 4d6f 6e6b 6579 5061 7463 6822 2c0a 2020  MonkeyPatch",.  
+000252e0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+000252f0: 2020 2020 206e 6f72 6d61 6c69 7a65 645f       normalized_
+00025300: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00025310: 203d 2074 6f5f 6865 785f 6966 5f62 7974   = to_hex_if_byt
+00025320: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+00025330: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+00025340: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+00025350: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
+00025360: 2829 0a20 2020 2020 2020 206d 6f63 6b5f  ().        mock_
+00025370: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+00025380: 7265 7175 6573 745f 7265 7370 6f6e 7365  request_response
+00025390: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
+000253a0: 6e6b 6579 7061 7463 682c 0a20 2020 2020  nkeypatch,.     
+000253b0: 2020 2020 2020 206d 6f63 6b65 645f 7265         mocked_re
+000253c0: 7175 6573 745f 7572 6c3d 6622 6874 7470  quest_url=f"http
+000253d0: 733a 2f2f 7765 6233 2e70 792f 6761 7465  s://web3.py/gate
+000253e0: 7761 792f 7b6e 6f72 6d61 6c69 7a65 645f  way/{normalized_
+000253f0: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00025400: 7d2f 7b4f 4646 4348 4149 4e5f 4c4f 4f4b  }/{OFFCHAIN_LOOK
+00025410: 5550 5f54 4553 545f 4441 5441 7d2e 6a73  UP_TEST_DATA}.js
+00025420: 6f6e 222c 2020 2320 6e6f 7161 3a20 4535  on",  # noqa: E5
+00025430: 3031 0a20 2020 2020 2020 2020 2020 206d  01.            m
+00025440: 6f63 6b65 645f 6a73 6f6e 5f64 6174 613d  ocked_json_data=
+00025450: 5745 4233 5059 5f41 535f 4845 5842 5954  WEB3PY_AS_HEXBYT
+00025460: 4553 2c0a 2020 2020 2020 2020 290a 2020  ES,.        ).  
+00025470: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00025480: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
+00025490: 5f63 6f6e 7472 6163 742e 6675 6e63 7469  _contract.functi
+000254a0: 6f6e 732e 7465 7374 4f66 6663 6861 696e  ons.testOffchain
+000254b0: 4c6f 6f6b 7570 280a 2020 2020 2020 2020  Lookup(.        
+000254c0: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
+000254d0: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
+000254e0: 2020 2020 2020 292e 6361 6c6c 2829 0a20        ).call(). 
+000254f0: 2020 2020 2020 2061 7373 6572 7420 7733         assert w3
+00025500: 2e63 6f64 6563 2e64 6563 6f64 6528 5b22  .codec.decode(["
+00025510: 7374 7269 6e67 225d 2c20 7265 7370 6f6e  string"], respon
+00025520: 7365 295b 305d 203d 3d20 2277 6562 3370  se)[0] == "web3p
+00025530: 7922 0a0a 2020 2020 6465 6620 7465 7374  y"..    def test
+00025540: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
+00025550: 696e 5f6c 6f6f 6b75 705f 7261 6973 6573  in_lookup_raises
+00025560: 5f77 6865 6e5f 6363 6970 5f72 6561 645f  _when_ccip_read_
+00025570: 6973 5f64 6973 6162 6c65 6428 0a20 2020  is_disabled(.   
+00025580: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00025590: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
+000255a0: 2020 2020 2020 206f 6666 6368 6169 6e5f         offchain_
+000255b0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 743a  lookup_contract:
+000255c0: 2022 436f 6e74 7261 6374 222c 0a20 2020   "Contract",.   
+000255d0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+000255e0: 2020 2020 7265 7475 726e 5f64 6174 6120      return_data 
+000255f0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00025600: 4f46 4643 4841 494e 5f4c 4f4f 4b55 505f  OFFCHAIN_LOOKUP_
+00025610: 3442 5954 455f 4441 5441 0a20 2020 2020  4BYTE_DATA.     
+00025620: 2020 2020 2020 202b 2061 6269 5f65 6e63         + abi_enc
+00025630: 6f64 6564 5f6f 6666 6368 6169 6e5f 6c6f  oded_offchain_lo
+00025640: 6f6b 7570 5f63 6f6e 7472 6163 745f 6164  okup_contract_ad
+00025650: 6472 6573 7328 7733 2c20 6f66 6663 6861  dress(w3, offcha
+00025660: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+00025670: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+00025680: 2b20 4f46 4643 4841 494e 5f4c 4f4f 4b55  + OFFCHAIN_LOOKU
+00025690: 505f 5245 5455 524e 5f44 4154 410a 2020  P_RETURN_DATA.  
+000256a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000256b0: 2320 7465 7374 2043 6f6e 7472 6163 7446  # test ContractF
+000256c0: 756e 6374 696f 6e20 6361 6c6c 0a20 2020  unction call.   
+000256d0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+000256e0: 2e72 6169 7365 7328 4f66 6663 6861 696e  .raises(Offchain
+000256f0: 4c6f 6f6b 7570 2920 6173 2065 3a0a 2020  Lookup) as e:.  
+00025700: 2020 2020 2020 2020 2020 6f66 6663 6861            offcha
+00025710: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+00025720: 6374 2e66 756e 6374 696f 6e73 2e74 6573  ct.functions.tes
+00025730: 744f 6666 6368 6169 6e4c 6f6f 6b75 7028  tOffchainLookup(
+00025740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025750: 204f 4646 4348 4149 4e5f 4c4f 4f4b 5550   OFFCHAIN_LOOKUP
+00025760: 5f54 4553 545f 4441 5441 0a20 2020 2020  _TEST_DATA.     
+00025770: 2020 2020 2020 2029 2e63 616c 6c28 6363         ).call(cc
+00025780: 6970 5f72 6561 645f 656e 6162 6c65 643d  ip_read_enabled=
+00025790: 4661 6c73 6529 0a20 2020 2020 2020 2061  False).        a
+000257a0: 7373 6572 7420 652e 7661 6c75 652e 6461  ssert e.value.da
+000257b0: 7461 203d 3d20 7265 7475 726e 5f64 6174  ta == return_dat
+000257c0: 610a 0a20 2020 2020 2020 2023 2074 6573  a..        # tes
+000257d0: 7420 436f 6e74 7261 6374 4361 6c6c 6572  t ContractCaller
+000257e0: 2063 616c 6c0a 2020 2020 2020 2020 7769   call.        wi
+000257f0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00025800: 284f 6666 6368 6169 6e4c 6f6f 6b75 7029  (OffchainLookup)
+00025810: 2061 7320 6578 6369 6e66 6f3a 0a20 2020   as excinfo:.   
+00025820: 2020 2020 2020 2020 206f 6666 6368 6169           offchai
+00025830: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+00025840: 742e 6361 6c6c 6572 2863 6369 705f 7265  t.caller(ccip_re
+00025850: 6164 5f65 6e61 626c 6564 3d46 616c 7365  ad_enabled=False
+00025860: 292e 7465 7374 4f66 6663 6861 696e 4c6f  ).testOffchainLo
+00025870: 6f6b 7570 280a 2020 2020 2020 2020 2020  okup(.          
+00025880: 2020 2020 2020 4f46 4643 4841 494e 5f4c        OFFCHAIN_L
+00025890: 4f4f 4b55 505f 5445 5354 5f44 4154 410a  OOKUP_TEST_DATA.
+000258a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000258b0: 2020 2020 2020 6173 7365 7274 2065 7863        assert exc
+000258c0: 696e 666f 2e76 616c 7565 2e64 6174 6120  info.value.data 
+000258d0: 3d3d 2072 6574 7572 6e5f 6461 7461 0a0a  == return_data..
+000258e0: 2020 2020 2020 2020 2320 7465 7374 2067          # test g
+000258f0: 6c6f 6261 6c20 666c 6167 206f 6e20 7468  lobal flag on th
+00025900: 6520 7072 6f76 6964 6572 0a20 2020 2020  e provider.     
+00025910: 2020 2077 332e 7072 6f76 6964 6572 2e67     w3.provider.g
+00025920: 6c6f 6261 6c5f 6363 6970 5f72 6561 645f  lobal_ccip_read_
+00025930: 656e 6162 6c65 6420 3d20 4661 6c73 650a  enabled = False.
+00025940: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00025950: 7465 7374 2e72 6169 7365 7328 4f66 6663  test.raises(Offc
+00025960: 6861 696e 4c6f 6f6b 7570 2920 6173 2065  hainLookup) as e
+00025970: 7863 5f69 6e66 6f3a 0a20 2020 2020 2020  xc_info:.       
+00025980: 2020 2020 206f 6666 6368 6169 6e5f 6c6f       offchain_lo
+00025990: 6f6b 7570 5f63 6f6e 7472 6163 742e 6675  okup_contract.fu
+000259a0: 6e63 7469 6f6e 732e 7465 7374 4f66 6663  nctions.testOffc
+000259b0: 6861 696e 4c6f 6f6b 7570 280a 2020 2020  hainLookup(.    
+000259c0: 2020 2020 2020 2020 2020 2020 4f46 4643              OFFC
+000259d0: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+000259e0: 5f44 4154 410a 2020 2020 2020 2020 2020  _DATA.          
+000259f0: 2020 292e 6361 6c6c 2829 0a20 2020 2020    ).call().     
+00025a00: 2020 2061 7373 6572 7420 6578 635f 696e     assert exc_in
+00025a10: 666f 2e76 616c 7565 2e64 6174 6120 3d3d  fo.value.data ==
+00025a20: 2072 6574 7572 6e5f 6461 7461 0a0a 2020   return_data..  
+00025a30: 2020 2020 2020 7733 2e70 726f 7669 6465        w3.provide
+00025a40: 722e 676c 6f62 616c 5f63 6369 705f 7265  r.global_ccip_re
+00025a50: 6164 5f65 6e61 626c 6564 203d 2054 7275  ad_enabled = Tru
+00025a60: 6520 2023 2063 6c65 616e 7570 0a0a 2020  e  # cleanup..  
+00025a70: 2020 6465 6620 7465 7374 5f65 7468 5f63    def test_eth_c
+00025a80: 616c 6c5f 6f66 6663 6861 696e 5f6c 6f6f  all_offchain_loo
+00025a90: 6b75 705f 6361 6c6c 5f66 6c61 675f 6f76  kup_call_flag_ov
+00025aa0: 6572 7269 6465 735f 7072 6f76 6964 6572  errides_provider
+00025ab0: 5f66 6c61 6728 0a20 2020 2020 2020 2073  _flag(.        s
+00025ac0: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
+00025ad0: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
+00025ae0: 206f 6666 6368 6169 6e5f 6c6f 6f6b 7570   offchain_lookup
+00025af0: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+00025b00: 7261 6374 222c 0a20 2020 2020 2020 206b  ract",.        k
+00025b10: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00025b20: 6464 7265 7373 3a20 4368 6563 6b73 756d  ddress: Checksum
+00025b30: 4164 6472 6573 732c 0a20 2020 2020 2020  Address,.       
+00025b40: 206d 6f6e 6b65 7970 6174 6368 3a20 224d   monkeypatch: "M
+00025b50: 6f6e 6b65 7950 6174 6368 222c 0a20 2020  onkeyPatch",.   
+00025b60: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00025b70: 2020 2020 6e6f 726d 616c 697a 6564 5f63      normalized_c
+00025b80: 6f6e 7472 6163 745f 6164 6472 6573 7320  ontract_address 
+00025b90: 3d20 746f 5f68 6578 5f69 665f 6279 7465  = to_hex_if_byte
+00025ba0: 7328 0a20 2020 2020 2020 2020 2020 206f  s(.            o
+00025bb0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f63  ffchain_lookup_c
+00025bc0: 6f6e 7472 6163 742e 6164 6472 6573 730a  ontract.address.
+00025bd0: 2020 2020 2020 2020 292e 6c6f 7765 7228          ).lower(
+00025be0: 290a 2020 2020 2020 2020 6d6f 636b 5f6f  ).        mock_o
+00025bf0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
+00025c00: 6571 7565 7374 5f72 6573 706f 6e73 6528  equest_response(
+00025c10: 0a20 2020 2020 2020 2020 2020 206d 6f6e  .            mon
+00025c20: 6b65 7970 6174 6368 2c0a 2020 2020 2020  keypatch,.      
+00025c30: 2020 2020 2020 6d6f 636b 6564 5f72 6571        mocked_req
+00025c40: 7565 7374 5f75 726c 3d66 2268 7474 7073  uest_url=f"https
+00025c50: 3a2f 2f77 6562 332e 7079 2f67 6174 6577  ://web3.py/gatew
+00025c60: 6179 2f7b 6e6f 726d 616c 697a 6564 5f63  ay/{normalized_c
+00025c70: 6f6e 7472 6163 745f 6164 6472 6573 737d  ontract_address}
+00025c80: 2f7b 4f46 4643 4841 494e 5f4c 4f4f 4b55  /{OFFCHAIN_LOOKU
+00025c90: 505f 5445 5354 5f44 4154 417d 2e6a 736f  P_TEST_DATA}.jso
+00025ca0: 6e22 2c20 2023 206e 6f71 613a 2045 3530  n",  # noqa: E50
+00025cb0: 310a 2020 2020 2020 2020 2020 2020 6d6f  1.            mo
+00025cc0: 636b 6564 5f6a 736f 6e5f 6461 7461 3d57  cked_json_data=W
+00025cd0: 4542 3350 595f 4153 5f48 4558 4259 5445  EB3PY_AS_HEXBYTE
+00025ce0: 532c 0a20 2020 2020 2020 2029 0a0a 2020  S,.        )..  
+00025cf0: 2020 2020 2020 7733 2e70 726f 7669 6465        w3.provide
+00025d00: 722e 676c 6f62 616c 5f63 6369 705f 7265  r.global_ccip_re
+00025d10: 6164 5f65 6e61 626c 6564 203d 2046 616c  ad_enabled = Fal
+00025d20: 7365 0a0a 2020 2020 2020 2020 7265 7370  se..        resp
+00025d30: 6f6e 7365 203d 206f 6666 6368 6169 6e5f  onse = offchain_
+00025d40: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
+00025d50: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
+00025d60: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
+00025d70: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
+00025d80: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
+00025d90: 4154 410a 2020 2020 2020 2020 292e 6361  ATA.        ).ca
+00025da0: 6c6c 2863 6369 705f 7265 6164 5f65 6e61  ll(ccip_read_ena
+00025db0: 626c 6564 3d54 7275 6529 0a20 2020 2020  bled=True).     
+00025dc0: 2020 2061 7373 6572 7420 7733 2e63 6f64     assert w3.cod
+00025dd0: 6563 2e64 6563 6f64 6528 5b22 7374 7269  ec.decode(["stri
+00025de0: 6e67 225d 2c20 7265 7370 6f6e 7365 295b  ng"], response)[
+00025df0: 305d 203d 3d20 2277 6562 3370 7922 0a0a  0] == "web3py"..
+00025e00: 2020 2020 2020 2020 7733 2e70 726f 7669          w3.provi
+00025e10: 6465 722e 676c 6f62 616c 5f63 6369 705f  der.global_ccip_
+00025e20: 7265 6164 5f65 6e61 626c 6564 203d 2054  read_enabled = T
+00025e30: 7275 6520 2023 2063 6c65 616e 7570 0a0a  rue  # cleanup..
+00025e40: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+00025e50: 2e70 6172 616d 6574 7269 7a65 2822 6d61  .parametrize("ma
+00025e60: 785f 7265 6469 7265 6374 7322 2c20 7261  x_redirects", ra
+00025e70: 6e67 6528 2d31 2c20 3429 290a 2020 2020  nge(-1, 4)).    
+00025e80: 6465 6620 7465 7374 5f65 7468 5f63 616c  def test_eth_cal
+00025e90: 6c5f 6f66 6663 6861 696e 5f6c 6f6f 6b75  l_offchain_looku
+00025ea0: 705f 7261 6973 6573 5f69 665f 6d61 785f  p_raises_if_max_
+00025eb0: 7265 6469 7265 6374 735f 6973 5f6c 6573  redirects_is_les
+00025ec0: 735f 7468 616e 5f34 280a 2020 2020 2020  s_than_4(.      
+00025ed0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00025ee0: 7733 3a20 2257 6562 3322 2c0a 2020 2020  w3: "Web3",.    
+00025ef0: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
+00025f00: 6b75 705f 636f 6e74 7261 6374 3a20 2243  kup_contract: "C
+00025f10: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+00025f20: 2020 6d61 785f 7265 6469 7265 6374 733a    max_redirects:
+00025f30: 2069 6e74 2c0a 2020 2020 2920 2d3e 204e   int,.    ) -> N
+00025f40: 6f6e 653a 0a20 2020 2020 2020 2064 6566  one:.        def
+00025f50: 6175 6c74 5f6d 6178 5f72 6564 6972 6563  ault_max_redirec
+00025f60: 7473 203d 2077 332e 7072 6f76 6964 6572  ts = w3.provider
+00025f70: 2e63 6369 705f 7265 6164 5f6d 6178 5f72  .ccip_read_max_r
+00025f80: 6564 6972 6563 7473 0a0a 2020 2020 2020  edirects..      
+00025f90: 2020 7733 2e70 726f 7669 6465 722e 6363    w3.provider.cc
+00025fa0: 6970 5f72 6561 645f 6d61 785f 7265 6469  ip_read_max_redi
+00025fb0: 7265 6374 7320 3d20 6d61 785f 7265 6469  rects = max_redi
+00025fc0: 7265 6374 730a 2020 2020 2020 2020 7769  rects.        wi
+00025fd0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00025fe0: 2857 6562 3356 616c 7565 4572 726f 722c  (Web3ValueError,
+00025ff0: 206d 6174 6368 3d22 6174 206c 6561 7374   match="at least
+00026000: 2034 2229 3a0a 2020 2020 2020 2020 2020   4"):.          
+00026010: 2020 6f66 6663 6861 696e 5f6c 6f6f 6b75    offchain_looku
+00026020: 705f 636f 6e74 7261 6374 2e66 756e 6374  p_contract.funct
+00026030: 696f 6e73 2e74 6573 744f 6666 6368 6169  ions.testOffchai
+00026040: 6e4c 6f6f 6b75 7028 0a20 2020 2020 2020  nLookup(.       
+00026050: 2020 2020 2020 2020 204f 4646 4348 4149           OFFCHAI
+00026060: 4e5f 4c4f 4f4b 5550 5f54 4553 545f 4441  N_LOOKUP_TEST_DA
+00026070: 5441 0a20 2020 2020 2020 2020 2020 2029  TA.            )
+00026080: 2e63 616c 6c28 290a 0a20 2020 2020 2020  .call()..       
+00026090: 2077 332e 7072 6f76 6964 6572 2e63 6369   w3.provider.cci
+000260a0: 705f 7265 6164 5f6d 6178 5f72 6564 6972  p_read_max_redir
+000260b0: 6563 7473 203d 2064 6566 6175 6c74 5f6d  ects = default_m
+000260c0: 6178 5f72 6564 6972 6563 7473 2020 2320  ax_redirects  # 
+000260d0: 636c 6561 6e75 700a 0a20 2020 2064 6566  cleanup..    def
+000260e0: 2074 6573 745f 6574 685f 6361 6c6c 5f6f   test_eth_call_o
+000260f0: 6666 6368 6169 6e5f 6c6f 6f6b 7570 5f72  ffchain_lookup_r
+00026100: 6169 7365 735f 666f 725f 696d 7072 6f70  aises_for_improp
+00026110: 6572 6c79 5f66 6f72 6d61 7474 6564 5f72  erly_formatted_r
+00026120: 6573 745f 7265 7175 6573 745f 7265 7370  est_request_resp
+00026130: 6f6e 7365 2820 2023 206e 6f71 613a 2045  onse(  # noqa: E
+00026140: 3530 310a 2020 2020 2020 2020 7365 6c66  501.        self
+00026150: 2c0a 2020 2020 2020 2020 7733 3a20 2257  ,.        w3: "W
+00026160: 6562 3322 2c0a 2020 2020 2020 2020 6f66  eb3",.        of
+00026170: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
+00026180: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
+00026190: 7422 2c0a 2020 2020 2020 2020 6b65 7966  t",.        keyf
+000261a0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+000261b0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+000261c0: 7265 7373 2c0a 2020 2020 2020 2020 6d6f  ress,.        mo
+000261d0: 6e6b 6579 7061 7463 683a 2022 4d6f 6e6b  nkeypatch: "Monk
+000261e0: 6579 5061 7463 6822 2c0a 2020 2020 2920  eyPatch",.    ) 
+000261f0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00026200: 206e 6f72 6d61 6c69 7a65 645f 636f 6e74   normalized_cont
+00026210: 7261 6374 5f61 6464 7265 7373 203d 2074  ract_address = t
+00026220: 6f5f 6865 785f 6966 5f62 7974 6573 280a  o_hex_if_bytes(.
+00026230: 2020 2020 2020 2020 2020 2020 6f66 6663              offc
+00026240: 6861 696e 5f6c 6f6f 6b75 705f 636f 6e74  hain_lookup_cont
+00026250: 7261 6374 2e61 6464 7265 7373 0a20 2020  ract.address.   
+00026260: 2020 2020 2029 2e6c 6f77 6572 2829 0a20       ).lower(). 
+00026270: 2020 2020 2020 206d 6f63 6b5f 6f66 6663         mock_offc
+00026280: 6861 696e 5f6c 6f6f 6b75 705f 7265 7175  hain_lookup_requ
+00026290: 6573 745f 7265 7370 6f6e 7365 280a 2020  est_response(.  
+000262a0: 2020 2020 2020 2020 2020 6d6f 6e6b 6579            monkey
+000262b0: 7061 7463 682c 0a20 2020 2020 2020 2020  patch,.         
+000262c0: 2020 206d 6f63 6b65 645f 7265 7175 6573     mocked_reques
+000262d0: 745f 7572 6c3d 6622 6874 7470 733a 2f2f  t_url=f"https://
+000262e0: 7765 6233 2e70 792f 6761 7465 7761 792f  web3.py/gateway/
+000262f0: 7b6e 6f72 6d61 6c69 7a65 645f 636f 6e74  {normalized_cont
+00026300: 7261 6374 5f61 6464 7265 7373 7d2f 7b4f  ract_address}/{O
+00026310: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
+00026320: 4553 545f 4441 5441 7d2e 6a73 6f6e 222c  EST_DATA}.json",
+00026330: 2020 2320 6e6f 7161 3a20 4535 3031 0a20    # noqa: E501. 
+00026340: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
+00026350: 645f 6a73 6f6e 5f64 6174 613d 5745 4233  d_json_data=WEB3
+00026360: 5059 5f41 535f 4845 5842 5954 4553 2c0a  PY_AS_HEXBYTES,.
+00026370: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
+00026380: 5f64 6174 615f 6669 656c 643d 226e 6f74  _data_field="not
+00026390: 5f64 6174 6122 2c0a 2020 2020 2020 2020  _data",.        
+000263a0: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+000263b0: 7974 6573 742e 7261 6973 6573 2857 6562  ytest.raises(Web
+000263c0: 3356 616c 6964 6174 696f 6e45 7272 6f72  3ValidationError
+000263d0: 2c20 6d61 7463 683d 226d 6973 7369 6e67  , match="missing
+000263e0: 2027 6461 7461 2720 6669 656c 6422 293a   'data' field"):
+000263f0: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
+00026400: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+00026410: 7472 6163 742e 6675 6e63 7469 6f6e 732e  tract.functions.
+00026420: 7465 7374 4f66 6663 6861 696e 4c6f 6f6b  testOffchainLook
+00026430: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
+00026440: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
+00026450: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
+00026460: 2020 2020 2020 2020 2020 292e 6361 6c6c            ).call
+00026470: 2829 0a0a 2020 2020 4070 7974 6573 742e  ()..    @pytest.
+00026480: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00026490: 2822 7374 6174 7573 5f63 6f64 655f 6e6f  ("status_code_no
+000264a0: 6e5f 3478 785f 6572 726f 7222 2c20 5b31  n_4xx_error", [1
+000264b0: 3030 2c20 3330 302c 2035 3030 2c20 3630  00, 300, 500, 60
+000264c0: 305d 290a 2020 2020 6465 6620 7465 7374  0]).    def test
+000264d0: 5f65 7468 5f63 616c 6c5f 6f66 6663 6861  _eth_call_offcha
+000264e0: 696e 5f6c 6f6f 6b75 705f 7472 6965 735f  in_lookup_tries_
+000264f0: 6e65 7874 5f75 726c 5f66 6f72 5f6e 6f6e  next_url_for_non
+00026500: 5f34 7878 5f65 7272 6f72 5f73 7461 7475  _4xx_error_statu
+00026510: 735f 616e 645f 7465 7374 735f 504f 5354  s_and_tests_POST
+00026520: 2820 2023 206e 6f71 613a 2045 3530 310a  (  # noqa: E501.
+00026530: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00026540: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
+00026550: 2c0a 2020 2020 2020 2020 6f66 6663 6861  ,.        offcha
+00026560: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+00026570: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
+00026580: 2020 2020 2020 2020 6b65 7966 696c 655f          keyfile_
+00026590: 6163 636f 756e 745f 6164 6472 6573 733a  account_address:
+000265a0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+000265b0: 2c0a 2020 2020 2020 2020 6d6f 6e6b 6579  ,.        monkey
+000265c0: 7061 7463 683a 2022 4d6f 6e6b 6579 5061  patch: "MonkeyPa
+000265d0: 7463 6822 2c0a 2020 2020 2020 2020 7374  tch",.        st
+000265e0: 6174 7573 5f63 6f64 655f 6e6f 6e5f 3478  atus_code_non_4x
+000265f0: 785f 6572 726f 723a 2069 6e74 2c0a 2020  x_error: int,.  
+00026600: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
+00026610: 2020 2020 206e 6f72 6d61 6c69 7a65 645f       normalized_
+00026620: 636f 6e74 7261 6374 5f61 6464 7265 7373  contract_address
+00026630: 203d 2074 6f5f 6865 785f 6966 5f62 7974   = to_hex_if_byt
+00026640: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+00026650: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+00026660: 636f 6e74 7261 6374 2e61 6464 7265 7373  contract.address
+00026670: 0a20 2020 2020 2020 2029 2e6c 6f77 6572  .        ).lower
+00026680: 2829 0a0a 2020 2020 2020 2020 2320 5468  ()..        # Th
+00026690: 6520 6e65 7874 2075 726c 2069 6e20 6f75  e next url in ou
+000266a0: 7220 7465 7374 2063 6f6e 7472 6163 7420  r test contract 
+000266b0: 646f 6573 6e27 7420 636f 6e74 6169 6e20  doesn't contain 
+000266c0: 277b 6461 7461 7d27 2c20 7472 6967 6765  '{data}', trigge
+000266d0: 7269 6e67 0a20 2020 2020 2020 2023 2074  ring.        # t
+000266e0: 6865 2050 4f53 5420 7265 7175 6573 7420  he POST request 
+000266f0: 6c6f 6769 632e 2054 6865 2069 6465 6120  logic. The idea 
+00026700: 6865 7265 2069 7320 746f 2072 6574 7572  here is to retur
+00026710: 6e20 6120 6261 6420 7374 6174 7573 2066  n a bad status f
+00026720: 6f72 0a20 2020 2020 2020 2023 2074 6865  or.        # the
+00026730: 2066 6972 7374 2075 726c 2028 4745 5429   first url (GET)
+00026740: 2061 6e64 2061 2073 7563 6365 7373 2073   and a success s
+00026750: 7461 7475 7320 6672 6f6d 2074 6865 2073  tatus from the s
+00026760: 6563 6f6e 6420 6361 6c6c 2028 504f 5354  econd call (POST
+00026770: 290a 2020 2020 2020 2020 2320 746f 2074  ).        # to t
+00026780: 6573 7420 626f 7468 2074 6861 7420 7765  est both that we
+00026790: 206d 6f76 6520 6f6e 2074 6f20 7468 6520   move on to the 
+000267a0: 6e65 7874 2075 726c 2077 6974 6820 6e6f  next url with no
+000267b0: 6e20 3478 7820 7374 6174 7573 2061 6e64  n 4xx status and
+000267c0: 0a20 2020 2020 2020 2023 2074 6861 7420  .        # that 
+000267d0: 7468 6520 504f 5354 206c 6f67 6963 2069  the POST logic i
+000267e0: 7320 616c 736f 2077 6f72 6b69 6e67 2061  s also working a
+000267f0: 7320 6578 7065 6374 6564 2e0a 2020 2020  s expected..    
+00026800: 2020 2020 6d6f 636b 5f6f 6666 6368 6169      mock_offchai
+00026810: 6e5f 6c6f 6f6b 7570 5f72 6571 7565 7374  n_lookup_request
+00026820: 5f72 6573 706f 6e73 6528 0a20 2020 2020  _response(.     
+00026830: 2020 2020 2020 206d 6f6e 6b65 7970 6174         monkeypat
+00026840: 6368 2c0a 2020 2020 2020 2020 2020 2020  ch,.            
+00026850: 6d6f 636b 6564 5f72 6571 7565 7374 5f75  mocked_request_u
+00026860: 726c 3d66 2268 7474 7073 3a2f 2f77 6562  rl=f"https://web
+00026870: 332e 7079 2f67 6174 6577 6179 2f7b 6e6f  3.py/gateway/{no
+00026880: 726d 616c 697a 6564 5f63 6f6e 7472 6163  rmalized_contrac
+00026890: 745f 6164 6472 6573 737d 2f7b 4f46 4643  t_address}/{OFFC
+000268a0: 4841 494e 5f4c 4f4f 4b55 505f 5445 5354  HAIN_LOOKUP_TEST
+000268b0: 5f44 4154 417d 2e6a 736f 6e22 2c20 2023  _DATA}.json",  #
+000268c0: 206e 6f71 613a 2045 3530 310a 2020 2020   noqa: E501.    
+000268d0: 2020 2020 2020 2020 6d6f 636b 6564 5f73          mocked_s
+000268e0: 7461 7475 735f 636f 6465 3d73 7461 7475  tatus_code=statu
+000268f0: 735f 636f 6465 5f6e 6f6e 5f34 7878 5f65  s_code_non_4xx_e
+00026900: 7272 6f72 2c0a 2020 2020 2020 2020 2020  rror,.          
+00026910: 2020 6d6f 636b 6564 5f6a 736f 6e5f 6461    mocked_json_da
+00026920: 7461 3d57 4542 3350 595f 4153 5f48 4558  ta=WEB3PY_AS_HEX
+00026930: 4259 5445 532c 0a20 2020 2020 2020 2029  BYTES,.        )
+00026940: 0a20 2020 2020 2020 206d 6f63 6b5f 6f66  .        mock_of
+00026950: 6663 6861 696e 5f6c 6f6f 6b75 705f 7265  fchain_lookup_re
+00026960: 7175 6573 745f 7265 7370 6f6e 7365 280a  quest_response(.
+00026970: 2020 2020 2020 2020 2020 2020 6d6f 6e6b              monk
+00026980: 6579 7061 7463 682c 0a20 2020 2020 2020  eypatch,.       
+00026990: 2020 2020 2068 7474 705f 6d65 7468 6f64       http_method
+000269a0: 3d22 504f 5354 222c 0a20 2020 2020 2020  ="POST",.       
+000269b0: 2020 2020 206d 6f63 6b65 645f 7265 7175       mocked_requ
+000269c0: 6573 745f 7572 6c3d 6622 6874 7470 733a  est_url=f"https:
+000269d0: 2f2f 7765 6233 2e70 792f 6761 7465 7761  //web3.py/gatewa
+000269e0: 792f 7b6e 6f72 6d61 6c69 7a65 645f 636f  y/{normalized_co
+000269f0: 6e74 7261 6374 5f61 6464 7265 7373 7d2e  ntract_address}.
+00026a00: 6a73 6f6e 222c 2020 2320 6e6f 7161 3a20  json",  # noqa: 
+00026a10: 4535 3031 0a20 2020 2020 2020 2020 2020  E501.           
+00026a20: 206d 6f63 6b65 645f 7374 6174 7573 5f63   mocked_status_c
+00026a30: 6f64 653d 3230 302c 0a20 2020 2020 2020  ode=200,.       
+00026a40: 2020 2020 206d 6f63 6b65 645f 6a73 6f6e       mocked_json
+00026a50: 5f64 6174 613d 5745 4233 5059 5f41 535f  _data=WEB3PY_AS_
+00026a60: 4845 5842 5954 4553 2c0a 2020 2020 2020  HEXBYTES,.      
+00026a70: 2020 2020 2020 7365 6e64 6572 3d6e 6f72        sender=nor
+00026a80: 6d61 6c69 7a65 645f 636f 6e74 7261 6374  malized_contract
+00026a90: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
+00026aa0: 2020 2020 2020 6361 6c6c 6461 7461 3d4f        calldata=O
+00026ab0: 4646 4348 4149 4e5f 4c4f 4f4b 5550 5f54  FFCHAIN_LOOKUP_T
+00026ac0: 4553 545f 4441 5441 2c0a 2020 2020 2020  EST_DATA,.      
+00026ad0: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
+00026ae0: 6f6e 7365 203d 206f 6666 6368 6169 6e5f  onse = offchain_
+00026af0: 6c6f 6f6b 7570 5f63 6f6e 7472 6163 742e  lookup_contract.
+00026b00: 6675 6e63 7469 6f6e 732e 7465 7374 4f66  functions.testOf
+00026b10: 6663 6861 696e 4c6f 6f6b 7570 280a 2020  fchainLookup(.  
+00026b20: 2020 2020 2020 2020 2020 4f46 4643 4841            OFFCHA
+00026b30: 494e 5f4c 4f4f 4b55 505f 5445 5354 5f44  IN_LOOKUP_TEST_D
+00026b40: 4154 410a 2020 2020 2020 2020 292e 6361  ATA.        ).ca
+00026b50: 6c6c 2829 0a20 2020 2020 2020 2061 7373  ll().        ass
+00026b60: 6572 7420 7733 2e63 6f64 6563 2e64 6563  ert w3.codec.dec
+00026b70: 6f64 6528 5b22 7374 7269 6e67 225d 2c20  ode(["string"], 
+00026b80: 7265 7370 6f6e 7365 295b 305d 203d 3d20  response)[0] == 
+00026b90: 2277 6562 3370 7922 0a0a 2020 2020 6465  "web3py"..    de
+00026ba0: 6620 7465 7374 5f65 7468 5f63 616c 6c5f  f test_eth_call_
+00026bb0: 6f66 6663 6861 696e 5f6c 6f6f 6b75 705f  offchain_lookup_
+00026bc0: 6361 6c6c 735f 7261 6973 655f 666f 725f  calls_raise_for_
+00026bd0: 7374 6174 7573 5f66 6f72 5f34 7878 5f73  status_for_4xx_s
+00026be0: 7461 7475 735f 636f 6465 280a 2020 2020  tatus_code(.    
+00026bf0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00026c00: 2020 7733 3a20 2257 6562 3322 2c0a 2020    w3: "Web3",.  
+00026c10: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
+00026c20: 6f6f 6b75 705f 636f 6e74 7261 6374 3a20  ookup_contract: 
+00026c30: 2243 6f6e 7472 6163 7422 2c0a 2020 2020  "Contract",.    
+00026c40: 2020 2020 6b65 7966 696c 655f 6163 636f      keyfile_acco
+00026c50: 756e 745f 6164 6472 6573 733a 2043 6865  unt_address: Che
+00026c60: 636b 7375 6d41 6464 7265 7373 2c0a 2020  cksumAddress,.  
+00026c70: 2020 2020 2020 6d6f 6e6b 6579 7061 7463        monkeypatc
+00026c80: 683a 2022 4d6f 6e6b 6579 5061 7463 6822  h: "MonkeyPatch"
+00026c90: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
+00026ca0: 0a20 2020 2020 2020 206e 6f72 6d61 6c69  .        normali
+00026cb0: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
+00026cc0: 7265 7373 203d 2074 6f5f 6865 785f 6966  ress = to_hex_if
+00026cd0: 5f62 7974 6573 280a 2020 2020 2020 2020  _bytes(.        
+00026ce0: 2020 2020 6f66 6663 6861 696e 5f6c 6f6f      offchain_loo
+00026cf0: 6b75 705f 636f 6e74 7261 6374 2e61 6464  kup_contract.add
+00026d00: 7265 7373 0a20 2020 2020 2020 2029 2e6c  ress.        ).l
+00026d10: 6f77 6572 2829 0a20 2020 2020 2020 206d  ower().        m
+00026d20: 6f63 6b5f 6f66 6663 6861 696e 5f6c 6f6f  ock_offchain_loo
+00026d30: 6b75 705f 7265 7175 6573 745f 7265 7370  kup_request_resp
+00026d40: 6f6e 7365 280a 2020 2020 2020 2020 2020  onse(.          
+00026d50: 2020 6d6f 6e6b 6579 7061 7463 682c 0a20    monkeypatch,. 
+00026d60: 2020 2020 2020 2020 2020 206d 6f63 6b65             mocke
+00026d70: 645f 7265 7175 6573 745f 7572 6c3d 6622  d_request_url=f"
+00026d80: 6874 7470 733a 2f2f 7765 6233 2e70 792f  https://web3.py/
+00026d90: 6761 7465 7761 792f 7b6e 6f72 6d61 6c69  gateway/{normali
+00026da0: 7a65 645f 636f 6e74 7261 6374 5f61 6464  zed_contract_add
+00026db0: 7265 7373 7d2f 7b4f 4646 4348 4149 4e5f  ress}/{OFFCHAIN_
+00026dc0: 4c4f 4f4b 5550 5f54 4553 545f 4441 5441  LOOKUP_TEST_DATA
+00026dd0: 7d2e 6a73 6f6e 222c 2020 2320 6e6f 7161  }.json",  # noqa
+00026de0: 3a20 4535 3031 0a20 2020 2020 2020 2020  : E501.         
+00026df0: 2020 206d 6f63 6b65 645f 7374 6174 7573     mocked_status
+00026e00: 5f63 6f64 653d 7261 6e64 696e 7428 3430  _code=randint(40
+00026e10: 302c 2034 3939 292c 0a20 2020 2020 2020  0, 499),.       
+00026e20: 2020 2020 206d 6f63 6b65 645f 6a73 6f6e       mocked_json
+00026e30: 5f64 6174 613d 5745 4233 5059 5f41 535f  _data=WEB3PY_AS_
+00026e40: 4845 5842 5954 4553 2c0a 2020 2020 2020  HEXBYTES,.      
+00026e50: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+00026e60: 2070 7974 6573 742e 7261 6973 6573 2845   pytest.raises(E
+00026e70: 7863 6570 7469 6f6e 2c20 6d61 7463 683d  xception, match=
+00026e80: 2263 616c 6c65 6420 7261 6973 655f 666f  "called raise_fo
+00026e90: 725f 7374 6174 7573 5c5c 285c 5c29 2229  r_status\\(\\)")
+00026ea0: 3a0a 2020 2020 2020 2020 2020 2020 6f66  :.            of
+00026eb0: 6663 6861 696e 5f6c 6f6f 6b75 705f 636f  fchain_lookup_co
+00026ec0: 6e74 7261 6374 2e66 756e 6374 696f 6e73  ntract.functions
+00026ed0: 2e74 6573 744f 6666 6368 6169 6e4c 6f6f  .testOffchainLoo
+00026ee0: 6b75 7028 0a20 2020 2020 2020 2020 2020  kup(.           
+00026ef0: 2020 2020 204f 4646 4348 4149 4e5f 4c4f       OFFCHAIN_LO
+00026f00: 4f4b 5550 5f54 4553 545f 4441 5441 0a20  OKUP_TEST_DATA. 
+00026f10: 2020 2020 2020 2020 2020 2029 2e63 616c             ).cal
+00026f20: 6c28 290a 0a20 2020 2064 6566 2074 6573  l()..    def tes
+00026f30: 745f 6574 685f 6361 6c6c 5f6f 6666 6368  t_eth_call_offch
+00026f40: 6169 6e5f 6c6f 6f6b 7570 5f72 6169 7365  ain_lookup_raise
+00026f50: 735f 7768 656e 5f61 6c6c 5f73 7570 706c  s_when_all_suppl
+00026f60: 6965 645f 7572 6c73 5f66 6169 6c28 0a20  ied_urls_fail(. 
+00026f70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00026f80: 2020 2020 206f 6666 6368 6169 6e5f 6c6f       offchain_lo
+00026f90: 6f6b 7570 5f63 6f6e 7472 6163 743a 2022  okup_contract: "
+00026fa0: 436f 6e74 7261 6374 222c 0a20 2020 2029  Contract",.    )
+00026fb0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00026fc0: 2020 2320 4745 5420 616e 6420 504f 5354    # GET and POST
+00026fd0: 2072 6571 7565 7374 7320 7368 6f75 6c64   requests should
+00026fe0: 2066 6169 6c20 7369 6e63 6520 7265 7370   fail since resp
+00026ff0: 6f6e 7365 7320 6172 6520 6e6f 7420 6d6f  onses are not mo
+00027000: 636b 6564 0a20 2020 2020 2020 2077 6974  cked.        wit
+00027010: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00027020: 0a20 2020 2020 2020 2020 2020 204d 756c  .            Mul
+00027030: 7469 706c 6546 6169 6c65 6452 6571 7565  tipleFailedReque
+00027040: 7374 732c 206d 6174 6368 3d22 4f66 6663  sts, match="Offc
+00027050: 6861 696e 206c 6f6f 6b75 7020 6661 696c  hain lookup fail
+00027060: 6564 2066 6f72 2073 7570 706c 6965 6420  ed for supplied 
+00027070: 7572 6c73 220a 2020 2020 2020 2020 293a  urls".        ):
+00027080: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
+00027090: 6368 6169 6e5f 6c6f 6f6b 7570 5f63 6f6e  chain_lookup_con
+000270a0: 7472 6163 742e 6675 6e63 7469 6f6e 732e  tract.functions.
+000270b0: 7465 7374 4f66 6663 6861 696e 4c6f 6f6b  testOffchainLook
+000270c0: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
+000270d0: 2020 2020 4f46 4643 4841 494e 5f4c 4f4f      OFFCHAIN_LOO
+000270e0: 4b55 505f 5445 5354 5f44 4154 410a 2020  KUP_TEST_DATA.  
+000270f0: 2020 2020 2020 2020 2020 292e 6361 6c6c            ).call
+00027100: 2829 0a0a 2020 2020 6465 6620 7465 7374  ()..    def test
+00027110: 5f65 7468 5f63 616c 6c5f 636f 6e74 696e  _eth_call_contin
+00027120: 756f 7573 5f6f 6666 6368 6169 6e5f 6c6f  uous_offchain_lo
+00027130: 6f6b 7570 5f72 6169 7365 735f 7769 7468  okup_raises_with
+00027140: 5f74 6f6f 5f6d 616e 795f 7265 7175 6573  _too_many_reques
+00027150: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+00027160: 2c0a 2020 2020 2020 2020 6f66 6663 6861  ,.        offcha
+00027170: 696e 5f6c 6f6f 6b75 705f 636f 6e74 7261  in_lookup_contra
+00027180: 6374 3a20 2243 6f6e 7472 6163 7422 2c0a  ct: "Contract",.
+00027190: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
+000271a0: 7463 683a 2022 4d6f 6e6b 6579 5061 7463  tch: "MonkeyPatc
+000271b0: 6822 2c0a 2020 2020 2920 2d3e 204e 6f6e  h",.    ) -> Non
+000271c0: 653a 0a20 2020 2020 2020 206e 6f72 6d61  e:.        norma
+000271d0: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
+000271e0: 6464 7265 7373 203d 2074 6f5f 6865 785f  ddress = to_hex_
+000271f0: 6966 5f62 7974 6573 280a 2020 2020 2020  if_bytes(.      
+00027200: 2020 2020 2020 6f66 6663 6861 696e 5f6c        offchain_l
+00027210: 6f6f 6b75 705f 636f 6e74 7261 6374 2e61  ookup_contract.a
+00027220: 6464 7265 7373 0a20 2020 2020 2020 2029  ddress.        )
+00027230: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
+00027240: 206d 6f63 6b5f 6f66 6663 6861 696e 5f6c   mock_offchain_l
+00027250: 6f6f 6b75 705f 7265 7175 6573 745f 7265  ookup_request_re
+00027260: 7370 6f6e 7365 280a 2020 2020 2020 2020  sponse(.        
+00027270: 2020 2020 6d6f 6e6b 6579 7061 7463 682c      monkeypatch,
+00027280: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00027290: 6b65 645f 7265 7175 6573 745f 7572 6c3d  ked_request_url=
+000272a0: 6622 6874 7470 733a 2f2f 7765 6233 2e70  f"https://web3.p
+000272b0: 792f 6761 7465 7761 792f 7b6e 6f72 6d61  y/gateway/{norma
+000272c0: 6c69 7a65 645f 636f 6e74 7261 6374 5f61  lized_contract_a
+000272d0: 6464 7265 7373 7d2f 3078 2e6a 736f 6e22  ddress}/0x.json"
+000272e0: 2c20 2023 206e 6f71 613a 2045 3530 310a  ,  # noqa: E501.
+000272f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00027300: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00027310: 6973 6573 2854 6f6f 4d61 6e79 5265 7175  ises(TooManyRequ
+00027320: 6573 7473 2c20 6d61 7463 683d 2254 6f6f  ests, match="Too
+00027330: 206d 616e 7920 4343 4950 2072 6561 6420   many CCIP read 
+00027340: 7265 6469 7265 6374 7322 293a 0a20 2020  redirects"):.   
+00027350: 2020 2020 2020 2020 206f 6666 6368 6169           offchai
+00027360: 6e5f 6c6f 6f6b 7570 5f63 6f6e 7472 6163  n_lookup_contrac
+00027370: 742e 6361 6c6c 6572 2829 2e63 6f6e 7469  t.caller().conti
+00027380: 6e75 6f75 734f 6666 6368 6169 6e4c 6f6f  nuousOffchainLoo
+00027390: 6b75 7028 290a 0a20 2020 2064 6566 2074  kup()..    def t
+000273a0: 6573 745f 6574 685f 6573 7469 6d61 7465  est_eth_estimate
+000273b0: 5f67 6173 5f72 6576 6572 745f 7769 7468  _gas_revert_with
+000273c0: 5f6d 7367 280a 2020 2020 2020 2020 7365  _msg(.        se
+000273d0: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
+000273e0: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
+000273f0: 7265 7665 7274 5f63 6f6e 7472 6163 743a  revert_contract:
+00027400: 2022 436f 6e74 7261 6374 222c 0a20 2020   "Contract",.   
+00027410: 2020 2020 206b 6579 6669 6c65 5f61 6363       keyfile_acc
+00027420: 6f75 6e74 5f61 6464 7265 7373 3a20 4368  ount_address: Ch
+00027430: 6563 6b73 756d 4164 6472 6573 732c 0a20  ecksumAddress,. 
+00027440: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00027450: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00027460: 742e 7261 6973 6573 280a 2020 2020 2020  t.raises(.      
+00027470: 2020 2020 2020 436f 6e74 7261 6374 4c6f        ContractLo
+00027480: 6769 6345 7272 6f72 2c20 6d61 7463 683d  gicError, match=
+00027490: 2265 7865 6375 7469 6f6e 2072 6576 6572  "execution rever
+000274a0: 7465 643a 2046 756e 6374 696f 6e20 6861  ted: Function ha
+000274b0: 7320 6265 656e 2072 6576 6572 7465 6422  s been reverted"
+000274c0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+000274d0: 2020 2020 2020 2020 7478 6e5f 7061 7261          txn_para
+000274e0: 6d73 203d 2072 6576 6572 745f 636f 6e74  ms = revert_cont
+000274f0: 7261 6374 2e5f 7072 6570 6172 655f 7472  ract._prepare_tr
+00027500: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+00027510: 2020 2020 2020 2020 2020 2066 6e5f 6e61             fn_na
+00027520: 6d65 3d22 7265 7665 7274 5769 7468 4d65  me="revertWithMe
+00027530: 7373 6167 6522 2c0a 2020 2020 2020 2020  ssage",.        
+00027540: 2020 2020 2020 2020 7472 616e 7361 6374          transact
+00027550: 696f 6e3d 7b0a 2020 2020 2020 2020 2020  ion={.          
+00027560: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+00027570: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00027580: 745f 6164 6472 6573 732c 0a20 2020 2020  t_address,.     
+00027590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000275a0: 746f 223a 2072 6576 6572 745f 636f 6e74  to": revert_cont
+000275b0: 7261 6374 2e61 6464 7265 7373 2c0a 2020  ract.address,.  
+000275c0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+000275d0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000275e0: 2020 2020 2020 2020 2020 2077 332e 6574             w3.et
+000275f0: 682e 6573 7469 6d61 7465 5f67 6173 2874  h.estimate_gas(t
+00027600: 786e 5f70 6172 616d 7329 0a0a 2020 2020  xn_params)..    
+00027610: 6465 6620 7465 7374 5f65 7468 5f65 7374  def test_eth_est
+00027620: 696d 6174 655f 6761 735f 7265 7665 7274  imate_gas_revert
+00027630: 5f77 6974 686f 7574 5f6d 7367 280a 2020  _without_msg(.  
+00027640: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00027650: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
+00027660: 2020 2020 2020 2020 7265 7665 7274 5f63          revert_c
+00027670: 6f6e 7472 6163 743a 2022 436f 6e74 7261  ontract: "Contra
+00027680: 6374 222c 0a20 2020 2020 2020 206b 6579  ct",.        key
+00027690: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+000276a0: 7265 7373 3a20 4368 6563 6b73 756d 4164  ress: ChecksumAd
+000276b0: 6472 6573 732c 0a20 2020 2029 202d 3e20  dress,.    ) -> 
+000276c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+000276d0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+000276e0: 2843 6f6e 7472 6163 744c 6f67 6963 4572  (ContractLogicEr
+000276f0: 726f 722c 206d 6174 6368 3d22 6578 6563  ror, match="exec
+00027700: 7574 696f 6e20 7265 7665 7274 6564 2229  ution reverted")
+00027710: 3a0a 2020 2020 2020 2020 2020 2020 7478  :.            tx
+00027720: 6e5f 7061 7261 6d73 203d 2072 6576 6572  n_params = rever
+00027730: 745f 636f 6e74 7261 6374 2e5f 7072 6570  t_contract._prep
+00027740: 6172 655f 7472 616e 7361 6374 696f 6e28  are_transaction(
+00027750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027760: 2066 6e5f 6e61 6d65 3d22 7265 7665 7274   fn_name="revert
+00027770: 5769 7468 6f75 744d 6573 7361 6765 222c  WithoutMessage",
+00027780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027790: 2074 7261 6e73 6163 7469 6f6e 3d7b 0a20   transaction={. 
+000277a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000277b0: 2020 2022 6672 6f6d 223a 206b 6579 6669     "from": keyfi
+000277c0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+000277d0: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
+000277e0: 2020 2020 2020 2020 2274 6f22 3a20 7265          "to": re
+000277f0: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
+00027800: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+00027810: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00027820: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00027830: 2020 2020 7733 2e65 7468 2e65 7374 696d      w3.eth.estim
+00027840: 6174 655f 6761 7328 7478 6e5f 7061 7261  ate_gas(txn_para
+00027850: 6d73 290a 0a20 2020 2064 6566 2074 6573  ms)..    def tes
+00027860: 745f 6574 685f 6573 7469 6d61 7465 5f67  t_eth_estimate_g
+00027870: 6173 5f63 7573 746f 6d5f 6572 726f 725f  as_custom_error_
+00027880: 7265 7665 7274 5f77 6974 685f 6d73 6728  revert_with_msg(
+00027890: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000278a0: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+000278b0: 222c 0a20 2020 2020 2020 2072 6576 6572  ",.        rever
+000278c0: 745f 636f 6e74 7261 6374 3a20 2243 6f6e  t_contract: "Con
+000278d0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
+000278e0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+000278f0: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
+00027900: 6d41 6464 7265 7373 2c0a 2020 2020 2920  mAddress,.    ) 
+00027910: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00027920: 2064 6174 6120 3d20 7265 7665 7274 5f63   data = revert_c
+00027930: 6f6e 7472 6163 742e 656e 636f 6465 5f61  ontract.encode_a
+00027940: 6269 280a 2020 2020 2020 2020 2020 2020  bi(.            
+00027950: 666e 5f6e 616d 653d 2255 6e61 7574 686f  fn_name="Unautho
+00027960: 7269 7a65 6457 6974 684d 6573 7361 6765  rizedWithMessage
+00027970: 222c 2061 7267 733d 5b22 596f 7520 6172  ", args=["You ar
+00027980: 6520 6e6f 7420 6175 7468 6f72 697a 6564  e not authorized
+00027990: 225d 0a20 2020 2020 2020 2029 0a20 2020  "].        ).   
+000279a0: 2020 2020 2074 786e 5f70 6172 616d 7320       txn_params 
+000279b0: 3d20 7265 7665 7274 5f63 6f6e 7472 6163  = revert_contrac
+000279c0: 742e 5f70 7265 7061 7265 5f74 7261 6e73  t._prepare_trans
+000279d0: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+000279e0: 2020 2020 666e 5f6e 616d 653d 2263 7573      fn_name="cus
+000279f0: 746f 6d45 7272 6f72 5769 7468 4d65 7373  tomErrorWithMess
+00027a00: 6167 6522 2c0a 2020 2020 2020 2020 2020  age",.          
+00027a10: 2020 7472 616e 7361 6374 696f 6e3d 7b0a    transaction={.
+00027a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a30: 2266 726f 6d22 3a20 6b65 7966 696c 655f  "from": keyfile_
+00027a40: 6163 636f 756e 745f 6164 6472 6573 732c  account_address,
+00027a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027a60: 2022 746f 223a 2072 6576 6572 745f 636f   "to": revert_co
+00027a70: 6e74 7261 6374 2e61 6464 7265 7373 2c0a  ntract.address,.
+00027a80: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00027a90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027aa0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+00027ab0: 7365 7328 436f 6e74 7261 6374 4375 7374  ses(ContractCust
+00027ac0: 6f6d 4572 726f 722c 206d 6174 6368 3d64  omError, match=d
+00027ad0: 6174 6129 2061 7320 6578 6369 6e66 6f3a  ata) as excinfo:
+00027ae0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
+00027af0: 6574 682e 6573 7469 6d61 7465 5f67 6173  eth.estimate_gas
+00027b00: 2874 786e 5f70 6172 616d 7329 0a20 2020  (txn_params).   
+00027b10: 2020 2020 2061 7373 6572 7420 6578 6369       assert exci
+00027b20: 6e66 6f2e 7661 6c75 652e 6461 7461 203d  nfo.value.data =
+00027b30: 3d20 6461 7461 0a0a 2020 2020 6465 6620  = data..    def 
+00027b40: 7465 7374 5f65 7468 5f65 7374 696d 6174  test_eth_estimat
+00027b50: 655f 6761 735f 6375 7374 6f6d 5f65 7272  e_gas_custom_err
+00027b60: 6f72 5f72 6576 6572 745f 7769 7468 6f75  or_revert_withou
+00027b70: 745f 6d73 6728 0a20 2020 2020 2020 2073  t_msg(.        s
+00027b80: 656c 662c 0a20 2020 2020 2020 2077 333a  elf,.        w3:
+00027b90: 2022 5765 6233 222c 0a20 2020 2020 2020   "Web3",.       
+00027ba0: 2072 6576 6572 745f 636f 6e74 7261 6374   revert_contract
+00027bb0: 3a20 2243 6f6e 7472 6163 7422 2c0a 2020  : "Contract",.  
+00027bc0: 2020 2020 2020 6b65 7966 696c 655f 6163        keyfile_ac
+00027bd0: 636f 756e 745f 6164 6472 6573 733a 2043  count_address: C
+00027be0: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+00027bf0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00027c00: 2020 2020 2020 2064 6174 6120 3d20 7265         data = re
+00027c10: 7665 7274 5f63 6f6e 7472 6163 742e 656e  vert_contract.en
+00027c20: 636f 6465 5f61 6269 2866 6e5f 6e61 6d65  code_abi(fn_name
+00027c30: 3d22 556e 6175 7468 6f72 697a 6564 2229  ="Unauthorized")
+00027c40: 0a20 2020 2020 2020 2074 786e 5f70 6172  .        txn_par
+00027c50: 616d 7320 3d20 7265 7665 7274 5f63 6f6e  ams = revert_con
+00027c60: 7472 6163 742e 5f70 7265 7061 7265 5f74  tract._prepare_t
+00027c70: 7261 6e73 6163 7469 6f6e 280a 2020 2020  ransaction(.    
+00027c80: 2020 2020 2020 2020 666e 5f6e 616d 653d          fn_name=
+00027c90: 2263 7573 746f 6d45 7272 6f72 5769 7468  "customErrorWith
+00027ca0: 6f75 744d 6573 7361 6765 222c 0a20 2020  outMessage",.   
+00027cb0: 2020 2020 2020 2020 2074 7261 6e73 6163           transac
+00027cc0: 7469 6f6e 3d7b 0a20 2020 2020 2020 2020  tion={.         
+00027cd0: 2020 2020 2020 2022 6672 6f6d 223a 206b         "from": k
+00027ce0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+00027cf0: 6464 7265 7373 2c0a 2020 2020 2020 2020  ddress,.        
+00027d00: 2020 2020 2020 2020 2274 6f22 3a20 7265          "to": re
+00027d10: 7665 7274 5f63 6f6e 7472 6163 742e 6164  vert_contract.ad
+00027d20: 6472 6573 732c 0a20 2020 2020 2020 2020  dress,.         
+00027d30: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
+00027d40: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00027d50: 6573 742e 7261 6973 6573 2843 6f6e 7472  est.raises(Contr
+00027d60: 6163 7443 7573 746f 6d45 7272 6f72 2c20  actCustomError, 
+00027d70: 6d61 7463 683d 6461 7461 2920 6173 2065  match=data) as e
+00027d80: 7863 696e 666f 3a0a 2020 2020 2020 2020  xcinfo:.        
+00027d90: 2020 2020 7733 2e65 7468 2e65 7374 696d      w3.eth.estim
+00027da0: 6174 655f 6761 7328 7478 6e5f 7061 7261  ate_gas(txn_para
+00027db0: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
+00027dc0: 7274 2065 7863 696e 666f 2e76 616c 7565  rt excinfo.value
+00027dd0: 2e64 6174 6120 3d3d 2064 6174 610a 0a20  .data == data.. 
+00027de0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+00027df0: 6573 7469 6d61 7465 5f67 6173 280a 2020  estimate_gas(.  
+00027e00: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00027e10: 2257 6562 3322 2c20 6b65 7966 696c 655f  "Web3", keyfile_
+00027e20: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+00027e30: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+00027e40: 7375 6d41 6464 7265 7373 0a20 2020 2029  sumAddress.    )
+00027e50: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00027e60: 2020 6761 735f 6573 7469 6d61 7465 203d    gas_estimate =
+00027e70: 2077 332e 6574 682e 6573 7469 6d61 7465   w3.eth.estimate
+00027e80: 5f67 6173 280a 2020 2020 2020 2020 2020  _gas(.          
+00027e90: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00027ea0: 2020 2020 2266 726f 6d22 3a20 6b65 7966      "from": keyf
+00027eb0: 696c 655f 6163 636f 756e 745f 6164 6472  ile_account_addr
+00027ec0: 6573 735f 6475 616c 5f74 7970 652c 0a20  ess_dual_type,. 
+00027ed0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00027ee0: 746f 223a 206b 6579 6669 6c65 5f61 6363  to": keyfile_acc
+00027ef0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00027f00: 6c5f 7479 7065 2c0a 2020 2020 2020 2020  l_type,.        
+00027f10: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00027f20: 2057 6569 2831 292c 0a20 2020 2020 2020   Wei(1),.       
+00027f30: 2020 2020 207d 0a20 2020 2020 2020 2029       }.        )
+00027f40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00027f50: 6973 5f69 6e74 6567 6572 2867 6173 5f65  is_integer(gas_e
+00027f60: 7374 696d 6174 6529 0a20 2020 2020 2020  stimate).       
+00027f70: 2061 7373 6572 7420 6761 735f 6573 7469   assert gas_esti
+00027f80: 6d61 7465 203e 2030 0a0a 2020 2020 6465  mate > 0..    de
+00027f90: 6620 7465 7374 5f65 7468 5f65 7374 696d  f test_eth_estim
+00027fa0: 6174 655f 6761 735f 7769 7468 5f62 6c6f  ate_gas_with_blo
+00027fb0: 636b 280a 2020 2020 2020 2020 7365 6c66  ck(.        self
+00027fc0: 2c20 7733 3a20 2257 6562 3322 2c20 6b65  , w3: "Web3", ke
+00027fd0: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+00027fe0: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
+00027ff0: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
+00028000: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00028010: 2020 2020 2020 2020 6761 735f 6573 7469          gas_esti
+00028020: 6d61 7465 203d 2077 332e 6574 682e 6573  mate = w3.eth.es
+00028030: 7469 6d61 7465 5f67 6173 280a 2020 2020  timate_gas(.    
+00028040: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00028050: 2020 2020 2020 2020 2020 2266 726f 6d22            "from"
+00028060: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00028070: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+00028080: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00028090: 2020 2020 2022 746f 223a 206b 6579 6669       "to": keyfi
+000280a0: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
+000280b0: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
+000280c0: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+000280d0: 616c 7565 223a 2057 6569 2831 292c 0a20  alue": Wei(1),. 
+000280e0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+000280f0: 2020 2020 2020 2020 2020 226c 6174 6573            "lates
+00028100: 7422 2c0a 2020 2020 2020 2020 290a 2020  t",.        ).  
+00028110: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00028120: 696e 7465 6765 7228 6761 735f 6573 7469  integer(gas_esti
+00028130: 6d61 7465 290a 2020 2020 2020 2020 6173  mate).        as
+00028140: 7365 7274 2067 6173 5f65 7374 696d 6174  sert gas_estimat
+00028150: 6520 3e20 300a 0a20 2020 2040 7079 7465  e > 0..    @pyte
+00028160: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00028170: 697a 6528 0a20 2020 2020 2020 2022 7061  ize(.        "pa
+00028180: 7261 6d73 222c 0a20 2020 2020 2020 2028  rams",.        (
+00028190: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+000281a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000281b0: 6e6f 6e63 6522 3a20 312c 2020 2320 696e  nonce": 1,  # in
+000281c0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+000281d0: 2020 2262 616c 616e 6365 223a 2031 2c20    "balance": 1, 
+000281e0: 2023 2069 6e74 0a20 2020 2020 2020 2020   # int.         
+000281f0: 2020 2020 2020 2022 636f 6465 223a 2048         "code": H
+00028200: 6578 5374 7228 2230 7822 292c 2020 2320  exStr("0x"),  # 
+00028210: 4865 7853 7472 0a20 2020 2020 2020 2020  HexStr.         
+00028220: 2020 2020 2020 2023 2077 6974 6820 7374         # with st
+00028230: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
+00028240: 2020 2020 2273 7461 7465 223a 207b 4865      "state": {He
+00028250: 7853 7472 2866 2230 787b 2730 3027 202a  xStr(f"0x{'00' *
+00028260: 2033 327d 2229 3a20 4865 7853 7472 2866   32}"): HexStr(f
+00028270: 2230 787b 2730 3027 202a 2033 327d 2229  "0x{'00' * 32}")
+00028280: 7d2c 0a20 2020 2020 2020 2020 2020 207d  },.            }
+00028290: 2c0a 2020 2020 2020 2020 2020 2020 7b0a  ,.            {.
+000282a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282b0: 226e 6f6e 6365 223a 2048 6578 5374 7228  "nonce": HexStr(
+000282c0: 2230 7831 2229 2c20 2023 2048 6578 5374  "0x1"),  # HexSt
+000282d0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000282e0: 2020 2262 616c 616e 6365 223a 2048 6578    "balance": Hex
+000282f0: 5374 7228 2230 7831 2229 2c20 2023 2048  Str("0x1"),  # H
+00028300: 6578 5374 720a 2020 2020 2020 2020 2020  exStr.          
+00028310: 2020 2020 2020 2263 6f64 6522 3a20 6222        "code": b"
+00028320: 5c78 3030 222c 2020 2320 6279 7465 730a  \x00",  # bytes.
+00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028340: 2320 7769 7468 2073 7461 7465 4469 6666  # with stateDiff
+00028350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028360: 2022 7374 6174 6544 6966 6622 3a20 7b48   "stateDiff": {H
+00028370: 6578 5374 7228 6622 3078 7b27 3030 2720  exStr(f"0x{'00' 
+00028380: 2a20 3332 7d22 293a 2048 6578 5374 7228  * 32}"): HexStr(
+00028390: 6622 3078 7b27 3030 2720 2a20 3332 7d22  f"0x{'00' * 32}"
+000283a0: 297d 2c0a 2020 2020 2020 2020 2020 2020  )},.            
+000283b0: 7d2c 0a20 2020 2020 2020 2029 2c0a 2020  },.        ),.  
+000283c0: 2020 290a 2020 2020 6465 6620 7465 7374    ).    def test
+000283d0: 5f65 7468 5f65 7374 696d 6174 655f 6761  _eth_estimate_ga
+000283e0: 735f 7769 7468 5f6f 7665 7272 6964 655f  s_with_override_
+000283f0: 7061 7261 6d5f 7479 7065 5f63 6865 636b  param_type_check
+00028400: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00028410: 2020 2020 2020 2020 7733 3a20 2257 6562          w3: "Web
+00028420: 3322 2c0a 2020 2020 2020 2020 6d61 7468  3",.        math
+00028430: 5f63 6f6e 7472 6163 743a 2022 436f 6e74  _contract: "Cont
+00028440: 7261 6374 222c 0a20 2020 2020 2020 2070  ract",.        p
+00028450: 6172 616d 733a 2053 7461 7465 4f76 6572  arams: StateOver
+00028460: 7269 6465 5061 7261 6d73 2c0a 2020 2020  rideParams,.    
+00028470: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00028480: 2020 2074 786e 5f70 6172 616d 733a 2054     txn_params: T
+00028490: 7850 6172 616d 7320 3d20 7b22 6672 6f6d  xParams = {"from
+000284a0: 223a 2077 332e 6574 682e 636f 696e 6261  ": w3.eth.coinba
+000284b0: 7365 7d0a 0a20 2020 2020 2020 2023 2061  se}..        # a
+000284c0: 7373 6572 7420 646f 6573 206e 6f74 2072  ssert does not r
+000284d0: 6169 7365 0a20 2020 2020 2020 2077 332e  aise.        w3.
+000284e0: 6574 682e 6573 7469 6d61 7465 5f67 6173  eth.estimate_gas
+000284f0: 2874 786e 5f70 6172 616d 732c 204e 6f6e  (txn_params, Non
+00028500: 652c 207b 6d61 7468 5f63 6f6e 7472 6163  e, {math_contrac
+00028510: 742e 6164 6472 6573 733a 2070 6172 616d  t.address: param
+00028520: 737d 290a 0a20 2020 2064 6566 2074 6573  s})..    def tes
+00028530: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+00028540: 4861 7368 2873 656c 662c 2077 333a 2022  Hash(self, w3: "
+00028550: 5765 6233 222c 2065 6d70 7479 5f62 6c6f  Web3", empty_blo
+00028560: 636b 3a20 426c 6f63 6b44 6174 6129 202d  ck: BlockData) -
+00028570: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00028580: 626c 6f63 6b20 3d20 7733 2e65 7468 2e67  block = w3.eth.g
+00028590: 6574 5f62 6c6f 636b 2865 6d70 7479 5f62  et_block(empty_b
+000285a0: 6c6f 636b 5b22 6861 7368 225d 290a 2020  lock["hash"]).  
+000285b0: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+000285c0: 636b 5b22 6861 7368 225d 203d 3d20 656d  ck["hash"] == em
+000285d0: 7074 795f 626c 6f63 6b5b 2268 6173 6822  pty_block["hash"
+000285e0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+000285f0: 2062 6c6f 636b 5b22 7265 6365 6970 7473   block["receipts
+00028600: 526f 6f74 225d 203d 3d20 656d 7074 795f  Root"] == empty_
+00028610: 626c 6f63 6b5b 2272 6563 6569 7074 7352  block["receiptsR
+00028620: 6f6f 7422 5d0a 2020 2020 2020 2020 6173  oot"].        as
+00028630: 7365 7274 2062 6c6f 636b 5b22 6c6f 6773  sert block["logs
+00028640: 426c 6f6f 6d22 5d20 3d3d 2065 6d70 7479  Bloom"] == empty
+00028650: 5f62 6c6f 636b 5b22 6c6f 6773 426c 6f6f  _block["logsBloo
+00028660: 6d22 5d0a 0a20 2020 2064 6566 2074 6573  m"]..    def tes
+00028670: 745f 6574 685f 6765 7442 6c6f 636b 4279  t_eth_getBlockBy
+00028680: 4861 7368 5f6e 6f74 5f66 6f75 6e64 280a  Hash_not_found(.
+00028690: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+000286a0: 3a20 2257 6562 3322 2c20 656d 7074 795f  : "Web3", empty_
+000286b0: 626c 6f63 6b3a 2042 6c6f 636b 4461 7461  block: BlockData
+000286c0: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+000286d0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+000286e0: 6573 742e 7261 6973 6573 2842 6c6f 636b  est.raises(Block
+000286f0: 4e6f 7446 6f75 6e64 293a 0a20 2020 2020  NotFound):.     
+00028700: 2020 2020 2020 2077 332e 6574 682e 6765         w3.eth.ge
+00028710: 745f 626c 6f63 6b28 554e 4b4e 4f57 4e5f  t_block(UNKNOWN_
+00028720: 4841 5348 290a 0a20 2020 2064 6566 2074  HASH)..    def t
+00028730: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00028740: 4279 4861 7368 5f70 656e 6469 6e67 2873  ByHash_pending(s
+00028750: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
+00028760: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00028770: 2020 626c 6f63 6b20 3d20 7733 2e65 7468    block = w3.eth
+00028780: 2e67 6574 5f62 6c6f 636b 2822 7065 6e64  .get_block("pend
+00028790: 696e 6722 290a 2020 2020 2020 2020 6173  ing").        as
+000287a0: 7365 7274 2062 6c6f 636b 5b22 6861 7368  sert block["hash
+000287b0: 225d 2069 7320 4e6f 6e65 0a0a 2020 2020  "] is None..    
+000287c0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+000287d0: 426c 6f63 6b42 794e 756d 6265 725f 7769  BlockByNumber_wi
+000287e0: 7468 5f69 6e74 6567 6572 280a 2020 2020  th_integer(.    
+000287f0: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+00028800: 6562 3322 2c20 656d 7074 795f 626c 6f63  eb3", empty_bloc
+00028810: 6b3a 2042 6c6f 636b 4461 7461 0a20 2020  k: BlockData.   
+00028820: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+00028830: 2020 2020 626c 6f63 6b20 3d20 7733 2e65      block = w3.e
+00028840: 7468 2e67 6574 5f62 6c6f 636b 2865 6d70  th.get_block(emp
+00028850: 7479 5f62 6c6f 636b 5b22 6e75 6d62 6572  ty_block["number
+00028860: 225d 290a 2020 2020 2020 2020 6173 7365  "]).        asse
+00028870: 7274 2062 6c6f 636b 5b22 6e75 6d62 6572  rt block["number
+00028880: 225d 203d 3d20 656d 7074 795f 626c 6f63  "] == empty_bloc
+00028890: 6b5b 226e 756d 6265 7222 5d0a 0a20 2020  k["number"]..   
+000288a0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+000288b0: 7442 6c6f 636b 4279 4e75 6d62 6572 5f6c  tBlockByNumber_l
+000288c0: 6174 6573 7428 0a20 2020 2020 2020 2073  atest(.        s
+000288d0: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+000288e0: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+000288f0: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00028900: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
+00028910: 7572 7265 6e74 5f62 6c6f 636b 5f6e 756d  urrent_block_num
+00028920: 6265 7220 3d20 7733 2e65 7468 2e62 6c6f  ber = w3.eth.blo
+00028930: 636b 5f6e 756d 6265 720a 2020 2020 2020  ck_number.      
+00028940: 2020 626c 6f63 6b20 3d20 7733 2e65 7468    block = w3.eth
+00028950: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
+00028960: 7374 2229 0a20 2020 2020 2020 2061 7373  st").        ass
+00028970: 6572 7420 626c 6f63 6b5b 226e 756d 6265  ert block["numbe
+00028980: 7222 5d20 3d3d 2063 7572 7265 6e74 5f62  r"] == current_b
+00028990: 6c6f 636b 5f6e 756d 6265 720a 0a20 2020  lock_number..   
+000289a0: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+000289b0: 7442 6c6f 636b 4279 4e75 6d62 6572 5f6e  tBlockByNumber_n
+000289c0: 6f74 5f66 6f75 6e64 280a 2020 2020 2020  ot_found(.      
+000289d0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+000289e0: 3322 2c20 656d 7074 795f 626c 6f63 6b3a  3", empty_block:
+000289f0: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
+00028a00: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00028a10: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00028a20: 6973 6573 2842 6c6f 636b 4e6f 7446 6f75  ises(BlockNotFou
+00028a30: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
+00028a40: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
+00028a50: 6b28 426c 6f63 6b4e 756d 6265 7228 3132  k(BlockNumber(12
+00028a60: 3334 3529 290a 0a20 2020 2064 6566 2074  345))..    def t
+00028a70: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00028a80: 4279 4e75 6d62 6572 5f70 656e 6469 6e67  ByNumber_pending
+00028a90: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00028aa0: 7733 3a20 2257 6562 3322 2c20 656d 7074  w3: "Web3", empt
+00028ab0: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+00028ac0: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00028ad0: 3a0a 2020 2020 2020 2020 6375 7272 656e  :.        curren
+00028ae0: 745f 626c 6f63 6b5f 6e75 6d62 6572 203d  t_block_number =
+00028af0: 2077 332e 6574 682e 626c 6f63 6b5f 6e75   w3.eth.block_nu
+00028b00: 6d62 6572 0a20 2020 2020 2020 2062 6c6f  mber.        blo
+00028b10: 636b 203d 2077 332e 6574 682e 6765 745f  ck = w3.eth.get_
+00028b20: 626c 6f63 6b28 2270 656e 6469 6e67 2229  block("pending")
+00028b30: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00028b40: 626c 6f63 6b5b 226e 756d 6265 7222 5d20  block["number"] 
+00028b50: 3d3d 2063 7572 7265 6e74 5f62 6c6f 636b  == current_block
+00028b60: 5f6e 756d 6265 7220 2b20 310a 0a20 2020  _number + 1..   
+00028b70: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00028b80: 7442 6c6f 636b 4279 4e75 6d62 6572 5f65  tBlockByNumber_e
+00028b90: 6172 6c69 6573 7428 0a20 2020 2020 2020  arliest(.       
+00028ba0: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+00028bb0: 222c 2065 6d70 7479 5f62 6c6f 636b 3a20  ", empty_block: 
+00028bc0: 426c 6f63 6b44 6174 610a 2020 2020 2920  BlockData.    ) 
+00028bd0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00028be0: 2067 656e 6573 6973 5f62 6c6f 636b 203d   genesis_block =
+00028bf0: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
+00028c00: 6b28 426c 6f63 6b4e 756d 6265 7228 3029  k(BlockNumber(0)
+00028c10: 290a 2020 2020 2020 2020 626c 6f63 6b20  ).        block 
+00028c20: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
+00028c30: 636b 2822 6561 726c 6965 7374 2229 0a20  ck("earliest"). 
+00028c40: 2020 2020 2020 2061 7373 6572 7420 626c         assert bl
+00028c50: 6f63 6b5b 226e 756d 6265 7222 5d20 3d3d  ock["number"] ==
+00028c60: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+00028c70: 7420 626c 6f63 6b5b 2268 6173 6822 5d20  t block["hash"] 
+00028c80: 3d3d 2067 656e 6573 6973 5f62 6c6f 636b  == genesis_block
+00028c90: 5b22 6861 7368 225d 0a0a 2020 2020 6465  ["hash"]..    de
+00028ca0: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
+00028cb0: 6f63 6b42 794e 756d 6265 725f 7361 6665  ockByNumber_safe
+00028cc0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00028cd0: 7733 3a20 2257 6562 3322 2c20 656d 7074  w3: "Web3", empt
+00028ce0: 795f 626c 6f63 6b3a 2042 6c6f 636b 4461  y_block: BlockDa
+00028cf0: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00028d00: 3a0a 2020 2020 2020 2020 626c 6f63 6b20  :.        block 
+00028d10: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
+00028d20: 636b 2822 7361 6665 2229 0a20 2020 2020  ck("safe").     
+00028d30: 2020 2061 7373 6572 7420 626c 6f63 6b20     assert block 
+00028d40: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00028d50: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
+00028d60: 7461 6e63 6528 626c 6f63 6b5b 226e 756d  tance(block["num
+00028d70: 6265 7222 5d2c 2069 6e74 290a 0a20 2020  ber"], int)..   
+00028d80: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
+00028d90: 7442 6c6f 636b 4279 4e75 6d62 6572 5f66  tBlockByNumber_f
+00028da0: 696e 616c 697a 6564 280a 2020 2020 2020  inalized(.      
+00028db0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+00028dc0: 3322 2c20 656d 7074 795f 626c 6f63 6b3a  3", empty_block:
+00028dd0: 2042 6c6f 636b 4461 7461 0a20 2020 2029   BlockData.    )
+00028de0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00028df0: 2020 626c 6f63 6b20 3d20 7733 2e65 7468    block = w3.eth
+00028e00: 2e67 6574 5f62 6c6f 636b 2822 6669 6e61  .get_block("fina
+00028e10: 6c69 7a65 6422 290a 2020 2020 2020 2020  lized").        
+00028e20: 6173 7365 7274 2062 6c6f 636b 2069 7320  assert block is 
+00028e30: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+00028e40: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+00028e50: 6365 2862 6c6f 636b 5b22 6e75 6d62 6572  ce(block["number
+00028e60: 225d 2c20 696e 7429 0a0a 2020 2020 6465  "], int)..    de
+00028e70: 6620 7465 7374 5f65 7468 5f67 6574 426c  f test_eth_getBl
+00028e80: 6f63 6b42 794e 756d 6265 725f 6675 6c6c  ockByNumber_full
+00028e90: 5f74 7261 6e73 6163 7469 6f6e 7328 0a20  _transactions(. 
+00028ea0: 2020 2020 2020 2073 656c 662c 2077 333a         self, w3:
+00028eb0: 2022 5765 6233 222c 2062 6c6f 636b 5f77   "Web3", block_w
+00028ec0: 6974 685f 7478 6e3a 2042 6c6f 636b 4461  ith_txn: BlockDa
+00028ed0: 7461 0a20 2020 2029 202d 3e20 4e6f 6e65  ta.    ) -> None
+00028ee0: 3a0a 2020 2020 2020 2020 626c 6f63 6b20  :.        block 
+00028ef0: 3d20 7733 2e65 7468 2e67 6574 5f62 6c6f  = w3.eth.get_blo
+00028f00: 636b 2862 6c6f 636b 5f77 6974 685f 7478  ck(block_with_tx
+00028f10: 6e5b 226e 756d 6265 7222 5d2c 2054 7275  n["number"], Tru
+00028f20: 6529 0a20 2020 2020 2020 2074 7261 6e73  e).        trans
+00028f30: 6163 7469 6f6e 203d 2062 6c6f 636b 5b22  action = block["
+00028f40: 7472 616e 7361 6374 696f 6e73 225d 5b30  transactions"][0
+00028f50: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+00028f60: 2074 7261 6e73 6163 7469 6f6e 5b22 6861   transaction["ha
+00028f70: 7368 225d 203d 3d20 626c 6f63 6b5f 7769  sh"] == block_wi
+00028f80: 7468 5f74 786e 5b22 7472 616e 7361 6374  th_txn["transact
+00028f90: 696f 6e73 225d 5b30 5d0a 0a20 2020 2064  ions"][0]..    d
+00028fa0: 6566 2074 6573 745f 6574 685f 6765 7442  ef test_eth_getB
+00028fb0: 6c6f 636b 5265 6365 6970 7473 5f68 6173  lockReceipts_has
+00028fc0: 6828 0a20 2020 2020 2020 2073 656c 662c  h(.        self,
+00028fd0: 2077 333a 2022 5765 6233 222c 2065 6d70   w3: "Web3", emp
+00028fe0: 7479 5f62 6c6f 636b 3a20 426c 6f63 6b44  ty_block: BlockD
+00028ff0: 6174 610a 2020 2020 2920 2d3e 204e 6f6e  ata.    ) -> Non
+00029000: 653a 0a20 2020 2020 2020 2072 6563 6569  e:.        recei
+00029010: 7074 7320 3d20 7733 2e65 7468 2e67 6574  pts = w3.eth.get
+00029020: 5f62 6c6f 636b 5f72 6563 6569 7074 7328  _block_receipts(
+00029030: 656d 7074 795f 626c 6f63 6b5b 2268 6173  empty_block["has
+00029040: 6822 5d29 0a20 2020 2020 2020 2061 7373  h"]).        ass
+00029050: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+00029060: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
+00029070: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+00029080: 5f67 6574 426c 6f63 6b52 6563 6569 7074  _getBlockReceipt
+00029090: 735f 6e6f 745f 666f 756e 6428 7365 6c66  s_not_found(self
+000290a0: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
+000290b0: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+000290c0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+000290d0: 7328 426c 6f63 6b4e 6f74 466f 756e 6429  s(BlockNotFound)
+000290e0: 3a0a 2020 2020 2020 2020 2020 2020 7733  :.            w3
+000290f0: 2e65 7468 2e67 6574 5f62 6c6f 636b 5f72  .eth.get_block_r
+00029100: 6563 6569 7074 7328 554e 4b4e 4f57 4e5f  eceipts(UNKNOWN_
+00029110: 4841 5348 290a 0a20 2020 2064 6566 2074  HASH)..    def t
+00029120: 6573 745f 6574 685f 6765 7442 6c6f 636b  est_eth_getBlock
+00029130: 5265 6365 6970 7473 5f77 6974 685f 696e  Receipts_with_in
+00029140: 7465 6765 7228 0a20 2020 2020 2020 2073  teger(.        s
+00029150: 656c 662c 2077 333a 2022 5765 6233 222c  elf, w3: "Web3",
+00029160: 2065 6d70 7479 5f62 6c6f 636b 3a20 426c   empty_block: Bl
+00029170: 6f63 6b44 6174 610a 2020 2020 2920 2d3e  ockData.    ) ->
+00029180: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+00029190: 6563 6569 7074 7320 3d20 7733 2e65 7468  eceipts = w3.eth
+000291a0: 2e67 6574 5f62 6c6f 636b 5f72 6563 6569  .get_block_recei
+000291b0: 7074 7328 656d 7074 795f 626c 6f63 6b5b  pts(empty_block[
+000291c0: 226e 756d 6265 7222 5d29 0a20 2020 2020  "number"]).     
+000291d0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+000291e0: 616e 6365 2872 6563 6569 7074 732c 206c  ance(receipts, l
+000291f0: 6973 7429 0a0a 2020 2020 6465 6620 7465  ist)..    def te
+00029200: 7374 5f65 7468 5f67 6574 426c 6f63 6b52  st_eth_getBlockR
+00029210: 6563 6569 7074 735f 7361 6665 280a 2020  eceipts_safe(.  
+00029220: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+00029230: 2257 6562 3322 2c20 656d 7074 795f 626c  "Web3", empty_bl
+00029240: 6f63 6b3a 2042 6c6f 636b 4461 7461 0a20  ock: BlockData. 
+00029250: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00029260: 2020 2020 2020 7265 6365 6970 7473 203d        receipts =
+00029270: 2077 332e 6574 682e 6765 745f 626c 6f63   w3.eth.get_bloc
+00029280: 6b5f 7265 6365 6970 7473 2822 7361 6665  k_receipts("safe
+00029290: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
+000292a0: 7420 6973 696e 7374 616e 6365 2872 6563  t isinstance(rec
+000292b0: 6569 7074 732c 206c 6973 7429 0a0a 2020  eipts, list)..  
+000292c0: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
+000292d0: 6574 426c 6f63 6b52 6563 6569 7074 735f  etBlockReceipts_
+000292e0: 6669 6e61 6c69 7a65 6428 0a20 2020 2020  finalized(.     
+000292f0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+00029300: 6233 222c 2065 6d70 7479 5f62 6c6f 636b  b3", empty_block
+00029310: 3a20 426c 6f63 6b44 6174 610a 2020 2020  : BlockData.    
+00029320: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00029330: 2020 2072 6563 6569 7074 7320 3d20 7733     receipts = w3
+00029340: 2e65 7468 2e67 6574 5f62 6c6f 636b 5f72  .eth.get_block_r
+00029350: 6563 6569 7074 7328 2266 696e 616c 697a  eceipts("finaliz
+00029360: 6564 2229 0a20 2020 2020 2020 2061 7373  ed").        ass
+00029370: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+00029380: 6563 6569 7074 732c 206c 6973 7429 0a0a  eceipts, list)..
+00029390: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
+000293a0: 5f67 6574 5472 616e 7361 6374 696f 6e42  _getTransactionB
+000293b0: 7948 6173 6828 7365 6c66 2c20 7733 3a20  yHash(self, w3: 
+000293c0: 2257 6562 3322 2c20 6d69 6e65 645f 7478  "Web3", mined_tx
+000293d0: 6e5f 6861 7368 3a20 4865 7853 7472 2920  n_hash: HexStr) 
+000293e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000293f0: 2074 7261 6e73 6163 7469 6f6e 203d 2077   transaction = w
+00029400: 332e 6574 682e 6765 745f 7472 616e 7361  3.eth.get_transa
+00029410: 6374 696f 6e28 6d69 6e65 645f 7478 6e5f  ction(mined_txn_
+00029420: 6861 7368 290a 2020 2020 2020 2020 6173  hash).        as
+00029430: 7365 7274 2069 735f 6469 6374 2874 7261  sert is_dict(tra
+00029440: 6e73 6163 7469 6f6e 290a 2020 2020 2020  nsaction).      
+00029450: 2020 6173 7365 7274 2074 7261 6e73 6163    assert transac
+00029460: 7469 6f6e 5b22 6861 7368 225d 203d 3d20  tion["hash"] == 
+00029470: 4865 7842 7974 6573 286d 696e 6564 5f74  HexBytes(mined_t
+00029480: 786e 5f68 6173 6829 0a0a 2020 2020 6465  xn_hash)..    de
+00029490: 6620 7465 7374 5f65 7468 5f67 6574 5472  f test_eth_getTr
+000294a0: 616e 7361 6374 696f 6e42 7948 6173 685f  ansactionByHash_
+000294b0: 636f 6e74 7261 6374 5f63 7265 6174 696f  contract_creatio
+000294c0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+000294d0: 2077 333a 2022 5765 6233 222c 206d 6174   w3: "Web3", mat
+000294e0: 685f 636f 6e74 7261 6374 5f64 6570 6c6f  h_contract_deplo
+000294f0: 795f 7478 6e5f 6861 7368 3a20 4865 7853  y_txn_hash: HexS
+00029500: 7472 0a20 2020 2029 202d 3e20 4e6f 6e65  tr.    ) -> None
+00029510: 3a0a 2020 2020 2020 2020 7472 616e 7361  :.        transa
+00029520: 6374 696f 6e20 3d20 7733 2e65 7468 2e67  ction = w3.eth.g
+00029530: 6574 5f74 7261 6e73 6163 7469 6f6e 286d  et_transaction(m
+00029540: 6174 685f 636f 6e74 7261 6374 5f64 6570  ath_contract_dep
+00029550: 6c6f 795f 7478 6e5f 6861 7368 290a 2020  loy_txn_hash).  
+00029560: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+00029570: 6469 6374 2874 7261 6e73 6163 7469 6f6e  dict(transaction
+00029580: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00029590: 2074 7261 6e73 6163 7469 6f6e 5b22 746f   transaction["to
+000295a0: 225d 2069 7320 4e6f 6e65 2c20 6622 746f  "] is None, f"to
+000295b0: 2066 6965 6c64 2069 7320 7b74 7261 6e73   field is {trans
+000295c0: 6163 7469 6f6e 5b27 746f 275d 2172 7d22  action['to']!r}"
+000295d0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+000295e0: 7468 5f67 6574 5472 616e 7361 6374 696f  th_getTransactio
+000295f0: 6e42 7942 6c6f 636b 4861 7368 416e 6449  nByBlockHashAndI
+00029600: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
+00029610: 6c66 2c20 7733 3a20 2257 6562 3322 2c20  lf, w3: "Web3", 
+00029620: 626c 6f63 6b5f 7769 7468 5f74 786e 3a20  block_with_txn: 
+00029630: 426c 6f63 6b44 6174 612c 206d 696e 6564  BlockData, mined
+00029640: 5f74 786e 5f68 6173 683a 2048 6578 5374  _txn_hash: HexSt
+00029650: 720a 2020 2020 2920 2d3e 204e 6f6e 653a  r.    ) -> None:
+00029660: 0a20 2020 2020 2020 2074 7261 6e73 6163  .        transac
+00029670: 7469 6f6e 203d 2077 332e 6574 682e 6765  tion = w3.eth.ge
+00029680: 745f 7472 616e 7361 6374 696f 6e5f 6279  t_transaction_by
+00029690: 5f62 6c6f 636b 2862 6c6f 636b 5f77 6974  _block(block_wit
+000296a0: 685f 7478 6e5b 2268 6173 6822 5d2c 2030  h_txn["hash"], 0
+000296b0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+000296c0: 2069 735f 6469 6374 2874 7261 6e73 6163   is_dict(transac
+000296d0: 7469 6f6e 290a 2020 2020 2020 2020 6173  tion).        as
+000296e0: 7365 7274 2074 7261 6e73 6163 7469 6f6e  sert transaction
+000296f0: 5b22 6861 7368 225d 203d 3d20 4865 7842  ["hash"] == HexB
+00029700: 7974 6573 286d 696e 6564 5f74 786e 5f68  ytes(mined_txn_h
+00029710: 6173 6829 0a0a 2020 2020 6465 6620 7465  ash)..    def te
+00029720: 7374 5f65 7468 5f67 6574 5472 616e 7361  st_eth_getTransa
+00029730: 6374 696f 6e42 7942 6c6f 636b 4e75 6d62  ctionByBlockNumb
+00029740: 6572 416e 6449 6e64 6578 280a 2020 2020  erAndIndex(.    
+00029750: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
+00029760: 6562 3322 2c20 626c 6f63 6b5f 7769 7468  eb3", block_with
+00029770: 5f74 786e 3a20 426c 6f63 6b44 6174 612c  _txn: BlockData,
+00029780: 206d 696e 6564 5f74 786e 5f68 6173 683a   mined_txn_hash:
+00029790: 2048 6578 5374 720a 2020 2020 2920 2d3e   HexStr.    ) ->
+000297a0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+000297b0: 7261 6e73 6163 7469 6f6e 203d 2077 332e  ransaction = w3.
+000297c0: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+000297d0: 696f 6e5f 6279 5f62 6c6f 636b 2862 6c6f  ion_by_block(blo
+000297e0: 636b 5f77 6974 685f 7478 6e5b 226e 756d  ck_with_txn["num
+000297f0: 6265 7222 5d2c 2030 290a 2020 2020 2020  ber"], 0).      
+00029800: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
+00029810: 2874 7261 6e73 6163 7469 6f6e 290a 2020  (transaction).  
+00029820: 2020 2020 2020 6173 7365 7274 2074 7261        assert tra
+00029830: 6e73 6163 7469 6f6e 5b22 6861 7368 225d  nsaction["hash"]
+00029840: 203d 3d20 4865 7842 7974 6573 286d 696e   == HexBytes(min
+00029850: 6564 5f74 786e 5f68 6173 6829 0a0a 2020  ed_txn_hash)..  
+00029860: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
+00029870: 6574 5f74 7261 6e73 6163 7469 6f6e 5f72  et_transaction_r
+00029880: 6563 6569 7074 5f6d 696e 6564 280a 2020  eceipt_mined(.  
+00029890: 2020 2020 2020 7365 6c66 2c20 7733 3a20        self, w3: 
+000298a0: 2257 6562 3322 2c20 626c 6f63 6b5f 7769  "Web3", block_wi
+000298b0: 7468 5f74 786e 3a20 426c 6f63 6b44 6174  th_txn: BlockDat
+000298c0: 612c 206d 696e 6564 5f74 786e 5f68 6173  a, mined_txn_has
+000298d0: 683a 2048 6578 5374 720a 2020 2020 2920  h: HexStr.    ) 
+000298e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+000298f0: 2072 6563 6569 7074 203d 2077 332e 6574   receipt = w3.et
+00029900: 682e 6765 745f 7472 616e 7361 6374 696f  h.get_transactio
+00029910: 6e5f 7265 6365 6970 7428 6d69 6e65 645f  n_receipt(mined_
+00029920: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
+00029930: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
+00029940: 2872 6563 6569 7074 290a 2020 2020 2020  (receipt).      
+00029950: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+00029960: 5b22 626c 6f63 6b4e 756d 6265 7222 5d20  ["blockNumber"] 
+00029970: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+00029980: 6e5b 226e 756d 6265 7222 5d0a 2020 2020  n["number"].    
+00029990: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+000299a0: 7074 5b22 626c 6f63 6b48 6173 6822 5d20  pt["blockHash"] 
+000299b0: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+000299c0: 6e5b 2268 6173 6822 5d0a 2020 2020 2020  n["hash"].      
+000299d0: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+000299e0: 5b22 7472 616e 7361 6374 696f 6e49 6e64  ["transactionInd
+000299f0: 6578 225d 203d 3d20 300a 2020 2020 2020  ex"] == 0.      
+00029a00: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+00029a10: 5b22 7472 616e 7361 6374 696f 6e48 6173  ["transactionHas
+00029a20: 6822 5d20 3d3d 2048 6578 4279 7465 7328  h"] == HexBytes(
+00029a30: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
+00029a40: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00029a50: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
+00029a60: 7373 2872 6563 6569 7074 5b22 746f 225d  ss(receipt["to"]
+00029a70: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00029a80: 2072 6563 6569 7074 5b22 6672 6f6d 225d   receipt["from"]
+00029a90: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00029aa0: 2020 2020 2061 7373 6572 7420 6973 5f63       assert is_c
+00029ab0: 6865 636b 7375 6d5f 6164 6472 6573 7328  hecksum_address(
+00029ac0: 7265 6365 6970 745b 2266 726f 6d22 5d29  receipt["from"])
+00029ad0: 0a0a 2020 2020 2020 2020 6566 6665 6374  ..        effect
+00029ae0: 6976 655f 6761 735f 7072 6963 6520 3d20  ive_gas_price = 
+00029af0: 7265 6365 6970 745b 2265 6666 6563 7469  receipt["effecti
+00029b00: 7665 4761 7350 7269 6365 225d 0a20 2020  veGasPrice"].   
+00029b10: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+00029b20: 7374 616e 6365 2865 6666 6563 7469 7665  stance(effective
+00029b30: 5f67 6173 5f70 7269 6365 2c20 696e 7429  _gas_price, int)
+00029b40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00029b50: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
+00029b60: 6963 6520 3e20 300a 0a20 2020 2064 6566  ice > 0..    def
+00029b70: 2074 6573 745f 6574 685f 6765 745f 7472   test_eth_get_tr
+00029b80: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+00029b90: 745f 756e 6d69 6e65 6428 0a20 2020 2020  t_unmined(.     
+00029ba0: 2020 2073 656c 662c 2077 333a 2022 5765     self, w3: "We
+00029bb0: 6233 222c 206b 6579 6669 6c65 5f61 6363  b3", keyfile_acc
+00029bc0: 6f75 6e74 5f61 6464 7265 7373 5f64 7561  ount_address_dua
+00029bd0: 6c5f 7479 7065 3a20 4368 6563 6b73 756d  l_type: Checksum
+00029be0: 4164 6472 6573 730a 2020 2020 2920 2d3e  Address.    ) ->
+00029bf0: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+00029c00: 786e 5f68 6173 6820 3d20 7733 2e65 7468  xn_hash = w3.eth
+00029c10: 2e73 656e 645f 7472 616e 7361 6374 696f  .send_transactio
+00029c20: 6e28 0a20 2020 2020 2020 2020 2020 207b  n(.            {
+00029c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029c40: 2022 6672 6f6d 223a 206b 6579 6669 6c65   "from": keyfile
+00029c50: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
+00029c60: 5f64 7561 6c5f 7479 7065 2c0a 2020 2020  _dual_type,.    
+00029c70: 2020 2020 2020 2020 2020 2020 2274 6f22              "to"
+00029c80: 3a20 6b65 7966 696c 655f 6163 636f 756e  : keyfile_accoun
+00029c90: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
+00029ca0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00029cb0: 2020 2020 2022 7661 6c75 6522 3a20 5765       "value": We
+00029cc0: 6928 3129 2c0a 2020 2020 2020 2020 2020  i(1),.          
+00029cd0: 2020 2020 2020 2267 6173 223a 2032 3130        "gas": 210
+00029ce0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+00029cf0: 2020 2020 226d 6178 4665 6550 6572 4761      "maxFeePerGa
+00029d00: 7322 3a20 7733 2e74 6f5f 7765 6928 332c  s": w3.to_wei(3,
+00029d10: 2022 6777 6569 2229 2c0a 2020 2020 2020   "gwei"),.      
+00029d20: 2020 2020 2020 2020 2020 226d 6178 5072            "maxPr
+00029d30: 696f 7269 7479 4665 6550 6572 4761 7322  iorityFeePerGas"
+00029d40: 3a20 7733 2e74 6f5f 7765 6928 312c 2022  : w3.to_wei(1, "
+00029d50: 6777 6569 2229 2c0a 2020 2020 2020 2020  gwei"),.        
+00029d60: 2020 2020 7d0a 2020 2020 2020 2020 290a      }.        ).
+00029d70: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00029d80: 6573 742e 7261 6973 6573 2854 7261 6e73  est.raises(Trans
+00029d90: 6163 7469 6f6e 4e6f 7446 6f75 6e64 293a  actionNotFound):
+00029da0: 0a20 2020 2020 2020 2020 2020 2077 332e  .            w3.
+00029db0: 6574 682e 6765 745f 7472 616e 7361 6374  eth.get_transact
+00029dc0: 696f 6e5f 7265 6365 6970 7428 7478 6e5f  ion_receipt(txn_
+00029dd0: 6861 7368 290a 0a20 2020 2064 6566 2074  hash)..    def t
+00029de0: 6573 745f 6574 685f 6765 745f 7472 616e  est_eth_get_tran
+00029df0: 7361 6374 696f 6e5f 7265 6365 6970 745f  saction_receipt_
+00029e00: 7769 7468 5f6c 6f67 5f65 6e74 7279 280a  with_log_entry(.
+00029e10: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00029e20: 2020 2020 2020 7733 3a20 2257 6562 3322        w3: "Web3"
+00029e30: 2c0a 2020 2020 2020 2020 626c 6f63 6b5f  ,.        block_
+00029e40: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
+00029e50: 673a 2042 6c6f 636b 4461 7461 2c0a 2020  g: BlockData,.  
+00029e60: 2020 2020 2020 656d 6974 7465 725f 636f        emitter_co
+00029e70: 6e74 7261 6374 3a20 2243 6f6e 7472 6163  ntract: "Contrac
+00029e80: 7422 2c0a 2020 2020 2020 2020 7478 6e5f  t",.        txn_
+00029e90: 6861 7368 5f77 6974 685f 6c6f 673a 2048  hash_with_log: H
+00029ea0: 6578 5374 722c 0a20 2020 2029 202d 3e20  exStr,.    ) -> 
+00029eb0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00029ec0: 6365 6970 7420 3d20 7733 2e65 7468 2e67  ceipt = w3.eth.g
+00029ed0: 6574 5f74 7261 6e73 6163 7469 6f6e 5f72  et_transaction_r
+00029ee0: 6563 6569 7074 2874 786e 5f68 6173 685f  eceipt(txn_hash_
+00029ef0: 7769 7468 5f6c 6f67 290a 2020 2020 2020  with_log).      
+00029f00: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
+00029f10: 2872 6563 6569 7074 290a 2020 2020 2020  (receipt).      
+00029f20: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+00029f30: 5b22 626c 6f63 6b4e 756d 6265 7222 5d20  ["blockNumber"] 
+00029f40: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+00029f50: 6e5f 7769 7468 5f6c 6f67 5b22 6e75 6d62  n_with_log["numb
+00029f60: 6572 225d 0a20 2020 2020 2020 2061 7373  er"].        ass
+00029f70: 6572 7420 7265 6365 6970 745b 2262 6c6f  ert receipt["blo
+00029f80: 636b 4861 7368 225d 203d 3d20 626c 6f63  ckHash"] == bloc
+00029f90: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+00029fa0: 6c6f 675b 2268 6173 6822 5d0a 2020 2020  log["hash"].    
+00029fb0: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+00029fc0: 7074 5b22 7472 616e 7361 6374 696f 6e49  pt["transactionI
+00029fd0: 6e64 6578 225d 203d 3d20 300a 2020 2020  ndex"] == 0.    
+00029fe0: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+00029ff0: 7074 5b22 7472 616e 7361 6374 696f 6e48  pt["transactionH
+0002a000: 6173 6822 5d20 3d3d 2048 6578 4279 7465  ash"] == HexByte
+0002a010: 7328 7478 6e5f 6861 7368 5f77 6974 685f  s(txn_hash_with_
+0002a020: 6c6f 6729 0a0a 2020 2020 2020 2020 6173  log)..        as
+0002a030: 7365 7274 206c 656e 2872 6563 6569 7074  sert len(receipt
+0002a040: 5b22 6c6f 6773 225d 2920 3d3d 2031 0a20  ["logs"]) == 1. 
+0002a050: 2020 2020 2020 206c 6f67 5f65 6e74 7279         log_entry
+0002a060: 203d 2072 6563 6569 7074 5b22 6c6f 6773   = receipt["logs
+0002a070: 225d 5b30 5d0a 0a20 2020 2020 2020 2061  "][0]..        a
+0002a080: 7373 6572 7420 6c6f 675f 656e 7472 795b  ssert log_entry[
+0002a090: 2262 6c6f 636b 4e75 6d62 6572 225d 203d  "blockNumber"] =
+0002a0a0: 3d20 626c 6f63 6b5f 7769 7468 5f74 786e  = block_with_txn
+0002a0b0: 5f77 6974 685f 6c6f 675b 226e 756d 6265  _with_log["numbe
+0002a0c0: 7222 5d0a 2020 2020 2020 2020 6173 7365  r"].        asse
+0002a0d0: 7274 206c 6f67 5f65 6e74 7279 5b22 626c  rt log_entry["bl
+0002a0e0: 6f63 6b48 6173 6822 5d20 3d3d 2062 6c6f  ockHash"] == blo
+0002a0f0: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
+0002a100: 5f6c 6f67 5b22 6861 7368 225d 0a20 2020  _log["hash"].   
+0002a110: 2020 2020 2061 7373 6572 7420 6c6f 675f       assert log_
+0002a120: 656e 7472 795b 226c 6f67 496e 6465 7822  entry["logIndex"
+0002a130: 5d20 3d3d 2030 0a20 2020 2020 2020 2061  ] == 0.        a
+0002a140: 7373 6572 7420 6973 5f73 616d 655f 6164  ssert is_same_ad
+0002a150: 6472 6573 7328 6c6f 675f 656e 7472 795b  dress(log_entry[
+0002a160: 2261 6464 7265 7373 225d 2c20 656d 6974  "address"], emit
+0002a170: 7465 725f 636f 6e74 7261 6374 2e61 6464  ter_contract.add
+0002a180: 7265 7373 290a 2020 2020 2020 2020 6173  ress).        as
+0002a190: 7365 7274 206c 6f67 5f65 6e74 7279 5b22  sert log_entry["
+0002a1a0: 7472 616e 7361 6374 696f 6e49 6e64 6578  transactionIndex
+0002a1b0: 225d 203d 3d20 300a 2020 2020 2020 2020  "] == 0.        
+0002a1c0: 6173 7365 7274 206c 6f67 5f65 6e74 7279  assert log_entry
+0002a1d0: 5b22 7472 616e 7361 6374 696f 6e48 6173  ["transactionHas
+0002a1e0: 6822 5d20 3d3d 2048 6578 4279 7465 7328  h"] == HexBytes(
+0002a1f0: 7478 6e5f 6861 7368 5f77 6974 685f 6c6f  txn_hash_with_lo
+0002a200: 6729 0a0a 2020 2020 6465 6620 7465 7374  g)..    def test
+0002a210: 5f65 7468 5f77 6169 745f 666f 725f 7472  _eth_wait_for_tr
+0002a220: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+0002a230: 745f 6d69 6e65 6428 0a20 2020 2020 2020  t_mined(.       
+0002a240: 2073 656c 662c 2077 333a 2022 5765 6233   self, w3: "Web3
+0002a250: 222c 2062 6c6f 636b 5f77 6974 685f 7478  ", block_with_tx
+0002a260: 6e3a 2042 6c6f 636b 4461 7461 2c20 6d69  n: BlockData, mi
+0002a270: 6e65 645f 7478 6e5f 6861 7368 3a20 4865  ned_txn_hash: He
+0002a280: 7853 7472 0a20 2020 2029 202d 3e20 4e6f  xStr.    ) -> No
+0002a290: 6e65 3a0a 2020 2020 2020 2020 7265 6365  ne:.        rece
+0002a2a0: 6970 7420 3d20 7733 2e65 7468 2e77 6169  ipt = w3.eth.wai
+0002a2b0: 745f 666f 725f 7472 616e 7361 6374 696f  t_for_transactio
+0002a2c0: 6e5f 7265 6365 6970 7428 6d69 6e65 645f  n_receipt(mined_
+0002a2d0: 7478 6e5f 6861 7368 290a 2020 2020 2020  txn_hash).      
+0002a2e0: 2020 6173 7365 7274 2069 735f 6469 6374    assert is_dict
+0002a2f0: 2872 6563 6569 7074 290a 2020 2020 2020  (receipt).      
+0002a300: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+0002a310: 5b22 626c 6f63 6b4e 756d 6265 7222 5d20  ["blockNumber"] 
+0002a320: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+0002a330: 6e5b 226e 756d 6265 7222 5d0a 2020 2020  n["number"].    
+0002a340: 2020 2020 6173 7365 7274 2072 6563 6569      assert recei
+0002a350: 7074 5b22 626c 6f63 6b48 6173 6822 5d20  pt["blockHash"] 
+0002a360: 3d3d 2062 6c6f 636b 5f77 6974 685f 7478  == block_with_tx
+0002a370: 6e5b 2268 6173 6822 5d0a 2020 2020 2020  n["hash"].      
+0002a380: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+0002a390: 5b22 7472 616e 7361 6374 696f 6e49 6e64  ["transactionInd
+0002a3a0: 6578 225d 203d 3d20 300a 2020 2020 2020  ex"] == 0.      
+0002a3b0: 2020 6173 7365 7274 2072 6563 6569 7074    assert receipt
+0002a3c0: 5b22 7472 616e 7361 6374 696f 6e48 6173  ["transactionHas
+0002a3d0: 6822 5d20 3d3d 2048 6578 4279 7465 7328  h"] == HexBytes(
+0002a3e0: 6d69 6e65 645f 7478 6e5f 6861 7368 290a  mined_txn_hash).
+0002a3f0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0002a400: 735f 6368 6563 6b73 756d 5f61 6464 7265  s_checksum_addre
+0002a410: 7373 2872 6563 6569 7074 5b22 746f 225d  ss(receipt["to"]
+0002a420: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0002a430: 2072 6563 6569 7074 5b22 6672 6f6d 225d   receipt["from"]
+0002a440: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+0002a450: 2020 2020 2061 7373 6572 7420 6973 5f63       assert is_c
+0002a460: 6865 636b 7375 6d5f 6164 6472 6573 7328  hecksum_address(
+0002a470: 7265 6365 6970 745b 2266 726f 6d22 5d29  receipt["from"])
+0002a480: 0a0a 2020 2020 2020 2020 6566 6665 6374  ..        effect
+0002a490: 6976 655f 6761 735f 7072 6963 6520 3d20  ive_gas_price = 
+0002a4a0: 7265 6365 6970 745b 2265 6666 6563 7469  receipt["effecti
+0002a4b0: 7665 4761 7350 7269 6365 225d 0a20 2020  veGasPrice"].   
+0002a4c0: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+0002a4d0: 7374 616e 6365 2865 6666 6563 7469 7665  stance(effective
+0002a4e0: 5f67 6173 5f70 7269 6365 2c20 696e 7429  _gas_price, int)
+0002a4f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0002a500: 6566 6665 6374 6976 655f 6761 735f 7072  effective_gas_pr
+0002a510: 6963 6520 3e20 300a 0a20 2020 2064 6566  ice > 0..    def
+0002a520: 2074 6573 745f 6574 685f 7761 6974 5f66   test_eth_wait_f
+0002a530: 6f72 5f74 7261 6e73 6163 7469 6f6e 5f72  or_transaction_r
+0002a540: 6563 6569 7074 5f75 6e6d 696e 6564 280a  eceipt_unmined(.
+0002a550: 2020 2020 2020 2020 7365 6c66 2c20 7733          self, w3
+0002a560: 3a20 2257 6562 3322 2c20 6b65 7966 696c  : "Web3", keyfil
+0002a570: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0002a580: 735f 6475 616c 5f74 7970 653a 2043 6865  s_dual_type: Che
+0002a590: 636b 7375 6d41 6464 7265 7373 0a20 2020  cksumAddress.   
+0002a5a0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0002a5b0: 2020 2020 7478 6e5f 6861 7368 203d 2077      txn_hash = w
+0002a5c0: 332e 6574 682e 7365 6e64 5f74 7261 6e73  3.eth.send_trans
+0002a5d0: 6163 7469 6f6e 280a 2020 2020 2020 2020  action(.        
+0002a5e0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0002a5f0: 2020 2020 2020 2266 726f 6d22 3a20 6b65        "from": ke
+0002a600: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
+0002a610: 6472 6573 735f 6475 616c 5f74 7970 652c  dress_dual_type,
+0002a620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a630: 2022 746f 223a 206b 6579 6669 6c65 5f61   "to": keyfile_a
+0002a640: 6363 6f75 6e74 5f61 6464 7265 7373 5f64  ccount_address_d
+0002a650: 7561 6c5f 7479 7065 2c0a 2020 2020 2020  ual_type,.      
+0002a660: 2020 2020 2020 2020 2020 2276 616c 7565            "value
+0002a670: 223a 2057 6569 2831 292c 0a20 2020 2020  ": Wei(1),.     
+0002a680: 2020 2020 2020 2020 2020 2022 6761 7322             "gas"
+0002a690: 3a20 3231 3030 302c 0a20 2020 2020 2020  : 21000,.       
+0002a6a0: 2020 2020 2020 2020 2022 6d61 7846 6565           "maxFee
+0002a6b0: 5065 7247 6173 223a 2077 332e 746f 5f77  PerGas": w3.to_w
+0002a6c0: 6569 2833 2c20 2267 7765 6922 292c 0a20  ei(3, "gwei"),. 
+0002a6d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002a6e0: 6d61 7850 7269 6f72 6974 7946 6565 5065  maxPriorityFeePe
+0002a6f0: 7247 6173 223a 2077 332e 746f 5f77 6569  rGas": w3.to_wei
+0002a700: 2831 2c20 2267 7765 6922 292c 0a20 2020  (1, "gwei"),.   
+0002a710: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0002a720: 2020 2029 0a0a 2020 2020 2020 2020 7469     )..        ti
+0002a730: 6d65 6f75 7420 3d20 302e 3031 0a20 2020  meout = 0.01.   
+0002a740: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0002a750: 2e72 6169 7365 7328 5469 6d65 4578 6861  .raises(TimeExha
+0002a760: 7573 7465 6429 2061 7320 6578 635f 696e  usted) as exc_in
+0002a770: 666f 3a0a 2020 2020 2020 2020 2020 2020  fo:.            
+0002a780: 7733 2e65 7468 2e77 6169 745f 666f 725f  w3.eth.wait_for_
+0002a790: 7472 616e 7361 6374 696f 6e5f 7265 6365  transaction_rece
+0002a7a0: 6970 7428 7478 6e5f 6861 7368 2c20 7469  ipt(txn_hash, ti
+0002a7b0: 6d65 6f75 743d 7469 6d65 6f75 7429 0a0a  meout=timeout)..
+0002a7c0: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
+0002a7d0: 5f20 696e 2073 7472 2865 7863 5f69 6e66  _ in str(exc_inf
+0002a7e0: 6f29 2066 6f72 205f 2069 6e20 5b72 6570  o) for _ in [rep
+0002a7f0: 7228 7478 6e5f 6861 7368 292c 2074 696d  r(txn_hash), tim
+0002a800: 656f 7574 5d29 0a0a 2020 2020 6465 6620  eout])..    def 
+0002a810: 7465 7374 5f65 7468 5f77 6169 745f 666f  test_eth_wait_fo
+0002a820: 725f 7472 616e 7361 6374 696f 6e5f 7265  r_transaction_re
+0002a830: 6365 6970 745f 7769 7468 5f6c 6f67 5f65  ceipt_with_log_e
+0002a840: 6e74 7279 280a 2020 2020 2020 2020 7365  ntry(.        se
+0002a850: 6c66 2c0a 2020 2020 2020 2020 7733 3a20  lf,.        w3: 
+0002a860: 2257 6562 3322 2c0a 2020 2020 2020 2020  "Web3",.        
+0002a870: 626c 6f63 6b5f 7769 7468 5f74 786e 5f77  block_with_txn_w
+0002a880: 6974 685f 6c6f 673a 2042 6c6f 636b 4461  ith_log: BlockDa
+0002a890: 7461 2c0a 2020 2020 2020 2020 656d 6974  ta,.        emit
+0002a8a0: 7465 725f 636f 6e74 7261 6374 3a20 2243  ter_contract: "C
+0002a8b0: 6f6e 7472 6163 7422 2c0a 2020 2020 2020  ontract",.      
+0002a8c0: 2020 7478 6e5f 6861 7368 5f77 6974 685f    txn_hash_with_
+0002a8d0: 6c6f 673a 2048 6578 5374 722c 0a20 2020  log: HexStr,.   
+0002a8e0: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
+0002a8f0: 2020 2020 7265 6365 6970 7420 3d20 7733      receipt = w3
+0002a900: 2e65 7468 2e77 6169 745f 666f 725f 7472  .eth.wait_for_tr
+0002a910: 616e 7361 6374 696f 6e5f 7265 6365 6970  ansaction_receip
+0002a920: 7428 7478 6e5f 6861 7368 5f77 6974 685f  t(txn_hash_with_
+0002a930: 6c6f 6729 0a20 2020 2020 2020 2061 7373  log).        ass
+0002a940: 6572 7420 6973 5f64 6963 7428 7265 6365  ert is_dict(rece
+0002a950: 6970 7429 0a20 2020 2020 2020 2061 7373  ipt).        ass
+0002a960: 6572 7420 7265 6365 6970 745b 2262 6c6f  ert receipt["blo
+0002a970: 636b 4e75 6d62 6572 225d 203d 3d20 626c  ckNumber"] == bl
+0002a980: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002a990: 685f 6c6f 675b 226e 756d 6265 7222 5d0a  h_log["number"].
+0002a9a0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0002a9b0: 6563 6569 7074 5b22 626c 6f63 6b48 6173  eceipt["blockHas
+0002a9c0: 6822 5d20 3d3d 2062 6c6f 636b 5f77 6974  h"] == block_wit
+0002a9d0: 685f 7478 6e5f 7769 7468 5f6c 6f67 5b22  h_txn_with_log["
+0002a9e0: 6861 7368 225d 0a20 2020 2020 2020 2061  hash"].        a
+0002a9f0: 7373 6572 7420 7265 6365 6970 745b 2274  ssert receipt["t
+0002aa00: 7261 6e73 6163 7469 6f6e 496e 6465 7822  ransactionIndex"
+0002aa10: 5d20 3d3d 2030 0a20 2020 2020 2020 2061  ] == 0.        a
+0002aa20: 7373 6572 7420 7265 6365 6970 745b 2274  ssert receipt["t
+0002aa30: 7261 6e73 6163 7469 6f6e 4861 7368 225d  ransactionHash"]
+0002aa40: 203d 3d20 4865 7842 7974 6573 2874 786e   == HexBytes(txn
+0002aa50: 5f68 6173 685f 7769 7468 5f6c 6f67 290a  _hash_with_log).
+0002aa60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0002aa70: 6c65 6e28 7265 6365 6970 745b 226c 6f67  len(receipt["log
+0002aa80: 7322 5d29 203d 3d20 310a 2020 2020 2020  s"]) == 1.      
+0002aa90: 2020 6c6f 675f 656e 7472 7920 3d20 7265    log_entry = re
+0002aaa0: 6365 6970 745b 226c 6f67 7322 5d5b 305d  ceipt["logs"][0]
+0002aab0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+0002aac0: 206c 6f67 5f65 6e74 7279 5b22 626c 6f63   log_entry["bloc
+0002aad0: 6b4e 756d 6265 7222 5d20 3d3d 2062 6c6f  kNumber"] == blo
+0002aae0: 636b 5f77 6974 685f 7478 6e5f 7769 7468  ck_with_txn_with
+0002aaf0: 5f6c 6f67 5b22 6e75 6d62 6572 225d 0a20  _log["number"]. 
+0002ab00: 2020 2020 2020 2061 7373 6572 7420 6c6f         assert lo
+0002ab10: 675f 656e 7472 795b 2262 6c6f 636b 4861  g_entry["blockHa
+0002ab20: 7368 225d 203d 3d20 626c 6f63 6b5f 7769  sh"] == block_wi
+0002ab30: 7468 5f74 786e 5f77 6974 685f 6c6f 675b  th_txn_with_log[
+0002ab40: 2268 6173 6822 5d0a 2020 2020 2020 2020  "hash"].        
+0002ab50: 6173 7365 7274 206c 6f67 5f65 6e74 7279  assert log_entry
+0002ab60: 5b22 6c6f 6749 6e64 6578 225d 203d 3d20  ["logIndex"] == 
+0002ab70: 300a 2020 2020 2020 2020 6173 7365 7274  0.        assert
+0002ab80: 2069 735f 7361 6d65 5f61 6464 7265 7373   is_same_address
+0002ab90: 286c 6f67 5f65 6e74 7279 5b22 6164 6472  (log_entry["addr
+0002aba0: 6573 7322 5d2c 2065 6d69 7474 6572 5f63  ess"], emitter_c
+0002abb0: 6f6e 7472 6163 742e 6164 6472 6573 7329  ontract.address)
+0002abc0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0002abd0: 6c6f 675f 656e 7472 795b 2274 7261 6e73  log_entry["trans
+0002abe0: 6163 7469 6f6e 496e 6465 7822 5d20 3d3d  actionIndex"] ==
+0002abf0: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+0002ac00: 7420 6c6f 675f 656e 7472 795b 2274 7261  t log_entry["tra
+0002ac10: 6e73 6163 7469 6f6e 4861 7368 225d 203d  nsactionHash"] =
+0002ac20: 3d20 4865 7842 7974 6573 2874 786e 5f68  = HexBytes(txn_h
+0002ac30: 6173 685f 7769 7468 5f6c 6f67 290a 0a20  ash_with_log).. 
+0002ac40: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0002ac50: 6765 7455 6e63 6c65 4279 426c 6f63 6b48  getUncleByBlockH
+0002ac60: 6173 6841 6e64 496e 6465 7828 7365 6c66  ashAndIndex(self
+0002ac70: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
+0002ac80: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+0002ac90: 2054 4f44 4f3a 2068 6f77 2064 6f20 7765   TODO: how do we
+0002aca0: 206d 616b 6520 756e 636c 6573 2e2e 2e2e   make uncles....
+0002acb0: 0a20 2020 2020 2020 2070 6173 730a 0a20  .        pass.. 
+0002acc0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0002acd0: 6765 7455 6e63 6c65 4279 426c 6f63 6b4e  getUncleByBlockN
+0002ace0: 756d 6265 7241 6e64 496e 6465 7828 7365  umberAndIndex(se
+0002acf0: 6c66 2c20 7733 3a20 2257 6562 3322 2920  lf, w3: "Web3") 
+0002ad00: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0002ad10: 2023 2054 4f44 4f3a 2068 6f77 2064 6f20   # TODO: how do 
+0002ad20: 7765 206d 616b 6520 756e 636c 6573 2e2e  we make uncles..
+0002ad30: 2e2e 0a20 2020 2020 2020 2070 6173 730a  ...        pass.
+0002ad40: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
+0002ad50: 685f 6e65 775f 6669 6c74 6572 2873 656c  h_new_filter(sel
+0002ad60: 662c 2077 333a 2022 5765 6233 2229 202d  f, w3: "Web3") -
+0002ad70: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0002ad80: 6669 6c74 6572 203d 2077 332e 6574 682e  filter = w3.eth.
+0002ad90: 6669 6c74 6572 287b 7d29 0a0a 2020 2020  filter({})..    
+0002ada0: 2020 2020 6368 616e 6765 7320 3d20 7733      changes = w3
+0002adb0: 2e65 7468 2e67 6574 5f66 696c 7465 725f  .eth.get_filter_
+0002adc0: 6368 616e 6765 7328 6669 6c74 6572 2e66  changes(filter.f
+0002add0: 696c 7465 725f 6964 290a 2020 2020 2020  ilter_id).      
+0002ade0: 2020 6173 7365 7274 2069 735f 6c69 7374    assert is_list
+0002adf0: 5f6c 696b 6528 6368 616e 6765 7329 0a20  _like(changes). 
+0002ae00: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
+0002ae10: 7420 6368 616e 6765 730a 0a20 2020 2020  t changes..     
+0002ae20: 2020 206c 6f67 7320 3d20 7733 2e65 7468     logs = w3.eth
+0002ae30: 2e67 6574 5f66 696c 7465 725f 6c6f 6773  .get_filter_logs
+0002ae40: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
+0002ae50: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
+0002ae60: 7420 6973 5f6c 6973 745f 6c69 6b65 286c  t is_list_like(l
+0002ae70: 6f67 7329 0a20 2020 2020 2020 2061 7373  ogs).        ass
+0002ae80: 6572 7420 6e6f 7420 6c6f 6773 0a0a 2020  ert not logs..  
+0002ae90: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
+0002aea0: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
+0002aeb0: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
+0002aec0: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+0002aed0: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+0002aee0: 7320 5472 7565 0a0a 2020 2020 6465 6620  s True..    def 
+0002aef0: 7465 7374 5f65 7468 5f6e 6577 5f62 6c6f  test_eth_new_blo
+0002af00: 636b 5f66 696c 7465 7228 7365 6c66 2c20  ck_filter(self, 
+0002af10: 7733 3a20 2257 6562 3322 2920 2d3e 204e  w3: "Web3") -> N
+0002af20: 6f6e 653a 0a20 2020 2020 2020 2066 696c  one:.        fil
+0002af30: 7465 7220 3d20 7733 2e65 7468 2e66 696c  ter = w3.eth.fil
+0002af40: 7465 7228 226c 6174 6573 7422 290a 2020  ter("latest").  
+0002af50: 2020 2020 2020 6173 7365 7274 2069 735f        assert is_
+0002af60: 7374 7269 6e67 2866 696c 7465 722e 6669  string(filter.fi
+0002af70: 6c74 6572 5f69 6429 0a0a 2020 2020 2020  lter_id)..      
+0002af80: 2020 6368 616e 6765 7320 3d20 7733 2e65    changes = w3.e
+0002af90: 7468 2e67 6574 5f66 696c 7465 725f 6368  th.get_filter_ch
+0002afa0: 616e 6765 7328 6669 6c74 6572 2e66 696c  anges(filter.fil
+0002afb0: 7465 725f 6964 290a 2020 2020 2020 2020  ter_id).        
+0002afc0: 6173 7365 7274 2069 735f 6c69 7374 5f6c  assert is_list_l
+0002afd0: 696b 6528 6368 616e 6765 7329 0a0a 2020  ike(changes)..  
+0002afe0: 2020 2020 2020 7265 7375 6c74 203d 2077        result = w
+0002aff0: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
+0002b000: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
+0002b010: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
+0002b020: 2061 7373 6572 7420 7265 7375 6c74 2069   assert result i
+0002b030: 7320 5472 7565 0a0a 2020 2020 6465 6620  s True..    def 
+0002b040: 7465 7374 5f65 7468 5f6e 6577 5f70 656e  test_eth_new_pen
+0002b050: 6469 6e67 5f74 7261 6e73 6163 7469 6f6e  ding_transaction
+0002b060: 5f66 696c 7465 7228 7365 6c66 2c20 7733  _filter(self, w3
+0002b070: 3a20 2257 6562 3322 2920 2d3e 204e 6f6e  : "Web3") -> Non
+0002b080: 653a 0a20 2020 2020 2020 2066 696c 7465  e:.        filte
+0002b090: 7220 3d20 7733 2e65 7468 2e66 696c 7465  r = w3.eth.filte
+0002b0a0: 7228 2270 656e 6469 6e67 2229 0a20 2020  r("pending").   
+0002b0b0: 2020 2020 2061 7373 6572 7420 6973 5f73       assert is_s
+0002b0c0: 7472 696e 6728 6669 6c74 6572 2e66 696c  tring(filter.fil
+0002b0d0: 7465 725f 6964 290a 0a20 2020 2020 2020  ter_id)..       
+0002b0e0: 2063 6861 6e67 6573 203d 2077 332e 6574   changes = w3.et
+0002b0f0: 682e 6765 745f 6669 6c74 6572 5f63 6861  h.get_filter_cha
+0002b100: 6e67 6573 2866 696c 7465 722e 6669 6c74  nges(filter.filt
+0002b110: 6572 5f69 6429 0a20 2020 2020 2020 2061  er_id).        a
+0002b120: 7373 6572 7420 6973 5f6c 6973 745f 6c69  ssert is_list_li
+0002b130: 6b65 2863 6861 6e67 6573 290a 2020 2020  ke(changes).    
+0002b140: 2020 2020 6173 7365 7274 206e 6f74 2063      assert not c
+0002b150: 6861 6e67 6573 0a0a 2020 2020 2020 2020  hanges..        
+0002b160: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
+0002b170: 756e 696e 7374 616c 6c5f 6669 6c74 6572  uninstall_filter
+0002b180: 2866 696c 7465 722e 6669 6c74 6572 5f69  (filter.filter_i
+0002b190: 6429 0a20 2020 2020 2020 2061 7373 6572  d).        asser
+0002b1a0: 7420 7265 7375 6c74 2069 7320 5472 7565  t result is True
+0002b1b0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
+0002b1c0: 7468 5f67 6574 5f6c 6f67 735f 7769 7468  th_get_logs_with
+0002b1d0: 6f75 745f 6c6f 6773 280a 2020 2020 2020  out_logs(.      
+0002b1e0: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0002b1f0: 3322 2c20 626c 6f63 6b5f 7769 7468 5f74  3", block_with_t
+0002b200: 786e 5f77 6974 685f 6c6f 673a 2042 6c6f  xn_with_log: Blo
+0002b210: 636b 4461 7461 0a20 2020 2029 202d 3e20  ckData.    ) -> 
+0002b220: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
+0002b230: 5465 7374 2077 6974 6820 626c 6f63 6b20  Test with block 
+0002b240: 7261 6e67 650a 0a20 2020 2020 2020 2066  range..        f
+0002b250: 696c 7465 725f 7061 7261 6d73 3a20 4669  ilter_params: Fi
+0002b260: 6c74 6572 5061 7261 6d73 203d 207b 0a20  lterParams = {. 
+0002b270: 2020 2020 2020 2020 2020 2022 6672 6f6d             "from
+0002b280: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
+0002b290: 6265 7228 3029 2c0a 2020 2020 2020 2020  ber(0),.        
+0002b2a0: 2020 2020 2274 6f42 6c6f 636b 223a 2042      "toBlock": B
+0002b2b0: 6c6f 636b 4e75 6d62 6572 2862 6c6f 636b  lockNumber(block
+0002b2c0: 5f77 6974 685f 7478 6e5f 7769 7468 5f6c  _with_txn_with_l
+0002b2d0: 6f67 5b22 6e75 6d62 6572 225d 202d 2031  og["number"] - 1
+0002b2e0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+0002b2f0: 2020 2020 2072 6573 756c 7420 3d20 7733       result = w3
+0002b300: 2e65 7468 2e67 6574 5f6c 6f67 7328 6669  .eth.get_logs(fi
+0002b310: 6c74 6572 5f70 6172 616d 7329 0a20 2020  lter_params).   
+0002b320: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0002b330: 7265 7375 6c74 2920 3d3d 2030 0a0a 2020  result) == 0..  
+0002b340: 2020 2020 2020 2320 7468 6520 7261 6e67        # the rang
+0002b350: 6520 6973 2077 726f 6e67 0a20 2020 2020  e is wrong.     
+0002b360: 2020 2066 696c 7465 725f 7061 7261 6d73     filter_params
+0002b370: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0002b380: 2022 6672 6f6d 426c 6f63 6b22 3a20 626c   "fromBlock": bl
+0002b390: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002b3a0: 685f 6c6f 675b 226e 756d 6265 7222 5d2c  h_log["number"],
+0002b3b0: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
+0002b3c0: 426c 6f63 6b22 3a20 426c 6f63 6b4e 756d  Block": BlockNum
+0002b3d0: 6265 7228 626c 6f63 6b5f 7769 7468 5f74  ber(block_with_t
+0002b3e0: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
+0002b3f0: 6265 7222 5d20 2d20 3129 2c0a 2020 2020  ber"] - 1),.    
+0002b400: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
+0002b410: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0002b420: 2857 6562 3352 5043 4572 726f 7229 3a0a  (Web3RPCError):.
+0002b430: 2020 2020 2020 2020 2020 2020 7733 2e65              w3.e
+0002b440: 7468 2e67 6574 5f6c 6f67 7328 6669 6c74  th.get_logs(filt
+0002b450: 6572 5f70 6172 616d 7329 0a0a 2020 2020  er_params)..    
+0002b460: 2020 2020 2320 5465 7374 2077 6974 6820      # Test with 
+0002b470: 6061 6464 7265 7373 600a 0a20 2020 2020  `address`..     
+0002b480: 2020 2023 2066 696c 7465 7220 7769 7468     # filter with
+0002b490: 206f 7468 6572 2061 6464 7265 7373 0a20   other address. 
+0002b4a0: 2020 2020 2020 2066 696c 7465 725f 7061         filter_pa
+0002b4b0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0002b4c0: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
+0002b4d0: 3a20 426c 6f63 6b4e 756d 6265 7228 3029  : BlockNumber(0)
+0002b4e0: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+0002b4f0: 6464 7265 7373 223a 2055 4e4b 4e4f 574e  ddress": UNKNOWN
+0002b500: 5f41 4444 5245 5353 2c0a 2020 2020 2020  _ADDRESS,.      
+0002b510: 2020 7d0a 2020 2020 2020 2020 7265 7375    }.        resu
+0002b520: 6c74 203d 2077 332e 6574 682e 6765 745f  lt = w3.eth.get_
+0002b530: 6c6f 6773 2866 696c 7465 725f 7061 7261  logs(filter_para
+0002b540: 6d73 290a 2020 2020 2020 2020 6173 7365  ms).        asse
+0002b550: 7274 206c 656e 2872 6573 756c 7429 203d  rt len(result) =
+0002b560: 3d20 300a 0a20 2020 2020 2020 2023 2054  = 0..        # T
+0002b570: 6573 7420 7769 7468 206d 756c 7469 706c  est with multipl
+0002b580: 6520 6061 6464 7265 7373 600a 0a20 2020  e `address`..   
+0002b590: 2020 2020 2023 2066 696c 7465 7220 7769       # filter wi
+0002b5a0: 7468 206f 7468 6572 2061 6464 7265 7373  th other address
+0002b5b0: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
+0002b5c0: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+0002b5d0: 2020 2020 2020 2022 6672 6f6d 426c 6f63         "fromBloc
+0002b5e0: 6b22 3a20 426c 6f63 6b4e 756d 6265 7228  k": BlockNumber(
+0002b5f0: 3029 2c0a 2020 2020 2020 2020 2020 2020  0),.            
+0002b600: 2261 6464 7265 7373 223a 205b 554e 4b4e  "address": [UNKN
+0002b610: 4f57 4e5f 4144 4452 4553 532c 2055 4e4b  OWN_ADDRESS, UNK
+0002b620: 4e4f 574e 5f41 4444 5245 5353 5d2c 0a20  NOWN_ADDRESS],. 
+0002b630: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0002b640: 2072 6573 756c 7420 3d20 7733 2e65 7468   result = w3.eth
+0002b650: 2e67 6574 5f6c 6f67 7328 6669 6c74 6572  .get_logs(filter
+0002b660: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+0002b670: 2061 7373 6572 7420 6c65 6e28 7265 7375   assert len(resu
+0002b680: 6c74 2920 3d3d 2030 0a0a 2020 2020 6465  lt) == 0..    de
+0002b690: 6620 7465 7374 5f65 7468 5f67 6574 5f6c  f test_eth_get_l
+0002b6a0: 6f67 735f 7769 7468 5f6c 6f67 7328 0a20  ogs_with_logs(. 
+0002b6b0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0002b6c0: 2020 2020 2077 333a 2022 5765 6233 222c       w3: "Web3",
+0002b6d0: 0a20 2020 2020 2020 2062 6c6f 636b 5f77  .        block_w
+0002b6e0: 6974 685f 7478 6e5f 7769 7468 5f6c 6f67  ith_txn_with_log
+0002b6f0: 3a20 426c 6f63 6b44 6174 612c 0a20 2020  : BlockData,.   
+0002b700: 2020 2020 2065 6d69 7474 6572 5f63 6f6e       emitter_con
+0002b710: 7472 6163 745f 6164 6472 6573 733a 2043  tract_address: C
+0002b720: 6865 636b 7375 6d41 6464 7265 7373 2c0a  hecksumAddress,.
+0002b730: 2020 2020 2020 2020 7478 6e5f 6861 7368          txn_hash
+0002b740: 5f77 6974 685f 6c6f 673a 2048 6578 5374  _with_log: HexSt
+0002b750: 722c 0a20 2020 2029 202d 3e20 4e6f 6e65  r,.    ) -> None
+0002b760: 3a0a 2020 2020 2020 2020 2320 5465 7374  :.        # Test
+0002b770: 2077 6974 6820 626c 6f63 6b20 7261 6e67   with block rang
+0002b780: 650a 0a20 2020 2020 2020 2023 2074 6865  e..        # the
+0002b790: 2072 616e 6765 2069 6e63 6c75 6465 7320   range includes 
+0002b7a0: 7468 6520 626c 6f63 6b20 7768 6572 6520  the block where 
+0002b7b0: 7468 6520 6c6f 6720 7265 7369 6465 7320  the log resides 
+0002b7c0: 696e 0a20 2020 2020 2020 2066 696c 7465  in.        filte
+0002b7d0: 725f 7061 7261 6d73 3a20 4669 6c74 6572  r_params: Filter
+0002b7e0: 5061 7261 6d73 203d 207b 0a20 2020 2020  Params = {.     
+0002b7f0: 2020 2020 2020 2022 6672 6f6d 426c 6f63         "fromBloc
+0002b800: 6b22 3a20 626c 6f63 6b5f 7769 7468 5f74  k": block_with_t
+0002b810: 786e 5f77 6974 685f 6c6f 675b 226e 756d  xn_with_log["num
+0002b820: 6265 7222 5d2c 0a20 2020 2020 2020 2020  ber"],.         
+0002b830: 2020 2022 746f 426c 6f63 6b22 3a20 626c     "toBlock": bl
+0002b840: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002b850: 685f 6c6f 675b 226e 756d 6265 7222 5d2c  h_log["number"],
+0002b860: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+0002b870: 2020 2072 6573 756c 7420 3d20 7733 2e65     result = w3.e
+0002b880: 7468 2e67 6574 5f6c 6f67 7328 6669 6c74  th.get_logs(filt
+0002b890: 6572 5f70 6172 616d 7329 0a20 2020 2020  er_params).     
+0002b8a0: 2020 2061 7373 6572 745f 636f 6e74 6169     assert_contai
+0002b8b0: 6e73 5f6c 6f67 280a 2020 2020 2020 2020  ns_log(.        
+0002b8c0: 2020 2020 7265 7375 6c74 2c20 626c 6f63      result, bloc
+0002b8d0: 6b5f 7769 7468 5f74 786e 5f77 6974 685f  k_with_txn_with_
+0002b8e0: 6c6f 672c 2065 6d69 7474 6572 5f63 6f6e  log, emitter_con
+0002b8f0: 7472 6163 745f 6164 6472 6573 732c 2074  tract_address, t
+0002b900: 786e 5f68 6173 685f 7769 7468 5f6c 6f67  xn_hash_with_log
+0002b910: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002b920: 2020 2020 2320 7370 6563 6966 7920 6f6e      # specify on
+0002b930: 6c79 2060 6672 6f6d 5f62 6c6f 636b 602e  ly `from_block`.
+0002b940: 2062 7920 6465 6661 756c 7420 6074 6f5f   by default `to_
+0002b950: 626c 6f63 6b60 2073 686f 756c 6420 6265  block` should be
+0002b960: 2027 6c61 7465 7374 270a 2020 2020 2020   'latest'.      
+0002b970: 2020 6669 6c74 6572 5f70 6172 616d 7320    filter_params 
+0002b980: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0002b990: 2266 726f 6d42 6c6f 636b 223a 2042 6c6f  "fromBlock": Blo
+0002b9a0: 636b 4e75 6d62 6572 2830 292c 0a20 2020  ckNumber(0),.   
+0002b9b0: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
+0002b9c0: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
+0002b9d0: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
+0002b9e0: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
+0002b9f0: 7373 6572 745f 636f 6e74 6169 6e73 5f6c  ssert_contains_l
+0002ba00: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
+0002ba10: 7265 7375 6c74 2c20 626c 6f63 6b5f 7769  result, block_wi
+0002ba20: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
+0002ba30: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
+0002ba40: 745f 6164 6472 6573 732c 2074 786e 5f68  t_address, txn_h
+0002ba50: 6173 685f 7769 7468 5f6c 6f67 0a20 2020  ash_with_log.   
+0002ba60: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002ba70: 2320 5465 7374 2077 6974 6820 6061 6464  # Test with `add
+0002ba80: 7265 7373 600a 0a20 2020 2020 2020 2023  ress`..        #
+0002ba90: 2066 696c 7465 7220 7769 7468 2065 6d69   filter with emi
+0002baa0: 7474 6572 5f63 6f6e 7472 6163 742e 6164  tter_contract.ad
+0002bab0: 6472 6573 730a 2020 2020 2020 2020 6669  dress.        fi
+0002bac0: 6c74 6572 5f70 6172 616d 7320 3d20 7b0a  lter_params = {.
+0002bad0: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
+0002bae0: 6d42 6c6f 636b 223a 2042 6c6f 636b 4e75  mBlock": BlockNu
+0002baf0: 6d62 6572 2830 292c 0a20 2020 2020 2020  mber(0),.       
+0002bb00: 2020 2020 2022 6164 6472 6573 7322 3a20       "address": 
+0002bb10: 656d 6974 7465 725f 636f 6e74 7261 6374  emitter_contract
+0002bb20: 5f61 6464 7265 7373 2c0a 2020 2020 2020  _address,.      
+0002bb30: 2020 7d0a 0a20 2020 2064 6566 2074 6573    }..    def tes
+0002bb40: 745f 6574 685f 6765 745f 6c6f 6773 5f77  t_eth_get_logs_w
+0002bb50: 6974 685f 6c6f 6773 5f74 6f70 6963 5f61  ith_logs_topic_a
+0002bb60: 7267 7328 0a20 2020 2020 2020 2073 656c  rgs(.        sel
+0002bb70: 662c 0a20 2020 2020 2020 2077 333a 2022  f,.        w3: "
+0002bb80: 5765 6233 222c 0a20 2020 2020 2020 2062  Web3",.        b
+0002bb90: 6c6f 636b 5f77 6974 685f 7478 6e5f 7769  lock_with_txn_wi
+0002bba0: 7468 5f6c 6f67 3a20 426c 6f63 6b44 6174  th_log: BlockDat
+0002bbb0: 612c 0a20 2020 2020 2020 2065 6d69 7474  a,.        emitt
+0002bbc0: 6572 5f63 6f6e 7472 6163 745f 6164 6472  er_contract_addr
+0002bbd0: 6573 733a 2043 6865 636b 7375 6d41 6464  ess: ChecksumAdd
+0002bbe0: 7265 7373 2c0a 2020 2020 2020 2020 7478  ress,.        tx
+0002bbf0: 6e5f 6861 7368 5f77 6974 685f 6c6f 673a  n_hash_with_log:
+0002bc00: 2048 6578 5374 722c 0a20 2020 2029 202d   HexStr,.    ) -
+0002bc10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0002bc20: 2320 5465 7374 2077 6974 6820 4e6f 6e65  # Test with None
+0002bc30: 2065 7665 6e74 2073 6967 0a0a 2020 2020   event sig..    
+0002bc40: 2020 2020 6669 6c74 6572 5f70 6172 616d      filter_param
+0002bc50: 733a 2046 696c 7465 7250 6172 616d 7320  s: FilterParams 
+0002bc60: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0002bc70: 2266 726f 6d42 6c6f 636b 223a 2042 6c6f  "fromBlock": Blo
+0002bc80: 636b 4e75 6d62 6572 2830 292c 0a20 2020  ckNumber(0),.   
+0002bc90: 2020 2020 2020 2020 2022 746f 7069 6373           "topics
+0002bca0: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+0002bcb0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
+0002bcc0: 2020 2020 2020 2020 2020 2048 6578 5374             HexSt
+0002bcd0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0002bce0: 2020 2020 2020 2022 3078 3030 3030 3030         "0x000000
 0002bcf0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
 0002bd00: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
-0002bd10: 6434 3331 220a 2020 2020 2020 2020 2020  d431".          
-0002bd20: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0002bd30: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002bd40: 7d0a 0a20 2020 2020 2020 2072 6573 756c  }..        resul
-0002bd50: 7420 3d20 7733 2e65 7468 2e67 6574 5f6c  t = w3.eth.get_l
-0002bd60: 6f67 7328 6669 6c74 6572 5f70 6172 616d  ogs(filter_param
-0002bd70: 7329 0a20 2020 2020 2020 2061 7373 6572  s).        asser
-0002bd80: 745f 636f 6e74 6169 6e73 5f6c 6f67 280a  t_contains_log(.
-0002bd90: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0002bda0: 6c74 2c20 626c 6f63 6b5f 7769 7468 5f74  lt, block_with_t
-0002bdb0: 786e 5f77 6974 685f 6c6f 672c 2065 6d69  xn_with_log, emi
-0002bdc0: 7474 6572 5f63 6f6e 7472 6163 745f 6164  tter_contract_ad
-0002bdd0: 6472 6573 732c 2074 786e 5f68 6173 685f  dress, txn_hash_
-0002bde0: 7769 7468 5f6c 6f67 0a20 2020 2020 2020  with_log.       
-0002bdf0: 2029 0a0a 2020 2020 2020 2020 2320 5465   )..        # Te
-0002be00: 7374 2077 6974 6820 4e6f 6e65 2069 6e64  st with None ind
-0002be10: 6578 6564 2061 7267 0a20 2020 2020 2020  exed arg.       
-0002be20: 2066 696c 7465 725f 7061 7261 6d73 203d   filter_params =
-0002be30: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0002be40: 6672 6f6d 426c 6f63 6b22 3a20 426c 6f63  fromBlock": Bloc
-0002be50: 6b4e 756d 6265 7228 3029 2c0a 2020 2020  kNumber(0),.    
-0002be60: 2020 2020 2020 2020 2274 6f70 6963 7322          "topics"
-0002be70: 3a20 5b0a 2020 2020 2020 2020 2020 2020  : [.            
-0002be80: 2020 2020 4865 7853 7472 280a 2020 2020      HexStr(.    
-0002be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bea0: 2230 7830 3537 6263 3332 3832 3666 6265  "0x057bc32826fbe
-0002beb0: 3136 3164 6131 6331 3130 6166 6364 6361  161da1c110afcdca
-0002bec0: 6537 6331 3039 6138 6236 3931 3439 6637  e7c109a8b69149f7
-0002bed0: 3237 6663 3337 6136 3033 6336 3065 6639  27fc37a603c60ef9
-0002bee0: 3463 6122 0a20 2020 2020 2020 2020 2020  4ca".           
-0002bef0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0002bf00: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0002bf10: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0002bf20: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-0002bf30: 6573 756c 7420 3d20 7733 2e65 7468 2e67  esult = w3.eth.g
-0002bf40: 6574 5f6c 6f67 7328 6669 6c74 6572 5f70  et_logs(filter_p
-0002bf50: 6172 616d 7329 0a20 2020 2020 2020 2061  arams).        a
-0002bf60: 7373 6572 745f 636f 6e74 6169 6e73 5f6c  ssert_contains_l
-0002bf70: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
-0002bf80: 7265 7375 6c74 2c20 626c 6f63 6b5f 7769  result, block_wi
-0002bf90: 7468 5f74 786e 5f77 6974 685f 6c6f 672c  th_txn_with_log,
-0002bfa0: 2065 6d69 7474 6572 5f63 6f6e 7472 6163   emitter_contrac
-0002bfb0: 745f 6164 6472 6573 732c 2074 786e 5f68  t_address, txn_h
-0002bfc0: 6173 685f 7769 7468 5f6c 6f67 0a20 2020  ash_with_log.   
-0002bfd0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0002bfe0: 7465 7374 5f65 7468 5f67 6574 5f6c 6f67  test_eth_get_log
-0002bff0: 735f 7769 7468 5f6c 6f67 735f 6e6f 6e65  s_with_logs_none
-0002c000: 5f74 6f70 6963 5f61 7267 7328 7365 6c66  _topic_args(self
-0002c010: 2c20 7733 3a20 2257 6562 3322 2920 2d3e  , w3: "Web3") ->
-0002c020: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
-0002c030: 2054 6573 7420 7769 7468 204e 6f6e 6520   Test with None 
-0002c040: 6f76 6572 666c 6f77 696e 670a 2020 2020  overflowing.    
-0002c050: 2020 2020 6669 6c74 6572 5f70 6172 616d      filter_param
-0002c060: 733a 2046 696c 7465 7250 6172 616d 7320  s: FilterParams 
-0002c070: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0002c080: 2266 726f 6d42 6c6f 636b 223a 2042 6c6f  "fromBlock": Blo
-0002c090: 636b 4e75 6d62 6572 2830 292c 0a20 2020  ckNumber(0),.   
-0002c0a0: 2020 2020 2020 2020 2022 746f 7069 6373           "topics
-0002c0b0: 223a 205b 4e6f 6e65 2c20 4e6f 6e65 2c20  ": [None, None, 
-0002c0c0: 4e6f 6e65 5d2c 0a20 2020 2020 2020 207d  None],.        }
-0002c0d0: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-0002c0e0: 203d 2077 332e 6574 682e 6765 745f 6c6f   = w3.eth.get_lo
-0002c0f0: 6773 2866 696c 7465 725f 7061 7261 6d73  gs(filter_params
-0002c100: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0002c110: 206c 656e 2872 6573 756c 7429 203d 3d20   len(result) == 
-0002c120: 300a 0a20 2020 2064 6566 2074 6573 745f  0..    def test_
-0002c130: 6574 685f 6361 6c6c 5f6f 6c64 5f63 6f6e  eth_call_old_con
-0002c140: 7472 6163 745f 7374 6174 6528 0a20 2020  tract_state(.   
-0002c150: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002c160: 2020 2077 333a 2022 5765 6233 222c 0a20     w3: "Web3",. 
-0002c170: 2020 2020 2020 206d 6174 685f 636f 6e74         math_cont
-0002c180: 7261 6374 3a20 2243 6f6e 7472 6163 7422  ract: "Contract"
-0002c190: 2c0a 2020 2020 2020 2020 6b65 7966 696c  ,.        keyfil
-0002c1a0: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
-0002c1b0: 733a 2043 6865 636b 7375 6d41 6464 7265  s: ChecksumAddre
-0002c1c0: 7373 2c0a 2020 2020 2920 2d3e 204e 6f6e  ss,.    ) -> Non
-0002c1d0: 653a 0a20 2020 2020 2020 206c 6174 6573  e:.        lates
-0002c1e0: 745f 626c 6f63 6b20 3d20 7733 2e65 7468  t_block = w3.eth
-0002c1f0: 2e67 6574 5f62 6c6f 636b 2822 6c61 7465  .get_block("late
-0002c200: 7374 2229 0a20 2020 2020 2020 2062 6c6f  st").        blo
-0002c210: 636b 5f6e 756d 203d 206c 6174 6573 745f  ck_num = latest_
-0002c220: 626c 6f63 6b5b 226e 756d 6265 7222 5d0a  block["number"].
-0002c230: 2020 2020 2020 2020 626c 6f63 6b5f 6861          block_ha
-0002c240: 7368 203d 206c 6174 6573 745f 626c 6f63  sh = latest_bloc
-0002c250: 6b5b 2268 6173 6822 5d0a 0a20 2020 2020  k["hash"]..     
-0002c260: 2020 206c 6174 6573 745f 6361 6c6c 5f72     latest_call_r
-0002c270: 6573 756c 7420 3d20 6d61 7468 5f63 6f6e  esult = math_con
-0002c280: 7472 6163 742e 6675 6e63 7469 6f6e 732e  tract.functions.
-0002c290: 636f 756e 7465 7228 292e 6361 6c6c 280a  counter().call(.
-0002c2a0: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-0002c2b0: 6b5f 6964 656e 7469 6669 6572 3d22 6c61  k_identifier="la
-0002c2c0: 7465 7374 220a 2020 2020 2020 2020 290a  test".        ).
-0002c2d0: 2020 2020 2020 2020 626c 6f63 6b5f 6861          block_ha
-0002c2e0: 7368 5f63 616c 6c5f 7265 7375 6c74 203d  sh_call_result =
-0002c2f0: 206d 6174 685f 636f 6e74 7261 6374 2e66   math_contract.f
-0002c300: 756e 6374 696f 6e73 2e63 6f75 6e74 6572  unctions.counter
-0002c310: 2829 2e63 616c 6c28 0a20 2020 2020 2020  ().call(.       
-0002c320: 2020 2020 2062 6c6f 636b 5f69 6465 6e74       block_ident
-0002c330: 6966 6965 723d 626c 6f63 6b5f 6861 7368  ifier=block_hash
-0002c340: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0002c350: 2020 2062 6c6f 636b 5f6e 756d 5f63 616c     block_num_cal
-0002c360: 6c5f 7265 7375 6c74 203d 206d 6174 685f  l_result = math_
-0002c370: 636f 6e74 7261 6374 2e66 756e 6374 696f  contract.functio
-0002c380: 6e73 2e63 6f75 6e74 6572 2829 2e63 616c  ns.counter().cal
-0002c390: 6c28 0a20 2020 2020 2020 2020 2020 2062  l(.            b
-0002c3a0: 6c6f 636b 5f69 6465 6e74 6966 6965 723d  lock_identifier=
-0002c3b0: 626c 6f63 6b5f 6e75 6d0a 2020 2020 2020  block_num.      
-0002c3c0: 2020 290a 2020 2020 2020 2020 6465 6661    ).        defa
-0002c3d0: 756c 745f 6361 6c6c 5f72 6573 756c 7420  ult_call_result 
-0002c3e0: 3d20 6d61 7468 5f63 6f6e 7472 6163 742e  = math_contract.
-0002c3f0: 6675 6e63 7469 6f6e 732e 636f 756e 7465  functions.counte
-0002c400: 7228 292e 6361 6c6c 2829 0a0a 2020 2020  r().call()..    
-0002c410: 2020 2020 2320 7365 6e64 2061 6e64 2077      # send and w
-0002c420: 6169 7420 3120 7365 636f 6e64 2074 6f20  ait 1 second to 
-0002c430: 6d69 6e65 0a20 2020 2020 2020 206d 6174  mine.        mat
-0002c440: 685f 636f 6e74 7261 6374 2e66 756e 6374  h_contract.funct
-0002c450: 696f 6e73 2e69 6e63 7265 6d65 6e74 436f  ions.incrementCo
-0002c460: 756e 7465 7228 292e 7472 616e 7361 6374  unter().transact
-0002c470: 280a 2020 2020 2020 2020 2020 2020 7b22  (.            {"
-0002c480: 6672 6f6d 223a 206b 6579 6669 6c65 5f61  from": keyfile_a
-0002c490: 6363 6f75 6e74 5f61 6464 7265 7373 7d0a  ccount_address}.
-0002c4a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002c4b0: 2020 7469 6d65 2e73 6c65 6570 2831 290a    time.sleep(1).
-0002c4c0: 0a20 2020 2020 2020 2070 656e 6469 6e67  .        pending
-0002c4d0: 5f63 616c 6c5f 7265 7375 6c74 203d 206d  _call_result = m
-0002c4e0: 6174 685f 636f 6e74 7261 6374 2e66 756e  ath_contract.fun
-0002c4f0: 6374 696f 6e73 2e63 6f75 6e74 6572 2829  ctions.counter()
-0002c500: 2e63 616c 6c28 0a20 2020 2020 2020 2020  .call(.         
-0002c510: 2020 2062 6c6f 636b 5f69 6465 6e74 6966     block_identif
-0002c520: 6965 723d 2270 656e 6469 6e67 220a 2020  ier="pending".  
-0002c530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002c540: 6173 7365 7274 2062 6c6f 636b 5f68 6173  assert block_has
-0002c550: 685f 6361 6c6c 5f72 6573 756c 7420 3d3d  h_call_result ==
-0002c560: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
-0002c570: 7420 626c 6f63 6b5f 6e75 6d5f 6361 6c6c  t block_num_call
-0002c580: 5f72 6573 756c 7420 3d3d 2030 0a20 2020  _result == 0.   
-0002c590: 2020 2020 2061 7373 6572 7420 6c61 7465       assert late
-0002c5a0: 7374 5f63 616c 6c5f 7265 7375 6c74 203d  st_call_result =
-0002c5b0: 3d20 300a 2020 2020 2020 2020 6173 7365  = 0.        asse
-0002c5c0: 7274 2064 6566 6175 6c74 5f63 616c 6c5f  rt default_call_
-0002c5d0: 7265 7375 6c74 203d 3d20 300a 0a20 2020  result == 0..   
-0002c5e0: 2020 2020 2069 6620 7065 6e64 696e 675f       if pending_
-0002c5f0: 6361 6c6c 5f72 6573 756c 7420 213d 2031  call_result != 1
-0002c600: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002c610: 6973 6520 4173 7365 7274 696f 6e45 7272  ise AssertionErr
-0002c620: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002c630: 2020 2020 6622 7065 6e64 696e 6720 6361      f"pending ca
-0002c640: 6c6c 2072 6573 756c 7420 7761 7320 7b70  ll result was {p
-0002c650: 656e 6469 6e67 5f63 616c 6c5f 7265 7375  ending_call_resu
-0002c660: 6c74 7d20 696e 7374 6561 6420 6f66 2031  lt} instead of 1
-0002c670: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0002c680: 0a20 2020 2064 6566 2074 6573 745f 6574  .    def test_et
-0002c690: 685f 756e 696e 7374 616c 6c5f 6669 6c74  h_uninstall_filt
-0002c6a0: 6572 2873 656c 662c 2077 333a 2022 5765  er(self, w3: "We
-0002c6b0: 6233 2229 202d 3e20 4e6f 6e65 3a0a 2020  b3") -> None:.  
-0002c6c0: 2020 2020 2020 6669 6c74 6572 203d 2077        filter = w
-0002c6d0: 332e 6574 682e 6669 6c74 6572 287b 7d29  3.eth.filter({})
-0002c6e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0002c6f0: 6973 5f73 7472 696e 6728 6669 6c74 6572  is_string(filter
-0002c700: 2e66 696c 7465 725f 6964 290a 0a20 2020  .filter_id)..   
-0002c710: 2020 2020 2073 7563 6365 7373 203d 2077       success = w
-0002c720: 332e 6574 682e 756e 696e 7374 616c 6c5f  3.eth.uninstall_
-0002c730: 6669 6c74 6572 2866 696c 7465 722e 6669  filter(filter.fi
-0002c740: 6c74 6572 5f69 6429 0a20 2020 2020 2020  lter_id).       
-0002c750: 2061 7373 6572 7420 7375 6363 6573 7320   assert success 
-0002c760: 6973 2054 7275 650a 0a20 2020 2020 2020  is True..       
-0002c770: 2066 6169 6c75 7265 203d 2077 332e 6574   failure = w3.et
-0002c780: 682e 756e 696e 7374 616c 6c5f 6669 6c74  h.uninstall_filt
-0002c790: 6572 2866 696c 7465 722e 6669 6c74 6572  er(filter.filter
-0002c7a0: 5f69 6429 0a20 2020 2020 2020 2061 7373  _id).        ass
-0002c7b0: 6572 7420 6661 696c 7572 6520 6973 2046  ert failure is F
-0002c7c0: 616c 7365 0a0a 2020 2020 6465 6620 7465  alse..    def te
-0002c7d0: 7374 5f65 7468 5f67 6574 5f72 6177 5f74  st_eth_get_raw_t
-0002c7e0: 7261 6e73 6163 7469 6f6e 2873 656c 662c  ransaction(self,
-0002c7f0: 2077 333a 2022 5765 6233 222c 206d 696e   w3: "Web3", min
-0002c800: 6564 5f74 786e 5f68 6173 683a 2048 6578  ed_txn_hash: Hex
-0002c810: 5374 7229 202d 3e20 4e6f 6e65 3a0a 2020  Str) -> None:.  
-0002c820: 2020 2020 2020 7261 775f 7472 616e 7361        raw_transa
-0002c830: 6374 696f 6e20 3d20 7733 2e65 7468 2e67  ction = w3.eth.g
-0002c840: 6574 5f72 6177 5f74 7261 6e73 6163 7469  et_raw_transacti
-0002c850: 6f6e 286d 696e 6564 5f74 786e 5f68 6173  on(mined_txn_has
-0002c860: 6829 0a20 2020 2020 2020 2061 7373 6572  h).        asser
-0002c870: 7420 6973 5f62 7974 6573 2872 6177 5f74  t is_bytes(raw_t
-0002c880: 7261 6e73 6163 7469 6f6e 290a 0a20 2020  ransaction)..   
-0002c890: 2064 6566 2074 6573 745f 6574 685f 6765   def test_eth_ge
-0002c8a0: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
-0002c8b0: 6e5f 7261 6973 6573 5f65 7272 6f72 2873  n_raises_error(s
-0002c8c0: 656c 662c 2077 333a 2022 5765 6233 2229  elf, w3: "Web3")
-0002c8d0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0002c8e0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-0002c8f0: 6973 6573 280a 2020 2020 2020 2020 2020  ises(.          
-0002c900: 2020 5472 616e 7361 6374 696f 6e4e 6f74    TransactionNot
-0002c910: 466f 756e 642c 206d 6174 6368 3d66 2254  Found, match=f"T
-0002c920: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
-0002c930: 6861 7368 3a20 277b 554e 4b4e 4f57 4e5f  hash: '{UNKNOWN_
-0002c940: 4841 5348 7d27 220a 2020 2020 2020 2020  HASH}'".        
-0002c950: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-0002c960: 332e 6574 682e 6765 745f 7261 775f 7472  3.eth.get_raw_tr
-0002c970: 616e 7361 6374 696f 6e28 554e 4b4e 4f57  ansaction(UNKNOW
-0002c980: 4e5f 4841 5348 290a 0a20 2020 2064 6566  N_HASH)..    def
-0002c990: 2074 6573 745f 6574 685f 6765 745f 7261   test_eth_get_ra
-0002c9a0: 775f 7472 616e 7361 6374 696f 6e5f 6279  w_transaction_by
-0002c9b0: 5f62 6c6f 636b 280a 2020 2020 2020 2020  _block(.        
-0002c9c0: 7365 6c66 2c0a 2020 2020 2020 2020 7733  self,.        w3
-0002c9d0: 3a20 2257 6562 3322 2c0a 2020 2020 2020  : "Web3",.      
-0002c9e0: 2020 6b65 7966 696c 655f 6163 636f 756e    keyfile_accoun
-0002c9f0: 745f 6164 6472 6573 735f 6475 616c 5f74  t_address_dual_t
-0002ca00: 7970 653a 2043 6865 636b 7375 6d41 6464  ype: ChecksumAdd
-0002ca10: 7265 7373 2c0a 2020 2020 2020 2020 626c  ress,.        bl
-0002ca20: 6f63 6b5f 7769 7468 5f74 786e 3a20 426c  ock_with_txn: Bl
-0002ca30: 6f63 6b44 6174 612c 0a20 2020 2029 202d  ockData,.    ) -
-0002ca40: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0002ca50: 2320 6574 685f 6765 7452 6177 5472 616e  # eth_getRawTran
-0002ca60: 7361 6374 696f 6e42 7942 6c6f 636b 4e75  sactionByBlockNu
-0002ca70: 6d62 6572 416e 6449 6e64 6578 3a20 626c  mberAndIndex: bl
-0002ca80: 6f63 6b20 6964 656e 7469 6669 6572 0a20  ock identifier. 
-0002ca90: 2020 2020 2020 2023 2073 656e 6420 6120         # send a 
-0002caa0: 7478 6e20 746f 206d 616b 6520 7375 7265  txn to make sure
-0002cab0: 2070 656e 6469 6e67 2062 6c6f 636b 2068   pending block h
-0002cac0: 6173 2061 7420 6c65 6173 7420 6f6e 6520  as at least one 
-0002cad0: 7478 6e0a 2020 2020 2020 2020 7733 2e65  txn.        w3.e
-0002cae0: 7468 2e73 656e 645f 7472 616e 7361 6374  th.send_transact
-0002caf0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0002cb00: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0002cb10: 2020 2022 6672 6f6d 223a 206b 6579 6669     "from": keyfi
-0002cb20: 6c65 5f61 6363 6f75 6e74 5f61 6464 7265  le_account_addre
-0002cb30: 7373 5f64 7561 6c5f 7479 7065 2c0a 2020  ss_dual_type,.  
-0002cb40: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0002cb50: 6f22 3a20 6b65 7966 696c 655f 6163 636f  o": keyfile_acco
-0002cb60: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0002cb70: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0002cb80: 2020 2020 2020 2022 7661 6c75 6522 3a20         "value": 
-0002cb90: 5765 6928 3129 2c0a 2020 2020 2020 2020  Wei(1),.        
-0002cba0: 2020 2020 7d0a 2020 2020 2020 2020 290a      }.        ).
-0002cbb0: 2020 2020 2020 2020 6c61 7374 5f70 656e          last_pen
-0002cbc0: 6469 6e67 5f74 786e 5f69 6e64 6578 203d  ding_txn_index =
-0002cbd0: 206c 656e 2877 332e 6574 682e 6765 745f   len(w3.eth.get_
-0002cbe0: 626c 6f63 6b28 2270 656e 6469 6e67 2229  block("pending")
-0002cbf0: 5b22 7472 616e 7361 6374 696f 6e73 225d  ["transactions"]
-0002cc00: 2920 2d20 310a 2020 2020 2020 2020 7261  ) - 1.        ra
-0002cc10: 775f 7472 616e 7361 6374 696f 6e20 3d20  w_transaction = 
-0002cc20: 7733 2e65 7468 2e67 6574 5f72 6177 5f74  w3.eth.get_raw_t
-0002cc30: 7261 6e73 6163 7469 6f6e 5f62 795f 626c  ransaction_by_bl
-0002cc40: 6f63 6b28 0a20 2020 2020 2020 2020 2020  ock(.           
-0002cc50: 2022 7065 6e64 696e 6722 2c20 6c61 7374   "pending", last
-0002cc60: 5f70 656e 6469 6e67 5f74 786e 5f69 6e64  _pending_txn_ind
-0002cc70: 6578 0a20 2020 2020 2020 2029 0a20 2020  ex.        ).   
-0002cc80: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
-0002cc90: 7974 6573 2872 6177 5f74 7261 6e73 6163  ytes(raw_transac
-0002cca0: 7469 6f6e 290a 0a20 2020 2020 2020 2023  tion)..        #
-0002ccb0: 2065 7468 5f67 6574 5261 7754 7261 6e73   eth_getRawTrans
-0002ccc0: 6163 7469 6f6e 4279 426c 6f63 6b4e 756d  actionByBlockNum
-0002ccd0: 6265 7241 6e64 496e 6465 783a 2062 6c6f  berAndIndex: blo
-0002cce0: 636b 206e 756d 6265 720a 2020 2020 2020  ck number.      
-0002ccf0: 2020 626c 6f63 6b5f 7769 7468 5f74 786e    block_with_txn
-0002cd00: 5f6e 756d 6265 7220 3d20 626c 6f63 6b5f  _number = block_
-0002cd10: 7769 7468 5f74 786e 5b22 6e75 6d62 6572  with_txn["number
-0002cd20: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-0002cd30: 7420 6973 5f69 6e74 6567 6572 2862 6c6f  t is_integer(blo
-0002cd40: 636b 5f77 6974 685f 7478 6e5f 6e75 6d62  ck_with_txn_numb
-0002cd50: 6572 290a 2020 2020 2020 2020 7261 775f  er).        raw_
-0002cd60: 7472 616e 7361 6374 696f 6e20 3d20 7733  transaction = w3
-0002cd70: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
-0002cd80: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0002cd90: 6b28 626c 6f63 6b5f 7769 7468 5f74 786e  k(block_with_txn
-0002cda0: 5f6e 756d 6265 722c 2030 290a 2020 2020  _number, 0).    
-0002cdb0: 2020 2020 6173 7365 7274 2069 735f 6279      assert is_by
-0002cdc0: 7465 7328 7261 775f 7472 616e 7361 6374  tes(raw_transact
-0002cdd0: 696f 6e29 0a0a 2020 2020 2020 2020 2320  ion)..        # 
-0002cde0: 6574 685f 6765 7452 6177 5472 616e 7361  eth_getRawTransa
-0002cdf0: 6374 696f 6e42 7942 6c6f 636b 4861 7368  ctionByBlockHash
-0002ce00: 416e 6449 6e64 6578 3a20 626c 6f63 6b20  AndIndex: block 
-0002ce10: 6861 7368 0a20 2020 2020 2020 2062 6c6f  hash.        blo
-0002ce20: 636b 5f77 6974 685f 7478 6e5f 6861 7368  ck_with_txn_hash
-0002ce30: 203d 2062 6c6f 636b 5f77 6974 685f 7478   = block_with_tx
-0002ce40: 6e5b 2268 6173 6822 5d0a 2020 2020 2020  n["hash"].      
-0002ce50: 2020 6173 7365 7274 2069 735f 6279 7465    assert is_byte
-0002ce60: 7328 626c 6f63 6b5f 7769 7468 5f74 786e  s(block_with_txn
-0002ce70: 5f68 6173 6829 0a20 2020 2020 2020 2072  _hash).        r
-0002ce80: 6177 5f74 7261 6e73 6163 7469 6f6e 203d  aw_transaction =
-0002ce90: 2077 332e 6574 682e 6765 745f 7261 775f   w3.eth.get_raw_
-0002cea0: 7472 616e 7361 6374 696f 6e5f 6279 5f62  transaction_by_b
-0002ceb0: 6c6f 636b 2862 6c6f 636b 5f77 6974 685f  lock(block_with_
-0002cec0: 7478 6e5f 6861 7368 2c20 3029 0a20 2020  txn_hash, 0).   
-0002ced0: 2020 2020 2061 7373 6572 7420 6973 5f62       assert is_b
-0002cee0: 7974 6573 2872 6177 5f74 7261 6e73 6163  ytes(raw_transac
-0002cef0: 7469 6f6e 290a 0a20 2020 2040 7079 7465  tion)..    @pyte
-0002cf00: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-0002cf10: 697a 6528 2275 6e6b 6e6f 776e 5f62 6c6f  ize("unknown_blo
-0002cf20: 636b 5f6e 756d 5f6f 725f 6861 7368 222c  ck_num_or_hash",
-0002cf30: 2028 3132 3334 3536 3738 3939 3939 392c   (1234567899999,
-0002cf40: 2055 4e4b 4e4f 574e 5f48 4153 4829 290a   UNKNOWN_HASH)).
-0002cf50: 2020 2020 6465 6620 7465 7374 5f65 7468      def test_eth
-0002cf60: 5f67 6574 5f72 6177 5f74 7261 6e73 6163  _get_raw_transac
-0002cf70: 7469 6f6e 5f62 795f 626c 6f63 6b5f 7261  tion_by_block_ra
-0002cf80: 6973 6573 5f65 7272 6f72 280a 2020 2020  ises_error(.    
-0002cf90: 2020 2020 7365 6c66 2c20 7733 3a20 2257      self, w3: "W
-0002cfa0: 6562 3322 2c20 756e 6b6e 6f77 6e5f 626c  eb3", unknown_bl
-0002cfb0: 6f63 6b5f 6e75 6d5f 6f72 5f68 6173 683a  ock_num_or_hash:
-0002cfc0: 2055 6e69 6f6e 5b69 6e74 2c20 4865 7842   Union[int, HexB
-0002cfd0: 7974 6573 5d0a 2020 2020 2920 2d3e 204e  ytes].    ) -> N
-0002cfe0: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
-0002cff0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0002d000: 0a20 2020 2020 2020 2020 2020 2054 7261  .            Tra
-0002d010: 6e73 6163 7469 6f6e 4e6f 7446 6f75 6e64  nsactionNotFound
-0002d020: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-0002d030: 7463 683d 280a 2020 2020 2020 2020 2020  tch=(.          
-0002d040: 2020 2020 2020 6622 5472 616e 7361 6374        f"Transact
-0002d050: 696f 6e20 696e 6465 783a 2030 206f 6e20  ion index: 0 on 
-0002d060: 626c 6f63 6b20 6964 3a20 220a 2020 2020  block id: ".    
-0002d070: 2020 2020 2020 2020 2020 2020 6622 7b74              f"{t
-0002d080: 6f5f 6865 785f 6966 5f69 6e74 6567 6572  o_hex_if_integer
-0002d090: 2875 6e6b 6e6f 776e 5f62 6c6f 636b 5f6e  (unknown_block_n
-0002d0a0: 756d 5f6f 725f 6861 7368 2921 727d 206e  um_or_hash)!r} n
-0002d0b0: 6f74 2066 6f75 6e64 2e22 0a20 2020 2020  ot found.".     
-0002d0c0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0002d0d0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0002d0e0: 2077 332e 6574 682e 6765 745f 7261 775f   w3.eth.get_raw_
-0002d0f0: 7472 616e 7361 6374 696f 6e5f 6279 5f62  transaction_by_b
-0002d100: 6c6f 636b 2875 6e6b 6e6f 776e 5f62 6c6f  lock(unknown_blo
-0002d110: 636b 5f6e 756d 5f6f 725f 6861 7368 2c20  ck_num_or_hash, 
-0002d120: 3029 0a0a 2020 2020 6465 6620 7465 7374  0)..    def test
-0002d130: 5f65 7468 5f67 6574 5f72 6177 5f74 7261  _eth_get_raw_tra
-0002d140: 6e73 6163 7469 6f6e 5f62 795f 626c 6f63  nsaction_by_bloc
-0002d150: 6b5f 7261 6973 6573 5f65 7272 6f72 5f62  k_raises_error_b
-0002d160: 6c6f 636b 5f69 6465 6e74 6966 6965 7228  lock_identifier(
-0002d170: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-0002d180: 333a 2022 5765 6233 220a 2020 2020 2920  3: "Web3".    ) 
-0002d190: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0002d1a0: 2075 6e6b 6e6f 776e 5f69 6465 6e74 6966   unknown_identif
-0002d1b0: 6965 7220 3d20 2275 6e6b 6e6f 776e 220a  ier = "unknown".
-0002d1c0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-0002d1d0: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
-0002d1e0: 2020 2020 2020 2020 5765 6233 5661 6c75          Web3Valu
-0002d1f0: 6545 7272 6f72 2c0a 2020 2020 2020 2020  eError,.        
-0002d200: 2020 2020 6d61 7463 683d 280a 2020 2020      match=(.    
-0002d210: 2020 2020 2020 2020 2020 2020 2256 616c              "Val
-0002d220: 7565 2064 6964 206e 6f74 206d 6174 6368  ue did not match
-0002d230: 2061 6e79 206f 6620 7468 6520 7265 636f   any of the reco
-0002d240: 676e 697a 6564 2062 6c6f 636b 2069 6465  gnized block ide
-0002d250: 6e74 6966 6965 7273 3a20 220a 2020 2020  ntifiers: ".    
-0002d260: 2020 2020 2020 2020 2020 2020 6622 7b75              f"{u
-0002d270: 6e6b 6e6f 776e 5f69 6465 6e74 6966 6965  nknown_identifie
-0002d280: 727d 220a 2020 2020 2020 2020 2020 2020  r}".            
-0002d290: 292c 0a20 2020 2020 2020 2029 3a0a 2020  ),.        ):.  
-0002d2a0: 2020 2020 2020 2020 2020 7733 2e65 7468            w3.eth
-0002d2b0: 2e67 6574 5f72 6177 5f74 7261 6e73 6163  .get_raw_transac
-0002d2c0: 7469 6f6e 5f62 795f 626c 6f63 6b28 756e  tion_by_block(un
-0002d2d0: 6b6e 6f77 6e5f 6964 656e 7469 6669 6572  known_identifier
-0002d2e0: 2c20 3029 0a0a 2020 2020 6465 6620 7465  , 0)..    def te
-0002d2f0: 7374 5f64 6566 6175 6c74 5f61 6363 6f75  st_default_accou
-0002d300: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
-0002d310: 2c20 7733 3a20 2257 6562 3322 2c20 6b65  , w3: "Web3", ke
-0002d320: 7966 696c 655f 6163 636f 756e 745f 6164  yfile_account_ad
-0002d330: 6472 6573 735f 6475 616c 5f74 7970 653a  dress_dual_type:
-0002d340: 2043 6865 636b 7375 6d41 6464 7265 7373   ChecksumAddress
-0002d350: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0002d360: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-0002d370: 6465 6661 756c 7473 2074 6f20 656d 7074  defaults to empt
-0002d380: 790a 2020 2020 2020 2020 6465 6661 756c  y.        defaul
-0002d390: 745f 6163 636f 756e 7420 3d20 7733 2e65  t_account = w3.e
-0002d3a0: 7468 2e64 6566 6175 6c74 5f61 6363 6f75  th.default_accou
-0002d3b0: 6e74 0a20 2020 2020 2020 2061 7373 6572  nt.        asser
-0002d3c0: 7420 6465 6661 756c 745f 6163 636f 756e  t default_accoun
-0002d3d0: 7420 6973 2065 6d70 7479 0a0a 2020 2020  t is empty..    
-0002d3e0: 2020 2020 2320 6368 6563 6b20 7365 7474      # check sett
-0002d3f0: 6572 0a20 2020 2020 2020 2077 332e 6574  er.        w3.et
-0002d400: 682e 6465 6661 756c 745f 6163 636f 756e  h.default_accoun
-0002d410: 7420 3d20 6b65 7966 696c 655f 6163 636f  t = keyfile_acco
-0002d420: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
-0002d430: 5f74 7970 650a 2020 2020 2020 2020 6465  _type.        de
-0002d440: 6661 756c 745f 6163 636f 756e 7420 3d20  fault_account = 
-0002d450: 7733 2e65 7468 2e64 6566 6175 6c74 5f61  w3.eth.default_a
-0002d460: 6363 6f75 6e74 0a20 2020 2020 2020 2061  ccount.        a
-0002d470: 7373 6572 7420 6465 6661 756c 745f 6163  ssert default_ac
-0002d480: 636f 756e 7420 3d3d 206b 6579 6669 6c65  count == keyfile
-0002d490: 5f61 6363 6f75 6e74 5f61 6464 7265 7373  _account_address
-0002d4a0: 5f64 7561 6c5f 7479 7065 0a0a 2020 2020  _dual_type..    
-0002d4b0: 2020 2020 2320 7265 7365 7420 746f 2064      # reset to d
-0002d4c0: 6566 6175 6c74 0a20 2020 2020 2020 2077  efault.        w
-0002d4d0: 332e 6574 682e 6465 6661 756c 745f 6163  3.eth.default_ac
-0002d4e0: 636f 756e 7420 3d20 656d 7074 790a 0a20  count = empty.. 
-0002d4f0: 2020 2064 6566 2074 6573 745f 6465 6661     def test_defa
-0002d500: 756c 745f 626c 6f63 6b28 0a20 2020 2020  ult_block(.     
-0002d510: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0002d520: 2077 333a 2022 5765 6233 222c 0a20 2020   w3: "Web3",.   
-0002d530: 2029 202d 3e20 4e6f 6e65 3a0a 2020 2020   ) -> None:.    
-0002d540: 2020 2020 2320 6368 6563 6b20 6465 6661      # check defa
-0002d550: 756c 7473 2074 6f20 276c 6174 6573 7427  ults to 'latest'
-0002d560: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-0002d570: 5f62 6c6f 636b 203d 2077 332e 6574 682e  _block = w3.eth.
-0002d580: 6465 6661 756c 745f 626c 6f63 6b0a 2020  default_block.  
-0002d590: 2020 2020 2020 6173 7365 7274 2064 6566        assert def
-0002d5a0: 6175 6c74 5f62 6c6f 636b 203d 3d20 226c  ault_block == "l
-0002d5b0: 6174 6573 7422 0a0a 2020 2020 2020 2020  atest"..        
-0002d5c0: 2320 6368 6563 6b20 7365 7474 6572 0a20  # check setter. 
-0002d5d0: 2020 2020 2020 2077 332e 6574 682e 6465         w3.eth.de
-0002d5e0: 6661 756c 745f 626c 6f63 6b20 3d20 426c  fault_block = Bl
-0002d5f0: 6f63 6b4e 756d 6265 7228 3132 3334 3529  ockNumber(12345)
-0002d600: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-0002d610: 5f62 6c6f 636b 203d 2077 332e 6574 682e  _block = w3.eth.
-0002d620: 6465 6661 756c 745f 626c 6f63 6b0a 2020  default_block.  
-0002d630: 2020 2020 2020 6173 7365 7274 2064 6566        assert def
-0002d640: 6175 6c74 5f62 6c6f 636b 203d 3d20 426c  ault_block == Bl
-0002d650: 6f63 6b4e 756d 6265 7228 3132 3334 3529  ockNumber(12345)
-0002d660: 0a0a 2020 2020 2020 2020 2320 7265 7365  ..        # rese
-0002d670: 7420 746f 2064 6566 6175 6c74 0a20 2020  t to default.   
-0002d680: 2020 2020 2077 332e 6574 682e 6465 6661       w3.eth.defa
-0002d690: 756c 745f 626c 6f63 6b20 3d20 226c 6174  ult_block = "lat
-0002d6a0: 6573 7422 0a                             est".
+0002bd10: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
+0002bd20: 3030 3030 3030 6434 3331 220a 2020 2020  000000d431".    
+0002bd30: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0002bd40: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+0002bd50: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+0002bd60: 2072 6573 756c 7420 3d20 7733 2e65 7468   result = w3.eth
+0002bd70: 2e67 6574 5f6c 6f67 7328 6669 6c74 6572  .get_logs(filter
+0002bd80: 5f70 6172 616d 7329 0a20 2020 2020 2020  _params).       
+0002bd90: 2061 7373 6572 745f 636f 6e74 6169 6e73   assert_contains
+0002bda0: 5f6c 6f67 280a 2020 2020 2020 2020 2020  _log(.          
+0002bdb0: 2020 7265 7375 6c74 2c20 626c 6f63 6b5f    result, block_
+0002bdc0: 7769 7468 5f74 786e 5f77 6974 685f 6c6f  with_txn_with_lo
+0002bdd0: 672c 2065 6d69 7474 6572 5f63 6f6e 7472  g, emitter_contr
+0002bde0: 6163 745f 6164 6472 6573 732c 2074 786e  act_address, txn
+0002bdf0: 5f68 6173 685f 7769 7468 5f6c 6f67 0a20  _hash_with_log. 
+0002be00: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0002be10: 2020 2320 5465 7374 2077 6974 6820 4e6f    # Test with No
+0002be20: 6e65 2069 6e64 6578 6564 2061 7267 0a20  ne indexed arg. 
+0002be30: 2020 2020 2020 2066 696c 7465 725f 7061         filter_pa
+0002be40: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0002be50: 2020 2020 2022 6672 6f6d 426c 6f63 6b22       "fromBlock"
+0002be60: 3a20 426c 6f63 6b4e 756d 6265 7228 3029  : BlockNumber(0)
+0002be70: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0002be80: 6f70 6963 7322 3a20 5b0a 2020 2020 2020  opics": [.      
+0002be90: 2020 2020 2020 2020 2020 4865 7853 7472            HexStr
+0002bea0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002beb0: 2020 2020 2020 2230 7830 3537 6263 3332        "0x057bc32
+0002bec0: 3832 3666 6265 3136 3164 6131 6331 3130  826fbe161da1c110
+0002bed0: 6166 6364 6361 6537 6331 3039 6138 6236  afcdcae7c109a8b6
+0002bee0: 3931 3439 6637 3237 6663 3337 6136 3033  9149f727fc37a603
+0002bef0: 6336 3065 6639 3463 6122 0a20 2020 2020  c60ef94ca".     
+0002bf00: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0002bf10: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+0002bf20: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0002bf30: 5d2c 0a20 2020 2020 2020 207d 0a20 2020  ],.        }.   
+0002bf40: 2020 2020 2072 6573 756c 7420 3d20 7733       result = w3
+0002bf50: 2e65 7468 2e67 6574 5f6c 6f67 7328 6669  .eth.get_logs(fi
+0002bf60: 6c74 6572 5f70 6172 616d 7329 0a20 2020  lter_params).   
+0002bf70: 2020 2020 2061 7373 6572 745f 636f 6e74       assert_cont
+0002bf80: 6169 6e73 5f6c 6f67 280a 2020 2020 2020  ains_log(.      
+0002bf90: 2020 2020 2020 7265 7375 6c74 2c20 626c        result, bl
+0002bfa0: 6f63 6b5f 7769 7468 5f74 786e 5f77 6974  ock_with_txn_wit
+0002bfb0: 685f 6c6f 672c 2065 6d69 7474 6572 5f63  h_log, emitter_c
+0002bfc0: 6f6e 7472 6163 745f 6164 6472 6573 732c  ontract_address,
+0002bfd0: 2074 786e 5f68 6173 685f 7769 7468 5f6c   txn_hash_with_l
+0002bfe0: 6f67 0a20 2020 2020 2020 2029 0a0a 2020  og.        )..  
+0002bff0: 2020 6465 6620 7465 7374 5f65 7468 5f67    def test_eth_g
+0002c000: 6574 5f6c 6f67 735f 7769 7468 5f6c 6f67  et_logs_with_log
+0002c010: 735f 6e6f 6e65 5f74 6f70 6963 5f61 7267  s_none_topic_arg
+0002c020: 7328 7365 6c66 2c20 7733 3a20 2257 6562  s(self, w3: "Web
+0002c030: 3322 2920 2d3e 204e 6f6e 653a 0a20 2020  3") -> None:.   
+0002c040: 2020 2020 2023 2054 6573 7420 7769 7468       # Test with
+0002c050: 204e 6f6e 6520 6f76 6572 666c 6f77 696e   None overflowin
+0002c060: 670a 2020 2020 2020 2020 6669 6c74 6572  g.        filter
+0002c070: 5f70 6172 616d 733a 2046 696c 7465 7250  _params: FilterP
+0002c080: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0002c090: 2020 2020 2020 2266 726f 6d42 6c6f 636b        "fromBlock
+0002c0a0: 223a 2042 6c6f 636b 4e75 6d62 6572 2830  ": BlockNumber(0
+0002c0b0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0002c0c0: 746f 7069 6373 223a 205b 4e6f 6e65 2c20  topics": [None, 
+0002c0d0: 4e6f 6e65 2c20 4e6f 6e65 5d2c 0a20 2020  None, None],.   
+0002c0e0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0002c0f0: 7265 7375 6c74 203d 2077 332e 6574 682e  result = w3.eth.
+0002c100: 6765 745f 6c6f 6773 2866 696c 7465 725f  get_logs(filter_
+0002c110: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0002c120: 6173 7365 7274 206c 656e 2872 6573 756c  assert len(resul
+0002c130: 7429 203d 3d20 300a 0a20 2020 2064 6566  t) == 0..    def
+0002c140: 2074 6573 745f 6574 685f 6361 6c6c 5f6f   test_eth_call_o
+0002c150: 6c64 5f63 6f6e 7472 6163 745f 7374 6174  ld_contract_stat
+0002c160: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0002c170: 0a20 2020 2020 2020 2077 333a 2022 5765  .        w3: "We
+0002c180: 6233 222c 0a20 2020 2020 2020 206d 6174  b3",.        mat
+0002c190: 685f 636f 6e74 7261 6374 3a20 2243 6f6e  h_contract: "Con
+0002c1a0: 7472 6163 7422 2c0a 2020 2020 2020 2020  tract",.        
+0002c1b0: 6b65 7966 696c 655f 6163 636f 756e 745f  keyfile_account_
+0002c1c0: 6164 6472 6573 733a 2043 6865 636b 7375  address: Checksu
+0002c1d0: 6d41 6464 7265 7373 2c0a 2020 2020 2920  mAddress,.    ) 
+0002c1e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0002c1f0: 206c 6174 6573 745f 626c 6f63 6b20 3d20   latest_block = 
+0002c200: 7733 2e65 7468 2e67 6574 5f62 6c6f 636b  w3.eth.get_block
+0002c210: 2822 6c61 7465 7374 2229 0a20 2020 2020  ("latest").     
+0002c220: 2020 2062 6c6f 636b 5f6e 756d 203d 206c     block_num = l
+0002c230: 6174 6573 745f 626c 6f63 6b5b 226e 756d  atest_block["num
+0002c240: 6265 7222 5d0a 2020 2020 2020 2020 626c  ber"].        bl
+0002c250: 6f63 6b5f 6861 7368 203d 206c 6174 6573  ock_hash = lates
+0002c260: 745f 626c 6f63 6b5b 2268 6173 6822 5d0a  t_block["hash"].
+0002c270: 0a20 2020 2020 2020 206c 6174 6573 745f  .        latest_
+0002c280: 6361 6c6c 5f72 6573 756c 7420 3d20 6d61  call_result = ma
+0002c290: 7468 5f63 6f6e 7472 6163 742e 6675 6e63  th_contract.func
+0002c2a0: 7469 6f6e 732e 636f 756e 7465 7228 292e  tions.counter().
+0002c2b0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0002c2c0: 2020 626c 6f63 6b5f 6964 656e 7469 6669    block_identifi
+0002c2d0: 6572 3d22 6c61 7465 7374 220a 2020 2020  er="latest".    
+0002c2e0: 2020 2020 290a 2020 2020 2020 2020 626c      ).        bl
+0002c2f0: 6f63 6b5f 6861 7368 5f63 616c 6c5f 7265  ock_hash_call_re
+0002c300: 7375 6c74 203d 206d 6174 685f 636f 6e74  sult = math_cont
+0002c310: 7261 6374 2e66 756e 6374 696f 6e73 2e63  ract.functions.c
+0002c320: 6f75 6e74 6572 2829 2e63 616c 6c28 0a20  ounter().call(. 
+0002c330: 2020 2020 2020 2020 2020 2062 6c6f 636b             block
+0002c340: 5f69 6465 6e74 6966 6965 723d 626c 6f63  _identifier=bloc
+0002c350: 6b5f 6861 7368 0a20 2020 2020 2020 2029  k_hash.        )
+0002c360: 0a20 2020 2020 2020 2062 6c6f 636b 5f6e  .        block_n
+0002c370: 756d 5f63 616c 6c5f 7265 7375 6c74 203d  um_call_result =
+0002c380: 206d 6174 685f 636f 6e74 7261 6374 2e66   math_contract.f
+0002c390: 756e 6374 696f 6e73 2e63 6f75 6e74 6572  unctions.counter
+0002c3a0: 2829 2e63 616c 6c28 0a20 2020 2020 2020  ().call(.       
+0002c3b0: 2020 2020 2062 6c6f 636b 5f69 6465 6e74       block_ident
+0002c3c0: 6966 6965 723d 626c 6f63 6b5f 6e75 6d0a  ifier=block_num.
+0002c3d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002c3e0: 2020 6465 6661 756c 745f 6361 6c6c 5f72    default_call_r
+0002c3f0: 6573 756c 7420 3d20 6d61 7468 5f63 6f6e  esult = math_con
+0002c400: 7472 6163 742e 6675 6e63 7469 6f6e 732e  tract.functions.
+0002c410: 636f 756e 7465 7228 292e 6361 6c6c 2829  counter().call()
+0002c420: 0a0a 2020 2020 2020 2020 2320 7365 6e64  ..        # send
+0002c430: 2061 6e64 2077 6169 7420 3120 7365 636f   and wait 1 seco
+0002c440: 6e64 2074 6f20 6d69 6e65 0a20 2020 2020  nd to mine.     
+0002c450: 2020 206d 6174 685f 636f 6e74 7261 6374     math_contract
+0002c460: 2e66 756e 6374 696f 6e73 2e69 6e63 7265  .functions.incre
+0002c470: 6d65 6e74 436f 756e 7465 7228 292e 7472  mentCounter().tr
+0002c480: 616e 7361 6374 280a 2020 2020 2020 2020  ansact(.        
+0002c490: 2020 2020 7b22 6672 6f6d 223a 206b 6579      {"from": key
+0002c4a0: 6669 6c65 5f61 6363 6f75 6e74 5f61 6464  file_account_add
+0002c4b0: 7265 7373 7d0a 2020 2020 2020 2020 290a  ress}.        ).
+0002c4c0: 2020 2020 2020 2020 7469 6d65 2e73 6c65          time.sle
+0002c4d0: 6570 2831 290a 0a20 2020 2020 2020 2070  ep(1)..        p
+0002c4e0: 656e 6469 6e67 5f63 616c 6c5f 7265 7375  ending_call_resu
+0002c4f0: 6c74 203d 206d 6174 685f 636f 6e74 7261  lt = math_contra
+0002c500: 6374 2e66 756e 6374 696f 6e73 2e63 6f75  ct.functions.cou
+0002c510: 6e74 6572 2829 2e63 616c 6c28 0a20 2020  nter().call(.   
+0002c520: 2020 2020 2020 2020 2062 6c6f 636b 5f69           block_i
+0002c530: 6465 6e74 6966 6965 723d 2270 656e 6469  dentifier="pendi
+0002c540: 6e67 220a 2020 2020 2020 2020 290a 2020  ng".        ).  
+0002c550: 2020 2020 2020 6173 7365 7274 2062 6c6f        assert blo
+0002c560: 636b 5f68 6173 685f 6361 6c6c 5f72 6573  ck_hash_call_res
+0002c570: 756c 7420 3d3d 2030 0a20 2020 2020 2020  ult == 0.       
+0002c580: 2061 7373 6572 7420 626c 6f63 6b5f 6e75   assert block_nu
+0002c590: 6d5f 6361 6c6c 5f72 6573 756c 7420 3d3d  m_call_result ==
+0002c5a0: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+0002c5b0: 7420 6c61 7465 7374 5f63 616c 6c5f 7265  t latest_call_re
+0002c5c0: 7375 6c74 203d 3d20 300a 2020 2020 2020  sult == 0.      
+0002c5d0: 2020 6173 7365 7274 2064 6566 6175 6c74    assert default
+0002c5e0: 5f63 616c 6c5f 7265 7375 6c74 203d 3d20  _call_result == 
+0002c5f0: 300a 0a20 2020 2020 2020 2069 6620 7065  0..        if pe
+0002c600: 6e64 696e 675f 6361 6c6c 5f72 6573 756c  nding_call_resul
+0002c610: 7420 213d 2031 3a0a 2020 2020 2020 2020  t != 1:.        
+0002c620: 2020 2020 7261 6973 6520 4173 7365 7274      raise Assert
+0002c630: 696f 6e45 7272 6f72 280a 2020 2020 2020  ionError(.      
+0002c640: 2020 2020 2020 2020 2020 6622 7065 6e64            f"pend
+0002c650: 696e 6720 6361 6c6c 2072 6573 756c 7420  ing call result 
+0002c660: 7761 7320 7b70 656e 6469 6e67 5f63 616c  was {pending_cal
+0002c670: 6c5f 7265 7375 6c74 7d20 696e 7374 6561  l_result} instea
+0002c680: 6420 6f66 2031 220a 2020 2020 2020 2020  d of 1".        
+0002c690: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+0002c6a0: 6573 745f 6574 685f 756e 696e 7374 616c  est_eth_uninstal
+0002c6b0: 6c5f 6669 6c74 6572 2873 656c 662c 2077  l_filter(self, w
+0002c6c0: 333a 2022 5765 6233 2229 202d 3e20 4e6f  3: "Web3") -> No
+0002c6d0: 6e65 3a0a 2020 2020 2020 2020 6669 6c74  ne:.        filt
+0002c6e0: 6572 203d 2077 332e 6574 682e 6669 6c74  er = w3.eth.filt
+0002c6f0: 6572 287b 7d29 0a20 2020 2020 2020 2061  er({}).        a
+0002c700: 7373 6572 7420 6973 5f73 7472 696e 6728  ssert is_string(
+0002c710: 6669 6c74 6572 2e66 696c 7465 725f 6964  filter.filter_id
+0002c720: 290a 0a20 2020 2020 2020 2073 7563 6365  )..        succe
+0002c730: 7373 203d 2077 332e 6574 682e 756e 696e  ss = w3.eth.unin
+0002c740: 7374 616c 6c5f 6669 6c74 6572 2866 696c  stall_filter(fil
+0002c750: 7465 722e 6669 6c74 6572 5f69 6429 0a20  ter.filter_id). 
+0002c760: 2020 2020 2020 2061 7373 6572 7420 7375         assert su
+0002c770: 6363 6573 7320 6973 2054 7275 650a 0a20  ccess is True.. 
+0002c780: 2020 2020 2020 2066 6169 6c75 7265 203d         failure =
+0002c790: 2077 332e 6574 682e 756e 696e 7374 616c   w3.eth.uninstal
+0002c7a0: 6c5f 6669 6c74 6572 2866 696c 7465 722e  l_filter(filter.
+0002c7b0: 6669 6c74 6572 5f69 6429 0a20 2020 2020  filter_id).     
+0002c7c0: 2020 2061 7373 6572 7420 6661 696c 7572     assert failur
+0002c7d0: 6520 6973 2046 616c 7365 0a0a 2020 2020  e is False..    
+0002c7e0: 6465 6620 7465 7374 5f65 7468 5f67 6574  def test_eth_get
+0002c7f0: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0002c800: 2873 656c 662c 2077 333a 2022 5765 6233  (self, w3: "Web3
+0002c810: 222c 206d 696e 6564 5f74 786e 5f68 6173  ", mined_txn_has
+0002c820: 683a 2048 6578 5374 7229 202d 3e20 4e6f  h: HexStr) -> No
+0002c830: 6e65 3a0a 2020 2020 2020 2020 7261 775f  ne:.        raw_
+0002c840: 7472 616e 7361 6374 696f 6e20 3d20 7733  transaction = w3
+0002c850: 2e65 7468 2e67 6574 5f72 6177 5f74 7261  .eth.get_raw_tra
+0002c860: 6e73 6163 7469 6f6e 286d 696e 6564 5f74  nsaction(mined_t
+0002c870: 786e 5f68 6173 6829 0a20 2020 2020 2020  xn_hash).       
+0002c880: 2061 7373 6572 7420 6973 5f62 7974 6573   assert is_bytes
+0002c890: 2872 6177 5f74 7261 6e73 6163 7469 6f6e  (raw_transaction
+0002c8a0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0002c8b0: 6574 685f 6765 745f 7261 775f 7472 616e  eth_get_raw_tran
+0002c8c0: 7361 6374 696f 6e5f 7261 6973 6573 5f65  saction_raises_e
+0002c8d0: 7272 6f72 2873 656c 662c 2077 333a 2022  rror(self, w3: "
+0002c8e0: 5765 6233 2229 202d 3e20 4e6f 6e65 3a0a  Web3") -> None:.
+0002c8f0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+0002c900: 6573 742e 7261 6973 6573 280a 2020 2020  est.raises(.    
+0002c910: 2020 2020 2020 2020 5472 616e 7361 6374          Transact
+0002c920: 696f 6e4e 6f74 466f 756e 642c 206d 6174  ionNotFound, mat
+0002c930: 6368 3d66 2254 7261 6e73 6163 7469 6f6e  ch=f"Transaction
+0002c940: 2077 6974 6820 6861 7368 3a20 277b 554e   with hash: '{UN
+0002c950: 4b4e 4f57 4e5f 4841 5348 7d27 220a 2020  KNOWN_HASH}'".  
+0002c960: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0002c970: 2020 2020 2077 332e 6574 682e 6765 745f       w3.eth.get_
+0002c980: 7261 775f 7472 616e 7361 6374 696f 6e28  raw_transaction(
+0002c990: 554e 4b4e 4f57 4e5f 4841 5348 290a 0a20  UNKNOWN_HASH).. 
+0002c9a0: 2020 2064 6566 2074 6573 745f 6574 685f     def test_eth_
+0002c9b0: 6765 745f 7261 775f 7472 616e 7361 6374  get_raw_transact
+0002c9c0: 696f 6e5f 6279 5f62 6c6f 636b 280a 2020  ion_by_block(.  
+0002c9d0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002c9e0: 2020 2020 7733 3a20 2257 6562 3322 2c0a      w3: "Web3",.
+0002c9f0: 2020 2020 2020 2020 6b65 7966 696c 655f          keyfile_
+0002ca00: 6163 636f 756e 745f 6164 6472 6573 735f  account_address_
+0002ca10: 6475 616c 5f74 7970 653a 2043 6865 636b  dual_type: Check
+0002ca20: 7375 6d41 6464 7265 7373 2c0a 2020 2020  sumAddress,.    
+0002ca30: 2020 2020 626c 6f63 6b5f 7769 7468 5f74      block_with_t
+0002ca40: 786e 3a20 426c 6f63 6b44 6174 612c 0a20  xn: BlockData,. 
+0002ca50: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0002ca60: 2020 2020 2020 2320 6574 685f 6765 7452        # eth_getR
+0002ca70: 6177 5472 616e 7361 6374 696f 6e42 7942  awTransactionByB
+0002ca80: 6c6f 636b 4e75 6d62 6572 416e 6449 6e64  lockNumberAndInd
+0002ca90: 6578 3a20 626c 6f63 6b20 6964 656e 7469  ex: block identi
+0002caa0: 6669 6572 0a20 2020 2020 2020 2023 2073  fier.        # s
+0002cab0: 656e 6420 6120 7478 6e20 746f 206d 616b  end a txn to mak
+0002cac0: 6520 7375 7265 2070 656e 6469 6e67 2062  e sure pending b
+0002cad0: 6c6f 636b 2068 6173 2061 7420 6c65 6173  lock has at leas
+0002cae0: 7420 6f6e 6520 7478 6e0a 2020 2020 2020  t one txn.      
+0002caf0: 2020 7733 2e65 7468 2e73 656e 645f 7472    w3.eth.send_tr
+0002cb00: 616e 7361 6374 696f 6e28 0a20 2020 2020  ansaction(.     
+0002cb10: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002cb20: 2020 2020 2020 2020 2022 6672 6f6d 223a           "from":
+0002cb30: 206b 6579 6669 6c65 5f61 6363 6f75 6e74   keyfile_account
+0002cb40: 5f61 6464 7265 7373 5f64 7561 6c5f 7479  _address_dual_ty
+0002cb50: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+0002cb60: 2020 2020 2274 6f22 3a20 6b65 7966 696c      "to": keyfil
+0002cb70: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0002cb80: 735f 6475 616c 5f74 7970 652c 0a20 2020  s_dual_type,.   
+0002cb90: 2020 2020 2020 2020 2020 2020 2022 7661               "va
+0002cba0: 6c75 6522 3a20 5765 6928 3129 2c0a 2020  lue": Wei(1),.  
+0002cbb0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0002cbc0: 2020 2020 290a 2020 2020 2020 2020 6c61      ).        la
+0002cbd0: 7374 5f70 656e 6469 6e67 5f74 786e 5f69  st_pending_txn_i
+0002cbe0: 6e64 6578 203d 206c 656e 2877 332e 6574  ndex = len(w3.et
+0002cbf0: 682e 6765 745f 626c 6f63 6b28 2270 656e  h.get_block("pen
+0002cc00: 6469 6e67 2229 5b22 7472 616e 7361 6374  ding")["transact
+0002cc10: 696f 6e73 225d 2920 2d20 310a 2020 2020  ions"]) - 1.    
+0002cc20: 2020 2020 7261 775f 7472 616e 7361 6374      raw_transact
+0002cc30: 696f 6e20 3d20 7733 2e65 7468 2e67 6574  ion = w3.eth.get
+0002cc40: 5f72 6177 5f74 7261 6e73 6163 7469 6f6e  _raw_transaction
+0002cc50: 5f62 795f 626c 6f63 6b28 0a20 2020 2020  _by_block(.     
+0002cc60: 2020 2020 2020 2022 7065 6e64 696e 6722         "pending"
+0002cc70: 2c20 6c61 7374 5f70 656e 6469 6e67 5f74  , last_pending_t
+0002cc80: 786e 5f69 6e64 6578 0a20 2020 2020 2020  xn_index.       
+0002cc90: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+0002cca0: 7420 6973 5f62 7974 6573 2872 6177 5f74  t is_bytes(raw_t
+0002ccb0: 7261 6e73 6163 7469 6f6e 290a 0a20 2020  ransaction)..   
+0002ccc0: 2020 2020 2023 2065 7468 5f67 6574 5261       # eth_getRa
+0002ccd0: 7754 7261 6e73 6163 7469 6f6e 4279 426c  wTransactionByBl
+0002cce0: 6f63 6b4e 756d 6265 7241 6e64 496e 6465  ockNumberAndInde
+0002ccf0: 783a 2062 6c6f 636b 206e 756d 6265 720a  x: block number.
+0002cd00: 2020 2020 2020 2020 626c 6f63 6b5f 7769          block_wi
+0002cd10: 7468 5f74 786e 5f6e 756d 6265 7220 3d20  th_txn_number = 
+0002cd20: 626c 6f63 6b5f 7769 7468 5f74 786e 5b22  block_with_txn["
+0002cd30: 6e75 6d62 6572 225d 0a20 2020 2020 2020  number"].       
+0002cd40: 2061 7373 6572 7420 6973 5f69 6e74 6567   assert is_integ
+0002cd50: 6572 2862 6c6f 636b 5f77 6974 685f 7478  er(block_with_tx
+0002cd60: 6e5f 6e75 6d62 6572 290a 2020 2020 2020  n_number).      
+0002cd70: 2020 7261 775f 7472 616e 7361 6374 696f    raw_transactio
+0002cd80: 6e20 3d20 7733 2e65 7468 2e67 6574 5f72  n = w3.eth.get_r
+0002cd90: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
+0002cda0: 795f 626c 6f63 6b28 626c 6f63 6b5f 7769  y_block(block_wi
+0002cdb0: 7468 5f74 786e 5f6e 756d 6265 722c 2030  th_txn_number, 0
+0002cdc0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0002cdd0: 2069 735f 6279 7465 7328 7261 775f 7472   is_bytes(raw_tr
+0002cde0: 616e 7361 6374 696f 6e29 0a0a 2020 2020  ansaction)..    
+0002cdf0: 2020 2020 2320 6574 685f 6765 7452 6177      # eth_getRaw
+0002ce00: 5472 616e 7361 6374 696f 6e42 7942 6c6f  TransactionByBlo
+0002ce10: 636b 4861 7368 416e 6449 6e64 6578 3a20  ckHashAndIndex: 
+0002ce20: 626c 6f63 6b20 6861 7368 0a20 2020 2020  block hash.     
+0002ce30: 2020 2062 6c6f 636b 5f77 6974 685f 7478     block_with_tx
+0002ce40: 6e5f 6861 7368 203d 2062 6c6f 636b 5f77  n_hash = block_w
+0002ce50: 6974 685f 7478 6e5b 2268 6173 6822 5d0a  ith_txn["hash"].
+0002ce60: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0002ce70: 735f 6279 7465 7328 626c 6f63 6b5f 7769  s_bytes(block_wi
+0002ce80: 7468 5f74 786e 5f68 6173 6829 0a20 2020  th_txn_hash).   
+0002ce90: 2020 2020 2072 6177 5f74 7261 6e73 6163       raw_transac
+0002cea0: 7469 6f6e 203d 2077 332e 6574 682e 6765  tion = w3.eth.ge
+0002ceb0: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
+0002cec0: 6e5f 6279 5f62 6c6f 636b 2862 6c6f 636b  n_by_block(block
+0002ced0: 5f77 6974 685f 7478 6e5f 6861 7368 2c20  _with_txn_hash, 
+0002cee0: 3029 0a20 2020 2020 2020 2061 7373 6572  0).        asser
+0002cef0: 7420 6973 5f62 7974 6573 2872 6177 5f74  t is_bytes(raw_t
+0002cf00: 7261 6e73 6163 7469 6f6e 290a 0a20 2020  ransaction)..   
+0002cf10: 2040 7079 7465 7374 2e6d 6172 6b2e 7061   @pytest.mark.pa
+0002cf20: 7261 6d65 7472 697a 6528 2275 6e6b 6e6f  rametrize("unkno
+0002cf30: 776e 5f62 6c6f 636b 5f6e 756d 5f6f 725f  wn_block_num_or_
+0002cf40: 6861 7368 222c 2028 3132 3334 3536 3738  hash", (12345678
+0002cf50: 3939 3939 392c 2055 4e4b 4e4f 574e 5f48  99999, UNKNOWN_H
+0002cf60: 4153 4829 290a 2020 2020 6465 6620 7465  ASH)).    def te
+0002cf70: 7374 5f65 7468 5f67 6574 5f72 6177 5f74  st_eth_get_raw_t
+0002cf80: 7261 6e73 6163 7469 6f6e 5f62 795f 626c  ransaction_by_bl
+0002cf90: 6f63 6b5f 7261 6973 6573 5f65 7272 6f72  ock_raises_error
+0002cfa0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0002cfb0: 7733 3a20 2257 6562 3322 2c20 756e 6b6e  w3: "Web3", unkn
+0002cfc0: 6f77 6e5f 626c 6f63 6b5f 6e75 6d5f 6f72  own_block_num_or
+0002cfd0: 5f68 6173 683a 2055 6e69 6f6e 5b69 6e74  _hash: Union[int
+0002cfe0: 2c20 4865 7842 7974 6573 5d0a 2020 2020  , HexBytes].    
+0002cff0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0002d000: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0002d010: 6169 7365 7328 0a20 2020 2020 2020 2020  aises(.         
+0002d020: 2020 2054 7261 6e73 6163 7469 6f6e 4e6f     TransactionNo
+0002d030: 7446 6f75 6e64 2c0a 2020 2020 2020 2020  tFound,.        
+0002d040: 2020 2020 6d61 7463 683d 280a 2020 2020      match=(.    
+0002d050: 2020 2020 2020 2020 2020 2020 6622 5472              f"Tr
+0002d060: 616e 7361 6374 696f 6e20 696e 6465 783a  ansaction index:
+0002d070: 2030 206f 6e20 626c 6f63 6b20 6964 3a20   0 on block id: 
+0002d080: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002d090: 2020 6622 7b74 6f5f 6865 785f 6966 5f69    f"{to_hex_if_i
+0002d0a0: 6e74 6567 6572 2875 6e6b 6e6f 776e 5f62  nteger(unknown_b
+0002d0b0: 6c6f 636b 5f6e 756d 5f6f 725f 6861 7368  lock_num_or_hash
+0002d0c0: 2921 727d 206e 6f74 2066 6f75 6e64 2e22  )!r} not found."
+0002d0d0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+0002d0e0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0002d0f0: 2020 2020 2020 2077 332e 6574 682e 6765         w3.eth.ge
+0002d100: 745f 7261 775f 7472 616e 7361 6374 696f  t_raw_transactio
+0002d110: 6e5f 6279 5f62 6c6f 636b 2875 6e6b 6e6f  n_by_block(unkno
+0002d120: 776e 5f62 6c6f 636b 5f6e 756d 5f6f 725f  wn_block_num_or_
+0002d130: 6861 7368 2c20 3029 0a0a 2020 2020 6465  hash, 0)..    de
+0002d140: 6620 7465 7374 5f65 7468 5f67 6574 5f72  f test_eth_get_r
+0002d150: 6177 5f74 7261 6e73 6163 7469 6f6e 5f62  aw_transaction_b
+0002d160: 795f 626c 6f63 6b5f 7261 6973 6573 5f65  y_block_raises_e
+0002d170: 7272 6f72 5f62 6c6f 636b 5f69 6465 6e74  rror_block_ident
+0002d180: 6966 6965 7228 0a20 2020 2020 2020 2073  ifier(.        s
+0002d190: 656c 662c 2077 333a 2022 5765 6233 220a  elf, w3: "Web3".
+0002d1a0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+0002d1b0: 2020 2020 2020 2075 6e6b 6e6f 776e 5f69         unknown_i
+0002d1c0: 6465 6e74 6966 6965 7220 3d20 2275 6e6b  dentifier = "unk
+0002d1d0: 6e6f 776e 220a 2020 2020 2020 2020 7769  nown".        wi
+0002d1e0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0002d1f0: 280a 2020 2020 2020 2020 2020 2020 5765  (.            We
+0002d200: 6233 5661 6c75 6545 7272 6f72 2c0a 2020  b3ValueError,.  
+0002d210: 2020 2020 2020 2020 2020 6d61 7463 683d            match=
+0002d220: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002d230: 2020 2256 616c 7565 2064 6964 206e 6f74    "Value did not
+0002d240: 206d 6174 6368 2061 6e79 206f 6620 7468   match any of th
+0002d250: 6520 7265 636f 676e 697a 6564 2062 6c6f  e recognized blo
+0002d260: 636b 2069 6465 6e74 6966 6965 7273 3a20  ck identifiers: 
+0002d270: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002d280: 2020 6622 7b75 6e6b 6e6f 776e 5f69 6465    f"{unknown_ide
+0002d290: 6e74 6966 6965 727d 220a 2020 2020 2020  ntifier}".      
+0002d2a0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0002d2b0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0002d2c0: 7733 2e65 7468 2e67 6574 5f72 6177 5f74  w3.eth.get_raw_t
+0002d2d0: 7261 6e73 6163 7469 6f6e 5f62 795f 626c  ransaction_by_bl
+0002d2e0: 6f63 6b28 756e 6b6e 6f77 6e5f 6964 656e  ock(unknown_iden
+0002d2f0: 7469 6669 6572 2c20 3029 0a0a 2020 2020  tifier, 0)..    
+0002d300: 6465 6620 7465 7374 5f64 6566 6175 6c74  def test_default
+0002d310: 5f61 6363 6f75 6e74 280a 2020 2020 2020  _account(.      
+0002d320: 2020 7365 6c66 2c20 7733 3a20 2257 6562    self, w3: "Web
+0002d330: 3322 2c20 6b65 7966 696c 655f 6163 636f  3", keyfile_acco
+0002d340: 756e 745f 6164 6472 6573 735f 6475 616c  unt_address_dual
+0002d350: 5f74 7970 653a 2043 6865 636b 7375 6d41  _type: ChecksumA
+0002d360: 6464 7265 7373 0a20 2020 2029 202d 3e20  ddress.    ) -> 
+0002d370: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
+0002d380: 6368 6563 6b20 6465 6661 756c 7473 2074  check defaults t
+0002d390: 6f20 656d 7074 790a 2020 2020 2020 2020  o empty.        
+0002d3a0: 6465 6661 756c 745f 6163 636f 756e 7420  default_account 
+0002d3b0: 3d20 7733 2e65 7468 2e64 6566 6175 6c74  = w3.eth.default
+0002d3c0: 5f61 6363 6f75 6e74 0a20 2020 2020 2020  _account.       
+0002d3d0: 2061 7373 6572 7420 6465 6661 756c 745f   assert default_
+0002d3e0: 6163 636f 756e 7420 6973 2065 6d70 7479  account is empty
+0002d3f0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+0002d400: 6b20 7365 7474 6572 0a20 2020 2020 2020  k setter.       
+0002d410: 2077 332e 6574 682e 6465 6661 756c 745f   w3.eth.default_
+0002d420: 6163 636f 756e 7420 3d20 6b65 7966 696c  account = keyfil
+0002d430: 655f 6163 636f 756e 745f 6164 6472 6573  e_account_addres
+0002d440: 735f 6475 616c 5f74 7970 650a 2020 2020  s_dual_type.    
+0002d450: 2020 2020 6465 6661 756c 745f 6163 636f      default_acco
+0002d460: 756e 7420 3d20 7733 2e65 7468 2e64 6566  unt = w3.eth.def
+0002d470: 6175 6c74 5f61 6363 6f75 6e74 0a20 2020  ault_account.   
+0002d480: 2020 2020 2061 7373 6572 7420 6465 6661       assert defa
+0002d490: 756c 745f 6163 636f 756e 7420 3d3d 206b  ult_account == k
+0002d4a0: 6579 6669 6c65 5f61 6363 6f75 6e74 5f61  eyfile_account_a
+0002d4b0: 6464 7265 7373 5f64 7561 6c5f 7479 7065  ddress_dual_type
+0002d4c0: 0a0a 2020 2020 2020 2020 2320 7265 7365  ..        # rese
+0002d4d0: 7420 746f 2064 6566 6175 6c74 0a20 2020  t to default.   
+0002d4e0: 2020 2020 2077 332e 6574 682e 6465 6661       w3.eth.defa
+0002d4f0: 756c 745f 6163 636f 756e 7420 3d20 656d  ult_account = em
+0002d500: 7074 790a 0a20 2020 2064 6566 2074 6573  pty..    def tes
+0002d510: 745f 6465 6661 756c 745f 626c 6f63 6b28  t_default_block(
+0002d520: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0002d530: 2020 2020 2020 2077 333a 2022 5765 6233         w3: "Web3
+0002d540: 222c 0a20 2020 2029 202d 3e20 4e6f 6e65  ",.    ) -> None
+0002d550: 3a0a 2020 2020 2020 2020 2320 6368 6563  :.        # chec
+0002d560: 6b20 6465 6661 756c 7473 2074 6f20 276c  k defaults to 'l
+0002d570: 6174 6573 7427 0a20 2020 2020 2020 2064  atest'.        d
+0002d580: 6566 6175 6c74 5f62 6c6f 636b 203d 2077  efault_block = w
+0002d590: 332e 6574 682e 6465 6661 756c 745f 626c  3.eth.default_bl
+0002d5a0: 6f63 6b0a 2020 2020 2020 2020 6173 7365  ock.        asse
+0002d5b0: 7274 2064 6566 6175 6c74 5f62 6c6f 636b  rt default_block
+0002d5c0: 203d 3d20 226c 6174 6573 7422 0a0a 2020   == "latest"..  
+0002d5d0: 2020 2020 2020 2320 6368 6563 6b20 7365        # check se
+0002d5e0: 7474 6572 0a20 2020 2020 2020 2077 332e  tter.        w3.
+0002d5f0: 6574 682e 6465 6661 756c 745f 626c 6f63  eth.default_bloc
+0002d600: 6b20 3d20 426c 6f63 6b4e 756d 6265 7228  k = BlockNumber(
+0002d610: 3132 3334 3529 0a20 2020 2020 2020 2064  12345).        d
+0002d620: 6566 6175 6c74 5f62 6c6f 636b 203d 2077  efault_block = w
+0002d630: 332e 6574 682e 6465 6661 756c 745f 626c  3.eth.default_bl
+0002d640: 6f63 6b0a 2020 2020 2020 2020 6173 7365  ock.        asse
+0002d650: 7274 2064 6566 6175 6c74 5f62 6c6f 636b  rt default_block
+0002d660: 203d 3d20 426c 6f63 6b4e 756d 6265 7228   == BlockNumber(
+0002d670: 3132 3334 3529 0a0a 2020 2020 2020 2020  12345)..        
+0002d680: 2320 7265 7365 7420 746f 2064 6566 6175  # reset to defau
+0002d690: 6c74 0a20 2020 2020 2020 2077 332e 6574  lt.        w3.et
+0002d6a0: 682e 6465 6661 756c 745f 626c 6f63 6b20  h.default_block 
+0002d6b0: 3d20 226c 6174 6573 7422 0a              = "latest".
```

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/go_ethereum_admin_module.py` & `web3-7.0.0b6/web3/_utils/module_testing/go_ethereum_admin_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/go_ethereum_txpool_module.py` & `web3-7.0.0b6/web3/_utils/module_testing/go_ethereum_txpool_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/module_testing_utils.py` & `web3-7.0.0b6/web3/_utils/module_testing/module_testing_utils.py`

 * *Files 3% similar despite different names*

```diff
@@ -173,24 +173,37 @@
 
     def __init__(
         self, messages: Collection[bytes] = None, raise_exception: Exception = None
     ) -> None:
         self.messages = deque(messages) if messages else deque()
         self.raise_exception = raise_exception
 
+    def __await__(self) -> Generator[Any, Any, "Self"]:
+        async def __async_init__() -> "Self":
+            return self
+
+        return __async_init__().__await__()
+
     def __aiter__(self) -> "Self":
         return self
 
     async def __anext__(self) -> bytes:
         if self.raise_exception:
             raise self.raise_exception
 
         elif len(self.messages) == 0:
             raise StopAsyncIteration
 
         return self.messages.popleft()
 
+    @staticmethod
+    async def pong() -> Literal[False]:
+        return False
+
+    async def connect(self) -> None:
+        pass
+
     async def send(self, data: bytes) -> None:
         pass
 
     async def close(self) -> None:
         pass
```

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/net_module.py` & `web3-7.0.0b6/web3/_utils/module_testing/net_module.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/persistent_connection_provider.py` & `web3-7.0.0b6/web3/_utils/module_testing/persistent_connection_provider.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/module_testing/utils.py` & `web3-7.0.0b6/web3/_utils/module_testing/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/normalizers.py` & `web3-7.0.0b6/web3/_utils/normalizers.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/request.py` & `web3-7.0.0b6/web3/_utils/request.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/rpc_abi.py` & `web3-7.0.0b6/web3/_utils/rpc_abi.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/threads.py` & `web3-7.0.0b6/web3/_utils/threads.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/transactions.py` & `web3-7.0.0b6/web3/_utils/transactions.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/type_conversion.py` & `web3-7.0.0b6/web3/_utils/type_conversion.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/utility_methods.py` & `web3-7.0.0b6/web3/_utils/utility_methods.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/validation.py` & `web3-7.0.0b6/web3/_utils/validation.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/_utils/windows.py` & `web3-7.0.0b6/web3/_utils/windows.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/beacon/api_endpoints.py` & `web3-7.0.0b6/web3/beacon/api_endpoints.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/beacon/async_beacon.py` & `web3-7.0.0b6/web3/beacon/async_beacon.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/beacon/beacon.py` & `web3-7.0.0b6/web3/beacon/beacon.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/constants.py` & `web3-7.0.0b6/web3/constants.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/contract/async_contract.py` & `web3-7.0.0b6/web3/contract/async_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/contract/base_contract.py` & `web3-7.0.0b6/web3/contract/base_contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/contract/contract.py` & `web3-7.0.0b6/web3/contract/contract.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/contract/utils.py` & `web3-7.0.0b6/web3/contract/utils.py`

 * *Files 27% similar despite different names*

```diff
@@ -5,21 +5,27 @@
     Callable,
     List,
     Optional,
     Sequence,
     Tuple,
     Type,
     Union,
+    cast,
 )
 
 from eth_abi.exceptions import (
     DecodingError,
 )
 from eth_typing import (
     ChecksumAddress,
+    TypeStr,
+)
+from eth_utils.toolz import (
+    compose,
+    curry,
 )
 from hexbytes import (
     HexBytes,
 )
 
 from web3._utils.abi import (
     filter_by_type,
@@ -56,18 +62,58 @@
 )
 
 if TYPE_CHECKING:
     from web3 import (  # noqa: F401
         AsyncWeb3,
         Web3,
     )
+    from web3.providers.persistent import (  # noqa: F401
+        PersistentConnectionProvider,
+    )
 
 ACCEPTABLE_EMPTY_STRINGS = ["0x", b"0x", "", b""]
 
 
+@curry
+def format_contract_call_return_data_curried(
+    async_w3: Union["AsyncWeb3", "Web3"],
+    decode_tuples: bool,
+    fn_abi: ABIFunction,
+    function_identifier: FunctionIdentifier,
+    normalizers: Tuple[Callable[..., Any], ...],
+    output_types: Sequence[TypeStr],
+    return_data: Any,
+) -> Any:
+    """
+    Helper function for formatting contract call return data for batch requests. Curry
+    with all arguments except `return_data` and process `return_data` once it is
+    available.
+    """
+    try:
+        output_data = async_w3.codec.decode(output_types, return_data)
+    except DecodingError as e:
+        msg = (
+            f"Could not decode contract function call to {function_identifier} "
+            f"with return data: {str(return_data)}, output_types: {output_types}"
+        )
+        raise BadFunctionCallOutput(msg) from e
+
+    _normalizers = itertools.chain(
+        BASE_RETURN_NORMALIZERS,
+        normalizers,
+    )
+    normalized_data = map_abi_data(_normalizers, output_types, output_data)
+
+    if decode_tuples:
+        decoded = named_tree(fn_abi["outputs"], normalized_data)
+        normalized_data = recursive_dict_to_namedtuple(decoded)
+
+    return normalized_data[0] if len(normalized_data) == 1 else normalized_data
+
+
 def call_contract_function(
     w3: "Web3",
     address: ChecksumAddress,
     normalizers: Tuple[Callable[..., Any], ...],
     function_identifier: FunctionIdentifier,
     transaction: TxParams,
     block_id: Optional[BlockIdentifier] = None,
@@ -104,14 +150,42 @@
     if fn_abi is None:
         fn_abi = find_matching_fn_abi(
             contract_abi, w3.codec, function_identifier, args, kwargs
         )
 
     output_types = get_abi_output_types(fn_abi)
 
+    provider = w3.provider
+    if hasattr(provider, "_is_batching") and provider._is_batching:
+        # request_information == ((method, params), response_formatters)
+        request_information = tuple(return_data)
+        method_and_params = request_information[0]
+
+        # append return data formatting to result formatters
+        current_response_formatters = request_information[1]
+        current_result_formatters = current_response_formatters[0]
+        updated_result_formatters = compose(
+            # contract call return data formatter
+            format_contract_call_return_data_curried(
+                w3,
+                decode_tuples,
+                fn_abi,
+                function_identifier,
+                normalizers,
+                output_types,
+            ),
+            current_result_formatters,
+        )
+        response_formatters = (
+            updated_result_formatters,  # result formatters
+            current_response_formatters[1],  # error formatters
+            current_response_formatters[2],  # null result formatters
+        )
+        return (method_and_params, response_formatters)
+
     try:
         output_data = w3.codec.decode(output_types, return_data)
     except DecodingError as e:
         # Provide a more helpful error message than the one provided by
         # eth-abi-utils
         is_missing_code_error = (
             return_data in ACCEPTABLE_EMPTY_STRINGS
@@ -315,14 +389,51 @@
     if fn_abi is None:
         fn_abi = find_matching_fn_abi(
             contract_abi, async_w3.codec, function_identifier, args, kwargs
         )
 
     output_types = get_abi_output_types(fn_abi)
 
+    if async_w3.provider._is_batching:
+        contract_call_return_data_formatter = format_contract_call_return_data_curried(
+            async_w3,
+            decode_tuples,
+            fn_abi,
+            function_identifier,
+            normalizers,
+            output_types,
+        )
+        if async_w3.provider.has_persistent_connection:
+            # get the current request id
+            provider = cast("PersistentConnectionProvider", async_w3.provider)
+            current_request_id = provider._batch_request_counter - 1
+            provider._request_processor.append_result_formatter_for_request(
+                current_request_id, contract_call_return_data_formatter
+            )
+        else:
+            # request_information == ((method, params), response_formatters)
+            request_information = tuple(return_data)
+            method_and_params = request_information[0]
+
+            # append return data formatter to result formatters
+            current_response_formatters = request_information[1]
+            current_result_formatters = current_response_formatters[0]
+            updated_result_formatters = compose(
+                contract_call_return_data_formatter,
+                current_result_formatters,
+            )
+            response_formatters = (
+                updated_result_formatters,  # result formatters
+                current_response_formatters[1],  # error formatters
+                current_response_formatters[2],  # null result formatters
+            )
+            return (method_and_params, response_formatters)
+
+        return return_data
+
     try:
         output_data = async_w3.codec.decode(output_types, return_data)
     except DecodingError as e:
         # Provide a more helpful error message than the one provided by
         # eth-abi-utils
         is_missing_code_error = (
             return_data in ACCEPTABLE_EMPTY_STRINGS
@@ -346,18 +457,15 @@
     )
     normalized_data = map_abi_data(_normalizers, output_types, output_data)
 
     if decode_tuples:
         decoded = named_tree(fn_abi["outputs"], normalized_data)
         normalized_data = recursive_dict_to_namedtuple(decoded)
 
-    if len(normalized_data) == 1:
-        return normalized_data[0]
-    else:
-        return normalized_data
+    return normalized_data[0] if len(normalized_data) == 1 else normalized_data
 
 
 async def async_transact_with_contract_function(
     address: ChecksumAddress,
     async_w3: "AsyncWeb3",
     function_name: Optional[FunctionIdentifier] = None,
     transaction: Optional[TxParams] = None,
```

### Comparing `web3-7.0.0b5/web3/datastructures.py` & `web3-7.0.0b6/web3/datastructures.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/eth/async_eth.py` & `web3-7.0.0b6/web3/eth/async_eth.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,14 +31,17 @@
 from web3._utils.async_transactions import (
     async_get_required_transaction,
     async_replace_transaction,
 )
 from web3._utils.blocks import (
     select_method_for_block_identifier,
 )
+from web3._utils.compat import (
+    Unpack,
+)
 from web3._utils.fee_utils import (
     async_fee_history_priority_fee,
 )
 from web3._utils.filters import (
     AsyncFilter,
     select_filter_method,
 )
@@ -590,18 +593,16 @@
         current_transaction = await async_get_required_transaction(
             self.w3, transaction_hash
         )
         return await async_replace_transaction(
             self.w3, current_transaction, new_transaction
         )
 
-    # todo: Update Any to stricter kwarg checking with TxParams
-    # https://github.com/python/mypy/issues/4441
     async def modify_transaction(
-        self, transaction_hash: _Hash32, **transaction_params: Any
+        self, transaction_hash: _Hash32, **transaction_params: Unpack[TxParams]
     ) -> HexBytes:
         assert_valid_transaction_params(cast(TxParams, transaction_params))
 
         current_transaction = await async_get_required_transaction(
             self.w3, transaction_hash
         )
         current_transaction_params = extract_valid_transaction_params(
@@ -761,15 +762,15 @@
 
         return await self._unsubscribe(subscription_id)
 
     # -- contract methods -- #
 
     @overload
     # mypy error: Overloaded function signatures 1 and 2 overlap with incompatible return types  # noqa: E501
-    def contract(self, address: None = None, **kwargs: Any) -> Type[AsyncContract]:  # type: ignore[misc]  # noqa: E501
+    def contract(self, address: None = None, **kwargs: Any) -> Type[AsyncContract]:  # type: ignore[overload-overlap]  # noqa: E501
         ...
 
     @overload
     def contract(
         self, address: Union[Address, ChecksumAddress, ENS], **kwargs: Any
     ) -> AsyncContract:
         ...
```

### Comparing `web3-7.0.0b5/web3/eth/base_eth.py` & `web3-7.0.0b6/web3/eth/base_eth.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/eth/eth.py` & `web3-7.0.0b6/web3/eth/eth.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,14 +26,17 @@
 from hexbytes import (
     HexBytes,
 )
 
 from web3._utils.blocks import (
     select_method_for_block_identifier,
 )
+from web3._utils.compat import (
+    Unpack,
+)
 from web3._utils.fee_utils import (
     fee_history_priority_fee,
 )
 from web3._utils.filters import (
     Filter,
     select_filter_method,
 )
@@ -592,18 +595,16 @@
 
     def replace_transaction(
         self, transaction_hash: _Hash32, new_transaction: TxParams
     ) -> HexBytes:
         current_transaction = get_required_transaction(self.w3, transaction_hash)
         return replace_transaction(self.w3, current_transaction, new_transaction)
 
-    # todo: Update Any to stricter kwarg checking with TxParams
-    # https://github.com/python/mypy/issues/4441
     def modify_transaction(
-        self, transaction_hash: _Hash32, **transaction_params: Any
+        self, transaction_hash: _Hash32, **transaction_params: Unpack[TxParams]
     ) -> HexBytes:
         assert_valid_transaction_params(cast(TxParams, transaction_params))
         current_transaction = get_required_transaction(self.w3, transaction_hash)
         current_transaction_params = extract_valid_transaction_params(
             current_transaction
         )
         new_transaction = merge(current_transaction_params, transaction_params)
@@ -676,15 +677,15 @@
     submit_work: Method[Callable[[int, _Hash32, _Hash32], bool]] = Method(
         RPC.eth_submitWork,
         mungers=[default_root_munger],
     )
 
     @overload
     # type error: Overloaded function signatures 1 and 2 overlap with incompatible return types  # noqa: E501
-    def contract(self, address: None = None, **kwargs: Any) -> Type[Contract]:  # type: ignore[misc]  # noqa: E501
+    def contract(self, address: None = None, **kwargs: Any) -> Type[Contract]:  # type: ignore[overload-overlap]  # noqa: E501
         ...
 
     @overload
     def contract(
         self, address: Union[Address, ChecksumAddress, ENS], **kwargs: Any
     ) -> Contract:
         ...
```

### Comparing `web3-7.0.0b5/web3/exceptions.py` & `web3-7.0.0b6/web3/exceptions.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 import datetime
 import time
 from typing import (
+    TYPE_CHECKING,
     Any,
     Dict,
     Optional,
     Union,
 )
 
 from eth_utils import (
@@ -12,14 +13,17 @@
 )
 
 from web3.types import (
     BlockData,
     RPCResponse,
 )
 
+if TYPE_CHECKING:
+    import asyncio
+
 
 class Web3Exception(Exception):
     """
     Exception mixin inherited by all exceptions of web3.py
 
     This allows::
 
@@ -303,14 +307,30 @@
 
 class BadResponseFormat(Web3Exception):
     """
     Raised when a JSON-RPC response comes back in an unexpected format
     """
 
 
+class TaskNotRunning(Web3Exception):
+    """
+    Used to signal between asyncio contexts that a task that is being awaited
+    is not currently running.
+    """
+
+    def __init__(
+        self, task: "asyncio.Task[Any]", message: Optional[str] = None
+    ) -> None:
+        self.task = task
+        if message is None:
+            message = f"Task {task} is not running."
+        self.message = message
+        super().__init__(message)
+
+
 class Web3RPCError(Web3Exception):
     """
     Raised when a JSON-RPC response contains an error field.
     """
 
     def __init__(
         self,
```

### Comparing `web3-7.0.0b5/web3/gas_strategies/time_based.py` & `web3-7.0.0b6/web3/gas_strategies/time_based.py`

 * *Files 2% similar despite different names*

```diff
@@ -106,19 +106,19 @@
 
     for miner, miner_data in data_by_miner.items():
         _, block_hashes, gas_prices = map(set, zip(*miner_data))
         try:
             # types ignored b/c mypy has trouble inferring gas_prices: Sequence[Wei]
             price_percentile = percentile(gas_prices, percentile=20)  # type: ignore
         except InsufficientData:
-            price_percentile = min(gas_prices)  # type: ignore
+            price_percentile = min(gas_prices)
         yield MinerData(
             miner,
             len(set(block_hashes)),
-            min(gas_prices),  # type: ignore
+            min(gas_prices),
             price_percentile,
         )
 
 
 @to_tuple
 def _compute_probabilities(
     miner_data: Iterable[MinerData], wait_blocks: int, sample_size: int
```

### Comparing `web3-7.0.0b5/web3/geth.py` & `web3-7.0.0b6/web3/geth.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/main.py` & `web3-7.0.0b6/web3/main.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,14 +30,15 @@
 from hexbytes import (
     HexBytes,
 )
 from typing import (
     TYPE_CHECKING,
     Any,
     AsyncIterator,
+    Callable,
     Dict,
     Generator,
     List,
     Optional,
     Sequence,
     Type,
     Union,
@@ -96,14 +97,17 @@
     GethAdmin,
     GethTxPool,
 )
 from web3.manager import (
     RequestManager as DefaultRequestManager,
 )
 from web3.middleware.base import MiddlewareOnion
+from web3.method import (
+    Method,
+)
 from web3.module import (
     Module,
 )
 from web3.net import (
     AsyncNet,
     Net,
 )
@@ -139,15 +143,17 @@
     Tracing,
 )
 from web3.types import (
     Wei,
 )
 
 if TYPE_CHECKING:
+    from web3._utils.batching import RequestBatcher  # noqa: F401
     from web3._utils.empty import Empty  # noqa: F401
+    from web3.providers.persistent import PersistentConnectionProvider  # noqa: F401
 
 
 def get_async_default_modules() -> Dict[str, Union[Type[Module], Sequence[Any]]]:
     return {
         "eth": AsyncEth,
         "net": AsyncNet,
         "geth": (
@@ -332,14 +338,21 @@
         Attach modules to the `Web3` instance.
         """
         _attach_modules(self, modules)
 
     def is_encodable(self, _type: TypeStr, value: Any) -> bool:
         return self.codec.is_encodable(_type, value)
 
+    # -- APIs for high-level requests -- #
+
+    def batch_requests(
+        self,
+    ) -> "RequestBatcher[Method[Callable[..., Any]]]":
+        return self.manager._batch_requests()
+
 
 class Web3(BaseWeb3):
     # mypy types
     eth: Eth
     net: Net
     geth: Geth
 
@@ -464,15 +477,15 @@
 
     @ens.setter
     def ens(self, new_ens: Union[AsyncENS, "Empty"]) -> None:
         if new_ens:
             new_ens.w3 = self  # set self object reference for ``AsyncENS.w3``
         self._ens = new_ens
 
-        # -- persistent connection methods -- #
+    # -- persistent connection methods -- #
 
     @property
     @persistent_connection_provider_method()
     def socket(self) -> PersistentConnection:
         return PersistentConnection(self)
 
     # w3 = await AsyncWeb3(PersistentConnectionProvider(...))
@@ -507,16 +520,15 @@
 
     # async for w3 in AsyncWeb3(PersistentConnectionProvider(...)):
     @persistent_connection_provider_method(
         message="Provider must inherit from ``PersistentConnectionProvider`` class "
         "when instantiating via ``async for``."
     )
     async def __aiter__(self) -> AsyncIterator[Self]:
-        if not await self.provider.is_connected():
-            await self.provider.connect()
-
+        provider = self.provider
         while True:
-            try:
-                yield self
-            except Exception:
-                # provider should handle connection / reconnection
-                continue
+            await provider.connect()
+            yield self
+            cast("PersistentConnectionProvider", provider).logger.error(
+                "Connection interrupted, attempting to reconnect..."
+            )
+            await provider.disconnect()
```

### Comparing `web3-7.0.0b5/web3/manager.py` & `web3-7.0.0b6/web3/manager.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,13 +1,15 @@
+import asyncio
 import logging
 from typing import (
     TYPE_CHECKING,
     Any,
     AsyncGenerator,
     Callable,
+    Coroutine,
     List,
     Optional,
     Sequence,
     Tuple,
     Union,
     cast,
 )
@@ -18,30 +20,37 @@
 from hexbytes import (
     HexBytes,
 )
 from websockets.exceptions import (
     ConnectionClosedOK,
 )
 
+from web3._utils.batching import (
+    RequestBatcher,
+)
 from web3._utils.caching import (
     generate_cache_key,
 )
 from web3._utils.compat import (
     Self,
 )
 from web3.datastructures import (
     NamedElementOnion,
 )
 from web3.exceptions import (
     BadResponseFormat,
     MethodUnavailable,
     ProviderConnectionError,
+    TaskNotRunning,
     Web3RPCError,
     Web3TypeError,
 )
+from web3.method import (
+    Method,
+)
 from web3.middleware import (
     AttributeDictMiddleware,
     BufferedGasEstimateMiddleware,
     ENSNameToAddressMiddleware,
     GasPriceStrategyMiddleware,
     ValidationMiddleware,
 )
@@ -50,16 +59,20 @@
     MiddlewareOnion,
 )
 from web3.module import (
     apply_result_formatters,
 )
 from web3.providers import (
     AutoProvider,
+    JSONBaseProvider,
     PersistentConnectionProvider,
 )
+from web3.providers.async_base import (
+    AsyncJSONBaseProvider,
+)
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
 if TYPE_CHECKING:
     from web3.main import (  # noqa: F401
@@ -371,14 +384,96 @@
         Coroutine for making a request using the provider
         """
         response = await self._coro_make_request(method, params)
         return self.formatted_response(
             response, params, error_formatters, null_result_formatters
         )
 
+    # -- batch requests management -- #
+
+    def _batch_requests(self) -> RequestBatcher[Method[Callable[..., Any]]]:
+        """
+        Context manager for making batch requests
+        """
+        if not isinstance(self.provider, (AsyncJSONBaseProvider, JSONBaseProvider)):
+            raise Web3TypeError("Batch requests are not supported by this provider.")
+        return RequestBatcher(self.w3)
+
+    def _make_batch_request(
+        self, requests_info: List[Tuple[Tuple["RPCEndpoint", Any], Sequence[Any]]]
+    ) -> List[RPCResponse]:
+        """
+        Make a batch request using the provider
+        """
+        provider = cast(JSONBaseProvider, self.provider)
+        request_func = provider.batch_request_func(
+            cast("Web3", self.w3), cast("MiddlewareOnion", self.middleware_onion)
+        )
+        responses = request_func(
+            [
+                (method, params)
+                for (method, params), _response_formatters in requests_info
+            ]
+        )
+        formatted_responses = [
+            self._format_batched_response(info, resp)
+            for info, resp in zip(requests_info, responses)
+        ]
+        return list(formatted_responses)
+
+    async def _async_make_batch_request(
+        self,
+        requests_info: List[
+            Coroutine[Any, Any, Tuple[Tuple["RPCEndpoint", Any], Sequence[Any]]]
+        ],
+    ) -> List[RPCResponse]:
+        """
+        Make an asynchronous batch request using the provider
+        """
+        provider = cast(AsyncJSONBaseProvider, self.provider)
+        request_func = await provider.batch_request_func(
+            cast("AsyncWeb3", self.w3),
+            cast("MiddlewareOnion", self.middleware_onion),
+        )
+        # since we add items to the batch without awaiting, we unpack the coroutines
+        # and await them all here
+        unpacked_requests_info = await asyncio.gather(*requests_info)
+        responses = await request_func(
+            [
+                (method, params)
+                for (method, params), _response_formatters in unpacked_requests_info
+            ]
+        )
+
+        if isinstance(self.provider, PersistentConnectionProvider):
+            # call _process_response for each response in the batch
+            return [await self._process_response(resp) for resp in responses]
+
+        formatted_responses = [
+            self._format_batched_response(info, resp)
+            for info, resp in zip(unpacked_requests_info, responses)
+        ]
+        return list(formatted_responses)
+
+    def _format_batched_response(
+        self,
+        requests_info: Tuple[Tuple[RPCEndpoint, Any], Sequence[Any]],
+        response: RPCResponse,
+    ) -> RPCResponse:
+        result_formatters, error_formatters, null_result_formatters = requests_info[1]
+        return apply_result_formatters(
+            result_formatters,
+            self.formatted_response(
+                response,
+                requests_info[0][1],
+                error_formatters,
+                null_result_formatters,
+            ),
+        )
+
     # -- persistent connection -- #
 
     async def send(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         provider = cast(PersistentConnectionProvider, self._provider)
         request_func = await provider.request_func(
             cast("AsyncWeb3", self.w3), cast("MiddlewareOnion", self.middleware_onion)
         )
@@ -404,22 +499,32 @@
 
         if self._provider._message_listener_task is None:
             raise ProviderConnectionError(
                 "No listener found for persistent connection."
             )
 
         while True:
-            response = await self._request_processor.pop_raw_response(subscription=True)
-            if (
-                response is not None
-                and response.get("params", {}).get("subscription")
-                in self._request_processor.active_subscriptions
-            ):
-                # if response is an active subscription response, process it
-                yield await self._process_response(response)
+            try:
+                response = await self._request_processor.pop_raw_response(
+                    subscription=True
+                )
+                if (
+                    response is not None
+                    and response.get("params", {}).get("subscription")
+                    in self._request_processor.active_subscriptions
+                ):
+                    # if response is an active subscription response, process it
+                    yield await self._process_response(response)
+            except TaskNotRunning:
+                self._provider._handle_listener_task_exceptions()
+                self.logger.error(
+                    "Message listener background task has stopped unexpectedly. "
+                    "Stopping message stream."
+                )
+                raise StopAsyncIteration
 
     async def _process_response(self, response: RPCResponse) -> RPCResponse:
         provider = cast(PersistentConnectionProvider, self._provider)
         request_info = self._request_processor.get_request_information_for_response(
             response
         )
```

### Comparing `web3-7.0.0b5/web3/method.py` & `web3-7.0.0b6/web3/method.py`

 * *Files 8% similar despite different names*

```diff
@@ -6,47 +6,54 @@
     Dict,
     Generic,
     List,
     Optional,
     Sequence,
     Tuple,
     Type,
-    TypeVar,
     Union,
 )
 import warnings
 
 from eth_utils.curried import (
     to_tuple,
 )
 from eth_utils.toolz import (
     pipe,
 )
 
+from web3._utils.batching import (
+    RPC_METHODS_UNSUPPORTED_DURING_BATCH,
+)
 from web3._utils.method_formatters import (
     get_error_formatters,
     get_null_result_formatters,
     get_request_formatters,
     get_result_formatters,
 )
 from web3._utils.rpc_abi import (
     RPC,
 )
 from web3.exceptions import (
+    MethodNotSupported,
     Web3TypeError,
     Web3ValidationError,
     Web3ValueError,
 )
 from web3.types import (
     RPCEndpoint,
+    TFunc,
     TReturn,
 )
 
 if TYPE_CHECKING:
-    from web3 import Web3  # noqa: F401
+    from web3 import (  # noqa: F401
+        PersistentConnectionProvider,
+        Web3,
+    )
     from web3.module import Module  # noqa: F401
 
 
 Munger = Callable[..., Any]
 
 
 @to_tuple
@@ -80,17 +87,14 @@
     return ()
 
 
 def default_root_munger(_module: "Module", *args: Any) -> List[Any]:
     return [*args]
 
 
-TFunc = TypeVar("TFunc", bound=Callable[..., Any])
-
-
 class Method(Generic[TFunc]):
     """
     Method object for web3 module methods
 
     Calls to the Method go through these steps:
 
     1. input munging - includes normalization, parameter checking, early parameter
@@ -145,23 +149,39 @@
         self.null_result_formatters = (
             null_result_formatters or get_null_result_formatters
         )
         self.method_choice_depends_on_args = method_choice_depends_on_args
         self.is_property = is_property
 
     def __get__(
-        self, obj: Optional["Module"] = None, obj_type: Optional[Type["Module"]] = None
+        self,
+        module: Optional["Module"] = None,
+        _type: Optional[Type["Module"]] = None,
     ) -> TFunc:
-        if obj is None:
+        self._module = module
+        if module is None:
             raise Web3TypeError(
                 "Direct calls to methods are not supported. "
-                "Methods must be called from an module instance, "
+                "Methods must be called from a module instance, "
                 "usually attached to a web3 instance."
             )
-        return obj.retrieve_caller_fn(self)
+
+        provider = module.w3.provider
+        if hasattr(provider, "_is_batching") and provider._is_batching:
+            if self.json_rpc_method in RPC_METHODS_UNSUPPORTED_DURING_BATCH:
+                raise MethodNotSupported(
+                    f"Method `{self.json_rpc_method}` is not supported within a batch "
+                    "request."
+                )
+            return module.retrieve_request_information(self)
+        else:
+            return module.retrieve_caller_fn(self)
+
+    def __call__(self, *args: Any, **kwargs: Any) -> Any:
+        return self.__get__(self._module)(*args, **kwargs)
 
     @property
     def method_selector_fn(
         self,
     ) -> Callable[..., Union[RPCEndpoint, Callable[..., RPCEndpoint]]]:
         """Gets the method selector from the config."""
         if callable(self.json_rpc_method):
```

### Comparing `web3-7.0.0b5/web3/middleware/__init__.py` & `web3-7.0.0b6/web3/middleware/__init__.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/attrdict.py` & `web3-7.0.0b6/web3/middleware/attrdict.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/buffered_gas_estimate.py` & `web3-7.0.0b6/web3/middleware/buffered_gas_estimate.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/filter.py` & `web3-7.0.0b6/web3/middleware/filter.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/formatting.py` & `web3-7.0.0b6/web3/middleware/formatting.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/gas_price_strategy.py` & `web3-7.0.0b6/web3/middleware/gas_price_strategy.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/names.py` & `web3-7.0.0b6/web3/middleware/names.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/proof_of_authority.py` & `web3-7.0.0b6/web3/middleware/proof_of_authority.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/signing.py` & `web3-7.0.0b6/web3/middleware/signing.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/stalecheck.py` & `web3-7.0.0b6/web3/middleware/stalecheck.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/middleware/validation.py` & `web3-7.0.0b6/web3/middleware/validation.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/module.py` & `web3-7.0.0b6/web3/module.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,14 +1,16 @@
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Coroutine,
     Dict,
     Optional,
+    Sequence,
+    Tuple,
     TypeVar,
     Union,
     cast,
 )
 
 from eth_abi.codec import (
     ABICodec,
@@ -52,16 +54,50 @@
         return result
 
 
 TReturn = TypeVar("TReturn")
 
 
 @curry
+def retrieve_request_information_for_batching(
+    w3: Union["AsyncWeb3", "Web3"],
+    module: "Module",
+    method: Method[Callable[..., Any]],
+) -> Union[
+    Callable[..., Tuple[Tuple[RPCEndpoint, Any], Sequence[Any]]],
+    Callable[..., Coroutine[Any, Any, Tuple[Tuple[RPCEndpoint, Any], Sequence[Any]]]],
+]:
+    async def async_inner(
+        *args: Any, **kwargs: Any
+    ) -> Tuple[Tuple[RPCEndpoint, Any], Sequence[Any]]:
+        (method_str, params), response_formatters = method.process_params(
+            module, *args, **kwargs
+        )
+        if isinstance(w3.provider, PersistentConnectionProvider):
+            w3.provider._request_processor.cache_request_information(
+                cast(RPCEndpoint, method_str), params, response_formatters
+            )
+        return (cast(RPCEndpoint, method_str), params), response_formatters
+
+    def inner(
+        *args: Any, **kwargs: Any
+    ) -> Tuple[Tuple[RPCEndpoint, Any], Sequence[Any]]:
+        (method_str, params), response_formatters = method.process_params(
+            module, *args, **kwargs
+        )
+        return (cast(RPCEndpoint, method_str), params), response_formatters
+
+    return async_inner if module.is_async else inner
+
+
+@curry
 def retrieve_blocking_method_call_fn(
-    w3: "Web3", module: "Module", method: Method[Callable[..., TReturn]]
+    w3: "Web3",
+    module: "Module",
+    method: Method[Callable[..., TReturn]],
 ) -> Callable[..., Union[TReturn, LogFilter]]:
     def caller(*args: Any, **kwargs: Any) -> Union[TReturn, LogFilter]:
         try:
             (method_str, params), response_formatters = method.process_params(
                 module, *args, **kwargs
             )
         except _UseExistingFilter as err:
@@ -78,31 +114,32 @@
         return apply_result_formatters(result_formatters, result)
 
     return caller
 
 
 @curry
 def retrieve_async_method_call_fn(
-    async_w3: "AsyncWeb3", module: "Module", method: Method[Callable[..., Any]]
+    async_w3: "AsyncWeb3",
+    module: "Module",
+    method: Method[Callable[..., Any]],
 ) -> Callable[..., Coroutine[Any, Any, Optional[Union[RPCResponse, AsyncLogFilter]]]]:
     async def caller(*args: Any, **kwargs: Any) -> Union[RPCResponse, AsyncLogFilter]:
         try:
             (method_str, params), response_formatters = method.process_params(
                 module, *args, **kwargs
             )
         except _UseExistingFilter as err:
             return AsyncLogFilter(eth_module=module, filter_id=err.filter_id)
 
         if isinstance(async_w3.provider, PersistentConnectionProvider):
-            # TODO: The typing does not seem to be correct for response_formatters.
-            #   For now, keep the expected typing but ignore it here.
             provider = async_w3.provider
             cache_key = provider._request_processor.cache_request_information(
-                cast(RPCEndpoint, method_str), params, response_formatters  # type: ignore # noqa: E501
+                cast(RPCEndpoint, method_str), params, response_formatters
             )
+
             try:
                 method_str = cast(RPCEndpoint, method_str)
                 return await async_w3.manager.send(method_str, params)
             except Exception as e:
                 if (
                     cache_key is not None
                     and cache_key
@@ -135,25 +172,28 @@
     is_async = False
 
     def __init__(self, w3: Union["AsyncWeb3", "Web3"]) -> None:
         if self.is_async:
             self.retrieve_caller_fn = retrieve_async_method_call_fn(w3, self)
         else:
             self.retrieve_caller_fn = retrieve_blocking_method_call_fn(w3, self)
+        self.retrieve_request_information = retrieve_request_information_for_batching(
+            w3, self
+        )
         self.w3 = w3
 
     @property
     def codec(self) -> ABICodec:
         # use codec set on the Web3 instance
         return self.w3.codec
 
     def attach_methods(
         self,
         methods: Dict[str, Method[Callable[..., Any]]],
     ) -> None:
         for method_name, method_class in methods.items():
             klass = (
-                method_class.__get__(obj=self)()
+                method_class.__get__(module=self)()
                 if method_class.is_property
-                else method_class.__get__(obj=self)
+                else method_class.__get__(module=self)
             )
             setattr(self, method_name, klass)
```

### Comparing `web3-7.0.0b5/web3/net.py` & `web3-7.0.0b6/web3/net.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/async_base.py` & `web3-7.0.0b6/web3/providers/base.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,187 +1,191 @@
-import asyncio
 import itertools
+import threading
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
-    Coroutine,
-    Optional,
+    List,
     Set,
     Tuple,
     cast,
 )
 
 from eth_utils import (
-    is_text,
     to_bytes,
     to_text,
 )
 
 from web3._utils.caching import (
-    async_handle_request_caching,
+    CACHEABLE_REQUESTS,
+    handle_request_caching,
 )
 from web3._utils.encoding import (
     FriendlyJsonSerde,
     Web3JsonEncoder,
 )
 from web3.exceptions import (
     ProviderConnectionError,
 )
 from web3.middleware import (
-    async_combine_middleware,
+    combine_middleware,
 )
 from web3.middleware.base import (
     Middleware,
     MiddlewareOnion,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 from web3.utils import (
     SimpleCache,
 )
 
 if TYPE_CHECKING:
-    from websockets import (
-        WebSocketClientProtocol,
-    )
-
-    from web3 import (  # noqa: F401
-        AsyncWeb3,
-        WebSocketProvider,
-    )
-    from web3.providers.persistent import (  # noqa: F401
-        RequestProcessor,
-    )
-
-
-CACHEABLE_REQUESTS = cast(
-    Set[RPCEndpoint],
-    (
-        "eth_chainId",
-        "eth_getBlockByHash",
-        "eth_getBlockTransactionCountByHash",
-        "eth_getRawTransactionByHash",
-        "eth_getTransactionByBlockHashAndIndex",
-        "eth_getTransactionByHash",
-        "eth_getUncleByBlockHashAndIndex",
-        "eth_getUncleCountByBlockHash",
-        "net_version",
-        "web3_clientVersion",
-    ),
-)
+    from web3 import Web3  # noqa: F401
 
 
-class AsyncBaseProvider:
-    _request_func_cache: Tuple[
-        Tuple[Middleware, ...], Callable[..., Coroutine[Any, Any, RPCResponse]]
-    ] = (None, None)
+class BaseProvider:
+    # a tuple of (middleware, request_func)
+    _request_func_cache: Tuple[Tuple[Middleware, ...], Callable[..., RPCResponse]] = (
+        None,
+        None,
+    )
 
-    is_async = True
+    is_async = False
     has_persistent_connection = False
     global_ccip_read_enabled: bool = True
     ccip_read_max_redirects: int = 4
 
     # request caching
-    cache_allowed_requests: bool = False
-    cacheable_requests: Set[RPCEndpoint] = CACHEABLE_REQUESTS
     _request_cache: SimpleCache
-    _request_cache_lock: asyncio.Lock = asyncio.Lock()
+    _request_cache_lock: threading.Lock = threading.Lock()
 
-    def __init__(self) -> None:
+    def __init__(
+        self,
+        cache_allowed_requests: bool = False,
+        cacheable_requests: Set[RPCEndpoint] = None,
+    ) -> None:
         self._request_cache = SimpleCache(1000)
+        self.cache_allowed_requests = cache_allowed_requests
+        self.cacheable_requests = cacheable_requests or CACHEABLE_REQUESTS
 
-    async def request_func(
-        self, async_w3: "AsyncWeb3", middleware_onion: MiddlewareOnion
-    ) -> Callable[..., Coroutine[Any, Any, RPCResponse]]:
+    def request_func(
+        self, w3: "Web3", middleware_onion: MiddlewareOnion
+    ) -> Callable[..., RPCResponse]:
+        """
+        @param w3 is the web3 instance
+        @param middleware_onion is an iterable of middleware,
+            ordered by first to execute
+        @returns a function that calls all the middleware and
+            eventually self.make_request()
+        """
         middleware: Tuple[Middleware, ...] = middleware_onion.as_tuple_of_middleware()
 
         cache_key = self._request_func_cache[0]
         if cache_key != middleware:
             self._request_func_cache = (
                 middleware,
-                await async_combine_middleware(
+                combine_middleware(
                     middleware=middleware,
-                    async_w3=async_w3,
+                    w3=w3,
                     provider_request_fn=self.make_request,
                 ),
             )
+
         return self._request_func_cache[-1]
 
-    @async_handle_request_caching
-    async def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
+    @handle_request_caching
+    def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         raise NotImplementedError("Providers must implement this method")
 
-    async def is_connected(self, show_traceback: bool = False) -> bool:
+    def is_connected(self, show_traceback: bool = False) -> bool:
         raise NotImplementedError("Providers must implement this method")
 
-    # -- persistent connection providers -- #
-
-    _request_processor: "RequestProcessor"
-    _message_listener_task: "asyncio.Task[None]"
-    _listen_event: "asyncio.Event"
-
-    async def connect(self) -> None:
-        raise NotImplementedError(
-            "Persistent connection providers must implement this method"
-        )
-
-    async def disconnect(self) -> None:
-        raise NotImplementedError(
-            "Persistent connection providers must implement this method"
-        )
-
-    # WebSocket typing
-    _ws: "WebSocketClientProtocol"
-
-    # IPC typing
-    _reader: Optional[asyncio.StreamReader]
-    _writer: Optional[asyncio.StreamWriter]
 
+class JSONBaseProvider(BaseProvider):
+    _is_batching: bool = False
+    _batch_request_func_cache: Tuple[
+        Tuple[Middleware, ...], Callable[..., List[RPCResponse]]
+    ] = (None, None)
 
-class AsyncJSONBaseProvider(AsyncBaseProvider):
-    def __init__(self) -> None:
-        super().__init__()
+    def __init__(self, **kwargs: Any) -> None:
         self.request_counter = itertools.count()
+        super().__init__(**kwargs)
 
     def encode_rpc_request(self, method: RPCEndpoint, params: Any) -> bytes:
-        request_id = next(self.request_counter)
         rpc_dict = {
             "jsonrpc": "2.0",
             "method": method,
             "params": params or [],
-            "id": request_id,
+            "id": next(self.request_counter),
         }
-        encoded = FriendlyJsonSerde().json_encode(rpc_dict, cls=Web3JsonEncoder)
+        encoded = FriendlyJsonSerde().json_encode(rpc_dict, Web3JsonEncoder)
         return to_bytes(text=encoded)
 
-    def decode_rpc_response(self, raw_response: bytes) -> RPCResponse:
-        text_response = str(
-            to_text(raw_response) if not is_text(raw_response) else raw_response
-        )
+    @staticmethod
+    def decode_rpc_response(raw_response: bytes) -> RPCResponse:
+        text_response = to_text(raw_response)
         return cast(RPCResponse, FriendlyJsonSerde().json_decode(text_response))
 
-    async def is_connected(self, show_traceback: bool = False) -> bool:
+    def is_connected(self, show_traceback: bool = False) -> bool:
         try:
-            response = await self.make_request(RPCEndpoint("web3_clientVersion"), [])
-        except (OSError, ProviderConnectionError) as e:
+            response = self.make_request(RPCEndpoint("web3_clientVersion"), [])
+        except OSError as e:
             if show_traceback:
                 raise ProviderConnectionError(
                     f"Problem connecting to provider with error: {type(e)}: {e}"
                 )
             return False
 
         if "error" in response:
             if show_traceback:
                 raise ProviderConnectionError(
                     f"Error received from provider: {response}"
                 )
             return False
 
-        if response.get("jsonrpc") == "2.0":
+        if response["jsonrpc"] == "2.0":
             return True
         else:
             if show_traceback:
                 raise ProviderConnectionError(f"Bad jsonrpc version: {response}")
             return False
+
+    #  -- batch requests -- #
+
+    def batch_request_func(
+        self, w3: "Web3", middleware_onion: MiddlewareOnion
+    ) -> Callable[..., List[RPCResponse]]:
+        middleware: Tuple[Middleware, ...] = middleware_onion.as_tuple_of_middleware()
+
+        cache_key = self._batch_request_func_cache[0]
+        if cache_key != middleware:
+            accumulator_fn = self.make_batch_request
+            for mw in reversed(middleware):
+                initialized = mw(w3)
+                # type ignore bc in order to wrap the method, we have to call
+                # `wrap_make_batch_request` with the accumulator_fn as the argument
+                # which breaks the type hinting for this particular case.
+                accumulator_fn = initialized.wrap_make_batch_request(
+                    accumulator_fn
+                )  # type: ignore  # noqa: E501
+            self._batch_request_func_cache = (middleware, accumulator_fn)
+
+        return self._batch_request_func_cache[-1]
+
+    def encode_batch_rpc_request(
+        self, requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> bytes:
+        return (
+            b"["
+            + b", ".join(
+                self.encode_rpc_request(method, params) for method, params in requests
+            )
+            + b"]"
+        )
+
+    def make_batch_request(
+        self, requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        raise NotImplementedError("Providers must implement this method")
```

### Comparing `web3-7.0.0b5/web3/providers/auto.py` & `web3-7.0.0b6/web3/providers/auto.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/eth_tester/defaults.py` & `web3-7.0.0b6/web3/providers/eth_tester/defaults.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/eth_tester/main.py` & `web3-7.0.0b6/web3/providers/eth_tester/main.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/eth_tester/middleware.py` & `web3-7.0.0b6/web3/providers/eth_tester/middleware.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/ipc.py` & `web3-7.0.0b6/web3/providers/ipc.py`

 * *Files 5% similar despite different names*

```diff
@@ -10,26 +10,32 @@
 import sys
 import threading
 from types import (
     TracebackType,
 )
 from typing import (
     Any,
+    List,
+    Tuple,
     Type,
     Union,
+    cast,
 )
 
 from web3._utils.threads import (
     Timeout,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
+from .._utils.batching import (
+    sort_batch_response_by_response_ids,
+)
 from ..exceptions import (
     Web3TypeError,
     Web3ValueError,
 )
 from .base import (
     JSONBaseProvider,
 )
@@ -131,38 +137,32 @@
     logger = logging.getLogger("web3.providers.IPCProvider")
     _socket = None
 
     def __init__(
         self,
         ipc_path: Union[str, Path] = None,
         timeout: int = 30,
-        *args: Any,
         **kwargs: Any,
     ) -> None:
         if ipc_path is None:
             self.ipc_path = get_default_ipc_path()
         elif isinstance(ipc_path, str) or isinstance(ipc_path, Path):
             self.ipc_path = str(Path(ipc_path).expanduser().resolve())
         else:
             raise Web3TypeError("ipc_path must be of type string or pathlib.Path")
 
         self.timeout = timeout
         self._lock = threading.Lock()
         self._socket = PersistantSocket(self.ipc_path)
-        super().__init__()
+        super().__init__(**kwargs)
 
     def __str__(self) -> str:
         return f"<{self.__class__.__name__} {self.ipc_path}>"
 
-    def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
-        self.logger.debug(
-            f"Making request IPC. Path: {self.ipc_path}, Method: {method}"
-        )
-        request = self.encode_rpc_request(method, params)
-
+    def _make_request(self, request: bytes) -> RPCResponse:
         with self._lock, self._socket as sock:
             try:
                 sock.sendall(request)
             except BrokenPipeError:
                 # one extra attempt, then give up
                 sock = self._socket.reset()
                 sock.sendall(request)
@@ -185,14 +185,29 @@
                             continue
                         else:
                             return response
                     else:
                         timeout.sleep(0)
                         continue
 
+    def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
+        self.logger.debug(
+            f"Making request IPC. Path: {self.ipc_path}, Method: {method}"
+        )
+        request = self.encode_rpc_request(method, params)
+        return self._make_request(request)
+
+    def make_batch_request(
+        self, requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        self.logger.debug(f"Making batch request IPC. Path: {self.ipc_path}")
+        request_data = self.encode_batch_rpc_request(requests)
+        response = cast(List[RPCResponse], self._make_request(request_data))
+        return sort_batch_response_by_response_ids(response)
+
 
 # A valid JSON RPC response can only end in } or ] http://www.jsonrpc.org/specification
 def has_valid_json_rpc_ending(raw_response: bytes) -> bool:
     stripped_raw_response = raw_response.rstrip()
     for valid_ending in [b"}", b"]"]:
         if stripped_raw_response.endswith(valid_ending):
             return True
```

### Comparing `web3-7.0.0b5/web3/providers/legacy_websocket.py` & `web3-7.0.0b6/web3/providers/legacy_websocket.py`

 * *Files 13% similar despite different names*

```diff
@@ -6,29 +6,38 @@
     Thread,
 )
 from types import (
     TracebackType,
 )
 from typing import (
     Any,
+    List,
     Optional,
+    Tuple,
     Type,
     Union,
+    cast,
 )
 
 from eth_typing import (
     URI,
 )
 from websockets.client import (
     connect,
 )
 from websockets.legacy.client import (
     WebSocketClientProtocol,
 )
 
+from web3._utils.batching import (
+    sort_batch_response_by_response_ids,
+)
+from web3._utils.caching import (
+    handle_request_caching,
+)
 from web3.exceptions import (
     Web3ValidationError,
 )
 from web3.providers.base import (
     JSONBaseProvider,
 )
 from web3.types import (
@@ -87,14 +96,15 @@
     _loop = None
 
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         websocket_kwargs: Optional[Any] = None,
         websocket_timeout: int = DEFAULT_WEBSOCKET_TIMEOUT,
+        **kwargs: Any,
     ) -> None:
         self.endpoint_uri = URI(endpoint_uri)
         self.websocket_timeout = websocket_timeout
         if self.endpoint_uri is None:
             self.endpoint_uri = get_default_endpoint()
         if LegacyWebSocketProvider._loop is None:
             LegacyWebSocketProvider._loop = _get_threaded_loop()
@@ -106,30 +116,45 @@
             )
             if found_restricted_keys:
                 raise Web3ValidationError(
                     f"{RESTRICTED_WEBSOCKET_KWARGS} are not allowed "
                     f"in websocket_kwargs, found: {found_restricted_keys}"
                 )
         self.conn = PersistentWebSocket(self.endpoint_uri, websocket_kwargs)
-        super().__init__()
+        super().__init__(**kwargs)
 
     def __str__(self) -> str:
         return f"WS connection {self.endpoint_uri}"
 
     async def coro_make_request(self, request_data: bytes) -> RPCResponse:
         async with self.conn as conn:
             await asyncio.wait_for(
                 conn.send(request_data), timeout=self.websocket_timeout
             )
             return json.loads(
                 await asyncio.wait_for(conn.recv(), timeout=self.websocket_timeout)
             )
 
+    @handle_request_caching
     def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         self.logger.debug(
             f"Making request WebSocket. URI: {self.endpoint_uri}, " f"Method: {method}"
         )
         request_data = self.encode_rpc_request(method, params)
         future = asyncio.run_coroutine_threadsafe(
             self.coro_make_request(request_data), LegacyWebSocketProvider._loop
         )
         return future.result()
+
+    def make_batch_request(
+        self, requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        self.logger.debug(
+            f"Making batch request WebSocket. URI: {self.endpoint_uri}, "
+            f"Methods: {requests}"
+        )
+        request_data = self.encode_batch_rpc_request(requests)
+        future = asyncio.run_coroutine_threadsafe(
+            self.coro_make_request(request_data), LegacyWebSocketProvider._loop
+        )
+        response = cast(List[RPCResponse], future.result())
+        return sort_batch_response_by_response_ids(response)
```

### Comparing `web3-7.0.0b5/web3/providers/persistent/async_ipc.py` & `web3-7.0.0b6/web3/providers/persistent/async_ipc.py`

 * *Files 15% similar despite different names*

```diff
@@ -7,31 +7,37 @@
 import logging
 from pathlib import (
     Path,
 )
 import sys
 from typing import (
     Any,
+    List,
     Optional,
     Tuple,
     Union,
+    cast,
 )
 
 from eth_utils import (
     to_text,
 )
 
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
 from . import (
     PersistentConnectionProvider,
 )
+from ..._utils.batching import (
+    BATCH_REQUEST_ID,
+    sort_batch_response_by_response_ids,
+)
 from ..._utils.caching import (
     async_handle_request_caching,
 )
 from ...exceptions import (
     ProviderConnectionError,
     Web3TypeError,
 )
@@ -55,30 +61,30 @@
 
 
 class AsyncIPCProvider(PersistentConnectionProvider):
     logger = logging.getLogger("web3.providers.AsyncIPCProvider")
 
     _reader: Optional[asyncio.StreamReader] = None
     _writer: Optional[asyncio.StreamWriter] = None
+    _decoder: json.JSONDecoder = json.JSONDecoder()
+    _raw_message: str = ""
 
     def __init__(
         self,
         ipc_path: Optional[Union[str, Path]] = None,
-        max_connection_retries: int = 5,
         # `PersistentConnectionProvider` kwargs can be passed through
         **kwargs: Any,
     ) -> None:
         if ipc_path is None:
             self.ipc_path = get_default_ipc_path()
         elif isinstance(ipc_path, str) or isinstance(ipc_path, Path):
             self.ipc_path = str(Path(ipc_path).expanduser().resolve())
         else:
             raise Web3TypeError("ipc_path must be of type string or pathlib.Path")
 
-        self._max_connection_retries = max_connection_retries
         super().__init__(**kwargs)
 
     def __str__(self) -> str:
         return f"<{self.__class__.__name__} {self.ipc_path}>"
 
     async def is_connected(self, show_traceback: bool = False) -> bool:
         if not self._writer or not self._reader:
@@ -95,71 +101,38 @@
         except (OSError, ProviderConnectionError) as e:
             if show_traceback:
                 raise ProviderConnectionError(
                     f"Problem connecting to provider with error: {type(e)}: {e}"
                 )
             return False
 
-    async def connect(self) -> None:
-        _connection_attempts = 0
-        _backoff_rate_change = 1.75
-        _backoff_time = 1.75
-
-        while _connection_attempts != self._max_connection_retries:
-            try:
-                _connection_attempts += 1
-                self._reader, self._writer = await async_get_ipc_socket(self.ipc_path)
-                self._message_listener_task = asyncio.create_task(
-                    self._message_listener()
-                )
-                break
-            except OSError as e:
-                if _connection_attempts == self._max_connection_retries:
-                    raise ProviderConnectionError(
-                        f"Could not connect to: {self.ipc_path}. "
-                        f"Retries exceeded max of {self._max_connection_retries}."
-                    ) from e
-                self.logger.info(
-                    f"Could not connect to: {self.ipc_path}. Retrying in "
-                    f"{round(_backoff_time, 1)} seconds.",
-                    exc_info=True,
-                )
-                await asyncio.sleep(_backoff_time)
-                _backoff_time *= _backoff_rate_change
+    async def _provider_specific_connect(self) -> None:
+        self._reader, self._writer = await async_get_ipc_socket(self.ipc_path)
 
-    async def disconnect(self) -> None:
+    async def _provider_specific_disconnect(self) -> None:
         if self._writer and not self._writer.is_closing():
             self._writer.close()
             await self._writer.wait_closed()
             self._writer = None
-            self.logger.debug(f'Successfully disconnected from : "{self.ipc_path}')
-
-        try:
-            self._message_listener_task.cancel()
-            await self._message_listener_task
+        if self._reader:
             self._reader = None
-        except (asyncio.CancelledError, StopAsyncIteration):
-            pass
-
-        self._request_processor.clear_caches()
 
     async def _reset_socket(self) -> None:
         self._writer.close()
         await self._writer.wait_closed()
         self._reader, self._writer = await async_get_ipc_socket(self.ipc_path)
 
     @async_handle_request_caching
     async def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
-        request_data = self.encode_rpc_request(method, params)
-
         if self._writer is None:
             raise ProviderConnectionError(
                 "Connection to ipc socket has not been initiated for the provider."
             )
 
+        request_data = self.encode_rpc_request(method, params)
         try:
             self._writer.write(request_data)
             await self._writer.drain()
         except OSError as e:
             # Broken pipe
             if e.errno == errno.EPIPE:
                 # one extra attempt, then give up
@@ -168,47 +141,58 @@
                 await self._writer.drain()
 
         current_request_id = json.loads(request_data)["id"]
         response = await self._get_response_for_request_id(current_request_id)
 
         return response
 
-    async def _message_listener(self) -> None:
-        self.logger.info(
-            "IPC socket listener background task started. Storing all messages in "
-            "appropriate request processor queues / caches to be processed."
+    async def make_batch_request(
+        self, requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        if self._writer is None:
+            raise ProviderConnectionError(
+                "Connection to ipc socket has not been initiated for the provider."
+            )
+
+        request_data = self.encode_batch_rpc_request(requests)
+        try:
+            self._writer.write(request_data)
+            await self._writer.drain()
+        except OSError as e:
+            # Broken pipe
+            if e.errno == errno.EPIPE:
+                # one extra attempt, then give up
+                await self._reset_socket()
+                self._writer.write(request_data)
+                await self._writer.drain()
+
+        response = cast(
+            List[RPCResponse], await self._get_response_for_request_id(BATCH_REQUEST_ID)
         )
-        raw_message = ""
-        decoder = json.JSONDecoder()
+        return response
 
-        while True:
-            # the use of sleep(0) seems to be the most efficient way to yield control
-            # back to the event loop to share the loop with other tasks.
-            await asyncio.sleep(0)
+    async def _provider_specific_message_listener(self) -> None:
+        self._raw_message += to_text(await self._reader.read(4096)).lstrip()
 
+        while self._raw_message:
             try:
-                raw_message += to_text(await self._reader.read(4096)).lstrip()
+                response, pos = self._decoder.raw_decode(self._raw_message)
+            except JSONDecodeError:
+                break
 
-                while raw_message:
-                    try:
-                        response, pos = decoder.raw_decode(raw_message)
-                    except JSONDecodeError:
-                        break
-
-                    is_subscription = response.get("method") == "eth_subscription"
-                    await self._request_processor.cache_raw_response(
-                        response, subscription=is_subscription
-                    )
-                    raw_message = raw_message[pos:].lstrip()
-            except Exception as e:
-                if not self.silence_listener_task_exceptions:
-                    loop = asyncio.get_event_loop()
-                    for task in asyncio.all_tasks(loop=loop):
-                        task.cancel()
-                    raise e
-
-                self.logger.error(
-                    "Exception caught in listener, error logging and keeping listener "
-                    f"background task alive.\n    error={e}"
-                )
-                # if only error logging, reset the ``raw_message`` buffer and continue
-                raw_message = ""
+            if isinstance(response, list):
+                response = sort_batch_response_by_response_ids(response)
+
+            is_subscription = (
+                response.get("method") == "eth_subscription"
+                if not isinstance(response, list)
+                else False
+            )
+            await self._request_processor.cache_raw_response(
+                response, subscription=is_subscription
+            )
+            self._raw_message = self._raw_message[pos:].lstrip()
+
+    def _error_log_listener_task_exception(self, e: Exception) -> None:
+        super()._error_log_listener_task_exception(e)
+        # reset the raw message buffer on exception when error logging
+        self._raw_message = ""
```

### Comparing `web3-7.0.0b5/web3/providers/persistent/persistent_connection.py` & `web3-7.0.0b6/web3/providers/persistent/persistent_connection.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/persistent/request_processor.py` & `web3-7.0.0b6/web3/providers/persistent/request_processor.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,25 +1,37 @@
 import asyncio
 from copy import (
     copy,
 )
+import sys
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
     Dict,
+    Generic,
     Optional,
     Tuple,
+    TypeVar,
+    Union,
 )
 
+from eth_utils.toolz import (
+    compose,
+)
+
+from web3._utils.batching import (
+    BATCH_REQUEST_ID,
+)
 from web3._utils.caching import (
     RequestInformation,
     generate_cache_key,
 )
 from web3.exceptions import (
+    TaskNotRunning,
     Web3ValueError,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 from web3.utils import (
@@ -27,30 +39,58 @@
 )
 
 if TYPE_CHECKING:
     from web3.providers.persistent import (
         PersistentConnectionProvider,
     )
 
+T = TypeVar("T")
+
+# TODO: This is an ugly hack for python 3.8. Remove this after we drop support for it
+#  and use `asyncio.Queue[T]` type directly in the `TaskReliantQueue` class.
+if sys.version_info >= (3, 9):
+
+    class _TaskReliantQueue(asyncio.Queue[T], Generic[T]):
+        pass
+
+else:
+
+    class _TaskReliantQueue(asyncio.Queue, Generic[T]):  # type: ignore
+        pass
+
+
+class TaskReliantQueue(_TaskReliantQueue[T]):
+    """
+    A queue that relies on a task to be running to process items in the queue.
+    """
+
+    async def get(self) -> T:
+        item = await super().get()
+        if isinstance(item, Exception):
+            # if the item is an exception, raise it so the task can handle this case
+            # more gracefully
+            raise item
+        return item
+
 
 class RequestProcessor:
     _subscription_queue_synced_with_ws_stream: bool = False
 
     def __init__(
         self,
         provider: "PersistentConnectionProvider",
         subscription_response_queue_size: int = 500,
     ) -> None:
         self._provider = provider
 
         self._request_information_cache: SimpleCache = SimpleCache(500)
         self._request_response_cache: SimpleCache = SimpleCache(500)
-        self._subscription_response_queue: asyncio.Queue[RPCResponse] = asyncio.Queue(
-            maxsize=subscription_response_queue_size
-        )
+        self._subscription_response_queue: TaskReliantQueue[
+            Union[RPCResponse, TaskNotRunning]
+        ] = TaskReliantQueue(maxsize=subscription_response_queue_size)
 
     @property
     def active_subscriptions(self) -> Dict[str, Any]:
         return {
             value.subscription_id: {"params": value.params}
             for key, value in self._request_information_cache.items()
             if value.method == "eth_subscribe"
@@ -58,42 +98,51 @@
 
     # request information cache
 
     def cache_request_information(
         self,
         method: RPCEndpoint,
         params: Any,
-        response_formatters: Tuple[Callable[..., Any], ...],
+        response_formatters: Tuple[
+            Union[Dict[str, Callable[..., Any]], Callable[..., Any]],
+            Callable[..., Any],
+            Callable[..., Any],
+        ],
     ) -> Optional[str]:
         cached_requests_key = generate_cache_key((method, params))
         if cached_requests_key in self._provider._request_cache._data:
             cached_response = self._provider._request_cache._data[cached_requests_key]
             cached_response_id = cached_response.get("id")
             cache_key = generate_cache_key(cached_response_id)
             if cache_key in self._request_information_cache:
                 self._provider.logger.debug(
                     "This is a cached request, not caching request info because it is "
                     f"not unique:\n    method={method},\n    params={params}"
                 )
                 return None
 
-        # copy the request counter and find the next request id without incrementing
-        # since this is done when / if the request is successfully sent
-        request_id = next(copy(self._provider.request_counter))
-        cache_key = generate_cache_key(request_id)
+        if self._provider._is_batching:
+            # the _batch_request_counter is set when entering the context manager
+            current_request_id = self._provider._batch_request_counter
+            self._provider._batch_request_counter += 1
+        else:
+            # copy the request counter and find the next request id without incrementing
+            # since this is done when / if the request is successfully sent
+            current_request_id = next(copy(self._provider.request_counter))
+        cache_key = generate_cache_key(current_request_id)
 
-        self._bump_cache_if_key_present(cache_key, request_id)
+        self._bump_cache_if_key_present(cache_key, current_request_id)
 
         request_info = RequestInformation(
             method,
             params,
             response_formatters,
         )
         self._provider.logger.debug(
-            f"Caching request info:\n    request_id={request_id},\n"
+            f"Caching request info:\n    request_id={current_request_id},\n"
             f"    cache_key={cache_key},\n    request_info={request_info.__dict__}"
         )
         self._request_information_cache.cache(
             cache_key,
             request_info,
         )
         return cache_key
@@ -149,17 +198,16 @@
             cache_key = generate_cache_key(response["params"]["subscription"])
             request_info = (
                 # don't pop the request info from the cache, since we need to keep it
                 # to process future subscription responses
                 # i.e. subscription request information remains in the cache
                 self._request_information_cache.get_cache_entry(cache_key)
             )
-
         else:
-            # retrieve the request info from the cache using the request id
+            # retrieve the request info from the cache using the response id
             cache_key = generate_cache_key(response["id"])
             if response in self._provider._request_cache._data.values():
                 request_info = (
                     # don't pop the request info from the cache, since we need to keep
                     # it to process future responses
                     # i.e. request information remains in the cache
                     self._request_information_cache.get_cache_entry(cache_key)
@@ -180,14 +228,41 @@
                 # information from the cache since it is no longer needed
                 subscription_id = request_info.params[0]
                 subscribe_cache_key = generate_cache_key(subscription_id)
                 self.pop_cached_request_information(subscribe_cache_key)
 
         return request_info
 
+    def append_result_formatter_for_request(
+        self, request_id: int, result_formatter: Callable[..., Any]
+    ) -> None:
+        cache_key = generate_cache_key(request_id)
+        cached_request_info_for_id: RequestInformation = (
+            self._request_information_cache.get_cache_entry(cache_key)
+        )
+        if cached_request_info_for_id is not None:
+            (
+                current_result_formatters,
+                error_formatters,
+                null_result_formatters,
+            ) = cached_request_info_for_id.response_formatters
+            cached_request_info_for_id.response_formatters = (
+                compose(
+                    result_formatter,
+                    current_result_formatters,
+                ),
+                error_formatters,
+                null_result_formatters,
+            )
+        else:
+            self._provider.logger.debug(
+                f"No cached request info for response id `{request_id}`. Cannot "
+                f"append response formatter for response."
+            )
+
     def append_middleware_response_processor(
         self,
         response: RPCResponse,
         middleware_response_processor: Callable[..., Any],
     ) -> None:
         response_id = response.get("id", None)
 
@@ -214,25 +289,34 @@
     # raw response cache
 
     async def cache_raw_response(
         self, raw_response: Any, subscription: bool = False
     ) -> None:
         if subscription:
             if self._subscription_response_queue.full():
-                self._provider.logger.info(
+                self._provider.logger.debug(
                     "Subscription queue is full. Waiting for provider to consume "
                     "messages before caching."
                 )
                 self._provider._listen_event.clear()
                 await self._provider._listen_event.wait()
 
             self._provider.logger.debug(
                 f"Caching subscription response:\n    response={raw_response}"
             )
             await self._subscription_response_queue.put(raw_response)
+        elif isinstance(raw_response, list):
+            # Since only one batch should be in the cache at all times, we use a
+            # constant cache key for the batch response.
+            cache_key = generate_cache_key(BATCH_REQUEST_ID)
+            self._provider.logger.debug(
+                f"Caching batch response:\n    cache_key={cache_key},\n"
+                f"    response={raw_response}"
+            )
+            self._request_response_cache.cache(cache_key, raw_response)
         else:
             response_id = raw_response.get("id")
             cache_key = generate_cache_key(response_id)
             self._provider.logger.debug(
                 f"Caching response:\n    response_id={response_id},\n"
                 f"    cache_key={cache_key},\n    response={raw_response}"
             )
@@ -285,10 +369,10 @@
 
     # request processor class methods
 
     def clear_caches(self) -> None:
         """Clear the request processor caches."""
         self._request_information_cache.clear()
         self._request_response_cache.clear()
-        self._subscription_response_queue = asyncio.Queue(
+        self._subscription_response_queue = TaskReliantQueue(
             maxsize=self._subscription_response_queue.maxsize
         )
```

### Comparing `web3-7.0.0b5/web3/providers/persistent/utils.py` & `web3-7.0.0b6/web3/providers/persistent/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/providers/rpc/async_rpc.py` & `web3-7.0.0b6/web3/providers/rpc/rpc.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,92 +1,106 @@
-import asyncio
 import logging
+import time
 from typing import (
+    TYPE_CHECKING,
     Any,
     Dict,
     Iterable,
+    List,
     Optional,
     Tuple,
     Union,
+    cast,
 )
 
-from aiohttp import (
-    ClientError,
-    ClientSession,
-)
 from eth_typing import (
     URI,
 )
 from eth_utils import (
     to_dict,
 )
+import requests
 
 from web3._utils.empty import (
     Empty,
     empty,
 )
 from web3._utils.http import (
     construct_user_agent,
 )
 from web3._utils.request import (
-    async_cache_and_return_session as _async_cache_and_return_session,
-    async_make_post_request,
+    cache_and_return_session,
     get_default_http_endpoint,
+    make_post_request,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
+from ..._utils.batching import (
+    sort_batch_response_by_response_ids,
+)
 from ..._utils.caching import (
-    async_handle_request_caching,
+    handle_request_caching,
 )
-from ..async_base import (
-    AsyncJSONBaseProvider,
+from ..base import (
+    JSONBaseProvider,
 )
 from .utils import (
     ExceptionRetryConfiguration,
     check_if_retry_on_failure,
 )
 
+if TYPE_CHECKING:
+    from web3.middleware.base import (  # noqa: F401
+        Middleware,
+    )
+
 
-class AsyncHTTPProvider(AsyncJSONBaseProvider):
-    logger = logging.getLogger("web3.providers.AsyncHTTPProvider")
+class HTTPProvider(JSONBaseProvider):
+    logger = logging.getLogger("web3.providers.HTTPProvider")
     endpoint_uri = None
     _request_kwargs = None
 
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         request_kwargs: Optional[Any] = None,
+        session: Optional[Any] = None,
         exception_retry_configuration: Union[
             ExceptionRetryConfiguration, Empty
         ] = empty,
+        **kwargs: Any,
     ) -> None:
         if endpoint_uri is None:
             self.endpoint_uri = get_default_http_endpoint()
         else:
             self.endpoint_uri = URI(endpoint_uri)
 
         self._request_kwargs = request_kwargs or {}
         self._exception_retry_configuration = exception_retry_configuration
 
-        super().__init__()
+        if session:
+            cache_and_return_session(self.endpoint_uri, session)
 
-    async def cache_async_session(self, session: ClientSession) -> ClientSession:
-        return await _async_cache_and_return_session(self.endpoint_uri, session)
+        super().__init__(**kwargs)
 
     def __str__(self) -> str:
         return f"RPC connection {self.endpoint_uri}"
 
     @property
     def exception_retry_configuration(self) -> ExceptionRetryConfiguration:
         if isinstance(self._exception_retry_configuration, Empty):
             self._exception_retry_configuration = ExceptionRetryConfiguration(
-                errors=(ClientError, TimeoutError)
+                errors=(
+                    ConnectionError,
+                    requests.HTTPError,
+                    requests.Timeout,
+                )
             )
         return self._exception_retry_configuration
 
     @exception_retry_configuration.setter
     def exception_retry_configuration(
         self, value: Union[ExceptionRetryConfiguration, Empty]
     ) -> None:
@@ -100,50 +114,62 @@
 
     def get_request_headers(self) -> Dict[str, str]:
         return {
             "Content-Type": "application/json",
             "User-Agent": construct_user_agent(type(self)),
         }
 
-    async def _make_request(self, method: RPCEndpoint, request_data: bytes) -> bytes:
+    def _make_request(self, method: RPCEndpoint, request_data: bytes) -> bytes:
         """
         If exception_retry_configuration is set, retry on failure; otherwise, make
         the request without retrying.
         """
         if (
             self.exception_retry_configuration is not None
             and check_if_retry_on_failure(
                 method, self.exception_retry_configuration.method_allowlist
             )
         ):
             for i in range(self.exception_retry_configuration.retries):
                 try:
-                    return await async_make_post_request(
+                    return make_post_request(
                         self.endpoint_uri, request_data, **self.get_request_kwargs()
                     )
-                except tuple(self.exception_retry_configuration.errors):
+                except tuple(self.exception_retry_configuration.errors) as e:
                     if i < self.exception_retry_configuration.retries - 1:
-                        await asyncio.sleep(
+                        time.sleep(
                             self.exception_retry_configuration.backoff_factor * 2**i
                         )
                         continue
                     else:
-                        raise
+                        raise e
             return None
         else:
-            return await async_make_post_request(
+            return make_post_request(
                 self.endpoint_uri, request_data, **self.get_request_kwargs()
             )
 
-    @async_handle_request_caching
-    async def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
+    @handle_request_caching
+    def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         self.logger.debug(
             f"Making request HTTP. URI: {self.endpoint_uri}, Method: {method}"
         )
         request_data = self.encode_rpc_request(method, params)
-        raw_response = await self._make_request(method, request_data)
+        raw_response = self._make_request(method, request_data)
         response = self.decode_rpc_response(raw_response)
         self.logger.debug(
             f"Getting response HTTP. URI: {self.endpoint_uri}, "
             f"Method: {method}, Response: {response}"
         )
         return response
+
+    def make_batch_request(
+        self, batch_requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        self.logger.debug(f"Making batch request HTTP, uri: `{self.endpoint_uri}`")
+        request_data = self.encode_batch_rpc_request(batch_requests)
+        raw_response = make_post_request(
+            self.endpoint_uri, request_data, **self.get_request_kwargs()
+        )
+        self.logger.debug("Received batch response HTTP.")
+        responses_list = cast(List[RPCResponse], self.decode_rpc_response(raw_response))
+        return sort_batch_response_by_response_ids(responses_list)
```

### Comparing `web3-7.0.0b5/web3/providers/rpc/rpc.py` & `web3-7.0.0b6/web3/providers/rpc/async_rpc.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,100 +1,98 @@
+import asyncio
 import logging
-import time
 from typing import (
-    TYPE_CHECKING,
     Any,
     Dict,
     Iterable,
+    List,
     Optional,
     Tuple,
     Union,
+    cast,
 )
 
+from aiohttp import (
+    ClientError,
+    ClientSession,
+)
 from eth_typing import (
     URI,
 )
 from eth_utils import (
     to_dict,
 )
-import requests
 
 from web3._utils.empty import (
     Empty,
     empty,
 )
 from web3._utils.http import (
     construct_user_agent,
 )
 from web3._utils.request import (
-    cache_and_return_session,
+    async_cache_and_return_session as _async_cache_and_return_session,
+    async_make_post_request,
     get_default_http_endpoint,
-    make_post_request,
 )
 from web3.types import (
     RPCEndpoint,
     RPCResponse,
 )
 
+from ..._utils.batching import (
+    sort_batch_response_by_response_ids,
+)
 from ..._utils.caching import (
-    handle_request_caching,
+    async_handle_request_caching,
 )
-from ..base import (
-    JSONBaseProvider,
+from ..async_base import (
+    AsyncJSONBaseProvider,
 )
 from .utils import (
     ExceptionRetryConfiguration,
     check_if_retry_on_failure,
 )
 
-if TYPE_CHECKING:
-    from web3.middleware.base import (  # noqa: F401
-        Middleware,
-    )
-
 
-class HTTPProvider(JSONBaseProvider):
-    logger = logging.getLogger("web3.providers.HTTPProvider")
+class AsyncHTTPProvider(AsyncJSONBaseProvider):
+    logger = logging.getLogger("web3.providers.AsyncHTTPProvider")
     endpoint_uri = None
     _request_kwargs = None
 
     def __init__(
         self,
         endpoint_uri: Optional[Union[URI, str]] = None,
         request_kwargs: Optional[Any] = None,
-        session: Optional[Any] = None,
         exception_retry_configuration: Union[
             ExceptionRetryConfiguration, Empty
         ] = empty,
+        **kwargs: Any,
     ) -> None:
         if endpoint_uri is None:
             self.endpoint_uri = get_default_http_endpoint()
         else:
             self.endpoint_uri = URI(endpoint_uri)
 
         self._request_kwargs = request_kwargs or {}
         self._exception_retry_configuration = exception_retry_configuration
 
-        if session:
-            cache_and_return_session(self.endpoint_uri, session)
+        super().__init__(**kwargs)
 
-        super().__init__()
+    async def cache_async_session(self, session: ClientSession) -> ClientSession:
+        return await _async_cache_and_return_session(self.endpoint_uri, session)
 
     def __str__(self) -> str:
         return f"RPC connection {self.endpoint_uri}"
 
     @property
     def exception_retry_configuration(self) -> ExceptionRetryConfiguration:
         if isinstance(self._exception_retry_configuration, Empty):
             self._exception_retry_configuration = ExceptionRetryConfiguration(
-                errors=(
-                    ConnectionError,
-                    requests.HTTPError,
-                    requests.Timeout,
-                )
+                errors=(ClientError, TimeoutError)
             )
         return self._exception_retry_configuration
 
     @exception_retry_configuration.setter
     def exception_retry_configuration(
         self, value: Union[ExceptionRetryConfiguration, Empty]
     ) -> None:
@@ -108,50 +106,62 @@
 
     def get_request_headers(self) -> Dict[str, str]:
         return {
             "Content-Type": "application/json",
             "User-Agent": construct_user_agent(type(self)),
         }
 
-    def _make_request(self, method: RPCEndpoint, request_data: bytes) -> bytes:
+    async def _make_request(self, method: RPCEndpoint, request_data: bytes) -> bytes:
         """
         If exception_retry_configuration is set, retry on failure; otherwise, make
         the request without retrying.
         """
         if (
             self.exception_retry_configuration is not None
             and check_if_retry_on_failure(
                 method, self.exception_retry_configuration.method_allowlist
             )
         ):
             for i in range(self.exception_retry_configuration.retries):
                 try:
-                    return make_post_request(
+                    return await async_make_post_request(
                         self.endpoint_uri, request_data, **self.get_request_kwargs()
                     )
-                except tuple(self.exception_retry_configuration.errors) as e:
+                except tuple(self.exception_retry_configuration.errors):
                     if i < self.exception_retry_configuration.retries - 1:
-                        time.sleep(
+                        await asyncio.sleep(
                             self.exception_retry_configuration.backoff_factor * 2**i
                         )
                         continue
                     else:
-                        raise e
+                        raise
             return None
         else:
-            return make_post_request(
+            return await async_make_post_request(
                 self.endpoint_uri, request_data, **self.get_request_kwargs()
             )
 
-    @handle_request_caching
-    def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
+    @async_handle_request_caching
+    async def make_request(self, method: RPCEndpoint, params: Any) -> RPCResponse:
         self.logger.debug(
             f"Making request HTTP. URI: {self.endpoint_uri}, Method: {method}"
         )
         request_data = self.encode_rpc_request(method, params)
-        raw_response = self._make_request(method, request_data)
+        raw_response = await self._make_request(method, request_data)
         response = self.decode_rpc_response(raw_response)
         self.logger.debug(
             f"Getting response HTTP. URI: {self.endpoint_uri}, "
             f"Method: {method}, Response: {response}"
         )
         return response
+
+    async def make_batch_request(
+        self, batch_requests: List[Tuple[RPCEndpoint, Any]]
+    ) -> List[RPCResponse]:
+        self.logger.debug(f"Making batch request HTTP - uri: `{self.endpoint_uri}`")
+        request_data = self.encode_batch_rpc_request(batch_requests)
+        raw_response = await async_make_post_request(
+            self.endpoint_uri, request_data, **self.get_request_kwargs()
+        )
+        self.logger.debug("Received batch response HTTP.")
+        responses_list = cast(List[RPCResponse], self.decode_rpc_response(raw_response))
+        return sort_batch_response_by_response_ids(responses_list)
```

### Comparing `web3-7.0.0b5/web3/providers/rpc/utils.py` & `web3-7.0.0b6/web3/providers/rpc/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/scripts/release/test_package.py` & `web3-7.0.0b6/web3/scripts/release/test_package.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/testing.py` & `web3-7.0.0b6/web3/testing.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/tools/benchmark/main.py` & `web3-7.0.0b6/web3/tools/benchmark/main.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/tools/benchmark/node.py` & `web3-7.0.0b6/web3/tools/benchmark/node.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/tools/benchmark/reporting.py` & `web3-7.0.0b6/web3/tools/benchmark/reporting.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/tools/benchmark/utils.py` & `web3-7.0.0b6/web3/tools/benchmark/utils.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/tracing.py` & `web3-7.0.0b6/web3/tracing.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/types.py` & `web3-7.0.0b6/web3/types.py`

 * *Files 2% similar despite different names*

```diff
@@ -5,14 +5,15 @@
     Coroutine,
     Dict,
     List,
     Literal,
     NewType,
     Optional,
     Sequence,
+    Tuple,
     Type,
     TypedDict,
     TypeVar,
     Union,
 )
 
 from eth_typing import (
@@ -39,16 +40,17 @@
     from web3.contract.contract import ContractFunction  # noqa: F401
     from web3.main import (  # noqa: F401
         AsyncWeb3,
         Web3,
     )
 
 
-TReturn = TypeVar("TReturn")
+TFunc = TypeVar("TFunc", bound=Callable[..., Any])
 TParams = TypeVar("TParams")
+TReturn = TypeVar("TReturn")
 TValue = TypeVar("TValue")
 
 BlockParams = Literal["latest", "earliest", "pending", "safe", "finalized"]
 BlockIdentifier = Union[BlockParams, BlockNumber, Hash32, HexStr, HexBytes, int]
 LatestBlockParam = Literal["latest"]
 
 FunctionIdentifier = Union[str, Type[FallbackFn], Type[ReceiveFn]]
@@ -314,15 +316,19 @@
 
 class CreateAccessListResponse(TypedDict):
     accessList: AccessList
     gasUsed: int
 
 
 MakeRequestFn = Callable[[RPCEndpoint, Any], RPCResponse]
+MakeBatchRequestFn = Callable[[List[Tuple[RPCEndpoint, Any]]], List[RPCResponse]]
 AsyncMakeRequestFn = Callable[[RPCEndpoint, Any], Coroutine[Any, Any, RPCResponse]]
+AsyncMakeBatchRequestFn = Callable[
+    [List[Tuple[RPCEndpoint, Any]]], Coroutine[Any, Any, List[RPCResponse]]
+]
 
 
 class FormattersDict(TypedDict, total=False):
     error_formatters: Optional[Formatters]
     request_formatters: Optional[Formatters]
     result_formatters: Optional[Formatters]
```

### Comparing `web3-7.0.0b5/web3/utils/address.py` & `web3-7.0.0b6/web3/utils/address.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/utils/async_exception_handling.py` & `web3-7.0.0b6/web3/utils/async_exception_handling.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/utils/caching.py` & `web3-7.0.0b6/web3/utils/caching.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3/utils/exception_handling.py` & `web3-7.0.0b6/web3/utils/exception_handling.py`

 * *Files identical despite different names*

### Comparing `web3-7.0.0b5/web3.egg-info/PKG-INFO` & `web3-7.0.0b6/web3.egg-info/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,26 +1,27 @@
 Metadata-Version: 2.1
 Name: web3
-Version: 7.0.0b5
-Summary: web3.py
+Version: 7.0.0b6
+Summary: web3: A Python library for interacting with Ethereum
 Home-page: https://github.com/ethereum/web3.py
 Author: The Ethereum Foundation
 Author-email: snakecharmers@ethereum.org
 License: MIT
 Keywords: ethereum
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
-Requires-Python: >=3.8
+Classifier: Programming Language :: Python :: 3.12
+Requires-Python: >=3.8, <4
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: aiohttp>=3.7.4.post0
 Requires-Dist: eth-abi>=5.0.1
 Requires-Dist: eth-account>=0.12.2
 Requires-Dist: eth-hash[pycryptodome]>=0.5.1
 Requires-Dist: eth-typing>=4.0.0
@@ -28,47 +29,58 @@
 Requires-Dist: hexbytes>=1.2.0
 Requires-Dist: pydantic>=2.4.0
 Requires-Dist: pywin32>=223; platform_system == "Windows"
 Requires-Dist: requests>=2.16.0
 Requires-Dist: typing-extensions>=4.0.1
 Requires-Dist: websockets>=10.0.0
 Requires-Dist: pyunormalize>=15.0.0
-Provides-Extra: tester
-Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "tester"
-Requires-Dist: py-geth>=4.1.0; extra == "tester"
-Provides-Extra: docs
-Requires-Dist: sphinx>=5.3.0; extra == "docs"
-Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
-Requires-Dist: towncrier<22,>=21; extra == "docs"
 Provides-Extra: dev
-Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
-Requires-Dist: py-geth>=4.1.0; extra == "dev"
-Requires-Dist: sphinx>=5.3.0; extra == "dev"
-Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
-Requires-Dist: towncrier<22,>=21; extra == "dev"
 Requires-Dist: build>=0.9.0; extra == "dev"
-Requires-Dist: bumpversion; extra == "dev"
+Requires-Dist: bumpversion>=0.5.3; extra == "dev"
 Requires-Dist: flaky>=3.7.0; extra == "dev"
 Requires-Dist: hypothesis>=3.31.2; extra == "dev"
+Requires-Dist: ipython; extra == "dev"
 Requires-Dist: pre-commit>=3.4.0; extra == "dev"
-Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
+Requires-Dist: pytest-asyncio<0.23,>=0.21.2; extra == "dev"
 Requires-Dist: pytest-mock>=1.10; extra == "dev"
-Requires-Dist: pytest-watch>=4.2; extra == "dev"
-Requires-Dist: pytest-xdist>=1.29; extra == "dev"
-Requires-Dist: pytest>=7.0.0; extra == "dev"
 Requires-Dist: setuptools>=38.6.0; extra == "dev"
-Requires-Dist: tox>=3.18.0; extra == "dev"
+Requires-Dist: tox>=4.0.0; extra == "dev"
 Requires-Dist: tqdm>4.32; extra == "dev"
 Requires-Dist: twine>=1.13; extra == "dev"
+Requires-Dist: wheel; extra == "dev"
+Requires-Dist: sphinx>=6.0.0; extra == "dev"
+Requires-Dist: sphinx-autobuild>=2021.3.14; extra == "dev"
+Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
+Requires-Dist: towncrier<22,>=21; extra == "dev"
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "dev"
+Requires-Dist: py-geth>=4.1.0; extra == "dev"
+Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "dev"
+Requires-Dist: pytest-mock>=1.10; extra == "dev"
+Requires-Dist: pytest-xdist>=2.4.0; extra == "dev"
+Requires-Dist: pytest>=7.0.0; extra == "dev"
+Provides-Extra: docs
+Requires-Dist: sphinx>=6.0.0; extra == "docs"
+Requires-Dist: sphinx-autobuild>=2021.3.14; extra == "docs"
+Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
+Requires-Dist: towncrier<22,>=21; extra == "docs"
+Provides-Extra: test
+Requires-Dist: eth-tester[py-evm]<0.12.0b1,>=0.11.0b1; extra == "test"
+Requires-Dist: py-geth>=4.1.0; extra == "test"
+Requires-Dist: pytest-asyncio<0.23,>=0.18.1; extra == "test"
+Requires-Dist: pytest-mock>=1.10; extra == "test"
+Requires-Dist: pytest-xdist>=2.4.0; extra == "test"
+Requires-Dist: pytest>=7.0.0; extra == "test"
 
 # web3.py
 
-[![Documentation Status](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
-[![Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
+[![Join the conversation on Discord](https://img.shields.io/discord/809793915578089484?color=blue&label=chat&logo=discord&logoColor=white)](https://discord.gg/GHryRvPB84)
 [![Build Status](https://circleci.com/gh/ethereum/web3.py.svg?style=shield)](https://circleci.com/gh/ethereum/web3.py)
+[![PyPI version](https://badge.fury.io/py/web3.svg)](https://badge.fury.io/py/web3)
+[![Python versions](https://img.shields.io/pypi/pyversions/web3.svg)](https://pypi.python.org/pypi/web3)
+[![Docs build](https://readthedocs.org/projects/web3py/badge/?version=latest)](https://web3py.readthedocs.io/en/latest/?badge=latest)
 
 A Python library for interacting with Ethereum.
 
 - Python 3.8+ support
 
 ______________________________________________________________________
```

### Comparing `web3-7.0.0b5/web3.egg-info/requires.txt` & `web3-7.0.0b6/web3.egg-info/requires.txt`

 * *Files 12% similar despite different names*

```diff
@@ -11,35 +11,43 @@
 websockets>=10.0.0
 pyunormalize>=15.0.0
 
 [:platform_system == "Windows"]
 pywin32>=223
 
 [dev]
-eth-tester[py-evm]<0.12.0b1,>=0.11.0b1
-py-geth>=4.1.0
-sphinx>=5.3.0
-sphinx_rtd_theme>=1.0.0
-towncrier<22,>=21
 build>=0.9.0
-bumpversion
+bumpversion>=0.5.3
 flaky>=3.7.0
 hypothesis>=3.31.2
+ipython
 pre-commit>=3.4.0
-pytest-asyncio<0.23,>=0.18.1
+pytest-asyncio<0.23,>=0.21.2
 pytest-mock>=1.10
-pytest-watch>=4.2
-pytest-xdist>=1.29
-pytest>=7.0.0
 setuptools>=38.6.0
-tox>=3.18.0
+tox>=4.0.0
 tqdm>4.32
 twine>=1.13
+wheel
+sphinx>=6.0.0
+sphinx-autobuild>=2021.3.14
+sphinx_rtd_theme>=1.0.0
+towncrier<22,>=21
+eth-tester[py-evm]<0.12.0b1,>=0.11.0b1
+py-geth>=4.1.0
+pytest-asyncio<0.23,>=0.18.1
+pytest-xdist>=2.4.0
+pytest>=7.0.0
 
 [docs]
-sphinx>=5.3.0
+sphinx>=6.0.0
+sphinx-autobuild>=2021.3.14
 sphinx_rtd_theme>=1.0.0
 towncrier<22,>=21
 
-[tester]
+[test]
 eth-tester[py-evm]<0.12.0b1,>=0.11.0b1
 py-geth>=4.1.0
+pytest-asyncio<0.23,>=0.18.1
+pytest-mock>=1.10
+pytest-xdist>=2.4.0
+pytest>=7.0.0
```

